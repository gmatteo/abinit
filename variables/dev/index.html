
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="dev input variables">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <link rel="canonical" href="https://gmatteo.github.io/abinit/variables/dev/">
      
      
        <link rel="prev" href="../bse/">
      
      
        <link rel="next" href="../dmft/">
      
      
      <link rel="icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.43">
    
    
      
        <title>Developers - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
    
      
    

    <!--
    IMPORTANT: Don't use boostrap in particular boostrap.css since it comes into conflict with mkdocs-material theme.
    Prefer low-level tools based on Jquery or JS library such as Tippyjs to get the work done.
    -->

    <!-- Jquery from Google CDN -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>
    -->

    <!-- jQuery Modal -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />

    <!-- Tippyjs for popovers https://atomiks.github.io/tippyjs/ -->
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />

    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <!-- MathJax support
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    -->

    <!-- This version is compatible with plotly. -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script>

    <!-- Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "boldsymbol.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // Workaround for bm package. See https://github.com/mathjax/MathJax/issues/1219
                bm: ["{\\boldsymbol #1}",1],
                // Mathcal symbols
                mcL: "{\\mathcal{L}}",
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // Acronyms
                KS: "{\\text{KS}}",
                eph: "{\\text{e-ph}}",
                ee: "{\\text{e-e}}",
                phph: "{\\text{ph-ph}}",
                FM: "{\\text{FM}}",
                DW: "{\\text{DW}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // Symbols commonly used (k-points, eigenvalues ...)
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                bg: "{\\bf g}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kG: "{\\bf k + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                nk: "{n \\kk}",
                mk: "{, \\kk}",
                nks: "{n \\kk\\sigma}",
                mks: "{m \\kk\\sigma}",
                enk: "{\\varepsilon_\\nk}",
                emkq: "{\\varepsilon_{m\\kk+\\qq}}",
                qnu: "{\\qq \\nu}",
                wqnu: "{\\omega_{\\qnu}}",
                vnk: "{\\mathbf{v}_{n\\kk}}",
                vmkq: "{\\mathbf{v}_{m\\kk+\\qq}}",
                vnka: "{\\mathrm{v}_{n\\kk,\\alpha}}",
                vnkb: "{\\mathrm{v}_{n\\kk,\\beta}}",
                ef: "{\\varepsilon_F}",
                // EPH quantities
                gkkp: "{g_{mn\\nu}(\\kk,\\qq)}",
                gkq: "{g_{mn\\nu}(\\kk,\\qq)}",
                //\newcommand{\gkkpL}{g_{mn\nu}^\Lc(\kb,\qb)}
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                Gove: "{\\overline{G}}",
                Gund: "{\\underline{G}}",
                // Greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    

    

    <!-- Load fonts used for input variables -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dev-input-variables" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="abinit" class="md-header__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            abinit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Developers
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../installation/" class="md-tabs__link">
          
  
  User Guides

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../topics/features/" class="md-tabs__link">
          
  
  Topics

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  Variables

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../tutorial/" class="md-tabs__link">
          
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../faq/configuration_and_compilation/" class="md-tabs__link">
          
  
  FAQ

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../theory/geometry/" class="md-tabs__link">
          
  
  Theory

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../developers/git_and_gitlab/" class="md-tabs__link">
          
  
  Developers

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../about/release-notes/" class="md-tabs__link">
          
  
  About

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="abinit" class="md-nav__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    abinit
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    User Guides
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            User Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_1" >
        
          
          <label class="md-nav__link" for="__nav_1_1" id="__nav_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Installation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_1">
            <span class="md-nav__icon md-icon"></span>
            Installation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HowTo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_MacOS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MacOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_Ubuntu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ubuntu
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_CentOS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CentOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_EasyBuild/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EasyBuild
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_gpu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GPUs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NewUser
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abitk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abitk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/aim/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aim
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/anaddb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Anaddb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/atdep/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aTDEP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/cut3d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cut3d
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/fold2bloch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fold2Bloch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgddb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mrgddb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgscr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mrgscr
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/multibinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multibinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/optic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/respfn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Respfn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/spacegroup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spacegroup
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Topics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Topics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Topic List
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Abipy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abipy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/APPA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    APPA
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Artificial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Artificial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/aTDEP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aTDEP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomCentered/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AtomCentered
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomManipulator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AtomManipulator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomTypes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AtomTypes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Bader/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bader
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Band2eps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Band2eps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Berry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Berry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BandOcc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BandOcc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BSE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BSE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BoundingProcess/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BoundingProcess
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedDFT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ConstrainedDFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedPol/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ConstrainedPol
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Coulomb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coulomb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CrossingBarriers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CrossingBarriers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CalcUJ/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CalcUJ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/crystal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Crystal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFT%2BU/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFT+U
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DeltaSCF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DeltaSCF
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DensityPotential/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DensityPotential
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Dev/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dev
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFPT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DMFT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DMFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DynamicsMultibinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DynamicsMultibinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EffectiveMass/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EffectiveMass
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EFG/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EFG
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Elastic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Elastic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonInt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ElPhonInt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonTransport/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ElPhonTransport
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecDOS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ElecDOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecBandStructure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ElecBandStructure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ExtFPMD/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ExtFPMD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FileFormats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FileFormats
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FitProcess/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FitProcess
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ForcesStresses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForcesStresses
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FrequencyMeshMBPT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FrequencyMeshMBPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoConstraints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GeoConstraints
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoOpt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GeoOpt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Git/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GSintroduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GSintroduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GW/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWR/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GWR
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWls/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GWls
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Hybrids/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hybrids
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/k-points/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    K points
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeModel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LatticeModel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeWannier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LatticeWannier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LWFModel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LWFModel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LDAminushalf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LDAminushalf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LOTF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LOTF
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/longwave/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Longwave
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Macroave/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Macroave
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagField/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MagField
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagMom/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MagMom
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MolecularDynamics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MolecularDynamics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/multidtset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multidtset
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/NMR/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NMR
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/nonlinear/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nonlinear
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Optic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Output/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Output
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/parallelism/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallelism
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PAW/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PAW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PIMD/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PIMD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Planewaves/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Planewaves
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Phonons/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phonons
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononBands/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PhononBands
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononWidth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PhononWidth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Polaron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Polaron
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PortabilityNonRegression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PortabilityNonRegression
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/positron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Positron
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/printing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Printing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PseudosPAW/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PseudosPAW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/q-points/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Q points
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RandStopPow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RandStopPow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Recursion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Recursion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RPACorrEn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RPACorrEn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RTTDDFT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RTTDDFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFControl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SCFControl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFAlgorithms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SCFAlgorithms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SelfEnergy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SelfEnergy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SmartSymm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SmartSymm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/spinpolarisation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spinpolarisation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SpinDynamicsMultibinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SpinDynamicsMultibinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/STM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    STM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Susceptibility/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Susceptibility
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDDFT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TDDFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDepES/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TDepES
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Temperature/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Temperature
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TransPath/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TransPath
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TuningSpeedMem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TuningSpeedMem
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Unfolding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unfolding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/UnitCell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UnitCell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/vdw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vdw
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Verification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Verification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wannier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wannier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wavelets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wavelets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/xc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Xc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/external_resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    External Resources
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Variables
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Variables
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    All Variables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" checked>
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Abinit
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Abinit
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bethe-Salpeter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Developers
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Developers
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#builtintest" class="md-nav__link">
    <span class="md-ellipsis">
      builtintest
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cprj_update_lvl" class="md-nav__link">
    <span class="md-ellipsis">
      cprj_update_lvl
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#densfor_pred" class="md-nav__link">
    <span class="md-ellipsis">
      densfor_pred
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#densty" class="md-nav__link">
    <span class="md-ellipsis">
      densty
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dmft_read_occnd" class="md-nav__link">
    <span class="md-ellipsis">
      dmft_read_occnd
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dmftctqmc_basis" class="md-nav__link">
    <span class="md-ellipsis">
      dmftctqmc_basis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#effmass_free" class="md-nav__link">
    <span class="md-ellipsis">
      effmass_free
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eshift" class="md-nav__link">
    <span class="md-ellipsis">
      eshift
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exchmix" class="md-nav__link">
    <span class="md-ellipsis">
      exchmix
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exchn2n3d" class="md-nav__link">
    <span class="md-ellipsis">
      exchn2n3d
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extrapwf" class="md-nav__link">
    <span class="md-ellipsis">
      extrapwf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fermie_nest" class="md-nav__link">
    <span class="md-ellipsis">
      fermie_nest
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fft_count" class="md-nav__link">
    <span class="md-ellipsis">
      fft_count
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fftalg" class="md-nav__link">
    <span class="md-ellipsis">
      fftalg
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fftcache" class="md-nav__link">
    <span class="md-ellipsis">
      fftcache
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getgam_eig2nkq" class="md-nav__link">
    <span class="md-ellipsis">
      getgam_eig2nkq
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getwfkfine" class="md-nav__link">
    <span class="md-ellipsis">
      getwfkfine
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#intxc" class="md-nav__link">
    <span class="md-ellipsis">
      intxc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#invovl_blksliced" class="md-nav__link">
    <span class="md-ellipsis">
      invovl_blksliced
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iomode" class="md-nav__link">
    <span class="md-ellipsis">
      iomode
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ionmov" class="md-nav__link">
    <span class="md-ellipsis">
      ionmov
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iprcfc" class="md-nav__link">
    <span class="md-ellipsis">
      iprcfc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#irandom" class="md-nav__link">
    <span class="md-ellipsis">
      irandom
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#irdwfkfine" class="md-nav__link">
    <span class="md-ellipsis">
      irdwfkfine
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#isecur" class="md-nav__link">
    <span class="md-ellipsis">
      isecur
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#istatr" class="md-nav__link">
    <span class="md-ellipsis">
      istatr
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#istatshft" class="md-nav__link">
    <span class="md-ellipsis">
      istatshft
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#istwfk" class="md-nav__link">
    <span class="md-ellipsis">
      istwfk
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lotf_classic" class="md-nav__link">
    <span class="md-ellipsis">
      lotf_classic
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lotf_nitex" class="md-nav__link">
    <span class="md-ellipsis">
      lotf_nitex
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lotf_nneigx" class="md-nav__link">
    <span class="md-ellipsis">
      lotf_nneigx
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lotf_version" class="md-nav__link">
    <span class="md-ellipsis">
      lotf_version
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#macro_uj" class="md-nav__link">
    <span class="md-ellipsis">
      macro_uj
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#maxnsym" class="md-nav__link">
    <span class="md-ellipsis">
      maxnsym
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mem_test" class="md-nav__link">
    <span class="md-ellipsis">
      mem_test
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mixprec" class="md-nav__link">
    <span class="md-ellipsis">
      mixprec
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mqgrid" class="md-nav__link">
    <span class="md-ellipsis">
      mqgrid
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nbdblock" class="md-nav__link">
    <span class="md-ellipsis">
      nbdblock
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nc_xccc_gspace" class="md-nav__link">
    <span class="md-ellipsis">
      nc_xccc_gspace
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nctime" class="md-nav__link">
    <span class="md-ellipsis">
      nctime
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nloc_alg" class="md-nav__link">
    <span class="md-ellipsis">
      nloc_alg
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nloc_mem" class="md-nav__link">
    <span class="md-ellipsis">
      nloc_mem
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nnsclo" class="md-nav__link">
    <span class="md-ellipsis">
      nnsclo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nnsclohf" class="md-nav__link">
    <span class="md-ellipsis">
      nnsclohf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nonlop_ylm_count" class="md-nav__link">
    <span class="md-ellipsis">
      nonlop_ylm_count
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#normpawu" class="md-nav__link">
    <span class="md-ellipsis">
      normpawu
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#npulayit" class="md-nav__link">
    <span class="md-ellipsis">
      npulayit
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nscforder" class="md-nav__link">
    <span class="md-ellipsis">
      nscforder
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optforces" class="md-nav__link">
    <span class="md-ellipsis">
      optforces
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optnlxccc" class="md-nav__link">
    <span class="md-ellipsis">
      optnlxccc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ortalg" class="md-nav__link">
    <span class="md-ellipsis">
      ortalg
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#papiopt" class="md-nav__link">
    <span class="md-ellipsis">
      papiopt
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawprt_b" class="md-nav__link">
    <span class="md-ellipsis">
      pawprt_b
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawprt_k" class="md-nav__link">
    <span class="md-ellipsis">
      pawprt_k
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawujat" class="md-nav__link">
    <span class="md-ellipsis">
      pawujat
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawujrad" class="md-nav__link">
    <span class="md-ellipsis">
      pawujrad
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawujv" class="md-nav__link">
    <span class="md-ellipsis">
      pawujv
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plowan_bandf" class="md-nav__link">
    <span class="md-ellipsis">
      plowan_bandf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plowan_bandi" class="md-nav__link">
    <span class="md-ellipsis">
      plowan_bandi
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plowan_compute" class="md-nav__link">
    <span class="md-ellipsis">
      plowan_compute
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plowan_iatom" class="md-nav__link">
    <span class="md-ellipsis">
      plowan_iatom
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plowan_it" class="md-nav__link">
    <span class="md-ellipsis">
      plowan_it
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plowan_lcalc" class="md-nav__link">
    <span class="md-ellipsis">
      plowan_lcalc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plowan_natom" class="md-nav__link">
    <span class="md-ellipsis">
      plowan_natom
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plowan_nbl" class="md-nav__link">
    <span class="md-ellipsis">
      plowan_nbl
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plowan_nt" class="md-nav__link">
    <span class="md-ellipsis">
      plowan_nt
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plowan_projcalc" class="md-nav__link">
    <span class="md-ellipsis">
      plowan_projcalc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plowan_realspace" class="md-nav__link">
    <span class="md-ellipsis">
      plowan_realspace
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepscphon" class="md-nav__link">
    <span class="md-ellipsis">
      prepscphon
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtbltztrp" class="md-nav__link">
    <span class="md-ellipsis">
      prtbltztrp
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtcif" class="md-nav__link">
    <span class="md-ellipsis">
      prtcif
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtdipole" class="md-nav__link">
    <span class="md-ellipsis">
      prtdipole
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtposcar" class="md-nav__link">
    <span class="md-ellipsis">
      prtposcar
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtprocar" class="md-nav__link">
    <span class="md-ellipsis">
      prtprocar
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recefermi" class="md-nav__link">
    <span class="md-ellipsis">
      recefermi
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recgratio" class="md-nav__link">
    <span class="md-ellipsis">
      recgratio
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recnpath" class="md-nav__link">
    <span class="md-ellipsis">
      recnpath
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recnrec" class="md-nav__link">
    <span class="md-ellipsis">
      recnrec
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recptrott" class="md-nav__link">
    <span class="md-ellipsis">
      recptrott
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recrcut" class="md-nav__link">
    <span class="md-ellipsis">
      recrcut
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rectesteg" class="md-nav__link">
    <span class="md-ellipsis">
      rectesteg
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rectolden" class="md-nav__link">
    <span class="md-ellipsis">
      rectolden
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#symmorphi" class="md-nav__link">
    <span class="md-ellipsis">
      symmorphi
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tfkinfunc" class="md-nav__link">
    <span class="md-ellipsis">
      tfkinfunc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tfw_toldfe" class="md-nav__link">
    <span class="md-ellipsis">
      tfw_toldfe
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tolrde" class="md-nav__link">
    <span class="md-ellipsis">
      tolrde
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use_gemm_nonlop" class="md-nav__link">
    <span class="md-ellipsis">
      use_gemm_nonlop
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use_nonscf_gkk" class="md-nav__link">
    <span class="md-ellipsis">
      use_nonscf_gkk
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usedmft" class="md-nav__link">
    <span class="md-ellipsis">
      usedmft
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usepotzero" class="md-nav__link">
    <span class="md-ellipsis">
      usepotzero
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#useria" class="md-nav__link">
    <span class="md-ellipsis">
      useria
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#userib" class="md-nav__link">
    <span class="md-ellipsis">
      userib
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#useric" class="md-nav__link">
    <span class="md-ellipsis">
      useric
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#userid" class="md-nav__link">
    <span class="md-ellipsis">
      userid
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#userie" class="md-nav__link">
    <span class="md-ellipsis">
      userie
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#userra" class="md-nav__link">
    <span class="md-ellipsis">
      userra
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#userrb" class="md-nav__link">
    <span class="md-ellipsis">
      userrb
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#userrc" class="md-nav__link">
    <span class="md-ellipsis">
      userrc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#userrd" class="md-nav__link">
    <span class="md-ellipsis">
      userrd
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#userre" class="md-nav__link">
    <span class="md-ellipsis">
      userre
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#useylm" class="md-nav__link">
    <span class="md-ellipsis">
      useylm
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vloc_rcut" class="md-nav__link">
    <span class="md-ellipsis">
      vloc_rcut
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wfoptalg" class="md-nav__link">
    <span class="md-ellipsis">
      wfoptalg
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xc_taupos" class="md-nav__link">
    <span class="md-ellipsis">
      xc_taupos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xc_tb09_c" class="md-nav__link">
    <span class="md-ellipsis">
      xc_tb09_c
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xg_nonlop_option" class="md-nav__link">
    <span class="md-ellipsis">
      xg_nonlop_option
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dmft/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DMFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eph/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Electron-Phonon
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ffield/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Varff
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File-handling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geometry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gstate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ground-State
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../internal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Internal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paral/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallelism
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PAW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dfpt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rlx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Relaxation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rttddft/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RTTDDFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vdw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VdW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../w90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wannier90
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../anaddb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Anaddb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../atdep/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aTDEP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../multibinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multibinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../optic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aim/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aim
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../external_parameters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    External Parameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../varset_stats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Statistics
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Basic tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Basic tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/base1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    basic1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/base2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    basic2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/base3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    basic3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/base4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    basic4
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/abinit_build/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ABINIT_build
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paw1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PAW1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/spin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/polarization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Polarization & finite field
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/rf1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFPT1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/rf2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFPT2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/basepar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallelism
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_10" >
        
          
          <label class="md-nav__link" for="__nav_4_10" id="__nav_4_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ABINIT postprocessors
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_10">
            <span class="md-nav__icon md-icon"></span>
            ABINIT postprocessors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/atdep1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aTDEP1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/cut3d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cut3D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/fold2bloch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fold2bloch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/optic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    optic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/wannier90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wannier90
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/z2pack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Z2pack
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_11" >
        
          
          <label class="md-nav__link" for="__nav_4_11" id="__nav_4_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DFT beyond basics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_11">
            <span class="md-nav__icon md-icon"></span>
            DFT beyond basics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/nuc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    properties at the nucleus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/dftu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFT+U
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/ucalc_crpa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cRPA U(J)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lruj/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linear Response U(J)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paw2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PAW2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paw3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PAW3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/positron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    positron
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_12" >
        
          
          <label class="md-nav__link" for="__nav_4_12" id="__nav_4_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Many-Body Theory & excitations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_12">
            <span class="md-nav__icon md-icon"></span>
            Many-Body Theory & excitations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/gw1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GW1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/gw2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GW2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/gwr_intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GWR_intro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/gwr1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GWR1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/bse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bethe-Salpeter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/dmft/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DMFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/tddft/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TDDFT (Casida)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/rttddft/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RT-TDDFT
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_13" >
        
          
          <label class="md-nav__link" for="__nav_4_13" id="__nav_4_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DFPT & electron-phonon
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_13">
            <span class="md-nav__icon md-icon"></span>
            DFPT & electron-phonon
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/elastic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    elastic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/nlo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nonlinear
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lattice_wannier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lattice_wannier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lw_quad/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    quadrupoles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph_intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph_intro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph4mob/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph for mobilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph4zpr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph for zero-point renormalization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph4vpq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph for variational polaron equations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph_legacy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph_legacy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/eph_tdep_legacy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph_tdep_legacy
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_14" >
        
          
          <label class="md-nav__link" for="__nav_4_14" id="__nav_4_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Multibinit
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_14">
            <span class="md-nav__icon md-icon"></span>
            Multibinit
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/multibinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    introduction to multibinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lattice_model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lattice_model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/spin_model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spin_model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/lwf_model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lwf_model
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_15" >
        
          
          <label class="md-nav__link" for="__nav_4_15" id="__nav_4_15_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Advanced parallelism
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_15">
            <span class="md-nav__icon md-icon"></span>
            Advanced parallelism
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_bandpw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_band_PW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_gswvl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_wavelets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_moldyn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_MD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_images/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_images
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_dfpt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_DFPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/paral_mbt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_MBPT
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            FAQ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/configuration_and_compilation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration and compilation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/general_questions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General questions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/pre_and_post_processing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pre/Post processing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/ground_state/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ground state
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/dfpt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/Troubleshooting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Troubleshooting (old-dokuwiki)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/tuning_abinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tuning (old-dokuwiki)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Theory
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Theory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/geometry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geometry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/spherical_harmonics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spherical Harmonics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/wavefunctions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wavefunctions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/noncollinear/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Noncollinear
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/pseudopotentials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pseudopotentials
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/mbt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Many-Body Perturbation Theory
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bethe-Salpeter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/documents/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Documents
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acknowledgments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Acknowledgments
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bibliography/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bibliography
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acronyms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Acronyms
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Developers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Developers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/git_and_gitlab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git and Gitlab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/developers_howto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HowTo for developers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/abimkdocs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abimkdocs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/markdown/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Markdown
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_5" >
        
          
          <label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Test Suite
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_5">
            <span class="md-nav__icon md-icon"></span>
            Test Suite
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test list
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite_howto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Suite Howto
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/new_testsuite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YAML-based test suite Howto
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/yaml_tools_api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YAML-based test suite Python tools and API
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/XgType/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XgType
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_7" >
        
          
          <label class="md-nav__link" for="__nav_7_7" id="__nav_7_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pseudos
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_7">
            <span class="md-nav__icon md-icon"></span>
            Pseudos
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp1_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp3_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp45_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp45
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp5spinorbit_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp5
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp6_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp6
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp8_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp8
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/codestats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code stats
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/autoconf_examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Autoconf_examples
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testlink/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Page for linkcheck
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    About
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            About
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/release-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release Notes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/history/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    History
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#builtintest" class="md-nav__link">
    <span class="md-ellipsis">
      builtintest
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cprj_update_lvl" class="md-nav__link">
    <span class="md-ellipsis">
      cprj_update_lvl
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#densfor_pred" class="md-nav__link">
    <span class="md-ellipsis">
      densfor_pred
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#densty" class="md-nav__link">
    <span class="md-ellipsis">
      densty
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dmft_read_occnd" class="md-nav__link">
    <span class="md-ellipsis">
      dmft_read_occnd
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dmftctqmc_basis" class="md-nav__link">
    <span class="md-ellipsis">
      dmftctqmc_basis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#effmass_free" class="md-nav__link">
    <span class="md-ellipsis">
      effmass_free
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eshift" class="md-nav__link">
    <span class="md-ellipsis">
      eshift
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exchmix" class="md-nav__link">
    <span class="md-ellipsis">
      exchmix
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exchn2n3d" class="md-nav__link">
    <span class="md-ellipsis">
      exchn2n3d
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extrapwf" class="md-nav__link">
    <span class="md-ellipsis">
      extrapwf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fermie_nest" class="md-nav__link">
    <span class="md-ellipsis">
      fermie_nest
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fft_count" class="md-nav__link">
    <span class="md-ellipsis">
      fft_count
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fftalg" class="md-nav__link">
    <span class="md-ellipsis">
      fftalg
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fftcache" class="md-nav__link">
    <span class="md-ellipsis">
      fftcache
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getgam_eig2nkq" class="md-nav__link">
    <span class="md-ellipsis">
      getgam_eig2nkq
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getwfkfine" class="md-nav__link">
    <span class="md-ellipsis">
      getwfkfine
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#intxc" class="md-nav__link">
    <span class="md-ellipsis">
      intxc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#invovl_blksliced" class="md-nav__link">
    <span class="md-ellipsis">
      invovl_blksliced
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iomode" class="md-nav__link">
    <span class="md-ellipsis">
      iomode
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ionmov" class="md-nav__link">
    <span class="md-ellipsis">
      ionmov
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iprcfc" class="md-nav__link">
    <span class="md-ellipsis">
      iprcfc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#irandom" class="md-nav__link">
    <span class="md-ellipsis">
      irandom
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#irdwfkfine" class="md-nav__link">
    <span class="md-ellipsis">
      irdwfkfine
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#isecur" class="md-nav__link">
    <span class="md-ellipsis">
      isecur
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#istatr" class="md-nav__link">
    <span class="md-ellipsis">
      istatr
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#istatshft" class="md-nav__link">
    <span class="md-ellipsis">
      istatshft
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#istwfk" class="md-nav__link">
    <span class="md-ellipsis">
      istwfk
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lotf_classic" class="md-nav__link">
    <span class="md-ellipsis">
      lotf_classic
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lotf_nitex" class="md-nav__link">
    <span class="md-ellipsis">
      lotf_nitex
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lotf_nneigx" class="md-nav__link">
    <span class="md-ellipsis">
      lotf_nneigx
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lotf_version" class="md-nav__link">
    <span class="md-ellipsis">
      lotf_version
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#macro_uj" class="md-nav__link">
    <span class="md-ellipsis">
      macro_uj
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#maxnsym" class="md-nav__link">
    <span class="md-ellipsis">
      maxnsym
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mem_test" class="md-nav__link">
    <span class="md-ellipsis">
      mem_test
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mixprec" class="md-nav__link">
    <span class="md-ellipsis">
      mixprec
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mqgrid" class="md-nav__link">
    <span class="md-ellipsis">
      mqgrid
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nbdblock" class="md-nav__link">
    <span class="md-ellipsis">
      nbdblock
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nc_xccc_gspace" class="md-nav__link">
    <span class="md-ellipsis">
      nc_xccc_gspace
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nctime" class="md-nav__link">
    <span class="md-ellipsis">
      nctime
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nloc_alg" class="md-nav__link">
    <span class="md-ellipsis">
      nloc_alg
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nloc_mem" class="md-nav__link">
    <span class="md-ellipsis">
      nloc_mem
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nnsclo" class="md-nav__link">
    <span class="md-ellipsis">
      nnsclo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nnsclohf" class="md-nav__link">
    <span class="md-ellipsis">
      nnsclohf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nonlop_ylm_count" class="md-nav__link">
    <span class="md-ellipsis">
      nonlop_ylm_count
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#normpawu" class="md-nav__link">
    <span class="md-ellipsis">
      normpawu
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#npulayit" class="md-nav__link">
    <span class="md-ellipsis">
      npulayit
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nscforder" class="md-nav__link">
    <span class="md-ellipsis">
      nscforder
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optforces" class="md-nav__link">
    <span class="md-ellipsis">
      optforces
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optnlxccc" class="md-nav__link">
    <span class="md-ellipsis">
      optnlxccc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ortalg" class="md-nav__link">
    <span class="md-ellipsis">
      ortalg
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#papiopt" class="md-nav__link">
    <span class="md-ellipsis">
      papiopt
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawprt_b" class="md-nav__link">
    <span class="md-ellipsis">
      pawprt_b
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawprt_k" class="md-nav__link">
    <span class="md-ellipsis">
      pawprt_k
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawujat" class="md-nav__link">
    <span class="md-ellipsis">
      pawujat
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawujrad" class="md-nav__link">
    <span class="md-ellipsis">
      pawujrad
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pawujv" class="md-nav__link">
    <span class="md-ellipsis">
      pawujv
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plowan_bandf" class="md-nav__link">
    <span class="md-ellipsis">
      plowan_bandf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plowan_bandi" class="md-nav__link">
    <span class="md-ellipsis">
      plowan_bandi
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plowan_compute" class="md-nav__link">
    <span class="md-ellipsis">
      plowan_compute
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plowan_iatom" class="md-nav__link">
    <span class="md-ellipsis">
      plowan_iatom
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plowan_it" class="md-nav__link">
    <span class="md-ellipsis">
      plowan_it
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plowan_lcalc" class="md-nav__link">
    <span class="md-ellipsis">
      plowan_lcalc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plowan_natom" class="md-nav__link">
    <span class="md-ellipsis">
      plowan_natom
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plowan_nbl" class="md-nav__link">
    <span class="md-ellipsis">
      plowan_nbl
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plowan_nt" class="md-nav__link">
    <span class="md-ellipsis">
      plowan_nt
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plowan_projcalc" class="md-nav__link">
    <span class="md-ellipsis">
      plowan_projcalc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#plowan_realspace" class="md-nav__link">
    <span class="md-ellipsis">
      plowan_realspace
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepscphon" class="md-nav__link">
    <span class="md-ellipsis">
      prepscphon
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtbltztrp" class="md-nav__link">
    <span class="md-ellipsis">
      prtbltztrp
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtcif" class="md-nav__link">
    <span class="md-ellipsis">
      prtcif
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtdipole" class="md-nav__link">
    <span class="md-ellipsis">
      prtdipole
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtposcar" class="md-nav__link">
    <span class="md-ellipsis">
      prtposcar
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prtprocar" class="md-nav__link">
    <span class="md-ellipsis">
      prtprocar
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recefermi" class="md-nav__link">
    <span class="md-ellipsis">
      recefermi
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recgratio" class="md-nav__link">
    <span class="md-ellipsis">
      recgratio
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recnpath" class="md-nav__link">
    <span class="md-ellipsis">
      recnpath
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recnrec" class="md-nav__link">
    <span class="md-ellipsis">
      recnrec
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recptrott" class="md-nav__link">
    <span class="md-ellipsis">
      recptrott
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recrcut" class="md-nav__link">
    <span class="md-ellipsis">
      recrcut
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rectesteg" class="md-nav__link">
    <span class="md-ellipsis">
      rectesteg
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rectolden" class="md-nav__link">
    <span class="md-ellipsis">
      rectolden
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#symmorphi" class="md-nav__link">
    <span class="md-ellipsis">
      symmorphi
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tfkinfunc" class="md-nav__link">
    <span class="md-ellipsis">
      tfkinfunc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tfw_toldfe" class="md-nav__link">
    <span class="md-ellipsis">
      tfw_toldfe
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tolrde" class="md-nav__link">
    <span class="md-ellipsis">
      tolrde
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use_gemm_nonlop" class="md-nav__link">
    <span class="md-ellipsis">
      use_gemm_nonlop
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use_nonscf_gkk" class="md-nav__link">
    <span class="md-ellipsis">
      use_nonscf_gkk
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usedmft" class="md-nav__link">
    <span class="md-ellipsis">
      usedmft
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usepotzero" class="md-nav__link">
    <span class="md-ellipsis">
      usepotzero
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#useria" class="md-nav__link">
    <span class="md-ellipsis">
      useria
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#userib" class="md-nav__link">
    <span class="md-ellipsis">
      userib
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#useric" class="md-nav__link">
    <span class="md-ellipsis">
      useric
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#userid" class="md-nav__link">
    <span class="md-ellipsis">
      userid
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#userie" class="md-nav__link">
    <span class="md-ellipsis">
      userie
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#userra" class="md-nav__link">
    <span class="md-ellipsis">
      userra
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#userrb" class="md-nav__link">
    <span class="md-ellipsis">
      userrb
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#userrc" class="md-nav__link">
    <span class="md-ellipsis">
      userrc
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#userrd" class="md-nav__link">
    <span class="md-ellipsis">
      userrd
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#userre" class="md-nav__link">
    <span class="md-ellipsis">
      userre
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#useylm" class="md-nav__link">
    <span class="md-ellipsis">
      useylm
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vloc_rcut" class="md-nav__link">
    <span class="md-ellipsis">
      vloc_rcut
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wfoptalg" class="md-nav__link">
    <span class="md-ellipsis">
      wfoptalg
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xc_taupos" class="md-nav__link">
    <span class="md-ellipsis">
      xc_taupos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xc_tb09_c" class="md-nav__link">
    <span class="md-ellipsis">
      xc_tb09_c
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#xg_nonlop_option" class="md-nav__link">
    <span class="md-ellipsis">
      xg_nonlop_option
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                

                  

  
  


<!--
This file is automatically generated by mksite.py. All changes will be lost.
Change the input yaml files or the python code
-->
<h1 id="dev-input-variables">dev input variables<a class="headerlink" href="#dev-input-variables" title="Permanent link">&para;</a></h1>
<p>This document lists and provides the description of the name (keywords) of the
dev input variables to be used in the input file for the abinit executable.</p>
<h2 id="builtintest"><strong>builtintest</strong><a class="headerlink" href="#builtintest" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> BUILT-IN TEST number<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to control the flow of ABINIT" data-toggle="popover" href="/topics/Control">topic_Control</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Moderately used, [14/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT. Very quick built-in test, to check that BigDFT is installed." data-toggle="popover" href="/tests/bigdft/Input/t00.abi" target="_blank">t00.abi</a></li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm." data-toggle="popover" href="/tests/built-in/Input/testin_fast.abi" target="_blank">testin_fast.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent" data-toggle="popover" href="/tests/built-in/Input/testin_v1.abi" target="_blank">testin_v1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces" data-toggle="popover" href="/tests/built-in/Input/testin_v5.abi" target="_blank">testin_v5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT" data-toggle="popover" href="/tests/built-in/Input/testin_bigdft.abi" target="_blank">testin_bigdft.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file." data-toggle="popover" href="/tests/built-in/Input/testin_etsf_io.abi" target="_blank">testin_etsf_io.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC" data-toggle="popover" href="/tests/built-in/Input/testin_libxc.abi" target="_blank">testin_libxc.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands." data-toggle="popover" href="/tests/built-in/Input/testin_wannier90.abi" target="_blank">testin_wannier90.abi</a></li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a></li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm.
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/fast/Input/t00.abi" target="_blank">t00.abi</a></li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="Bi atom with PAW, GGA PBE from LibXC
Very quick built-in test, to check that LibXC is installed." data-toggle="popover" href="/tests/libxc/Input/t00.abi" target="_blank">t00.abi</a></li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent
Very quick built-in test, to check that ABINIT works." data-toggle="popover" href="/tests/v1/Input/t00.abi" target="_blank">t00.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="HBe molecule, spin-polarized, determination of forces
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/v5/Input/t00.abi" target="_blank">t00.abi</a></li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands. Very quick built-in test, to check that Wannier90 is installed." data-toggle="popover" href="/tests/wannier90/Input/t00.abi" target="_blank">t00.abi</a></li>
</ul>
</details>
<p>When  <strong>builtintest</strong>  is non-zero, the input file is a special one, that runs
very quickly, and that is accompanied by a specific analysis by ABINIT, at the
end of the run, against a hard-coded value of total energy (and possibly
stresses, forces &hellip;). The echo of the analysis is done in the STATUS file. In
particular, such built-in tests can be used to check quickly whether ABINIT
fallbacks have been connected or not (bigdft, netcdf, libxc, wannier90). At
present,  <strong>builtintest</strong>  = 1&hellip; 7 are allowed. See more information in tests/built-in/README.</p>
<h2 id="cprj_update_lvl"><strong>cprj_update_lvl</strong><a class="headerlink" href="#cprj_update_lvl" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> C-PRoJectors UPDATE LeVeL<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to tune the speed and memory usage" data-toggle="popover" href="/topics/TuningSpeedMem">topic_TuningSpeedMem</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em>   </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [4/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Quick test on AlAs (PAW) to check that different nloc_alg options give the correct energy.
Case istwfk=1." data-toggle="popover" href="/tests/v9/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Quick test on AlAs (PAW) to check that different nloc_alg options give the correct energy.
Case istwfk&gt;=2." data-toggle="popover" href="/tests/v9/Input/t72.abi" target="_blank">t72.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Quick test on AlAs (PAW) to check that different cprj_update_lvl options give the correct energy.
Compute forces and stress at the end of the run." data-toggle="popover" href="/tests/v9/Input/t73.abi" target="_blank">t73.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Quick test on AlAs (PAW) to check that different cprj_update_lvl options give the correct energy.
Compute forces at every iteration, compute stress at the end of the run." data-toggle="popover" href="/tests/v9/Input/t74.abi" target="_blank">t74.abi</a></li>
</ul>
</details>
<p>This variable is used to control the updates of &ldquo;cprj&rdquo; coefficients, which are kept in memory during the computation:</p>
<div class="arithmatex">\[ cprj(a,i) = &lt;p_{a,i}|\psi&gt; \]</div>
<p>Read the <a class="wikilink codevar-wikilink" href="/variables/gstate#cprj_in_memory">cprj_in_memory</a> documentation for details about the notations.
This feature is available only for <a class="wikilink codevar-wikilink" href="/variables/gstate#cprj_in_memory">cprj_in_memory</a> = 2.
&ldquo;cprj&rdquo; coefficients are computed at the beginning of the run and evolves as the wave-function do.
In principle, there is no need to compute &ldquo;cprj&rdquo; coefficients directly from the wave-functions again after they are initialized.
However, numerical errors can accumulate and lead to a significant difference between &ldquo;cprj&rdquo; coefficients and wave-functions.
One can update the &ldquo;cprj&rdquo; coefficients from time to time, computing them directly from the wave-functions, in different places in the code:</p>
<ul>
<li>
<p>A: at the beginning of the run, or after the move of atoms</p>
</li>
<li>
<p>B: after wave-functions orthogonalization</p>
</li>
<li>
<p>C: before the subspace diagonalization</p>
</li>
<li>
<p>D: at the end of an iteration in the conjugate gradient algorithm</p>
</li>
<li>
<p>E: at the beginning of the conjugate gradient algorithm</p>
</li>
</ul>
<p>The update is done depending on the  <strong>cprj_update_lvl</strong>  value according to the following table:</p>
<table>
<thead>
<tr>
<th>cprj_update_lvl</th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
<th>E</th>
</tr>
</thead>
<tbody>
<tr>
<td>4</td>
<td>X</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>3</td>
<td>X</td>
<td>X</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>X</td>
<td></td>
<td>X</td>
<td></td>
<td></td>
</tr>
<tr>
<td>1</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td></td>
<td></td>
</tr>
<tr>
<td>-1</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td></td>
</tr>
<tr>
<td>-2</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>X</td>
<td>X</td>
</tr>
</tbody>
</table>
<p>The updates B, C and E add one computation of &ldquo;cprj&rdquo; coefficients per SCF step (see <a class="wikilink codevar-wikilink" href="/variables/basic#nstep">nstep</a>), whereas the update D add one computation per &ldquo;line&rdquo; (see <a class="wikilink codevar-wikilink" href="/variables/gstate#nline">nline</a>).
Places D and E are activated only for negative values of  <strong>cprj_update_lvl</strong>  and should be used only for debugging.
One can count the number of non-local operations done in a dataset using <a class="wikilink codevar-wikilink" href="/variables/dev#nonlop_ylm_count">nonlop_ylm_count</a> to precisely measure the effect of  <strong>cprj_update_lvl</strong> .</p>
<h2 id="densfor_pred"><strong>densfor_pred</strong><a class="headerlink" href="#densfor_pred" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> DENSity and FORces PREDictor<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to select the SCF algorithm" data-toggle="popover" href="/topics/SCFAlgorithms">topic_SCFAlgorithms</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to perform a molecular dynamics calculation" data-toggle="popover" href="/topics/MolecularDynamics">topic_MolecularDynamics</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 6 if <a class="wikilink codevar-wikilink" href="/variables/paral#paral_kgb">paral_kgb</a> == 1,
2 otherwise.</p>
<p><em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> &gt; 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Moderately used, [37/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm." data-toggle="popover" href="/tests/built-in/Input/testin_fast.abi" target="_blank">testin_fast.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm.
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/fast/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Conduct relaxation of molecule starting from wf.19, using ionmov=2. (Broyden method)." data-toggle="popover" href="/tests/fast/Input/t20.abi" target="_blank">t20.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
21. Conduct same relaxation but use ionmov=1 (molecular dynamics)." data-toggle="popover" href="/tests/fast/Input/t21.abi" target="_blank">t21.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="Test of HSE06 in PAW" data-toggle="popover" href="/tests/libxc/Input/t53.abi" target="_blank">t53.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si, Bulk, 2 atoms , paral_kgb.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He FCC solid in conventional cell (4 atoms).
Test the recursion algorithm (for high-temperature calculations).
Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t42.abi" target="_blank">t42.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si, Bulk, 2 atoms , parallel IO. Test of ground state
Only with 4 procs, no sequential version (tests accesswf 1)" data-toggle="popover" href="/tests/mpiio/Input/t49.abi" target="_blank">t49.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si, Bulk, 2 atoms , paral_kgb.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/paral/Input/t21.abi" target="_blank">t21.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the option ionmov=4. 8-atom Si cube, non spin-polarized.
Same test as number 22a of fast, except for the change
of ionmov, no reading of wavefunctions, iscf to 2, and different
tolerance criteria." data-toggle="popover" href="/tests/v1/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the option ionmov=4. Si2 molecule, spin-polarized.
Same test as number 16 of fast, except for the change
of ionmov, no reading of wavefunctions, iscf to 2, and different
tolerance criteria.

Cannot be executed in parallel:
--- !ERROR
message: |
the number of bands in the spin up case must be equal to
the number of bands in the spin down case.
This is not the case for the k point number : 1
The number of bands spin up and down are : 5 3 Action : change nband, or use the sequential
version of ABINIT.
src_file: chkinp.F90
src_line: 1181
..." data-toggle="popover" href="/tests/v1/Input/t45.abi" target="_blank">t45.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, spin-polarized
Same as test 45, but use ithe default densfor_pred=2 instead of densfor_pred=1.
Cannot be executed in parallel:
--- !ERROR
message: |
the number of bands in the spin up case must be equal to
the number of bands in the spin down case.
This is not the case for the k point number : 1
The number of bands spin up and down are : 5 3 Action : change nband, or use the sequential
version of ABINIT.
src_file: chkinp.F90
src_line: 1181
..." data-toggle="popover" href="/tests/v1/Input/t48.abi" target="_blank">t48.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of Mg2 molecule chains, in a slab supercell geometry.
Symmetries are broken. k point (1/4 1/4 1/4)
Use of default values of fftalg and exchn2n3
Reference for test #92." data-toggle="popover" href="/tests/v4/Input/t91.abi" target="_blank">t91.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of Mg2 molecule chains, in a slab supercell geometry.
Symmetries are broken. k point (1/4 1/4 1/4)
Use fftalg 412 and exchn2n3 1.
Suitable for tests of space parallelisation." data-toggle="popover" href="/tests/v4/Input/t92.abi" target="_blank">t92.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of Ca, simple cubic , 2  k-point. Testing GS  energy and lobpcg algorithm." data-toggle="popover" href="/tests/v4/Input/t93.abi" target="_blank">t93.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for double grid (fine/coarse) system, the cutting
radius and the initial fermi energy in recursion method
Corresponding variables: recgratio, recrcut,recefermi respectively
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-toggle="popover" href="/tests/v5/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test for an electron gas by recursion method (Vtrial is set to zero)
Corresponding variable: rectesteg
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-toggle="popover" href="/tests/v5/Input/t76.abi" target="_blank">t76.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bismuth, rhombohedral, two atoms per unit cell
Scalar relativistic.
Relax four different images, using the steepest descent algorithm." data-toggle="popover" href="/tests/v6/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Hydrogen diatomic molecule in a cell, close to BCC
Test the string method : 6 images, exploring the transition
path. Similar to test 22 (but with string)." data-toggle="popover" href="/tests/v6/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Hydrogen diatomic molecule in a cell, close to BCC
Test the string method : 6 images, exploring the transition
path but keeping X coordinated fixed. Similar to test 24" data-toggle="popover" href="/tests/v6/Input/t25.abi" target="_blank">t25.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the extrapolation of then wave functions from
one structural relaxation (time) step to the other:
extrapwf=1
WARNING: this feature is stil experimental and probably buggy.
Si, Bulk, 2 atoms" data-toggle="popover" href="/tests/v7/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Nickel ferromagnetic fcc structure with an ONCVPSP pseudo containing valence density.
We test several improvements that are available when the NC file contains the PS valence charge.
More specifically, we test the initialization of the density from atomic quantities (initro.F90),
the correction to the forces due to the residuals and the extrapolation of the density
for structural relaxations (well, xred is fixed by symmetry).
We also test the treatment of the core charge in G-space in the case of GS calculations
By default, abinit handles XCCC in real space, here we use nc_xccc_gspace==1 to treat it
in G-space using the same approach as the one used in PAW." data-toggle="popover" href="/tests/v7/Input/t10.abi" target="_blank">t10.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Boron, 32 atoms - Thomas-Fermi method (without orbitals)
Test the temperature-dependent XC functional (ixc=50)
Ichimaru et al Phys. Rep. 149, 91-205 (1987)
Test the von Weizsacker gradient correction (tfkinfunc=11 or 12)" data-toggle="popover" href="/tests/v7/Input/t11.abi" target="_blank">t11.abi</a> &hellip;</li>
</ul>
</details>
<p>Used when <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> &gt; 0, to define:</p>
<ul>
<li>the way a change of density is derived from a change of atomic position,</li>
<li>the way forces are corrected when the SCF cycle is not converged.</li>
</ul>
<p>Supported values:</p>
<ul>
<li>0 &rarr; density not changed (fixed charge), forces not corrected</li>
<li>1 &rarr; density not changed, forces corrected with rigid ion hypothesis (atomic charge moved with atom)</li>
<li>2 &rarr; density changed and forces corrected with rigid ion hypothesis (atomic charge moves with atom)</li>
<li>3 &rarr; density changed and forces corrected with a different implementation of the rigid ion hypothesis</li>
<li>4 &rarr; density not changed, forces corrected with the use of Harris functional formula (see note)</li>
<li>5 &rarr; density changed using D. Alfe 2<sup>nd</sup>-order algorithm (see notes), forces not corrected</li>
<li>6 &rarr; density changed using D. Alfe 2<sup>nd</sup>-order algorithm (see notes) and forces corrected with the use of Harris functional formula</li>
</ul>
<p>Similar negative values are also allowed (see the meaning later), for
development purposes only. No meaning for RF calculations.</p>
<p>For the time being,</p>
<ul>
<li><strong>densfor_pred</strong>  = 3 must be used with <a class="wikilink codevar-wikilink" href="/variables/dev#ionmov">ionmov</a> = 4 and <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> = 5.</li>
<li><strong>densfor_pred</strong>  = 4, 5 or 6 must be used when band-FFT parallelism is selected.
  Otherwise, use  <strong>densfor_pred</strong>  = 2</li>
</ul>
<div class="admonition note">
<p class="admonition-title">About the correction to forces (use of  <strong>densfor_pred</strong>  = 1, 2, 3, 4 or 6)</p>
<p>The force on the atom located at R is corrected by the addition of the following
term: <span class="arithmatex">\(F_{residual}=\int dr V_{residual} \frac{d \rho_{atomic}}{dR}\)</span>,
where <span class="arithmatex">\(\rho_{atomic}\)</span> is an atomic (spherical) density.</p>
<ul>
<li>
<p>When such an atomic density (<span class="arithmatex">\(\rho_{atomic}\)</span>) is found in the pseudopotential or
PAW file, it is used. If not, a gaussian density (defined by <a class="wikilink codevar-wikilink" href="/variables/dev#densty">densty</a> parameter) is used.</p>
</li>
<li>
<p>When SCF mixing is done on the density (<a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> &gt;= 10), the potential
residual (<span class="arithmatex">\(V_{residual}\)</span>) is obtained from the density residual with the first
order formula <span class="arithmatex">\(V_{residual}=\frac{dV}{d \rho} \rho_{residual}\)</span>
and uses the exchange-correlation kernel <span class="arithmatex">\(K_{xc}=\frac{dV_{xc}}{d\rho}\)</span> whose computation
is time-consuming for GGA (or meta-GGA) functionals.</p>
</li>
<li>
<p>By default (positive values of  <strong>densfor_pred</strong> ), even for GGA and meta-GGA,
the local-density part of the exchange-correlation kernel is used, which gives a reasonable accuracy.
Using the full GGA exchange correlation kernel (so, including derivatives with respect to the gradient of
the density) is always possible by giving a negative value to  <strong>densfor_pred</strong> .</p>
</li>
<li>
<p>In case of hybrid functionals, a similar correction term is
added, although in the density mixing scheme, the related GGA kernel is used
instead of the hybrid functional kernel.</p>
</li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">About the use of  <strong>densfor_pred</strong>  = 5 or 6 (density prediction)</p>
<p>The algorithm is described in <a class="wikilink citation-wikilink" data-tippy-content="Ab initio molecular dynamics, a simple algorithm for charge extrapolation" data-toggle="popover" href="/theory/bibliography#alfe1999">[Alfe1999]</a>.
It uses an atomic (spherical) density. When such an atomic density
is found in the pseudopotential or PAW file, it is used. If not, a gaussian
density (defined by <a class="wikilink codevar-wikilink" href="/variables/dev#densty">densty</a> parameter) is used.
Also note that, to be efficient, this algorithm requires a minimum convergence
of the SCF cycle; Typically, vres2 (or nres2) has to be small enough (let&rsquo;s say smaller than 10e-4).</p>
</div>
<h2 id="densty"><strong>densty</strong><a class="headerlink" href="#densty" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> initial DENSity for each TYpe of atom<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the exchange and correlation functionals" data-toggle="popover" href="/topics/xc">topic_xc</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/basic#ntypat">ntypat</a>)<br />
<em>Default value:</em> 0.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Moderately used, [34/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Compute an optimal densty parameter for N. Atomic computation,
using multi-dataset mode." data-toggle="popover" href="/tests/v1/Input/t67.abi" target="_blank">t67.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Compute an optimal densty parameter for N2. Molecular computation,
using multi-dataset mode." data-toggle="popover" href="/tests/v1/Input/t68.abi" target="_blank">t68.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of X2 molecules (2 atoms per unit cell),
using alchemical atoms, GS only.
The first psp is Ge, the second one is Si, but the
mixing coefficients are 0.0 and 1.0 .
See previous test, except GS only, and the two atoms are switched." data-toggle="popover" href="/tests/v3/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of X2 molecules (2 atoms per unit cell),
using alchemical atoms, GS only.
The first psp is Si, the second one is Si, the
mixing coefficients are 0.2 and 0.8 , then, in a second
dataset, they are 0.5 and 0.5 .
Should give same numerical results as the previous test." data-toggle="popover" href="/tests/v3/Input/t94.abi" target="_blank">t94.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Linear chain of X2 molecules (2 atoms per unit cell),
using alchemical atoms, GS only.
The first psp is Si, the second one is Ge, the
mixing coefficients are 0.2 and 0.8, then
0.5 and 0.5 , then 0.001 and 0.999 ." data-toggle="popover" href="/tests/v3/Input/t95.abi" target="_blank">t95.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (1 Si2 molecule in the cell)
Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96).
The default fftcache=16 seems OK :
With fftcache=1, the tcpu/ncalls/ndata is 0.028 on testf (the reference machine, 20090912)
With fftcache=16 (the default), the tcpu/ncalls/ndata is 0.021
With fftcache=128, the tcpu/ncalls/ndata is 0.021" data-toggle="popover" href="/tests/v6/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
h-BN single layer using 2D cut-off method of Beigi:
compute the first order derivative of the total energy
With delta(xred)=0.0002, one gets delta(etot)/delta(xred)=-0,0050208160
With delta(xred)=0.0001, one gets delta(etot)/delta(xred)=-0,0050213750
The combination of both results, in a higher-order finite difference
formula gives -0,0050215613 . The direct computation of forces
at the target geometry gives -0,0050217263 when converged values are used.
The agreement falls within (6) digits of the finite-difference result." data-toggle="popover" href="/tests/v9/Input/t132.abi" target="_blank">t132.abi</a> &hellip;</li>
</ul>
</details>
<p>Gives a rough description of the initial GS density, for each type of atom.
This value is used to create the first exchange and correlation
potential. Afterwards, it is not used anymore, except in cases related to <a class="wikilink codevar-wikilink" href="/variables/dev#densfor_pred">densfor_pred</a>.</p>
<p><strong>densty</strong>  gives an average radius (a.u.) of a Gaussian density, that will make each pseudoion neutral.
If set to 0.0, a tabulated value is used, announced as a &lsquo;decay length&rsquo; in the log file.
No meaning for RF calculations or any calculation in which a starting density is taken as input.</p>
<h2 id="dmft_read_occnd"><strong>dmft_read_occnd</strong><a class="headerlink" href="#dmft_read_occnd" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Dynamical Mean Field Theory: READ OCCupations (Non Diagonal)<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform a DMFT calculation" data-toggle="popover" href="/topics/DMFT">topic_DMFT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [7/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC options only. Not realistic" data-toggle="popover" href="/tests/gpu_omp/Input/t49.abi" target="_blank">t49.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC options only. Not realistic" data-toggle="popover" href="/tests/gpu_omp/Input/t50.abi" target="_blank">t50.abi</a></li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC parallelism" data-toggle="popover" href="/tests/paral/Input/t92.abi" target="_blank">t92.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC parallelism" data-toggle="popover" href="/tests/paral/Input/t92.abi" target="_blank">t92.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT tests on ferromagnetic NiO (2 atoms), check DMFT for several
values of dmft_solv : computes occupations and energy." data-toggle="popover" href="/tests/v6/Input/t45.abi" target="_blank">t45.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC options only. Not realistic" data-toggle="popover" href="/tests/v7/Input/t28.abi" target="_blank">t28.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC options only. Not realistic" data-toggle="popover" href="/tests/v7/Input/t29.abi" target="_blank">t29.abi</a></li>
</ul>
</details>
<p>Flag to read/write Occupations as computed in DMFT. This flag is useful to
restart a DFT+DMFT calculation with self-consistency over electronic density.
The occupations are written each time a DMFT loop is finished. So if the
calculation stops because the time limit is reached, this option offers the
possibility to restart the self-consistent loop over density at the point
where it stopped (assuming a restart with the wave functions, see <a class="wikilink codevar-wikilink" href="/variables/files#getwfk">getwfk</a>).</p>
<ul>
<li>0 &rarr; Occupations are written but never read.</li>
<li>1 &rarr; Occupations are read from I_DMFTOCCND, where I is the root for input files.</li>
<li>2 &rarr; Occupations are read from O_DMFTOCCND, where O is the root for output files.</li>
</ul>
<p>An alternative and more simple way to restart a DFT+DMFT calculation is to use
the density file (obtained with <a class="wikilink codevar-wikilink" href="/variables/files#prtden">prtden</a> = 1 or <a class="wikilink codevar-wikilink" href="/variables/files#prtden">prtden</a> = -1) and the self-energy (see <a class="wikilink codevar-wikilink" href="/variables/dmft#dmft_rslf">dmft_rslf</a>).
In this case, use  <strong>dmft_read_occnd</strong> =0.</p>
<h2 id="dmftctqmc_basis"><strong>dmftctqmc_basis</strong><a class="headerlink" href="#dmftctqmc_basis" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Dynamical Mean Field Theory: Continuous Time Quantum Monte Carlo BASIS<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform a DMFT calculation" data-toggle="popover" href="/topics/DMFT">topic_DMFT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/dmft#dmft_solv">dmft_solv</a> == 5<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [6/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC options only. Not realistic" data-toggle="popover" href="/tests/gpu_omp/Input/t49.abi" target="_blank">t49.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC options only. Not realistic" data-toggle="popover" href="/tests/gpu_omp/Input/t50.abi" target="_blank">t50.abi</a></li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC parallelism" data-toggle="popover" href="/tests/paral/Input/t92.abi" target="_blank">t92.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC parallelism" data-toggle="popover" href="/tests/paral/Input/t92.abi" target="_blank">t92.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC options only. Not realistic" data-toggle="popover" href="/tests/v7/Input/t28.abi" target="_blank">t28.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC options only. Not realistic" data-toggle="popover" href="/tests/v7/Input/t29.abi" target="_blank">t29.abi</a></li>
</ul>
</details>
<p>Choose the basis to perform CTQMC calculation.</p>
<ul>
<li>0 &rarr; Use the local basis in the spherical harmonics basis.
  Can be useful if the Hamiltonian has weak off diagonal terms and for this reason,
  one want to keep the original basis for simplicity and for physical insight.</li>
<li>1 &rarr; Default value, diagonalize the local Hamiltonian (but only if it is not diagonal).
  The best choice in general.</li>
<li>2 &rarr; Diagonalise the local correlated occupation matrix. Can lead to non
  diagonal Hamiltonian that cannot be handled by CTQMC. This option should be thus avoided.</li>
</ul>
<h2 id="effmass_free"><strong>effmass_free</strong><a class="headerlink" href="#effmass_free" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EFFective MASS for the FREE electron<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform some artificial modifications of the physics" data-toggle="popover" href="/topics/Artificial">topic_Artificial</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [4/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Tests series for the mGGA implementation (from 31 to 33)
Silicon bulk. Two datasets are run. One (classic) LDA calculation with ixc 7.
One with a fake native mGGA (fake1, i.e. ixc 31) and using effmass_free=1.01.
Both calculation should give the same total energy (change in kinetic energy due to
effmass_free is compensated by the fake mGGA using kinetic energy density: taur).
(Two other datasets are also run for spin polarized case)" data-toggle="popover" href="/tests/gpu_omp/Input/t36.abi" target="_blank">t36.abi</a></li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Hydrogen atom. Treated with the Fermi-Amaldi correction (ixc=20), so that this
corresponds to exact cancellation of the Hartree and XC contributions,
as it should for Hydrogen atom.
Examine the 1s-2s splitting, that should be equal to 0.375 Ha,
and is obtained at 0.368 Ha (so within 2%), with the chosen ecut and acell.
This quantity converges much faster to the correct value than either the total
energy or the 1s eigenenergy.
Also test effmass_free. A value 10 times bigger than the usual electron mass
leads to a 10-fold contraction of the system. The 1s-2s splitting is
multiplied by 10 exactly, provided ecut, acell and the smearing of the
potential at origin are scaled appropriately." data-toggle="popover" href="/tests/v1/Input/t25.abi" target="_blank">t25.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Tests series for the mGGA implementation (from 31 to 33)
Silicon bulk. Two datasets are run. One (classic) LDA calculation with ixc 7.
One with a fake native mGGA (fake1, i.e. ixc 31) and using effmass_free=1.01.
Both calculation should give the same total energy (change in kinetic energy due to
effmass_free is compensated by the fake mGGA using kinetic energy density: taur).
(Two other datasets are also run for spin polarized case)" data-toggle="popover" href="/tests/v6/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the mGGA implementation. Silicon bulk. Two datasets are run.
One with a fake native mGGA (fake2, i.e. ixc 32) involving laplacian of the density.
One with a fake native mGGA (fake3, i.e. ixc 33) involving gradient of the density.
Both calculation should give the same total and exchange-correlation energies.
(Two other datasets are also run for spin polarized case)" data-toggle="popover" href="/tests/v6/Input/t32.abi" target="_blank">t32.abi</a></li>
</ul>
</details>
<p>This parameter allows one to change the free electron mass, with respect to its experimental value.
The electron mass is simply changed in the Schrodinger equation.
Only for testing purposes, of course.</p>
<h2 id="eshift"><strong>eshift</strong><a class="headerlink" href="#eshift" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Energy SHIFT<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a>, <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to select the SCF algorithm" data-toggle="popover" href="/topics/SCFAlgorithms">topic_SCFAlgorithms</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/dev#wfoptalg">wfoptalg</a> == 3<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [1/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
8 Silicon atoms + 1 interstitial Mg atom.
Try to get the inner bands (close to the Fermi energy),
not the lower ones, thanks to wfoptalg=2.
It works, but it does not seem very efficient.
Still subject of study." data-toggle="popover" href="/tests/v3/Input/t45.abi" target="_blank">t45.abi</a></li>
</ul>
</details>
<p><strong>eshift</strong>  gives the shift of the energy used in the shifted Hamiltonian
squared. The algorithm will determine eigenvalues and eigenvectors centered on  <strong>eshift</strong> .
Can be specified in Ha (the default), Ry, eV or Kelvin, since  <strong>eshift</strong>  has the
<a class="wikilink" href="/guide/abinit#parameters">ENERGY</a> characteristics. (1 Ha = 27.2113845 eV)</p>
<h2 id="exchmix"><strong>exchmix</strong><a class="headerlink" href="#exchmix" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EXCHange MIXing<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the exchange and correlation functionals" data-toggle="popover" href="/topics/xc">topic_xc</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.25<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/paw#useexexch">useexexch</a> == 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [1/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO with 4 atoms per cell
Test computation of the local exact exchange (PBE0) in PAW." data-toggle="popover" href="/tests/v5/Input/t18.abi" target="_blank">t18.abi</a></li>
</ul>
</details>
<p><strong>exchmix</strong>  allows one to tune the ratio of exact exchange when <a class="wikilink codevar-wikilink" href="/variables/paw#useexexch">useexexch</a> is
used. The default value of 0.25 corresponds to PBE0.</p>
<h2 id="exchn2n3d"><strong>exchn2n3d</strong><a class="headerlink" href="#exchn2n3d" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> EXCHange N2 and N3 Dimensions<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to tune the speed and memory usage" data-toggle="popover" href="/topics/TuningSpeedMem">topic_TuningSpeedMem</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [1/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of Mg2 molecule chains, in a slab supercell geometry.
Symmetries are broken. k point (1/4 1/4 1/4)
Use fftalg 412 and exchn2n3 1.
Suitable for tests of space parallelisation." data-toggle="popover" href="/tests/v4/Input/t92.abi" target="_blank">t92.abi</a></li>
</ul>
</details>
<p>If  <strong>exchn2n3d</strong>  is 1, the internal representation of the FFT arrays in
reciprocal space will be array(n1,n3,n2), where the second and third
dimensions have been switched. This is to allow to be coherent with the
 <strong>exchn2n3d</strong>  = 4xx FFT treatment.</p>
<h2 id="extrapwf"><strong>extrapwf</strong><a class="headerlink" href="#extrapwf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> flag - EXTRAPolation of the Wave-Functions<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to tune the speed and memory usage" data-toggle="popover" href="/topics/TuningSpeedMem">topic_TuningSpeedMem</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to perform a molecular dynamics calculation" data-toggle="popover" href="/topics/MolecularDynamics">topic_MolecularDynamics</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/dev#densfor_pred">densfor_pred</a> in [5, 6]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [1/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the extrapolation of then wave functions from
one structural relaxation (time) step to the other:
extrapwf=1
WARNING: this feature is stil experimental and probably buggy.
Si, Bulk, 2 atoms" data-toggle="popover" href="/tests/v7/Input/t09.abi" target="_blank">t09.abi</a></li>
</ul>
</details>
<p>This flag activates the extrapolation of wave-functions from one Molecular
Dynamics (or Structural Relaxation) step to another. The wave functions are
extrapolated using 2<sup>nd</sup>-order algorithm of <a class="wikilink citation-wikilink" data-tippy-content="Ab initio molecular-dynamics techniques extended to large-length-scale systems" data-toggle="popover" href="/theory/bibliography#arias1992">[Arias1992]</a>.
Note that, when activated, this extrapolation requires non-negligible
additional memory resources as the wave functions are stored for the two
previous time steps. Also, it can only be activated if a consistent density
extrapolation is activated (see <a class="wikilink codevar-wikilink" href="/variables/dev#densfor_pred">densfor_pred</a>).
ABINIT 7.10: this option is <strong>under development</strong> and might give wrong results.</p>
<h2 id="fermie_nest"><strong>fermie_nest</strong><a class="headerlink" href="#fermie_nest" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> FERMI Energy for printing the NESTing function<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to print some useful quantities" data-toggle="popover" href="/topics/printing">topic_printing</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [3/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="Ground state and phonons of hcp TiNb alloy" data-toggle="popover" href="/tests/v6/Input/t72.abi" target="_blank">t72.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ground state and phonons of hcp Ti (similar to test 72, but grid 2 2 4)" data-toggle="popover" href="/tests/v6/Input/t90.abi" target="_blank">t90.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Ground state and phonons of bcc Li" data-toggle="popover" href="/tests/v7/Input/t90.abi" target="_blank">t90.abi</a></li>
</ul>
</details>
<p>This input variable is only effective when <a class="wikilink codevar-wikilink" href="/variables/eph#prtnest">prtnest</a> = 1.
The energy is relative to the calculated Fermi energy.</p>
<h2 id="fft_count"><strong>fft_count</strong><a class="headerlink" href="#fft_count" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Fast Fourier Transform COUNTer<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to tune the speed and memory usage" data-toggle="popover" href="/topics/TuningSpeedMem">topic_TuningSpeedMem</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em>   </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [4/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Quick test on AlAs (PAW) to check that different nloc_alg options give the correct energy.
Case istwfk=1." data-toggle="popover" href="/tests/v9/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Quick test on AlAs (PAW) to check that different nloc_alg options give the correct energy.
Case istwfk&gt;=2." data-toggle="popover" href="/tests/v9/Input/t72.abi" target="_blank">t72.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Quick test on AlAs (PAW) to check that different cprj_update_lvl options give the correct energy.
Compute forces and stress at the end of the run." data-toggle="popover" href="/tests/v9/Input/t73.abi" target="_blank">t73.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Quick test on AlAs (PAW) to check that different cprj_update_lvl options give the correct energy.
Compute forces at every iteration, compute stress at the end of the run." data-toggle="popover" href="/tests/v9/Input/t74.abi" target="_blank">t74.abi</a></li>
</ul>
</details>
<p>This variable is similar than <a class="wikilink codevar-wikilink" href="/variables/dev#nonlop_ylm_count">nonlop_ylm_count</a>, but for FFT operations instead of non-local ones.</p>
<p>FFT operations are one of the most time-consumming operations, especially for systems with few atoms.
It is then interesting to count the number of FFT operations in a dataset, which is done with  <strong>fft_count</strong>  = 1 (or any non-zero value).
More precisely, it counts the number of FFTs done in &ldquo;fourdp&rdquo; and &ldquo;fourwf&rdquo; routines.</p>
<p>This feature is not equivalent to what other profiling tools would give (as the one included in Abinit, see <a class="wikilink codevar-wikilink" href="/variables/gstate#timopt">timopt</a>), because the number of FFTs done per call
depends on input options which vary during the computation.
Indeed, one or two FFTs could be done in one call.
The counting activated by  <strong>fft_count</strong>  takes into account this effect.
Also, one can count several datasets separately in one run.</p>
<p>For now, this feature is available only in the following context:</p>
<ul>
<li>
<p><a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> = 0: ground-state computation</p>
</li>
<li>
<p><a class="wikilink codevar-wikilink" href="/variables/paral#paral_kgb">paral_kgb</a> = 0: simple parallelization over k-points</p>
</li>
</ul>
<p>If the counting is activated, a little report is written in abinit output.
Here an example:</p>
<div class="codehilite"><pre><span></span><code><span class="nb">---</span><span class="c"> FFT COUNTERS </span><span class="nb">------------------------------------------------------------</span>
<span class="c">total Number of Bands         : NB =     64</span>
<span class="c">                     | total count (TC) |            TC/NB</span>
<span class="nb">-----------------------------------------------------------------------------</span>
<span class="c">fourdp               |               45 |</span>
<span class="c">fourwf               |             4918 |             76</span><span class="nt">.</span><span class="c">8</span>
<span class="nb">-----------------------------------------------------------------------------</span>
</code></pre></div>

<p>The total count (TC) corresponds to the number of calls of the routine.
NB is the total number of bands, including the empty ones, summed over the k-points.</p>
<h2 id="fftalg"><strong>fftalg</strong><a class="headerlink" href="#fftalg" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Fast Fourier Transform ALGorithm<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to tune the speed and memory usage" data-toggle="popover" href="/topics/TuningSpeedMem">topic_TuningSpeedMem</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 312 if <a class="wikilink" data-tippy-content="This is an external parameter
typically compilation parameters, available libraries, or number of processors.
You can change these parameters at compile or runtime usually.
" data-toggle="popover" href="/variables/external_parameters#fftw3" title="True if FFTW3 is enabled (compilation)">FFTW3</a> and <a class="wikilink codevar-wikilink" href="/variables/dev#usedmft">usedmft</a> == 0,
401 if <a class="wikilink codevar-wikilink" href="/variables/paral#paral_kgb">paral_kgb</a> == 1,
112 otherwise.</p>
<p><em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Moderately used, [62/1314] in all abinit tests, [1/178] in abinit tutorials</summary>
<ul>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==1, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==2, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si, Bulk, 2 atoms , paral_kgb.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*np_spkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over bands and spins:
npband*npfft*np_spkpt=2*1*2=4 processors.
In addition, we also test here various features of bandfft-kpt parallelisation
In particular, the bandpp, istwfk=2 and wfoptalg=14 variables." data-toggle="popover" href="/tests/mpiio/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He FCC solid in conventional cell (4 atoms).
Test the recursion algorithm (for high-temperature calculations).
Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t42.abi" target="_blank">t42.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si, Bulk, 2 atoms , paral_kgb.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/paral/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*np_spkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over bands and spins:
npband*npfft*np_spkpt=2*1*2=4 processors.
In addition, we also test here various features of bandfft-kpt parallelisation
In particular, the bandpp, istwfk=2 and wfoptalg=14 variables." data-toggle="popover" href="/tests/paral/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 4 procs.
Similar to test paral_22 but test the automatic parallelisation" data-toggle="popover" href="/tests/paral/Input/t26.abi" target="_blank">t26.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PAW2 tutorial
Nickel ferromagnetic fcc structure
Testing ecut convergence" data-toggle="popover" href="/tests/tutorial/Input/tpaw2_2.abi" target="_blank">tpaw2_2.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=3 and tsmear=0.02.
Designed to test the treatment of metals, with a finite
temperature corresponding to about 6300 Kelvin. Use fftalg=400" data-toggle="popover" href="/tests/v1/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H atom (spin-unpolarized in a medium size cubic box, k=0 0 0 similar to test 1 of fast)
Using multi-dataset mode, examine the following combinations of
fftalg and istwfk : (112,2),(112,1),(111,1),(111,2),(110,2),(110,1),
(100,1), then compute the energy with nstep=0 for (112,2) and (112,1).
Then again SCF test for (400,1), (401,1), (402,1).
For the second dataset, reads the wavefunctions of the first dataset." data-toggle="popover" href="/tests/v1/Input/t87.abi" target="_blank">t87.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H atom, similar to test 87, except that the box is not cubic,
but only parallelipipedic (not even a rectangle parallelipiped).
However, the primitive vectors describe the same lattice as
in case 87, so that the results must be identical
to those of test 87, even if a different FFT grid is used.
That is what is observed." data-toggle="popover" href="/tests/v1/Input/t88.abi" target="_blank">t88.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
MgO FCC crystal, with very low cut-off, and 32 k points.
Pseudopotentials WITHOUT a non-linear core correction.
Compute the dynamical matrices at q(0.25 0.5 0.498) and q(0.25 0.5 0.5).
The results should be very close to each other, but were not in pre v2.1
versions, because the symmetry was not treated correctly for the
highest-symmetry q vector q(0.25 0.5 0.5) (test case found by PTepesch)." data-toggle="popover" href="/tests/v2/Input/t37.abi" target="_blank">t37.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Mg atom, in a big box, displaced from the center,
test different k points with time-reversal symmetry, and different
fftalg values (4xx) corresponding to the 2002 FFT of SGoedecker." data-toggle="popover" href="/tests/v3/Input/t50.abi" target="_blank">t50.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of Mg2 molecule chains, in a slab supercell geometry.
Symmetries are broken. k point (1/4 1/4 1/4)
Use of default values of fftalg and exchn2n3
Reference for test #92." data-toggle="popover" href="/tests/v4/Input/t91.abi" target="_blank">t91.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of Mg2 molecule chains, in a slab supercell geometry.
Symmetries are broken. k point (1/4 1/4 1/4)
Use fftalg 412 and exchn2n3 1.
Suitable for tests of space parallelisation." data-toggle="popover" href="/tests/v4/Input/t92.abi" target="_blank">t92.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of Ca, simple cubic , 2  k-point. Testing GS  energy and lobpcg algorithm." data-toggle="popover" href="/tests/v4/Input/t93.abi" target="_blank">t93.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for double grid (fine/coarse) system, the cutting
radius and the initial fermi energy in recursion method
Corresponding variables: recgratio, recrcut,recefermi respectively
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-toggle="popover" href="/tests/v5/Input/t75.abi" target="_blank">t75.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (1 Si2 molecule in the cell)
Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96).
The default fftcache=16 seems OK :
With fftcache=1, the tcpu/ncalls/ndata is 0.028 on testf (the reference machine, 20090912)
With fftcache=16 (the default), the tcpu/ncalls/ndata is 0.021
With fftcache=128, the tcpu/ncalls/ndata is 0.021" data-toggle="popover" href="/tests/v6/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO with 4 atoms. Check of the modified self-consistent loop over electronic density for DMFT. This
calculation use LDA occupations for the test and is not running the DMFT part (dmftcheck2=-1)." data-toggle="popover" href="/tests/v6/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT tests on Antiferromagnetic NiO (4 atoms), check DMFT loop with Hubbard I, DMFT
self-consistency and density self-consistency : computes occupations and energy." data-toggle="popover" href="/tests/v6/Input/t46.abi" target="_blank">t46.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="(Apparently the documentation section of this test has been lost)" data-toggle="popover" href="/tests/v7/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC options only. Not realistic" data-toggle="popover" href="/tests/v7/Input/t28.abi" target="_blank">t28.abi</a> &hellip;</li>
</ul>
</details>
<p>Allows to choose the implementation for performing Fast Fourier Transforms.
These have to be used when applied to wavefunctions (routine <code>fourwf</code>), as well as when
applied to densities and potentials (routine <code>fourdp.F90</code>).
Presently, it is the concatenation of three digits, labelled (A), (B) and (C).</p>
<p>The first digit (A) is to be chosen among 1, 2, 3, 4 or 5:</p>
<ul>
<li>1 &rarr; use FFT routines written by S. Goedecker.</li>
<li>2 &rarr;  not available anymore</li>
<li>3 &rarr;  use serial or multi-threaded FFTW3 Fortran routines (<a href="http://www.fftw.org">http://www.fftw.org </a>).
    Currently implemented with  <strong>fftalg</strong>  = 312.</li>
<li>4 &rarr;  use FFT routines written by S. Goedecker, 2002 version, that will be suited for MPI and OpenMP parallelism.</li>
<li>5 &rarr;  use serial or multi-threaded MKL routines Currently implemented with  <strong>fftalg</strong>  = 512.</li>
</ul>
<p>The second digit (B) is related to <code>fourdp</code>:</p>
<ul>
<li>0 &rarr;  only use Complex-to-complex FFT</li>
<li>1 &rarr;  real-to-complex is also allowed (only coded for A==1, A==3 and A==5)</li>
</ul>
<p>The third digit (C) is related to <code>fourwf</code>:</p>
<ul>
<li>0 &rarr; no use of zero padding</li>
<li>1 &rarr; use of zero padding (only coded for A==1, A==4)</li>
<li>2 &rarr; use of zero padding, and also combines actual FFT operations (using 2 routines from S. Goedecker)
    with important pre- and post-processing operations, in order to maximize cache data reuse.
    This is very efficient for cache architectures. (coded for A==1 and A==4, but A==4 is not yet sufficiently tested)</li>
</ul>
<p>Internal representation as <a class="wikilink codevar-wikilink" href="/variables/gstate#ngfft">ngfft</a>(7).</p>
<p>FFTW and DFTI are usually faster than the internal implementation and are therefore recommended.
These libraries, however, must be activated at configure time with e.g. the <em>with_fft_flavor</em> option.
In this case, the default value of  <strong>fftalg</strong>  is changed accordingly.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This keyword is <strong>ignored</strong> when Fast Fourier Transforms are done using
<strong>Graphics Processing Units</strong> (GPU), i.e. when <a class="wikilink codevar-wikilink" href="/variables/paral#gpu_option">gpu_option</a> &gt; 0.</p>
</div>
<h2 id="fftcache"><strong>fftcache</strong><a class="headerlink" href="#fftcache" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Fast Fourier Transform CACHE size<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to tune the speed and memory usage" data-toggle="popover" href="/topics/TuningSpeedMem">topic_TuningSpeedMem</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 16<br />
<em>Comment:</em> todo: Not yet machine-dependent<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [1/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (1 Si2 molecule in the cell)
Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96).
The default fftcache=16 seems OK :
With fftcache=1, the tcpu/ncalls/ndata is 0.028 on testf (the reference machine, 20090912)
With fftcache=16 (the default), the tcpu/ncalls/ndata is 0.021
With fftcache=128, the tcpu/ncalls/ndata is 0.021" data-toggle="popover" href="/tests/v6/Input/t03.abi" target="_blank">t03.abi</a></li>
</ul>
</details>
<p>Gives the cache size of the current machine, in Kbytes.
Internal representation as <a class="wikilink codevar-wikilink" href="/variables/gstate#ngfft">ngfft</a>(8).</p>
<h2 id="getgam_eig2nkq"><strong>getgam_eig2nkq</strong><a class="headerlink" href="#getgam_eig2nkq" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GET the GAMma phonon data EIG2NKQ from dataset<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a multi dataset calculation" data-toggle="popover" href="/topics/multidtset">topic_multidtset</a>, <a class="wikilink topic-wikilink" data-tippy-content="To to calculate the temperature dependence of the electronic structure" data-toggle="popover" href="/topics/TDepES">topic_TDepES</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/dfpt#ieig2rf">ieig2rf</a> != 0 and <a class="wikilink codevar-wikilink" href="/variables/gstate#qpt">qpt</a> != (0.0, 0.0, 0.0)<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [2/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Test temperature-dependent of the electronic structure, with
reduction of the number of q points to be computed, thanks to thmflag=7 .
Warning : only valid for Gamma, AND the temperature-dependent shifts must be averaged
over degenerate states." data-toggle="popover" href="/tests/v6/Input/t37.abi" target="_blank">t37.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
He BCC primitive cell. Fake smooth pseudopotential.
For testing the electron-phonon modification of the electronic structure.
To be compared with the results of tests 51 to 59.
Use a 2x2x2 grid of k (shifted) and q (non-shifted) points.
No imaginary frequences for the phonons with this choice.
Computation of the electronic eigenvalues as well as phonon eigenfrequencies,
and corresponding ingredients for the computation of the electron-phonon effect, in the
next tests 51-53." data-toggle="popover" href="/tests/v6/Input/t50.abi" target="_blank">t50.abi</a></li>
</ul>
</details>
<p>Relevant for second-order eigenvalue calculations using response-functions
(<a class="wikilink codevar-wikilink" href="/variables/dfpt#ieig2rf">ieig2rf</a> != 0), and only for non-zero wavevectors <a class="wikilink codevar-wikilink" href="/variables/gstate#qpt">qpt</a>.
From the electron-phonon matrix elements at some wavevector only, it is not
possible to determine the Debye-Waller contribution: one has to know also the
q=Gamma electron-phonon matrix elements.
The variable  <strong>getgam_eig2nkq</strong>  allows one to transmit the information about the
second-order derivatives of the eigenvalues for q=Gamma from the dataset where
the calculation at Gamma was done, to the datasets for other wavevectors.</p>
<h2 id="getwfkfine"><strong>getwfkfine</strong><a class="headerlink" href="#getwfkfine" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> GET the fine grid wavefunctions from _WFK file<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a multi dataset calculation" data-toggle="popover" href="/topics/multidtset">topic_multidtset</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to generically perform DFPT calculations" data-toggle="popover" href="/topics/DFPT">topic_DFPT</a>, <a class="wikilink topic-wikilink" data-tippy-content="To to calculate the temperature dependence of the electronic structure" data-toggle="popover" href="/topics/TDepES">topic_TDepES</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [9/1314] in all abinit tests, [1/178] in abinit tutorials</summary>
<ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="
E-ph for mobility in semiconductors" data-toggle="popover" href="/tests/tutorespfn/Input/teph4mob_7.abi" target="_blank">teph4mob_7.abi</a></li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with the interpolation technique
In t31, preparation, BSE equation with Model dielectric function and Haydock (only resonant + W + v), then full BSE
In t32, bs_interp_mode 1
In t33, bs_interp_mode 2
In t34, bs_interp_mode 3
In t35, Rohlfing-Louie" data-toggle="popover" href="/tests/v67mbpt/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with the interpolation technique
In t31, preparation, BSE equation with Model dielectric function and Haydock (only resonant + W + v), then full BSE
In t32, bs_interp_mode 1
In t33, bs_interp_mode 2
In t34, bs_interp_mode 3
In t35, Rohlfing-Louie" data-toggle="popover" href="/tests/v67mbpt/Input/t33.abi" target="_blank">t33.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with the interpolation technique
In t31, preparation, BSE equation with Model dielectric function and Haydock (only resonant + W + v), then full BSE
In t32, bs_interp_mode 1
In t33, bs_interp_mode 2
In t34, bs_interp_mode 3
In t35, Rohlfing-Louie" data-toggle="popover" href="/tests/v67mbpt/Input/t34.abi" target="_blank">t34.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon: Solution of the Bethe-Salpeter equation (BSE) with the interpolation technique
In t31, preparation, BSE equation with Model dielectric function and Haydock (only resonant + W + v), then full BSE
In t32, bs_interp_mode 1
In t33, bs_interp_mode 2
In t34, bs_interp_mode 3
In t35, Rohlfing-Louie" data-toggle="popover" href="/tests/v67mbpt/Input/t35.abi" target="_blank">t35.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond.
Test temperature-dependent of the electronic structure, with
reduction of the number of q points to be computed, thanks to thmflag=7 .
The temperature-dependent shifts must be averaged over degenerate states.
This temperature-dependent calculation make use of a k-point interpolation to speed up
the convergence study with respect to the q-points integration. Two q-points are computed." data-toggle="popover" href="/tests/v7/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This tests make use of the irdwfkfine variable instead of the getwfkfine variable used in the
previous test. The third q-point is computed here." data-toggle="popover" href="/tests/v7/Input/t51.abi" target="_blank">t51.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the imaginary part of the Fan-Migdal self-energy matrix elements.
Use of the two-grids technique" data-toggle="popover" href="/tests/v9/Input/t55.abi" target="_blank">t55.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the imaginary part of the Fan-Migdal self-energy matrix elements.
Test of the calculation of the Fermi level under different conditions" data-toggle="popover" href="/tests/v9/Input/t56.abi" target="_blank">t56.abi</a></li>
</ul>
</details>
<p>Eventually used when <a class="wikilink codevar-wikilink" href="/variables/basic#ndtset">ndtset</a> &gt; 0 (in the multi-dataset mode), to indicate
starting wavefunctions, as an alternative to <a class="wikilink codevar-wikilink" href="/variables/dev#irdwfkfine">irdwfkfine</a>. One should first
read the explanations given for this latter variable.</p>
<p>The  <strong>getwfkfine</strong>  variable is typically used to chain the calculations in
the multi-dataset mode, since they describe from which dataset the OUTPUT
wavefunctions are to be taken, as INPUT wavefunctions of the present dataset.</p>
<ul>
<li>If  <strong>getwfkfine</strong>  == 0, no use of previously computed output wavefunction file
appended with _DSx_WFK is done.</li>
<li>If  <strong>getwfkfine</strong>  is positive, its value gives the index of the dataset for
which the output wavefunction file appended with _WFK must be used.</li>
<li>If  <strong>getwfkfine</strong>  is -1, the output wf file with _WFK of the previous dataset
must be taken, which is a frequently occurring case.</li>
<li>If  <strong>getwfkfine</strong>  is a negative number, it indicates the number of datasets to
go backward to find the needed wavefunction file. Going back beyond the first dataset is equivalent to using zero for the get variable.</li>
</ul>
<p>Response-function calculation:</p>
<ul>
<li>one and only one of  <strong>getwfkfine</strong>  or <a class="wikilink codevar-wikilink" href="/variables/dev#irdwfkfine">irdwfkfine</a> MUST be non-zero</li>
<li>if  <strong>getwfkfine</strong>  = 1: read ground state k -wavefunctions from a disk file appended with _WFK,
    produced in a previous ground state calculation.</li>
<li>Reading the fine grid wavefunction will trigger the k-points interpolation
  technique of the temperature dependent calculations.</li>
</ul>
<p>Bethe-Salpeter calculation:</p>
<ul>
<li>one and only one of  <strong>getwfkfine</strong>  or <a class="wikilink codevar-wikilink" href="/variables/dev#irdwfkfine">irdwfkfine</a> MUST be non-zero</li>
<li>if  <strong>getwfkfine</strong>  = 1: read ground state k -wavefunctions from a disk file appended with _WFK,
    produced in a previous ground state calculation</li>
<li>This variable or <a class="wikilink codevar-wikilink" href="/variables/dev#irdwfkfine">irdwfkfine</a> is mandatory when <a class="wikilink codevar-wikilink" href="/variables/bse#bs_interp_mode">bs_interp_mode</a> == 1</li>
</ul>
<p>For further information about the naming of files in ABINIT, consult the <a class="wikilink user-guide-wikilink" href="/guide/abinit#files-file">abinit help file</a>.</p>
<p><strong>This variable is experimental. In development.</strong></p>
<h2 id="intxc"><strong>intxc</strong><a class="headerlink" href="#intxc" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> INTerpolation for eXchange-Correlation<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the exchange and correlation functionals" data-toggle="popover" href="/topics/xc">topic_xc</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Moderately used, [145/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent" data-toggle="popover" href="/tests/built-in/Input/testin_v1.abi" target="_blank">testin_v1.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, static, spin-polarized.
Same system as test 49 of v2, except that nctime is non-zero.
Test ionmov=6 (Verlet) as well as ionmov=7." data-toggle="popover" href="/tests/etsf_io/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Single H atom in a box..
Test of prtvol = -2, so stop after init, and echo in a NETCDF file." data-toggle="popover" href="/tests/etsf_io/Input/t22.abi" target="_blank">t22.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="
Single H atom in box.  Uses local psp, which makes initialization
time much shorter.  This calculation is iterated to convergence.
This test case is a good choice for running alone just to get
something working fast." data-toggle="popover" href="/tests/fast/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 diatomic molecule, static, to check accurate forces." data-toggle="popover" href="/tests/fast/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2 special k point Si in 2-atom diamond unit cell.  Uses symmetry.
mkmem=mkpt, mffmem=1 (&quot;in core&quot; solution),
This calculation is also iterated to convergence.  ecut too small.
Uses original Teter extended norm conserving psp 14si.psp." data-toggle="popover" href="/tests/fast/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon
Test the equivalence between the internal and LibXC implementations
of various XC functionals for the response functions
(thus, the XC kernel is also tested).
The test includes 3 different functionals:
1) Perdew-Zunger: ixc=2 and ixc=-001009
2) PBE: ixc=11 and ixc=-101130
3) Perdew-Wang92: ixc=7, ixc=-001012, and ixc=-001013
The results for PBE and Perdew-Wang92 (ixc=-001013) are not equivalent
unless some constants are changed in 56_xc/xcpbe.F90 by uncommenting
some lines indicated by GMR.
Note that the underlying FFT grid does not have the symmetry of the
lattice." data-toggle="popover" href="/tests/libxc/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon
Test the equivalence between the internal and LibXC implementations
of the Perdew-Zunger XC functionals for the response functions
(thus, the XC kernel is also tested) in PAW." data-toggle="popover" href="/tests/libxc/Input/t82.abi" target="_blank">t82.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut. Test localrdwf=1" data-toggle="popover" href="/tests/mpiio/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Si in diamond structure; 60 special points in core; low ecut." data-toggle="popover" href="/tests/paral/Input/t01.abi" target="_blank">t01.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
81. Nitrogen atom in a big box, spin-polarized.
Compute Berry phase for atom at different positions." data-toggle="popover" href="/tests/seq/Input/tsv2_81.abi" target="_blank">tsv2_81.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="Yb cristal, self-consistent
Very quick built-in test, to check that ABINIT works." data-toggle="popover" href="/tests/v1/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.5634 (minimization of the bump)." data-toggle="popover" href="/tests/v1/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=5 and tsmear=0.05.
Designed to test the treatment of metals, using the &quot;cold smearing&quot;
of N. Marzari , with a=-.8165 (monotonic function in the tail)." data-toggle="popover" href="/tests/v1/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Molybdenum. Test the k point generator : Monkhorst-Pack
grid, then band structure." data-toggle="popover" href="/tests/v2/Input/t43.abi" target="_blank">t43.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Arsenic in rhombohedral structure.
Optimization of unit cell size and shape.
With 4x4x4 k point grid, ecut 3.0, occopt 4 and tsmear 0.06d0,
one get acell 3*7.325  angdeg 3*57.36 and xred 0.2277
These input parameters are too small, but still give a realistic
geometry, since with the much better parameters
12x12x12 k point grid, ecut 12.0, occopt 4 and tsmear 0.04d0,
one gets acell 3*7.633  angdeg 3*54.95 and xred 0.2296, while
the experimental values are
acell 3*7.751   angdeg 3*54.554 and xred 0.2276" data-toggle="popover" href="/tests/v2/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Aluminum in FCC structure.
For occopt=4,5,6,7 , determination of the total energy
at slightly different tsmear values, and check of the
dE/d(tsmear)=-kT.entropy relationship.
For example, for occopt=4, the difference between tsmear=0.101 and
tsmear=0.099 is -11.149450d-6 Ha , while the value of -kT.entropy
is -5.574709d-4Ha, that is about 500 larger, as expected." data-toggle="popover" href="/tests/v2/Input/t45.abi" target="_blank">t45.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state KS wavefunctions (tolwfr 1.0d-16).
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3)
nband 10) for the GW calculation and stores it in _SCR.
In dataset 3-6, ABINIT computes the GW correction for bands 4 and 5 with different plasmon-pole models." data-toggle="popover" href="/tests/v3/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state wavefunctions (tolwfr 1.0d-16)
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3, nband 10)
for the GW calculation and stores it in _SCR.
In dataset 3, ABINIT computes the GW correction for bands 4 and 5" data-toggle="popover" href="/tests/v3/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Mg atom, in a big box, displaced from the center,
test different k points with time-reversal symmetry, and different
fftalg values (4xx) corresponding to the 2002 FFT of SGoedecker." data-toggle="popover" href="/tests/v3/Input/t50.abi" target="_blank">t50.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Ta, single atom in a box (1k point). Same as test v2 #84
HGH pseudopotential
Ecut and acell are NOT realistic. One would need 20 Ha
and a 20x20x20 box, while here we have 5 Ha and a 12x12x12 box.
Prepare the analysis of next test
level  degeneracy       energy (Ha)  spin-orbit splitting
6s      2               -0.194573
5d3/2   4               -0.141779
5d5/2   6               -0.119933       0.0218
6p1/2   2               -0.050542
6p3/2   4               -0.031281       0.0193" data-toggle="popover" href="/tests/v4/Input/t36.abi" target="_blank">t36.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of Ca, simple cubic , 2  k-point. Testing GS  energy and lobpcg algorithm." data-toggle="popover" href="/tests/v4/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of Ca, simple cubic , 2  k-point.
Testing GS  PAW  energy and lobpcg algorithm." data-toggle="popover" href="/tests/v4/Input/t94.abi" target="_blank">t94.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
This is a test, in the norm conserving case, of the Molecular Dynamics flag
ionmov==13. With the values of optcell=0, 1, 2 (isothermal (0) , isothermal/isenthalpic
with homogeneous cell deformations (1) or full cell deformations (2).)
This is the reversible integrator of Martyna, Tuckerman, Tobias and Klein.
(Mol. Phys., 1996, p 1117).
XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent, while
the bmass varies by a factor of 2 ?" data-toggle="popover" href="/tests/v5/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
G0W0 calculation updating G and W by a scissor operator" data-toggle="popover" href="/tests/v5/Input/t67.abi" target="_blank">t67.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for double grid (fine/coarse) system, the cutting
radius and the initial fermi energy in recursion method
Corresponding variables: recgratio, recrcut,recefermi respectively
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-toggle="popover" href="/tests/v5/Input/t75.abi" target="_blank">t75.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (1 Si2 molecule in the cell)
Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96).
The default fftcache=16 seems OK :
With fftcache=1, the tcpu/ncalls/ndata is 0.028 on testf (the reference machine, 20090912)
With fftcache=16 (the default), the tcpu/ncalls/ndata is 0.021
With fftcache=128, the tcpu/ncalls/ndata is 0.021" data-toggle="popover" href="/tests/v6/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the symmetry finder for all the Bravais lattices,
with different input formats (rprim or angdeg), and for
non-conventional choices of axes as well.
Uses only one atom, placed at (0.6 0 0)
Similar to test v2#52, except for the choice of the location" data-toggle="popover" href="/tests/v6/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Hydrure of Lithium-Boron, in a face-centered monoclinic cell.
Test the recognition of the space group (C2/c (# 15)). Was lacking a case before Dec 2011." data-toggle="popover" href="/tests/v6/Input/t30.abi" target="_blank">t30.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk aluminum, with and without PAW XML data (FJollet)" data-toggle="popover" href="/tests/v7/Input/t60.abi" target="_blank">t60.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk aluminum, with PAW XML data designed for PWPAW (F Jollet)" data-toggle="popover" href="/tests/v7/Input/t61.abi" target="_blank">t61.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Bulk aluminum, with PAW XML data designed for GPAW (F Jollet)" data-toggle="popover" href="/tests/v7/Input/t62.abi" target="_blank">t62.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Simple input (from fast/t03) to test nblock_lobpcg variable" data-toggle="popover" href="/tests/v9/Input/t205.abi" target="_blank">t205.abi</a> &hellip;</li>
</ul>
</details>
<ul>
<li>0 &rarr; do &ldquo;usual&rdquo; xc quadrature on fft grid</li>
<li>1 &rarr; do higher accuracy xc quadrature using fft grid and additional points at the centers of each cube
   (doubles number of grid points)&ndash;the high accuracy version is only valid for boxcut&gt;=2. If boxcut &lt; 2, the code stops.</li>
</ul>
<p>For RF calculations only  <strong>intxc</strong>  = 0 is allowed yet. Moreover, the GS
preparation runs (giving the density file and zero-order wavefunctions) must be done with  <strong>intxc</strong>  = 0</p>
<p>Prior to ABINITv2.3, the choice  <strong>intxc</strong>  = 1 was favoured (it was the default),
but the continuation of the development of the code lead to prefer the default
 <strong>intxc</strong>  = 0. Indeed, the benefit of  <strong>intxc</strong>  = 1 is rather small, while making
it available for all cases is a non-negligible development effort.
Other targets are prioritary. You will notice that many automatic tests use
 <strong>intxc</strong>  = 1. Please, do not follow this historical choice for your production runs.</p>
<h2 id="invovl_blksliced"><strong>invovl_blksliced</strong><a class="headerlink" href="#invovl_blksliced" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> INVerse OVerLap: BLocK-diagonal matrix applied SLICED<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a parallel calculation" data-toggle="popover" href="/topics/parallelism">topic_parallelism</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0 if <a class="wikilink codevar-wikilink" href="/variables/paral#gpu_option">gpu_option</a> &gt; 0,
1 otherwise.</p>
<p><em>Added in version:</em> 9.7.2  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [0/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
</details>
<p>Only relevant if <a class="wikilink codevar-wikilink" href="/variables/dev#wfoptalg">wfoptalg</a> == 1 or 111 (WF optimization by Chebyshev filtering algorithm).
In the Chebyshev-filtered subspace method (iterative diagonalization algorithm))
one needs to apply the inverse of the overlap matrix.  <strong>invovl_blksliced</strong>  allows one
to choose between two variants, sliced (1) or non-sliced (0).
Default value is different for an execution on GPU.</p>
<h2 id="iomode"><strong>iomode</strong><a class="headerlink" href="#iomode" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Input-Output MODE<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a parallel calculation" data-toggle="popover" href="/topics/parallelism">topic_parallelism</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1 if <a class="wikilink" data-tippy-content="This is an external parameter
typically compilation parameters, available libraries, or number of processors.
You can change these parameters at compile or runtime usually.
" data-toggle="popover" href="/variables/external_parameters#mpi_io" title="True if MPI_IO is enabled (compilation)">MPI_IO</a> and <a class="wikilink codevar-wikilink" href="/variables/paral#paral_kgb">paral_kgb</a> == 1,
0 otherwise.</p>
<p><em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Moderately used, [69/1314] in all abinit tests, [1/178] in abinit tutorials</summary>
<ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2O in isolated boundary conditions (plane waves, NC), try tu use Damiens Poisson cutoff.
Water molecule with HGH pseudo-potentials. This checks that a negative
value in rhor will not make the Poisson solver crashes on XC computation." data-toggle="popover" href="/tests/bigdft/Input/t22.abi" target="_blank">t22.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file." data-toggle="popover" href="/tests/built-in/Input/testin_etsf_io.abi" target="_blank">testin_etsf_io.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk water ice 1h, made-up with 8 water molecules.
Density is exported using the ETSF I/O file format.
Should be a nice system to look at with visualisation tools." data-toggle="popover" href="/tests/etsf_io/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure with KSS output. This is a two data set run,
the first dataset being a ground state calculation and the second put
nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file
is generated by ETSF-IO. The density of the first dataset also use ETSF-IO
and dataset two is a good test for density restart." data-toggle="popover" href="/tests/etsf_io/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==1, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==2, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
LOBPCG, C-diamond, Bulk, 2 atoms, paral_kgb, mono-GPU, istwfk==1, with PAW." data-toggle="popover" href="/tests/gpu_omp/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>gwr_suite:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr_suite/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr_suite/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr_suite/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, with PAW.
Test the IO routines with paral_kgb in [1, 0] and different combinations
of parameters (npfft, npband, np_spkpt).
Test the plane wave load balancing procedure (pw_unbal_thresh).
Test also the computation of PJDOS." data-toggle="popover" href="/tests/mpiio/Input/t26.abi" target="_blank">t26.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, with NC pseudo generated with oncvps-3.2.3.
Test the IO routines with paral_kgb in [1, 0] and different combinations
of parameters (npfft, npband, np_spkpt).
Test also prtdos (PJDOS) in parallel with MPI-FFT.
Similar to t26.in" data-toggle="popover" href="/tests/mpiio/Input/t27.abi" target="_blank">t27.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs with PAW and spin-orbit coupling. 2x2x2 K grid; low cut-off for test
Test paral_kgb==1 with MPI-FFT/spinor parallelization, the IO of the WFK file,
the output of potential files and the calculation of PJDOS in parallel
(PW term + on-site contributions)" data-toggle="popover" href="/tests/mpiio/Input/t28.abi" target="_blank">t28.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si, Bulk, 2 atoms , paral_kgb.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/paral/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/paral/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*np_spkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over FFT and kpoints:
npband*npfft*np_spkpt=1*2*2=4 processors.
In test tY.in we check other distributions for guarantee." data-toggle="popover" href="/tests/paral/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Similar to v7[07]. Here we test optdriver 8 (WFK post-processing) with NC
and SO. More specifically, we reconstruct the wavefunctions in the full BZ in
dataset 2 and we use this WFK to restart the calculation in dataset 3 with
the full k-mesh (kptopt 3). The SCF cycle should exit at the first iteration
since the wavefunctions are already converged." data-toggle="popover" href="/tests/v7/Input/t12.abi" target="_blank">t12.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test to prepare a SOC conductivity calculation (test v9#t102)
Ground state calculation for 4 Al atoms
The number of bands is unrealistic. This test produces files that are inputs for test 103.
It tests the following parts of the code:
optic_paw_core
Note that, in addition to the psp file, the spinor core wave functions file is needed." data-toggle="popover" href="/tests/v9/Input/t102.abi" target="_blank">t102.abi</a> &hellip;</li>
</ul>
</details>
<p>This option selects the format used to produce &ldquo;large&rdquo; binary files such as the output wavefunction files,
the files with densities and potentials (DEN, POT) as well as the SCR file produced by the GW code.
Other &ldquo;small&rdquo; netcdf files such as the GSR.nc are always produced independently of the value of <strong>iomode</strong>.</p>
<p>Note that this variable mainly defines the format of the output files since Abinit is able to read
data from files independently of their format (either Fortran binary files or netcdf files).
The possible values are:</p>
<ul>
<li>0 &rarr; Use standard Fortran IO (ok for sequential runs, not suitable for large parallel runs)</li>
<li>1 &rarr; Use MPI/IO routines (ok both for sequential and large parallel runs)</li>
<li>3 &rarr; Use NetCDF library to produce files according to the ETSF specification <a class="wikilink citation-wikilink" data-tippy-content="Specification of an extensible and portable file format for electronic structure and crystallographic data" data-toggle="popover" href="/theory/bibliography#gonze2008">[Gonze2008]</a>
    (ok for sequential, requires netcdf4 + hdf5 + MPI-IO support for large parallel runs)</li>
</ul>
<p>By default, Abinit produces Fortran files and uses the MPI-IO API when these operations
cannot be implemented in terms of simple Fortran write/read statements.
For example, <a class="wikilink codevar-wikilink" href="/variables/paral#paral_kgb">paral_kgb</a> = 1 uses the MPI-IO API to generate a Fortran binary file that can be read with
plain Fortran read statements.</p>
<p>There are cases, however, in which you would like to change the default behaviour.
For example, you may want to generate WFK or DEN files in netcdf
format because you need data in this format.
In this case, you have to use  <strong>iomode</strong>  == 3 in the input file to override the default behaviour.
Note, however, that you still need parallel IO capabilities enabled in the netcdf library if
you want to produce netcdf files in parallel with <a class="wikilink codevar-wikilink" href="/variables/paral#paral_kgb">paral_kgb</a> = 1
(i.e. netcdf4 + hdf5 + MPI-IO).
At present, the internal fallbacks provided by Abinit do not support netcdf4 so you have
to link against an external netcdf library that supports hdf5+MPI-IO
and is compatible with the mpif90 used to compile Abinit.
See ~abinit/doc/build/config-examples/ubu_intel_17.0_openmpi.ac for a typical configuration file.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The use of the ETSF_IO library <a class="wikilink citation-wikilink" data-tippy-content="Sharing electronic structure and crystallographic data with ETSF\_IO" data-toggle="popover" href="/theory/bibliography#caliste2008">[Caliste2008]</a> has been disabled, and replaced
by direct NetCDF calls since the ETSF_IO library is not maintained anymore.
The netcdf files, however, are still written following the ETSF-IO specifications <a class="wikilink citation-wikilink" data-tippy-content="Specification of an extensible and portable file format for electronic structure and crystallographic data" data-toggle="popover" href="/theory/bibliography#gonze2008">[Gonze2008]</a>
and extended with Abinit-specific quantities.</p>
</div>
<h2 id="ionmov"><strong>ionmov</strong><a class="headerlink" href="#ionmov" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> IONic MOVEs<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform a molecular dynamics calculation" data-toggle="popover" href="/topics/MolecularDynamics">topic_MolecularDynamics</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to perform a geometry optimization" data-toggle="popover" href="/topics/GeoOpt">topic_GeoOpt</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Moderately used, [123/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with geometry optimisation using BFGS (test the reformating part of the code)." data-toggle="popover" href="/tests/bigdft/Input/t10.abi" target="_blank">t10.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2O in isolated boundary conditions (plane waves, NC), try tu use Damiens Poisson cutoff.
Water molecule with HGH pseudo-potentials. This checks that a negative
value in rhor will not make the Poisson solver crashes on XC computation." data-toggle="popover" href="/tests/bigdft/Input/t22.abi" target="_blank">t22.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm." data-toggle="popover" href="/tests/built-in/Input/testin_fast.abi" target="_blank">testin_fast.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file." data-toggle="popover" href="/tests/built-in/Input/testin_etsf_io.abi" target="_blank">testin_etsf_io.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ca atom in PAW. Test the output of density in PAW formalism with ETSF_IO.
Also test the output of the wavefunctions in PAW formalism with ETSF_IO." data-toggle="popover" href="/tests/etsf_io/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, static, spin-polarized.
Same system as test 49 of v2, except that nctime is non-zero.
Test ionmov=6 (Verlet) as well as ionmov=7." data-toggle="popover" href="/tests/etsf_io/Input/t21.abi" target="_blank">t21.abi</a> &hellip;</li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm.
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/fast/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Conduct relaxation of molecule starting from wf.19, using ionmov=2. (Broyden method)." data-toggle="popover" href="/tests/fast/Input/t20.abi" target="_blank">t20.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
21. Conduct same relaxation but use ionmov=1 (molecular dynamics)." data-toggle="popover" href="/tests/fast/Input/t21.abi" target="_blank">t21.abi</a> &hellip;</li>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CH molecule NON-spin-polarized, in a big box, without tetragonal symmetry, in order to avoid
spurious degeneracy effects coupled to occupation numbers rapidly changing.
GPU
PAW : first PBE, then PBE0, then HSE06. Interatomic distance optimization." data-toggle="popover" href="/tests/gpu_omp/Input/t28.abi" target="_blank">t28.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
N2 molecule non-spin-polarized, in a big box.
PAW : first PBE, then PBE0, then HSE06. Interatomic distance optimization.
Test the geometry convergence in the hybrid functional case
The results obtained with underconverged ecut (ecut 18) and box size (5 4 4 Angstrom)
compare favourably with those mentioned in Arnardi&#x27;s report, as well as with those of VASP.
Values for the distance d, in Angstrom, for PBE, PBE0 and HSE06 respectively :
Present calculation  (ecut 18, 5 4 4 box) : 1.101, 1.084, 1.085 Angstrom
Better  calculation  (ecut 22, 6 5 5 box) : 1.102, 1.086, 1.086 Angstrom
ABINIT Arnardi report (ecut acell unknown): 1.103, 1.091, 1.092 Angstrom
VASP Arnardi report (ecut acell unknown)  : 1.103, 1.089,  NA   Angstrom
Experimental : 1.098 Angstrom." data-toggle="popover" href="/tests/libxc/Input/t67.abi" target="_blank">t67.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CH molecule spin-polarized, in a big box.
Norm conserving : first PBE, then PBE0, then HSE06. Interatomic distance optimization.
Test the geometry convergence in the hybrid functional case
The results obtained with underconverged ecut (ecut 15) and box size (4 3 3 Angstrom)
compare favourably with those mentioned in Arnardi&#x27;s report, as well as with those of VASP.
Values for the distance d, in Angstrom, for PBE, PBE0 and HSE06 respectively :
Present calculation  (ecut 13, 5 4 4 box) : 1.138, 1.130, 1.131 Angstrom
Better  calculation  (ecut 18, 7 6 6 box) : 1.135, 1.124, 1.125 Angstrom
ABINIT Arnardi report (ecut acell unknown): 1.136, 1.124, 1.124 Angstrom
VASP Arnardi report (ecut acell unknown)  : 1.136, 1.124,  NA   Angstrom
Experimental : 1.120 Angstrom." data-toggle="popover" href="/tests/libxc/Input/t68.abi" target="_blank">t68.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
CH molecule spin-polarized, in a big box.
PAW : first PBE, then PBE0, then HSE06. Interatomic distance optimization.
Test the geometry convergence in the hybrid functional case
The results obtained with slightly better converged ecut (ecut 15) and box size (6 5 5 Angstrom)
compare favourably with those mentioned in Arnardi&#x27;s report, as well as with those of VASP.
Values for the distance d, in Angstrom, for PBE, PBE0 and HSE06 respectively :
Present calculation (ecut 13, 5 4 4 box)     : 1.130, 1.121, 1.122 Angstrom
Better calculation (ecut 15, 6 5 5 box)      : 1.136, 1.125, 1.126 Angstrom
Even better calculation (ecut 18, 7 6 6 box) : 1.138, 1.126, 1.127 Angstrom
ABINIT Arnardi report (ecut acell unknown)   : 1.136, 1.124, 1.124 Angstrom
VASP Arnardi report (ecut acell unknown)     : 1.136, 1.124,  NA   Angstrom
Experimental : 1.120 Angstrom." data-toggle="popover" href="/tests/libxc/Input/t69.abi" target="_blank">t69.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si, Bulk, 2 atoms , paral_kgb.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*np_spkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over FFT and kpoints:
npband*npfft*np_spkpt=1*2*2=4 processors.
In test tY.in we check other distributions for guarantee." data-toggle="popover" href="/tests/mpiio/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si, Bulk, 2 atoms , paral_kgb.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/paral/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/paral/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*np_spkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over FFT and kpoints:
npband*npfft*np_spkpt=1*2*2=4 processors.
In test tY.in we check other distributions for guarantee." data-toggle="popover" href="/tests/paral/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>psml:  <a class="wikilink abifile-wikilink" data-tippy-content="
Partial cut-off energy convergence study of bulk FCC aluminium,
to compare with the PSML results of t07 and t11" data-toggle="popover" href="/tests/psml/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Total energy vs. cell size for bulk FCC aluminium, to compare with the
PSML results of t08 and t12" data-toggle="popover" href="/tests/psml/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Partial cut-off energy convergence study of bulk FCC aluminium" data-toggle="popover" href="/tests/psml/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
PbTiO3 in the tetragonal geometry.
Test berryopt=14 (finite reduced electric field calculation,relaxing cell
parameters, e.g. optcell=2)
(XG120616 : tranferred to tests/seq)" data-toggle="popover" href="/tests/seq/Input/tsv6_121.abi" target="_blank">tsv6_121.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PbTiO3 in the tetragonal geometry.
Test berryopt=16 (finite reduced electric displacement field calculation,
relaxing cell parameters, e.g. optcell=2)
(XG120616 : tranferred to tests/seq)" data-toggle="popover" href="/tests/seq/Input/tsv6_122.abi" target="_blank">tsv6_122.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PbTiO3 in the tetragonal geometry.
Test berryopt=4 (finite electric field calculation, relaxing cell
parameters, e.g. optcell=2)
(XG120616 : tranferred to tests/seq)" data-toggle="popover" href="/tests/seq/Input/tsv6_123.abi" target="_blank">tsv6_123.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Mo surface, with 10 atom per cell. Not very large, but the
number of bands make it a medium-size problem : 36 bands." data-toggle="popover" href="/tests/v1/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the option ionmov=4. 8-atom Si cube, non spin-polarized.
Same test as number 22a of fast, except for the change
of ionmov, no reading of wavefunctions, iscf to 2, and different
tolerance criteria." data-toggle="popover" href="/tests/v1/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the option ionmov=4. Si2 molecule, spin-polarized.
Same test as number 16 of fast, except for the change
of ionmov, no reading of wavefunctions, iscf to 2, and different
tolerance criteria.

Cannot be executed in parallel:
--- !ERROR
message: |
the number of bands in the spin up case must be equal to
the number of bands in the spin down case.
This is not the case for the k point number : 1
The number of bands spin up and down are : 5 3 Action : change nband, or use the sequential
version of ABINIT.
src_file: chkinp.F90
src_line: 1181
..." data-toggle="popover" href="/tests/v1/Input/t45.abi" target="_blank">t45.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the post identification of more symmetric structures obtained after geometry optimization
Consider diamond and graphene, with low ecut and number of k points." data-toggle="popover" href="/tests/v10/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2) for cell optimization. PAW,istwfk=1." data-toggle="popover" href="/tests/v10/Input/t19.abi" target="_blank">t19.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule: MD simulation with Langevin thermostat." data-toggle="popover" href="/tests/v10/Input/t20.abi" target="_blank">t20.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Arsenic in rhombohedral structure.
Optimization of unit cell size and shape.
With 4x4x4 k point grid, ecut 3.0, occopt 4 and tsmear 0.06d0,
one get acell 3*7.325  angdeg 3*57.36 and xred 0.2277
These input parameters are too small, but still give a realistic
geometry, since with the much better parameters
12x12x12 k point grid, ecut 12.0, occopt 4 and tsmear 0.04d0,
one gets acell 3*7.633  angdeg 3*54.95 and xred 0.2296, while
the experimental values are
acell 3*7.751   angdeg 3*54.554 and xred 0.2276" data-toggle="popover" href="/tests/v2/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box.
Comparison of the modified Broyden algorithm (ionmov=3) with the
original one (ionmov=2). Start with different values
of xcart, from 0.6 to 1.1, by step of 0.1 . The number of Broyden
steps needed to reach acceptable residual forces
with the ionmov=3 algorithm are : 3, 2, 2, 3, 3, 4, while
with the ionmov=2 algorithms, one get : 4, 3, 2, 5, and then,
either the algorithm does not converge within 8 steps, or it
converges to a saddle point of the energy !
This test was hard to make portable. This is why the tolerance
for fldiff is very large." data-toggle="popover" href="/tests/v2/Input/t48.abi" target="_blank">t48.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, static, spin-polarized.
Same system as test 17 of fast, except lower ecut.
Test ionmov=6 (Verlet) as well as ionmov=7.
Cannot be executed in parallel:
--- !ERROR
message: |
the number of bands in the spin up case must be equal to
the number of bands in the spin down case.
This is not the case for the k point number : 1 The number of bands spin up and down are : 5 3
Action : change nband, or use the sequential version of ABINIT.
src_file: chkinp.F90
src_line: 1181" data-toggle="popover" href="/tests/v2/Input/t49.abi" target="_blank">t49.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
8 atoms of Si in an elongated box.
4 of them are fixed, while atoms 5 and 6
and 7 and 8 are grouped by pair, such as
the sum of their relative separations along y is constrained to 8.0 .
This is a crazy constraint, just to show that it can be done !" data-toggle="popover" href="/tests/v3/Input/t40.abi" target="_blank">t40.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Magnesium HCP. Optimize the cell volume and shape using different constraints.
Checks whether the stresses are symmetric, and whether the optimisation algorithm does
not break the symmetry.
Also checks the possibility to disable the stop after violation of the condition related to dilatmx.
This is done in dataset 6. The optimization delivers acell values slightly different from those of dataset 2." data-toggle="popover" href="/tests/v3/Input/t42.abi" target="_blank">t42.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule : examine the rotational freedom.
The present test produces the following
vibrational frequencies (with degeneracies indicated):
56.89 i cm-1 (2)
0.41   cm-1 (2)
1.05   cm-1
3800    cm-1
The large frequency corresponds to the stretching
mode, and has the right order of magnitude.
The frequencies close to 1 cm-1 corresponds
to translation modes, and are small enough
for usual applications.
The  56.89 i cm-1 mode corresponds to rotation of
the H2 molecule. The magnitude of this
frequency might seem quite
large. Here are the results of tests made to understand
this phenomenon. First, note that
ecut 12  acell 3*14
Increasing the value of ecut to 25 decreases
the magnitude of the frequency to 36.8 cm-1 .
However, in order to continue to make it smaller,
the cell size must be increased , and an oscillatory
behaviour is observed :
3*16   45.6 i cm-1
3*18   22.7   cm-1
3*20   19.1 i cm-1
3*22   15.7 i cm-1
3*24   13.7   cm-1
Many other tests have been set up. In particular,
it was observed that the frequency of the oscillatory
behaviour changes with the ecut, and also that
using the Gamma point, instead of the 1/4 1/4 1/4 k point
(used in this test) degrades the convergence.
The overall picture is as follows.
There are different reasons for the translation
and rotation modes to acquire a non-zero frequency
when plane waves and supercells are used.
Still, as concerns translations, only the
existence of a discretization of the XC grid
is important. For rotations, supercell effects
are also present :
- alignement of dipole or quadrupoles
- interaction between tails of wavefunctions, accross cells
Since the convergence in supercell size is oscillatory, we infer
that the breaking of the rotational invariance is mostly
due to interaction between wavefunction tails.
This will be checked by confining the system in a spherical
well, in a forthcoming test." data-toggle="popover" href="/tests/v3/Input/t80.abi" target="_blank">t80.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ca in orthorhombic structure. 1 k point, low ecut.
Perform a test of GS total energy computation, using an
experimental PAW pseudopotential (pspcod=7)." data-toggle="popover" href="/tests/v4/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O in orthorhombic structure. 1 k point, low ecut. Experimental PAW pseudopotential.
The aim of this test is to verify that different values
of input variable &#x27;ortalg&#x27; give the same results for
total energy. &#x27;ortalg&#x27; is use in the conjugate gradient
algorithm which solves, in the case of PAW calculations,
a generalized eigenproblem (H.|Psi&gt;=Lambda.S|Psi&gt;).
Three datasets are perfomed ; they must give the same
total energies values (when converged)." data-toggle="popover" href="/tests/v4/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
This is a test, in the norm conserving case, of the Molecular Dynamics flag
ionmov==13. With the values of optcell=0, 1, 2 (isothermal (0) , isothermal/isenthalpic
with homogeneous cell deformations (1) or full cell deformations (2).)
This is the reversible integrator of Martyna, Tuckerman, Tobias and Klein.
(Mol. Phys., 1996, p 1117).
XG20090912 : Why is the result of dataset 1 and dataset 4 equivalent, while
the bmass varies by a factor of 2 ?" data-toggle="popover" href="/tests/v5/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of geometry optimization using using ionmov=1,4,5 and 7
Hydrogen molecule inside a box of 12 Bohr
This test was created to test ionmov=5" data-toggle="popover" href="/tests/v5/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
uses ionmov 14 : a 14-step time integration by Blanes and Moan." data-toggle="popover" href="/tests/v5/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Hydrogen diatomic molecule in a cell, close to BCC.
One hydrogen atom is at the origin. The other lies initially
along the 1 1 1 direction, at a distance close to the one of the free dimer distance.
The final position is the mirror with respect to the plane perpendicular to x, passing at 1/2 0 0 .
The cell parameter is less than twice the H2 interatomic distance, so that the transition
path come close to the x axis, although it never reaches it (the closest being in the
mirror plane).
Test the images : 6 images, exploring the transition path by a simple algorithm.
MG: Does it work in parallel. I tried 2 CPUs and the run get stuck!" data-toggle="popover" href="/tests/v6/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Delocalized internals test. Si diamond bulk with displaced atom
Unconverged in all variables" data-toggle="popover" href="/tests/v6/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Hydrure of Lithium-Boron, in a face-centered monoclinic cell.
Test the recognition of the space group (C2/c (# 15)). Was lacking a case before Dec 2011." data-toggle="popover" href="/tests/v6/Input/t30.abi" target="_blank">t30.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the extrapolation of then wave functions from
one structural relaxation (time) step to the other:
extrapwf=1
WARNING: this feature is stil experimental and probably buggy.
Si, Bulk, 2 atoms" data-toggle="popover" href="/tests/v7/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Nickel ferromagnetic fcc structure with an ONCVPSP pseudo containing valence density.
We test several improvements that are available when the NC file contains the PS valence charge.
More specifically, we test the initialization of the density from atomic quantities (initro.F90),
the correction to the forces due to the residuals and the extrapolation of the density
for structural relaxations (well, xred is fixed by symmetry).
We also test the treatment of the core charge in G-space in the case of GS calculations
By default, abinit handles XCCC in real space, here we use nc_xccc_gspace==1 to treat it
in G-space using the same approach as the one used in PAW." data-toggle="popover" href="/tests/v7/Input/t10.abi" target="_blank">t10.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Boron, 32 atoms - Thomas-Fermi method (without orbitals)
Test the temperature-dependent XC functional (ixc=50)
Ichimaru et al Phys. Rep. 149, 91-205 (1987)
Test the von Weizsacker gradient correction (tfkinfunc=11 or 12)" data-toggle="popover" href="/tests/v7/Input/t11.abi" target="_blank">t11.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Geometry optimization with LBFGS" data-toggle="popover" href="/tests/v8/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test of velocity verlet integrator" data-toggle="popover" href="/tests/v8/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Geometry optimization with FIRE (ionmov 15)" data-toggle="popover" href="/tests/v8/Input/t17.abi" target="_blank">t17.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
NaI with a sligthly expanded lattice, to allow self-localisation of a hole polaron, using pSIC technique.
Realistic ecut and reasonable k point sampling, but small cell of only 8 atoms for testing." data-toggle="popover" href="/tests/v9/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test to prepare a SOC conductivity calculation (test v9#t101)
Ground state calculation for 4 Al atoms
The number of bands is unrealistic. This test produces files that are inputs for test 101.
It tests the following parts of the code:
optic_paw, optic_paw_core, optic_paw_soc
Note that, in addition to the psp file, the spinor core wave functions file is needed." data-toggle="popover" href="/tests/v9/Input/t100.abi" target="_blank">t100.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test to prepare a SOC conductivity calculation (test v9#t102)
Ground state calculation for 4 Al atoms
The number of bands is unrealistic. This test produces files that are inputs for test 103.
It tests the following parts of the code:
optic_paw_core
Note that, in addition to the psp file, the spinor core wave functions file is needed." data-toggle="popover" href="/tests/v9/Input/t102.abi" target="_blank">t102.abi</a> &hellip;</li>
<li>vdwxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Argon FCC. Test the vdW-DFT-D2 (Grimme) semi-empirical potential." data-toggle="popover" href="/tests/vdwxc/Input/t10.abi" target="_blank">t10.abi</a> &hellip;</li>
</ul>
</details>
<p>Choice of algorithm to control the displacements of ions, and possibly changes of cell shape and size (see <a class="wikilink codevar-wikilink" href="/variables/rlx#optcell">optcell</a>).
No meaning for RF calculations.</p>
<ul>
<li>
<p>0 &rarr; Do not move ions (<strong>default behaviour</strong>)</p>
</li>
<li>
<p>1 &rarr; Move atoms using molecular dynamics with optional viscous damping (friction linearly proportional to velocity).
  The viscous damping is controlled by the <a class="wikilink codevar-wikilink" href="/variables/rlx#vis">vis</a> parameter.
  If undamped molecular dynamics is desired, set <a class="wikilink codevar-wikilink" href="/variables/rlx#vis">vis</a> to 0.
  The implemented algorithm is the generalisation of the Numerov technique (6<sup>th</sup> order), but is NOT invariant upon time-reversal,
  so that the energy is not conserved.
  The value <strong>ionmov</strong> = 6 will usually be preferred, although the algorithm that is implemented is lower-order.
  The time step is governed by <a class="wikilink codevar-wikilink" href="/variables/rlx#dtion">dtion</a>.
  <strong>Purpose:</strong> Molecular dynamics (if <a class="wikilink codevar-wikilink" href="/variables/rlx#vis">vis</a> = 0), Structural optimization (if <a class="wikilink codevar-wikilink" href="/variables/rlx#vis">vis</a> &gt;0)
  <strong>Cell optimization:</strong> No (Use <a class="wikilink codevar-wikilink" href="/variables/rlx#optcell">optcell</a> = 0 only)
  <strong>Related variables:</strong> Viscous parameter <a class="wikilink codevar-wikilink" href="/variables/rlx#vis">vis</a>, time step <a class="wikilink codevar-wikilink" href="/variables/rlx#dtion">dtion</a>, index of atoms fixed <a class="wikilink codevar-wikilink" href="/variables/rlx#iatfix">iatfix</a></p>
</li>
<li>
<p>2 &rarr; Conduct structural optimization using the Broyden-Fletcher-Goldfarb-Shanno minimization (BFGS).
  This is much more efficient for structural optimization than viscous damping, when there are
  less than about 10 degrees of freedom to optimize.
  <strong>Purpose:</strong> Structural optimization
  <strong>Cell optimization:</strong> Yes (if <a class="wikilink codevar-wikilink" href="/variables/rlx#optcell">optcell</a>/=0)</p>
</li>
<li>
<p>3 &rarr; Conduct structural optimization using the Broyden-Fletcher-Goldfarb-Shanno minimization (BFGS),
  modified to take into account the total energy as well as the gradients (as in usual BFGS).
  See <a class="wikilink citation-wikilink" data-tippy-content="Optimization of equilibrium geometries and transition structures" data-toggle="popover" href="/theory/bibliography#schlegel1982">[Schlegel1982]</a>. Might be better than <strong>ionmov</strong> = 2 for few degrees of freedom (less than 3 or 4).
  Can be very unstable - use with caution!
  <strong>Purpose:</strong> Structural optimization
  <strong>Cell optimization:</strong> Yes (if <a class="wikilink codevar-wikilink" href="/variables/rlx#optcell">optcell</a>/=0)</p>
</li>
<li>
<p>4 &rarr; Conjugate gradient algorithm for simultaneous optimization of potential and ionic degrees of freedom.
  It can be used with <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> = 2 and <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> =5 or 6
  (WARNING: this is under development, and does not work very well in many cases).
  <strong>Purpose:</strong> Structural optimization
  <strong>Cell optimization:</strong> No (Use <a class="wikilink codevar-wikilink" href="/variables/rlx#optcell">optcell</a> = 0 only)</p>
</li>
<li>
<p>5 &rarr; Simple relaxation of ionic positions according to (converged) forces.
  Equivalent to <strong>ionmov</strong> = 1 with zero masses, albeit the relaxation coefficient is not <a class="wikilink codevar-wikilink" href="/variables/rlx#vis">vis</a>, but <a class="wikilink codevar-wikilink" href="/variables/dev#iprcfc">iprcfc</a>.
  <strong>Purpose:</strong> Structural optimization
  <strong>Cell optimization:</strong> No (Use <a class="wikilink codevar-wikilink" href="/variables/rlx#optcell">optcell</a> = 0 only)</p>
</li>
<li>
<p>6 &rarr; Molecular dynamics using the Verlet algorithm, see <a class="wikilink citation-wikilink" data-tippy-content="Computer Simulation of Liquids" data-toggle="popover" href="/theory/bibliography#allen1987a">[Allen1987a]</a> p 81].
  The only related parameter is the time step (<a class="wikilink codevar-wikilink" href="/variables/rlx#dtion">dtion</a>).
  <strong>Purpose:</strong> Molecular dynamics
  <strong>Cell optimization:</strong> No (Use <a class="wikilink codevar-wikilink" href="/variables/rlx#optcell">optcell</a> = 0 only)
  <strong>Related variables:</strong> time step <a class="wikilink codevar-wikilink" href="/variables/rlx#dtion">dtion</a>, index of atoms fixed <a class="wikilink codevar-wikilink" href="/variables/rlx#iatfix">iatfix</a></p>
</li>
<li>
<p>7 &rarr; Quenched Molecular dynamics using the Verlet algorithm, and stopping each atom for which
  the scalar product of velocity and force is negative. The only related parameter is the time step (<a class="wikilink codevar-wikilink" href="/variables/rlx#dtion">dtion</a>).
  The goal is not to produce a realistic dynamics, but to go as fast as possible to the minimum.
  For this purpose, it is advised to set all the masses to the same value
  (for example, use the Carbon mass, i.e. set <a class="wikilink codevar-wikilink" href="/variables/rlx#amu">amu</a> to 12 for all type of atoms).
  <strong>Purpose:</strong> Structural optimization
  <strong>Cell optimization:</strong> No (Use <a class="wikilink codevar-wikilink" href="/variables/rlx#optcell">optcell</a> = 0 only)
  <strong>Related variables:</strong> time step <a class="wikilink codevar-wikilink" href="/variables/rlx#dtion">dtion</a>, index of atoms fixed <a class="wikilink codevar-wikilink" href="/variables/rlx#iatfix">iatfix</a></p>
</li>
<li>
<p>8 &rarr; Molecular dynamics with Nose-Hoover thermostat, using the Verlet algorithm.
  <strong>Purpose:</strong> Molecular dynamics
  <strong>Cell optimization:</strong> No (Use <a class="wikilink codevar-wikilink" href="/variables/rlx#optcell">optcell</a> = 0 only)
  <strong>Related variables:</strong> time step (<a class="wikilink codevar-wikilink" href="/variables/rlx#dtion">dtion</a>), Temperatures (<a class="wikilink codevar-wikilink" href="/variables/rlx#mdtemp">mdtemp</a>), and thermostat mass (<a class="wikilink codevar-wikilink" href="/variables/rlx#noseinert">noseinert</a>).</p>
</li>
<li>
<p>9 &rarr; Langevin molecular dynamics.
  <strong>Purpose:</strong> Molecular dynamics
  <strong>Cell optimization:</strong> No (Use <a class="wikilink codevar-wikilink" href="/variables/rlx#optcell">optcell</a> = 0 only)
  <strong>Related variables:</strong> time step (<a class="wikilink codevar-wikilink" href="/variables/rlx#dtion">dtion</a>), temperatures (<a class="wikilink codevar-wikilink" href="/variables/rlx#mdtemp">mdtemp</a>) and friction coefficient (<a class="wikilink codevar-wikilink" href="/variables/rlx#friction">friction</a>).</p>
</li>
<li>
<p>10 &rarr; Delocalized internal coordinates with simple BFGS
  <strong>Purpose:</strong> Structural optimization
  <strong>Cell optimization:</strong> No (Use <a class="wikilink codevar-wikilink" href="/variables/rlx#optcell">optcell</a> = 0 only)</p>
</li>
<li>
<p>11 &rarr; Delocalized internal coordinates with BFGS using total energy
  <strong>Purpose:</strong> Structural optimization
  <strong>Cell optimization:</strong> No (Use <a class="wikilink codevar-wikilink" href="/variables/rlx#optcell">optcell</a> = 0 only)</p>
</li>
<li>
<p>12 &rarr; Isokinetic ensemble molecular dynamics.
    The equations of motion of the ions in contact with a thermostat are solved with the
    algorithm proposed in <a class="wikilink citation-wikilink" data-tippy-content="Operator-splitting integrators for constant-temperature molecular dynamics" data-toggle="popover" href="/theory/bibliography#zhang1997">[Zhang1997]</a>, as worked out in <a class="wikilink citation-wikilink" data-tippy-content="Algorithms and novel applications based on the isokinetic ensemble. I. Biophysical and path integral molecular dynamics" data-toggle="popover" href="/theory/bibliography#minary2003">[Minary2003]</a>.
    The conservation of the kinetic energy is obtained within machine precision at each step.
    As in <a class="wikilink citation-wikilink" data-tippy-content="The isothermal/isobaric molecular dynamics ensemble" data-toggle="popover" href="/theory/bibliography#evans1983">[Evans1983]</a>, when there is no fixing of atoms, the number of degrees of freedom in which the
    microscopic kinetic energy is hosted is 3*<a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a> - 4.
    Indeed, the total kinetic energy is constrained, which accounts for
    minus one degree of freedom (also mentioned in <a class="wikilink citation-wikilink" data-tippy-content="Algorithms and novel applications based on the isokinetic ensemble. I. Biophysical and path integral molecular dynamics" data-toggle="popover" href="/theory/bibliography#minary2003">[Minary2003]</a>), but also there are three degrees of freedom
    related to the total momentum in each direction, that cannot be counted as microscopic degrees of freedom, since the
    total momentum is also preserved (but this is not mentioned in <a class="wikilink citation-wikilink" data-tippy-content="Algorithms and novel applications based on the isokinetic ensemble. I. Biophysical and path integral molecular dynamics" data-toggle="popover" href="/theory/bibliography#minary2003">[Minary2003]</a>).
    When some atom is fixed in one or more direction,
    e.g. using <a class="wikilink codevar-wikilink" href="/variables/rlx#natfix">natfix</a>, <a class="wikilink codevar-wikilink" href="/variables/rlx#natfixx">natfixx</a>, <a class="wikilink codevar-wikilink" href="/variables/rlx#natfixy">natfixy</a>, or <a class="wikilink codevar-wikilink" href="/variables/rlx#natfixz">natfixz</a>, the number of degrees of freedom is decreased accordingly,
    albeit taking into account that the total momentum is not preserved
    anymore (e.g. fixing the position of one atom gives 3*natom-4, like in the non-fixed case).
    <strong>Purpose:</strong> Molecular dynamics
    <strong>Cell optimization:</strong> No (Use <a class="wikilink codevar-wikilink" href="/variables/rlx#optcell">optcell</a> = 0 only)
    <strong>Related variables:</strong> time step (<a class="wikilink codevar-wikilink" href="/variables/rlx#dtion">dtion</a>) and the first temperature in <a class="wikilink codevar-wikilink" href="/variables/rlx#mdtemp">mdtemp</a> in case
    the velocities <a class="wikilink codevar-wikilink" href="/variables/rlx#vel">vel</a> are not initialized, or all initialized to zero.</p>
</li>
<li>
<p>13 &rarr; The equations of motion of the ions in contact with a thermostat
    and a barostat are solved with the algorithm proposed in <a class="wikilink citation-wikilink" data-tippy-content="Explict reversible integrators for extended systems dynamics" data-toggle="popover" href="/theory/bibliography#martyna1996">[Martyna1996]</a>.
    If optcell=1 or 2, the mass of the barostat (<a class="wikilink codevar-wikilink" href="/variables/rlx#bmass">bmass</a>) must be given in addition.
    <strong>Purpose:</strong> Molecular dynamics
    <strong>Cell optimization:</strong> Yes (if <a class="wikilink codevar-wikilink" href="/variables/rlx#optcell">optcell</a>/=0)
    <strong>Related variables:</strong> The time step (<a class="wikilink codevar-wikilink" href="/variables/rlx#dtion">dtion</a>), the temperatures (<a class="wikilink codevar-wikilink" href="/variables/rlx#mdtemp">mdtemp</a>),
    the number of thermostats (<a class="wikilink codevar-wikilink" href="/variables/rlx#nnos">nnos</a>), and the masses of thermostats (<a class="wikilink codevar-wikilink" href="/variables/rlx#qmass">qmass</a>).</p>
</li>
<li>
<p>14 &rarr; Simple molecular dynamics with a symplectic algorithm proposed in <a class="wikilink citation-wikilink" data-tippy-content="Practical symplectic partitioned Runge--Kutta and Runge--Kutta--Nystrom methods" data-toggle="popover" href="/theory/bibliography#blanes2002">[Blanes2002]</a>  (called SRKNa14]
    of the kind first published in <a class="wikilink citation-wikilink" data-tippy-content="Construction of higher order sympletic integrators" data-toggle="popover" href="/theory/bibliography#yoshida1990">[Yoshida1990]</a>.
    This algorithm requires at least 14 evaluation of the forces (actually 15 are done within Abinit) per time step.
    At this cost it usually gives much better energy conservation than the verlet algorithm (<strong>ionmov</strong> 6)
    for a 30 times bigger value of <a class="wikilink codevar-wikilink" href="/variables/rlx#dtion">dtion</a>.
    Notice that the potential energy of the initial atomic configuration is never evaluated using this algorithm.
    <strong>Purpose:</strong> Molecular dynamics
    <strong>Cell optimization:</strong> No (Use <a class="wikilink codevar-wikilink" href="/variables/rlx#optcell">optcell</a> = 0 only)</p>
</li>
<li>
<p>15 &rarr; Fast inertial relaxation engine (FIRE) algorithm proposed by Erik Bitzek, Pekka Koskinen, Franz Ghler,
    Michael Moseler, and Peter Gumbsch in <a class="wikilink citation-wikilink" data-tippy-content="Structural Relaxation Made Simple" data-toggle="popover" href="/theory/bibliography#bitzek2006">[Bitzek2006]</a>.
    According to the authors, the efficiency of this method is nearly the same as L-bfgs (<strong>ionmov</strong> = 22).
    It is based on conventional molecular dynamics with additional velocity modifications and adaptive time steps.
    The initial time step is set with <a class="wikilink codevar-wikilink" href="/variables/rlx#dtion">dtion</a>. Note that the physical meaning and unit of <a class="wikilink codevar-wikilink" href="/variables/rlx#dtion">dtion</a> are different
    from the default ones.
    The purpose of this algorithm is relaxation, not molecular dynamics. <a class="wikilink codevar-wikilink" href="/variables/rlx#dtion">dtion</a> governs the ion position changes,
    but the cell parameter changes as well.
    The positions are in reduced coordinates instead of in cartesian coordinates.
    The suggested first guess of dtion is 0.03.
    <strong>Purpose:</strong> Relaxation
    <strong>Cell optimization:</strong> Yes (if <a class="wikilink codevar-wikilink" href="/variables/rlx#optcell">optcell</a>/=0)
    <strong>Related variables:</strong> The initial time step <a class="wikilink codevar-wikilink" href="/variables/rlx#dtion">dtion</a></p>
</li>
<li>
<p>16 &rarr; Langevin molecular dynamics. The equations of motion of the ions are described
    with the algorithms proposed in <a class="wikilink citation-wikilink" data-tippy-content="Langevin dynamics in constant pressure extended systems" data-toggle="popover" href="/theory/bibliography#quigley2004">[Quigley2004]</a> and <a class="wikilink citation-wikilink" data-tippy-content="Constant pressure Langevin dynamics: theory and application" data-toggle="popover" href="/theory/bibliography#quigley2005">[Quigley2005]</a>.
    <strong>Purpose:</strong> Molecular dynamics
    <strong>Cell optimization:</strong> Yes (Use <a class="wikilink codevar-wikilink" href="/variables/rlx#optcell">optcell</a> = 2 only)
    <strong>Related variables:</strong> time step (<a class="wikilink codevar-wikilink" href="/variables/rlx#dtion">dtion</a>), temperatures (<a class="wikilink codevar-wikilink" href="/variables/rlx#mdtemp">mdtemp</a>), friction coefficient (<a class="wikilink codevar-wikilink" href="/variables/rlx#friction">friction</a>).
    If <a class="wikilink codevar-wikilink" href="/variables/rlx#optcell">optcell</a>/=0, friction coefficient of the barostat (<a class="wikilink codevar-wikilink" href="/variables/rlx#frictionbar">frictionbar</a>), and the mass of the barostat (<a class="wikilink codevar-wikilink" href="/variables/rlx#bmass">bmass</a>).</p>
</li>
<li>
<p>20 &rarr; Direct inversion of the iterative subspace.
    Given a starting point <a class="wikilink codevar-wikilink" href="/variables/basic#xred">xred</a> that is a vector of length 3*<a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a> (reduced nuclei coordinates),
    and unit cell parameters (<a class="wikilink codevar-wikilink" href="/variables/basic#rprimd">%rprimd</a>) this routine uses the DIIS (direct inversion of the iterative subspace)
    to minimize the gradient (forces) on atoms.
    The preconditioning used to compute errors from gradients is using an inverse hessian matrix obtained by a BFGS algorithm.
    This method is known to converge to the nearest point where gradients vanish.
    This is efficient to refine positions around a saddle point for instance.
    <strong>Purpose:</strong> Structural optimization
    <strong>Cell optimization:</strong> No (Use <a class="wikilink codevar-wikilink" href="/variables/rlx#optcell">optcell</a> = 0 only)
    <strong>Related variables:</strong> DIIS memory <a class="wikilink codevar-wikilink" href="/variables/rlx#diismemory">diismemory</a></p>
</li>
<li>
<p>22 &rarr; Conduct structural optimization using the Limited-memory
    Broyden-Fletcher-Goldfarb-Shanno minimization (L-BFGS) <a class="wikilink citation-wikilink" data-tippy-content="Updating Quasi-Newton Matrices with Limited Storage" data-toggle="popover" href="/theory/bibliography#nocedal1980">[Nocedal1980]</a>.
    The routines are based on the original implementation by J. Nocedal available on netlib.org.
    This algorithm can be much better than the native implementation of BFGS in ABINIT (<strong>ionmov</strong> = 2)
    when one approaches convergence, perhaps because of better treatment of numerical details.
    <strong>Purpose:</strong> Structural optimization
    <strong>Cell optimization:</strong> Yes (if <a class="wikilink codevar-wikilink" href="/variables/rlx#optcell">optcell</a>/=0)</p>
</li>
<li>
<p>23 &rarr; Use of Learn on The Fly method (LOTF) for Molecular Dynamics.
    In the framework of isokinetic MD, the atomic forces and positions are computed by using LOTF interpolation.
    A SCF computation is performed only any <a class="wikilink codevar-wikilink" href="/variables/dev#lotf_nitex">lotf_nitex</a> steps.
    The results of the SCF are used to compute the parameters of a short range classical potential
    (for the moment only the glue potential for gold is implemented). Then these parameters are continuously
    tuned to compute atomic trajectories. LOTF has to be enabled at configure time.
    If LOTF is not enabled and <strong>ionmov</strong> = 23, abinit will set automatically <strong>ionmov</strong> = 12.
    The LOTF cycle is divided in the following steps:
    a) Initialization (SFC at t=0) and computation of potential parameters.
    b) Extrapolation of the atomic forces and positions for <a class="wikilink codevar-wikilink" href="/variables/dev#lotf_nitex">lotf_nitex</a> time
    step. To perform this extrapolation, the potential computed in a) is used
    (Verlet algorithm).
    c) SFC at t=<a class="wikilink codevar-wikilink" href="/variables/dev#lotf_nitex">lotf_nitex</a>. Computation of the potential parameters.
    d) LOTF interpolation, linear interpolation of the potential parameters and
    computation of the atomic forces and positions between t=0 and t=lotf_nitex.
    <strong>Purpose:</strong> Molecular Dynamics
    <strong>Cell optimization:</strong> No (Use <a class="wikilink codevar-wikilink" href="/variables/rlx#optcell">optcell</a> = 0 only)
    <strong>Related variables:</strong> <a class="wikilink codevar-wikilink" href="/variables/rlx#dtion">dtion</a>, <a class="wikilink codevar-wikilink" href="/variables/dev#lotf_classic">lotf_classic</a>, <a class="wikilink codevar-wikilink" href="/variables/dev#lotf_nitex">lotf_nitex</a>, <a class="wikilink codevar-wikilink" href="/variables/dev#lotf_nneigx">lotf_nneigx</a>, <a class="wikilink codevar-wikilink" href="/variables/dev#lotf_version">lotf_version</a>.</p>
</li>
<li>
<p>24 &rarr; Simple constant energy molecular dynamics using
   the velocity Verlet symplectic algorithm (second order), see <a class="wikilink citation-wikilink" data-tippy-content="Geometric numerical integration illustrated by the Stomer-Verlet Method" data-toggle="popover" href="/theory/bibliography#hairer2003">[Hairer2003]</a>.
   The only related parameter is the time step (<a class="wikilink codevar-wikilink" href="/variables/rlx#dtion">dtion</a>).
   <strong>Purpose:</strong> Molecular dynamics
   <strong>Cell optimization:</strong> No (Use <a class="wikilink codevar-wikilink" href="/variables/rlx#optcell">optcell</a> = 0 only)
   <strong>Related variables:</strong> time step <a class="wikilink codevar-wikilink" href="/variables/rlx#dtion">dtion</a></p>
</li>
<li>
<p>25 &rarr; Hybrid Monte Carlo sampling of the ionic positions at fixed temperature and unit cell geometry (NVT ensemble).
  The underlying molecular dynamics corresponds to <strong>ionmov</strong> = 24.
  The related parameters are the time step (<a class="wikilink codevar-wikilink" href="/variables/rlx#dtion">dtion</a>) and thermostat temperature (<a class="wikilink codevar-wikilink" href="/variables/rlx#mdtemp">mdtemp</a>).
  Within the HMC algorithm <a class="wikilink citation-wikilink" data-tippy-content="Hybrid Monte Carlo" data-toggle="popover" href="/theory/bibliography#duane1987">[Duane1987]</a>, the trial states are generated
  via short <span class="arithmatex">\(NVE\)</span> trajectories (ten <strong>ionmov</strong> = 24 steps in current implementation).
  The initial momenta for each trial are randomly sampled from Boltzmann distribution,
  and the final trajectory state is either accepted or rejected based on the Metropolis criterion.
  Such strategy allows to simultaneously update all reduced coordinates, achieve higher acceptance
  ratio than classical Metropolis Monte Carlo and better sampling efficiency
  for shallow energy landscapes <a class="wikilink citation-wikilink" data-tippy-content="Large scale hybrid Monte Carlo simulations for structure and property prediction" data-toggle="popover" href="/theory/bibliography#prokhorenko2018">[Prokhorenko2018]</a>.
  <strong>Purpose:</strong> Monte Carlo sampling
  <strong>Cell optimization:</strong> No (Use <a class="wikilink codevar-wikilink" href="/variables/rlx#optcell">optcell</a> = 0 only)
  <strong>Related variables:</strong> time step <a class="wikilink codevar-wikilink" href="/variables/rlx#dtion">dtion</a>, thermostat temperature <a class="wikilink codevar-wikilink" href="/variables/rlx#mdtemp">mdtemp</a>,</p>
</li>
<li>
<p>28 &rarr; Update atomic positions and unit cell parameters using the i-pi client-server protocol
   as described in <a class="wikilink citation-wikilink" data-tippy-content="i-PI 2.0: A universal force engine for advanced molecular simulations" data-toggle="popover" href="/theory/bibliography#kapil2019">[Kapil2019]</a>.
   In this case, ABINIT (the client) sends total energies, forces and stress tensor to the server
   that sends back the new configuration (atomic positions and cell parameters) to the ab-initio
   engine for further calculations.
   Note that the server is supposed to generate an input file that is consistent with the optimization/MD
   algorithm implemented by ABINIT.
   For instance, a server that wants to performs calculations with varying unit cells
   should set <a class="wikilink codevar-wikilink" href="/variables/rlx#optcell">optcell</a> &gt; 0 in the initial input.
   Note that, at present, this feature is mainly used to interface ABINIT
   with the ASE optimization routines. Moreover the user is responsible for creating an input
   file with tuned tolerances to prevent Abinit from exiting when internal convergence is reached.
   See examples available in the <a href="https://wiki.fysik.dtu.dk/ase/dev/ase/calculators/socketio/socketio.html">ASE documentation</a>
   <strong>Purpose:</strong> Structural optimization driver by the server (MD runs are not yet supported)
   <strong>Cell optimization:</strong> Yes (provide <a class="wikilink codevar-wikilink" href="/variables/rlx#optcell">optcell</a> &gt; 0 in the initial input)</p>
</li>
</ul>
<h2 id="iprcfc"><strong>iprcfc</strong><a class="headerlink" href="#iprcfc" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer for PReConditioner of Force Constants<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform a geometry optimization" data-toggle="popover" href="/topics/GeoOpt">topic_GeoOpt</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [4/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the option ionmov=4. 8-atom Si cube, non spin-polarized.
Same test as number 22a of fast, except for the change
of ionmov, no reading of wavefunctions, iscf to 2, and different
tolerance criteria." data-toggle="popover" href="/tests/v1/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the option ionmov=4. Si2 molecule, spin-polarized.
Same test as number 16 of fast, except for the change
of ionmov, no reading of wavefunctions, iscf to 2, and different
tolerance criteria.

Cannot be executed in parallel:
--- !ERROR
message: |
the number of bands in the spin up case must be equal to
the number of bands in the spin down case.
This is not the case for the k point number : 1
The number of bands spin up and down are : 5 3 Action : change nband, or use the sequential
version of ABINIT.
src_file: chkinp.F90
src_line: 1181
..." data-toggle="popover" href="/tests/v1/Input/t45.abi" target="_blank">t45.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, spin-polarized
Same as test 45, but use ithe default densfor_pred=2 instead of densfor_pred=1.
Cannot be executed in parallel:
--- !ERROR
message: |
the number of bands in the spin up case must be equal to
the number of bands in the spin down case.
This is not the case for the k point number : 1
The number of bands spin up and down are : 5 3 Action : change nband, or use the sequential
version of ABINIT.
src_file: chkinp.F90
src_line: 1181
..." data-toggle="popover" href="/tests/v1/Input/t48.abi" target="_blank">t48.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, spin-polarized. Same as test 45, but use densfor_pred=3 instead of densfor_pred=1.
Cannot be executed in parallel:
--- !ERROR
message: |
the number of bands in the spin up case must be equal to
the number of bands in the spin down case.
This is not the case for the k point number : 1
The number of bands spin up and down are : 5 3 Action : change nband, or use the sequential
version of ABINIT.
src_file: chkinp.F90
src_line: 1181
..." data-toggle="popover" href="/tests/v1/Input/t49.abi" target="_blank">t49.abi</a></li>
</ul>
</details>
<p>Used when <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> &gt; 0, to define the SCF preconditioning scheme. Potential-
based preconditioning schemes for the SCF loop are still under development.
The present parameter (force constant part) describes the way a change of
force is derived from a change of atomic position.
Supported values:</p>
<ul>
<li>0 &rarr; hessian is the identity matrix</li>
<li>1 &rarr; hessian is 0.5 times the identity matrix</li>
<li>2 &rarr; hessian is 0.25 times the identity matrix</li>
<li>-1 &rarr; hessian is twice the identity matrix
  *&hellip; (simply corresponding power of 2 times the identity matrix)</li>
</ul>
<p>No meaning for RF calculations.</p>
<h2 id="irandom"><strong>irandom</strong><a class="headerlink" href="#irandom" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer for the choice of the RANDOM number generator<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform a PIMD calculation" data-toggle="popover" href="/topics/PIMD">topic_PIMD</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to perform a molecular dynamics calculation" data-toggle="popover" href="/topics/MolecularDynamics">topic_MolecularDynamics</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 3<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [4/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule: MD simulation with Langevin thermostat." data-toggle="popover" href="/tests/v10/Input/t20.abi" target="_blank">t20.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule: MD simulation with Langevin thermostat." data-toggle="popover" href="/tests/v10/Input/t21.abi" target="_blank">t21.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Hydrogen molecule: Test the Path-Integral Molecular Dynamics (PIMD) implementation
in (N,V,T) ensemble. THe two thermostats (Nose-Hoover chains and Langevin) are tested
together with the three coordinate systems (primitive, normal mode, staging).
NOTE: MPI run with 2 procs is ok but fldiff comparison fails due to an extra section with
--- Pseudopotential description --" data-toggle="popover" href="/tests/v7/Input/t08.abi" target="_blank">t08.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule: PIMD simulation with Langevin thermostat. Test of restart with HIST.nc file. Test of linear constraint." data-toggle="popover" href="/tests/v8/Input/t05.abi" target="_blank">t05.abi</a></li>
</ul>
</details>
<p>For the time being, only used when <a class="wikilink codevar-wikilink" href="/variables/rlx#imgmov">imgmov</a> = 9 (Langevin Path-Integral Molecular Dynamics),
or <a class="wikilink codevar-wikilink" href="/variables/rlx#moldyn">moldyn</a> = &ldquo;nvt_langevin&rdquo; or &ldquo;npt_langevin&rdquo; (<a class="wikilink codevar-wikilink" href="/variables/dev#ionmov">ionmov</a> = 16).</p>
<p><strong>irandom</strong>  defines the random number generator.</p>
<p>Supported values:</p>
<ul>
<li>1 &rarr; &ldquo;uniformrandom&rdquo;, delivered with ABINIT package (initially comes from numerical recipes).</li>
<li>2 &rarr; intrinsic Fortran 90 random number generator.</li>
<li>3 &rarr; &ldquo;ZBQ&rdquo; non-deterministic random number generator by R. Chandler and P. Northrop.
  <a href="http://www.ucl.ac.uk/~ucakarc/work/software/randgen.txt">Documentation</a> and
  <a href="http://www.ucl.ac.uk/~ucakarc/work/software/randgen.f">Source code</a></li>
</ul>
<p><strong>irandom</strong>  = 3 is strongly advised when performing Molecular Dynamics restarts (avoids bias).</p>
<h2 id="irdwfkfine"><strong>irdwfkfine</strong><a class="headerlink" href="#irdwfkfine" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer that governs the ReaDing of the grid _WFK file on the FINE grid<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a multi dataset calculation" data-toggle="popover" href="/topics/multidtset">topic_multidtset</a>, <a class="wikilink topic-wikilink" data-tippy-content="To to calculate the temperature dependence of the electronic structure" data-toggle="popover" href="/topics/TDepES">topic_TDepES</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [1/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
This tests make use of the irdwfkfine variable instead of the getwfkfine variable used in the
previous test. The third q-point is computed here." data-toggle="popover" href="/tests/v7/Input/t51.abi" target="_blank">t51.abi</a></li>
</ul>
</details>
<p>If 1, will restart from existing wavefunctions on the fine grid. As alternative, one can use the input variables <a class="wikilink codevar-wikilink" href="/variables/dev#getwfkfine">getwfkfine</a>.</p>
<p>Ground-state calculation:</p>
<ul>
<li>only  <strong>irdwfkfine</strong>  and <a class="wikilink codevar-wikilink" href="/variables/dev#getwfkfine">getwfkfine</a> have a meaning</li>
<li>at most one of  <strong>irdwfkfine</strong>  or <a class="wikilink codevar-wikilink" href="/variables/dev#getwfkfine">getwfkfine</a> can be non-zero</li>
<li>if  <strong>irdwfkfine</strong>  = 1: read ground state wavefunctions from a disk file appended with _WFK,
    produced in a previous ground state fine grid calculation</li>
</ul>
<p>Response-function calculation:</p>
<ul>
<li>one and only one of  <strong>irdwfkfine</strong>  or <a class="wikilink codevar-wikilink" href="/variables/dev#getwfkfine">getwfkfine</a> MUST be non-zero</li>
<li>if  <strong>irdwfkfine</strong>  = 1: read ground state k -wavefunctions from a disk file appended with _WFK,
    produced in a previous ground state calculation</li>
<li>Reading the fine grid wavefunction will trigger the k-points interpolation technique of the temperature dependent calculations.</li>
</ul>
<p>Bethe-Salpeter calculation:</p>
<ul>
<li>one and only one of  <strong>irdwfkfine</strong>  or <a class="wikilink codevar-wikilink" href="/variables/dev#getwfkfine">getwfkfine</a> MUST be non-zero</li>
<li>if  <strong>irdwfkfine</strong>  = 1: read ground state k -wavefunctions from a disk file appended with _WFK,
     produced in a previous ground state calculation</li>
<li>This variable or <a class="wikilink codevar-wikilink" href="/variables/dev#getwfkfine">getwfkfine</a> is mandatory when <a class="wikilink codevar-wikilink" href="/variables/bse#bs_interp_mode">bs_interp_mode</a> = 1</li>
</ul>
<p>For further information about the naming of files in ABINIT, consult the <a class="wikilink user-guide-wikilink" href="/guide/abinit#files-file">abinit help file</a>.</p>
<p><strong>This variable is experimental. In development.</strong></p>
<h2 id="isecur"><strong>isecur</strong><a class="headerlink" href="#isecur" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer for level of SECURity choice<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to select the SCF algorithm" data-toggle="popover" href="/topics/SCFAlgorithms">topic_SCFAlgorithms</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [7/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, static, spin-polarized.  Write t17o_DEN (prtden=1)." data-toggle="popover" href="/tests/fast/Input/t17.abi" target="_blank">t17.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Re-run 17 but in slightly larger box, same ecut, larger ng.
(Box is still too small for proper model of Si2.)" data-toggle="popover" href="/tests/fast/Input/t19.abi" target="_blank">t19.abi</a></li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
O2 molecule, treated like a metal (there is a degeneracy at the Fermi level),
occopt=4 and tsmear=0.04 , with nsppol=2 .
Use spinat to polarize the molecule at start.
Gives total energy of -32.09317 Hartree
This test can be used to check the accuracy of stresses in the
spin-polarized case. Setting acell(1:2) to 7.005 and 6.995
gives ETOT -32.090846193972 and -32.095501753750,
ucvol  441.63023 and 440.37023
so that the estimation of stress by d(Etot)/d(Vol) gives 3.6948887E-03,
to be compared with sigma(1)=3.6949713786E-03
and sigma(2)=3.6949681083E-03 from the present test
(the degeneracy is slightly lifted because of incomplete convergence,
using tolvrs 1.0d-12 instead of toldfe gives at least 8 identical digits for both
sigma values)." data-toggle="popover" href="/tests/v1/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated carbon atom, with PseudosTM_pwteter/6c.pspnc pseudopotential
Test a non-spherical, spin-polarized atom, with nsym=2.
In order to have a fast computation, the cut-off, 19Ha,
is not large enough for good convergence, as well as the box size 9x9x9.
With better convergence parameters, it can be used to find
the atomization energy of carbon-containing molecules." data-toggle="popover" href="/tests/v1/Input/t33.abi" target="_blank">t33.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
SiH4 : optimize the geometry with partially constrained atomic positions.
1 special k-point, in a box 8x8x8 (too small), and 8Ha cut-off.
Test ionmov=2
Permutes the three axes x,y,z in three datasets.
Since the initialization is different, the three datasets deliver slightly different
results, though quite close to each others. Should be identical at convergence." data-toggle="popover" href="/tests/v1/Input/t85.abi" target="_blank">t85.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
SiH4 : molecular dynamics with partially constrained atomic positions.
1 special k-point, in a box 8x8x8 (too small), and 8Ha cut-off.
Test ionmov=1" data-toggle="popover" href="/tests/v1/Input/t86.abi" target="_blank">t86.abi</a></li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
O2 (nsppol=2, non-linear XC core correction, GGA)
Similar to test50, except use iscf=6 ." data-toggle="popover" href="/tests/v2/Input/t51.abi" target="_blank">t51.abi</a></li>
</ul>
</details>
<p>In the presently used algorithms, there is a compromise between speed and
robustness, that can be tuned by using  <strong>isecur</strong> .
If  <strong>isecur</strong>  =0, an extrapolation of out-of-line data is allowed, and might
save one non-SCF calculation every two line minimisation when some stability
conditions are fulfilled (since there are 2 non-SCF calculations per line
minimisation, 1 out of 4 is saved)
Using  <strong>isecur</strong>  = 1 or higher integers will raise gradually the threshold to make extrapolation.
Using  <strong>isecur</strong>  = -2 will allow to save 2 non-SCF calculations every three line
minimisation, but this can make the algorithm unstable. Lower values of
 <strong>isecur</strong>  allows one for more (tentative) savings. In any case, there must be one
non-SCF computation per line minimisation.
No meaning for RF calculations yet.</p>
<h2 id="istatr"><strong>istatr</strong><a class="headerlink" href="#istatr" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer for STATus file rate<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a>, <a class="wikilink" href="/guide/abinit#parameters">NO_MULTI</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to print some useful quantities" data-toggle="popover" href="/topics/printing">topic_printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Comment:</em> Values lower than 10 may not work on some machines.<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Moderately used, [14/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm." data-toggle="popover" href="/tests/built-in/Input/testin_fast.abi" target="_blank">testin_fast.abi</a></li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="H2 molecule, determination of the H-H distance by the Broyden algorithm.
Very quick built-in test, to check that ABINIT is working." data-toggle="popover" href="/tests/fast/Input/t00.abi" target="_blank">t00.abi</a></li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al; non-selfconsistent computation of wavefunctions" data-toggle="popover" href="/tests/paral/Input/t52.abi" target="_blank">t52.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al metallic; 10 phonon at 1/4 1/8 1/8" data-toggle="popover" href="/tests/paral/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al; non-selfconsistent computation of wavefunctions" data-toggle="popover" href="/tests/paral/Input/t52.abi" target="_blank">t52.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al metallic; 10 phonon at 1/4 1/8 1/8" data-toggle="popover" href="/tests/paral/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al; non-selfconsistent computation of wavefunctions" data-toggle="popover" href="/tests/paral/Input/t52.abi" target="_blank">t52.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al metallic; 10 phonon at 1/4 1/8 1/8" data-toggle="popover" href="/tests/paral/Input/t53.abi" target="_blank">t53.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al; non-selfconsistent computation of wavefunctions" data-toggle="popover" href="/tests/paral/Input/t52.abi" target="_blank">t52.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="FCC Al metallic; 10 phonon at 1/4 1/8 1/8" data-toggle="popover" href="/tests/paral/Input/t53.abi" target="_blank">t53.abi</a></li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk Aluminium, FCC, with 2 special points, occopt=6 and tsmear=0.05.
Designed to test the treatment of metals,
with the Gaussian-Hermite smearing of Methfessel and Paxton.
Also test the use of fband instead of nband." data-toggle="popover" href="/tests/v1/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Al2 molecule, inversion point shifted from the origin, ixc=0,
kpt=1/4 1/4 1/4, nsym=4.
Large number of bands (20 instead of 3).
8 first SCF steps with simple mixing algorithm, mixing factor 1/5.
Slow convergence.
Computation of the hermitian dielectric matrix at the 8th step.
The inverse of the dielectric matrix is then used as preconditioning.
A factor of 20 is gained on each step. Largest eigenvalue value of the
dielectric matrix is 5.712 (a mixing factor of 1/3 would have
been enough, but 1/5 is faster). A second eigenvalue is close : 5.531 ." data-toggle="popover" href="/tests/v1/Input/t51.abi" target="_blank">t51.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test multi-dataset mode. Si diamond.
2 datasets, with index 2 and 57 (!). No advanced features like get variables.
Rather fast." data-toggle="popover" href="/tests/v1/Input/t59.abi" target="_blank">t59.abi</a></li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
8 Silicon atoms + 1 interstitial Mg atom.
Try to get the inner bands (close to the Fermi energy),
not the lower ones, thanks to wfoptalg=2.
It works, but it does not seem very efficient.
Still subject of study." data-toggle="popover" href="/tests/v3/Input/t45.abi" target="_blank">t45.abi</a></li>
</ul>
</details>
<p>Govern the rate of output of the status file. This status file is written when
the number of the call to the status subroutine is equal to <a class="wikilink codevar-wikilink" href="/variables/dev#istatshft">istatshft</a>
modulo  <strong>istatr</strong> , so that it is written once every  <strong>istatr</strong>  call.
When  <strong>istatr</strong>  = 0, there is no writing of a status file (which is the default).</p>
<h2 id="istatshft"><strong>istatshft</strong><a class="headerlink" href="#istatshft" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer for STATus file SHiFT<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a>, <a class="wikilink" href="/guide/abinit#parameters">NO_MULTI</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to print some useful quantities" data-toggle="popover" href="/topics/printing">topic_printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [1/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
8 Silicon atoms + 1 interstitial Mg atom.
Try to get the inner bands (close to the Fermi energy),
not the lower ones, thanks to wfoptalg=2.
It works, but it does not seem very efficient.
Still subject of study." data-toggle="popover" href="/tests/v3/Input/t45.abi" target="_blank">t45.abi</a></li>
</ul>
</details>
<p>Govern the rate of output of the status file. This status file is written when
the number of the call to the status subroutine is equal to &rsquo; <strong>istatshft</strong> &rsquo;
modulo &rsquo; <strong>istatr</strong> &lsquo;, so that it is written once every &rsquo; <strong>istatr</strong> &rsquo; call.
There is also a writing for each of the 5 first calls, and the 10<sup>th</sup> call.</p>
<h2 id="istwfk"><strong>istwfk</strong><a class="headerlink" href="#istwfk" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Integer for choice of STorage of WaveFunction at each k point<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the electronic wavevectors (k-points)" data-toggle="popover" href="/topics/k-points">topic_k-points</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to tune the speed and memory usage" data-toggle="popover" href="/topics/TuningSpeedMem">topic_TuningSpeedMem</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/basic#nkpt">nkpt</a>)<br />
<em>Default value:</em> <em>0<br />
*Comment:</em> For RF calculations, the Default is not used:  <strong>istwfk</strong> is forced to be 1 deep inside the code, for all k points. For spin-orbit calculations (<a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> = 2), <strong>istwfk</strong> is also forced to be 1, for all k points.<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Moderately used, [399/1314] in all abinit tests, [49/178] in abinit tutorials</summary>
<ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with steepest decent
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with DIIS
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. Forces are computed." data-toggle="popover" href="/tests/bigdft/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file." data-toggle="popover" href="/tests/built-in/Input/testin_etsf_io.abi" target="_blank">testin_etsf_io.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands." data-toggle="popover" href="/tests/built-in/Input/testin_wannier90.abi" target="_blank">testin_wannier90.abi</a> &hellip;</li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bulk water ice 1h, made-up with 8 water molecules.
Density is exported using the ETSF I/O file format.
Should be a nice system to look at with visualisation tools." data-toggle="popover" href="/tests/etsf_io/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple Li-F structure with KSS output. This is a two data set run,
the first dataset being a ground state calculation and the second put
nbandkss to non-null value to compute the Kohn-Sham structure. The KSS file
is generated by ETSF-IO. The density of the first dataset also use ETSF-IO
and dataset two is a good test for density restart." data-toggle="popover" href="/tests/etsf_io/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/gpu_kokkos/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gwr_suite:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr_suite/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr_suite/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr_suite/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t04.abi" target="_blank">t04.abi</a> &hellip;</li>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Oxygen atom
Test a few functionals for which HGH pseudopotentials are available (from M. Krack),
that are present also in the lib XC, but not in the native ABINIT set of functionals." data-toggle="popover" href="/tests/libxc/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond: hybrid functional calculation with the GW code
Perturbative approach to the HSE06, PBE0, and B3LYP band gaps
HSE06 and PBE0 tests temporarily disabled, waiting for the next version of the libxc)" data-toggle="popover" href="/tests/libxc/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond: hybrid functional calculation with the GW code
Self-consistent approach to the HSE06 band structure
based on a unitary transform of a subset of LDA wavefunctions" data-toggle="popover" href="/tests/libxc/Input/t42.abi" target="_blank">t42.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si, Bulk, 2 atoms , paral_kgb.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*np_spkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over FFT and kpoints:
npband*npfft*np_spkpt=1*2*2=4 processors.
In test tY.in we check other distributions for guarantee." data-toggle="popover" href="/tests/mpiio/Input/t24.abi" target="_blank">t24.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (chebfi2). Test atoms not ordered by types. PAW,istwfk=1." data-toggle="popover" href="/tests/paral/Input/t18.abi" target="_blank">t18.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). PAW,istwfk&gt;1,dilatmx&gt;1,npband=4" data-toggle="popover" href="/tests/paral/Input/t19.abi" target="_blank">t19.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). PAW,istwfk&gt;1,dilatmx&gt;1,npband=4" data-toggle="popover" href="/tests/paral/Input/t20.abi" target="_blank">t20.abi</a> &hellip;</li>
<li>rttddft_suite:  <a class="wikilink abifile-wikilink" data-tippy-content="
FCC Ni, nonmagnetic, GGA, PAW.
Tests RT-TDDFT using ER and EMR propagator in PAW." data-toggle="popover" href="/tests/rttddft_suite/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
FCC Al, GGA, NC.
Tests RT-TDDFT using ER and EMR propagator in NC." data-toggle="popover" href="/tests/rttddft_suite/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
FCC Al, GGA, NC.
Tests RT-TDDFT restart capabilities." data-toggle="popover" href="/tests/rttddft_suite/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using HGH psps.
Test the computation of the Berry phase.
Grid sampling is very rough, for speed.
8 dataset, testing all combinations of
location of wfs (memory or disk), spin polarisation,
use (or non-use) of time-reversal symmetry." data-toggle="popover" href="/tests/seq/Input/tsv3_03.abi" target="_blank">tsv3_03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Zinc-blende GaAs (2 atoms per unit cell),
using old, rather inaccurate psps.
Computation of the Berry phase.
Test the doubling of the step of the sampling." data-toggle="popover" href="/tests/seq/Input/tsv3_04.abi" target="_blank">tsv3_04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon : print the pwfn.data file,
for use in a subsequent run of the CASINO code." data-toggle="popover" href="/tests/seq/Input/tsv4_90.abi" target="_blank">tsv4_90.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute band structure" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_1.abi" target="_blank">tdmft_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Tutorial DFT+DMFT on SrVO3" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_2.abi" target="_blank">tdmft_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for PARAL_GSWVL tutorial
14 atom boron cluster, parallel calculation" data-toggle="popover" href="/tests/tutoparal/Input/tgswvl_1.abi" target="_blank">tgswvl_1.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_1.abi" target="_blank">tw90_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW calculation)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_2.abi" target="_blank">tw90_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-toggle="popover" href="/tests/tutoplugs/Input/tw90_3.abi" target="_blank">tw90_3.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_1.abi" target="_blank">teph_tdep_legacy_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond. Quick determination of the k-point grid in the IBZ." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_2.abi" target="_blank">teph_tdep_legacy_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Temperature dependence calculation of diamond." data-toggle="popover" href="/tests/tutorespfn/Input/teph_tdep_legacy_3.abi" target="_blank">teph_tdep_legacy_3.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Preparatory run for BS calculations

There are four datasets specified in this input:
1) Ground-state calculation to get the density.
2) NSCF run to generate the WFK file on a symmetric k-mesh (4x4x4, gamma-centered)
3) NSCF run to generate another WFK file on a shifted 4x4x4 k-mesh that breaks the symmetry of the BZ sampling
4) SCR calculation with the WFK file generated in the second dataset" data-toggle="popover" href="/tests/tutorial/Input/tbs_1.abi" target="_blank">tbs_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
BS run: Tamm-Dancoff approximation solved with the Haydock algorithm." data-toggle="popover" href="/tests/tutorial/Input/tbs_2.abi" target="_blank">tbs_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Convergence of the number of bands in the transition space." data-toggle="popover" href="/tests/tutorial/Input/tbs_3.abi" target="_blank">tbs_3.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, spin-polarized
Same as test 45, but use densfor_pred=3 instead of densfor_pred=1, and iscf=7 instead of iscf=2.
Si2 molecule, spin-polarized. Same as test 45, but use densfor_pred=3 instead of densfor_pred=1.
Cannot be executed in parallel:
--- !ERROR
message: |
the number of bands in the spin up case must be equal to
the number of bands in the spin down case.
This is not the case for the k point number : 1
The number of bands spin up and down are : 5 3 Action : change nband, or use the sequential
version of ABINIT.
src_file: chkinp.F90
src_line: 1181
..." data-toggle="popover" href="/tests/v1/Input/t50.abi" target="_blank">t50.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H atom (spin-unpolarized in a medium size cubic box, k=0 0 0 similar to test 1 of fast)
Using multi-dataset mode, examine the following combinations of
fftalg and istwfk : (112,2),(112,1),(111,1),(111,2),(110,2),(110,1),
(100,1), then compute the energy with nstep=0 for (112,2) and (112,1).
Then again SCF test for (400,1), (401,1), (402,1).
For the second dataset, reads the wavefunctions of the first dataset." data-toggle="popover" href="/tests/v1/Input/t87.abi" target="_blank">t87.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H atom, similar to test 87, except that the box is not cubic,
but only parallelipipedic (not even a rectangle parallelipiped).
However, the primitive vectors describe the same lattice as
in case 87, so that the results must be identical
to those of test 87, even if a different FFT grid is used.
That is what is observed." data-toggle="popover" href="/tests/v1/Input/t88.abi" target="_blank">t88.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,NC)." data-toggle="popover" href="/tests/v10/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,PAW)." data-toggle="popover" href="/tests/v10/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,NC)." data-toggle="popover" href="/tests/v10/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule in a big box : compute VERY accurately
the derivatives of the energy, by both symmetric finite-differences and
direct computation of forces and 2DTE.
Also test the interplay between istwfk/=1 in the GS calculation
and istwfk==1 in the RF calculation (istwfk/=1 is not yet-991020-
allowed for RF, which is a shame)
1) Computation of the first-order derivative of the total energy
With delta(xred)=0.0002, one gets delta(etot)/delta(xred)=-3.145846551
With delta(xred)=0.0001, one gets delta(etot)/delta(xred)=-3.145836932
The combination of both results, in a higher-order finite difference
formula gives -3.145833726 . The direct computation of forces
at the target geometry gives -3.145833725869 . The agreement is perfect,
taking into account the &quot;limited&quot; number of digits (10) of the
finite-difference result.
2) Computation of the second-order derivative of the total energy
With delta(xred)=0.0002, one gets delta(dedt)/delta(xred)=188.73875
With delta(xred)=0.0001, one gets delta(dedt)/delta(xred)=188.73837
The combination of both results, in a higher-order finite difference
formula gives 188.73824613 . The direct computation of 2DTE
at the target geometry gives 188.73824613046 . The agreement at the
level of 11 digits is also perfect." data-toggle="popover" href="/tests/v2/Input/t33.abi" target="_blank">t33.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
MgO FCC crystal, with very low cut-off, and 32 k points.
Pseudopotentials WITHOUT a non-linear core correction.
Compute the dynamical matrices at q(0.25 0.5 0.498) and q(0.25 0.5 0.5).
The results should be very close to each other, but were not in pre v2.1
versions, because the symmetry was not treated correctly for the
highest-symmetry q vector q(0.25 0.5 0.5) (test case found by PTepesch)." data-toggle="popover" href="/tests/v2/Input/t37.abi" target="_blank">t37.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ta, single atom in a box (1k point). HGH pseudopotential
Ecut and acell are NOT realistic. One would need 20 Ha
and a 20x20x20 box, while here we have 5 Ha and a 12x12x12 box.
The small box size changes the degeneracy of levels.
The all-electron values derived from another code, for comparison, are
level  degeneracy       energy (Ha)  spin-orbit splitting
6s      2               -0.194573
5d3/2   4               -0.141779
5d5/2   6               -0.119933       0.0218
6p1/2   2               -0.050542
6p3/2   4               -0.031281       0.0193" data-toggle="popover" href="/tests/v2/Input/t84.abi" target="_blank">t84.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC Tantalum (1 atoms per unit cell),
using the HGH pseudopotential, within LDA.
Fixed cell dimensions: 2 slightly different
cell sizes.
Use only one k point. Test whether the stress
is correctly given, even with spin-orbit coupling.
Difference of total energies : 0.0000588977 Ha
Difference of unit cell volume : 0.05861 Bohr^3
Stress from finite difference : 1.0049 Ha/Bohr^3
Average stress : 1.0062 Ha/Bohr^3" data-toggle="popover" href="/tests/v3/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state KS wavefunctions (tolwfr 1.0d-16).
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3)
nband 10) for the GW calculation and stores it in _SCR.
In dataset 3-6, ABINIT computes the GW correction for bands 4 and 5 with different plasmon-pole models." data-toggle="popover" href="/tests/v3/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure (nkpt 2; ecut 6)
In dataset 1, ABINIT finds the ground state wavefunctions (tolwfr 1.0d-16)
the eigenvectors necessary for the GW calculation being stored in _WFK.
In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3, nband 10)
for the GW calculation and stores it in _SCR.
In dataset 3, ABINIT computes the GW correction for bands 4 and 5" data-toggle="popover" href="/tests/v3/Input/t31.abi" target="_blank">t31.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ca in orthorhombic structure. 1 k point, low ecut.
Perform a test of GS total energy computation, using an
experimental PAW pseudopotential (pspcod=7)." data-toggle="popover" href="/tests/v4/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O in orthorhombic structure. 1 k point, low ecut. Experimental PAW pseudopotential.
The aim of this test is to verify that different values
of input variable &#x27;ortalg&#x27; give the same results for
total energy. &#x27;ortalg&#x27; is use in the conjugate gradient
algorithm which solves, in the case of PAW calculations,
a generalized eigenproblem (H.|Psi&gt;=Lambda.S|Psi&gt;).
Three datasets are perfomed ; they must give the same
total energies values (when converged)." data-toggle="popover" href="/tests/v4/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test to prepare a conductivity calculation (test v5#t10)
Ground state calculation for 4 Al atoms
The number of bands is unrealistic. This test produces files that are inputs for test 10.
It tests the following parts of the code:
optic_paw, optic_paw_core
Note that, in addition to the psp file, the core wave functions file is needed." data-toggle="popover" href="/tests/v5/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
preliminary spin current output test: output x y z- spin current density in x,y,z directions" data-toggle="popover" href="/tests/v5/Input/t46.abi" target="_blank">t46.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bcc Hydrogen, r_s=2.6 a.u AF
Check the GW+spin calculation with and without symmetries" data-toggle="popover" href="/tests/v5/Input/t63.abi" target="_blank">t63.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Chain of Silicon diatomic molecules (1 Si2 molecule in the cell)
Uses different values of fftcache. Test similar to B3 of the cpu series (case with ecut=112 and ngfft=3*96).
The default fftcache=16 seems OK :
With fftcache=1, the tcpu/ncalls/ndata is 0.028 on testf (the reference machine, 20090912)
With fftcache=16 (the default), the tcpu/ncalls/ndata is 0.021
With fftcache=128, the tcpu/ncalls/ndata is 0.021" data-toggle="popover" href="/tests/v6/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT tests on ferromagnetic NiO (2 atoms), check DMFT for several
values of dmft_solv : computes occupations and energy." data-toggle="popover" href="/tests/v6/Input/t45.abi" target="_blank">t45.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT tests on Antiferromagnetic NiO (4 atoms), check DMFT loop with Hubbard I, DMFT
self-consistency and density self-consistency : computes occupations and energy." data-toggle="popover" href="/tests/v6/Input/t46.abi" target="_blank">t46.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
SiC in zinc-blende structure
Calculation of the GW corrections with 4 different plasmon-pole models.
The following variables are tested: inclvkb=2, nomegasrd and omegasrd." data-toggle="popover" href="/tests/v67mbpt/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GW calculation in Si: Hilbert transform method for the irreducible polarizability (gaussian approximant)
and analytic continuation of sigma from imaginary- to real-axis. The spectral function is also
obtained via Pade extrapolation. The following variables are tested spmeth=2, spbroad,
nomegasi, and omegasimax" data-toggle="popover" href="/tests/v67mbpt/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated H chain: GW calculation with cylindrical cutoff in the Coulomb interaction in order to
speed up the convergence wrt the size of the super cell. The following variables are tested
gw_icutcoul=1, rcut, vcutgeo, gw_nqlwl and gw_qlwl." data-toggle="popover" href="/tests/v67mbpt/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test natsph_extra, ratsph_extra, and xredsph_extra for STS calculation. Al (111) surface
slab with very low ecut and ngkpt in the plane." data-toggle="popover" href="/tests/v7/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Boron, 32 atoms - Thomas-Fermi method (without orbitals)
Test the temperature-dependent XC functional (ixc=50)
Ichimaru et al Phys. Rep. 149, 91-205 (1987)
Test the von Weizsacker gradient correction (tfkinfunc=11 or 12)" data-toggle="popover" href="/tests/v7/Input/t11.abi" target="_blank">t11.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Similar to v7[07]. Here we test optdriver 8 (WFK post-processing) with NC
and SO. More specifically, we reconstruct the wavefunctions in the full BZ in
dataset 2 and we use this WFK to restart the calculation in dataset 3 with
the full k-mesh (kptopt 3). The SCF cycle should exit at the first iteration
since the wavefunctions are already converged." data-toggle="popover" href="/tests/v7/Input/t12.abi" target="_blank">t12.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Geometry optimization with LBFGS" data-toggle="popover" href="/tests/v8/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="GS calculation with the CG + RMM-DIIS eigensolver and NC pseudos" data-toggle="popover" href="/tests/v9/Input/t29.abi" target="_blank">t29.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
GS calculation with the CG + RMM-DIIS eigensolver and PAW GGA-PBE pseudos." data-toggle="popover" href="/tests/v9/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
HF in GW code with the miniBZ integration of the coulomb singularity" data-toggle="popover" href="/tests/v9/Input/t31.abi" target="_blank">t31.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands. Very quick built-in test, to check that Wannier90 is installed." data-toggle="popover" href="/tests/wannier90/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use..." data-toggle="popover" href="/tests/wannier90/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="The same as in 01 but using PAW." data-toggle="popover" href="/tests/wannier90/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
</ul>
</details>
<p>Control the way the wavefunction for each k-point is stored inside ABINIT, in reciprocal space.
For the GS calculations, in the &ldquo;cg&rdquo; array containing the wavefunction
coefficients, there is for each k-point and each band, a segment
cg(1:2,1:npw). The &lsquo;full&rsquo; number of plane wave is determined by <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a>.</p>
<p>However, if the k-point coordinates are build only from zeroes and halves (see
list below), the use of time-reversal symmetry (that connects coefficients)
has been implemented, in order to use real-to-complex FFTs (see <a class="wikilink codevar-wikilink" href="/variables/dev#fftalg">fftalg</a>),
and to treat explicitly only half of the number of plane waves (this being used as &lsquo;npw&rsquo;).
For the RF calculations, there is not only the &ldquo;cg&rdquo; array, but also the &ldquo;cgq&rdquo;
and &ldquo;cg1&rdquo; arrays. For the time-reversal symmetry to decrease the number of
plane waves of these arrays, the q vector MUST be (0 0 0). Then, for each k
point, the same rule as for the RF can be applied.
WARNING (991018): for the time being, the time-reversal symmetry cannot be
used in the RF calculations.</p>
<ul>
<li>1 &rarr; do NOT take advantage of the time-reversal symmetry</li>
<li>2 &rarr; use time-reversal symmetry for k = (0, 0, 0,)</li>
<li>3 &rarr; use time-reversal symmetry for k = (&frac12;, 0, 0)</li>
<li>4 &rarr; use time-reversal symmetry for k = (0, 0, &frac12;)</li>
<li>5 &rarr; use time-reversal symmetry for k = (&frac12;, 0, &frac12;)</li>
<li>6 &rarr; use time-reversal symmetry for k = (0, &frac12;, 0)</li>
<li>7 &rarr; use time-reversal symmetry for k = (&frac12;, &frac12;, 0)</li>
<li>8 &rarr; use time-reversal symmetry for k = (0, &frac12;, &frac12;)</li>
<li>9 &rarr; use time-reversal symmetry for k = (&frac12;, &frac12;, &frac12;)</li>
<li>0 &rarr; (preprocessed) for each k point, choose automatically
          the appropriate time-reversal option when it is allowed, and chose <strong>istwfk</strong> = 1 for all the other k-points.</li>
</ul>
<h2 id="lotf_classic"><strong>lotf_classic</strong><a class="headerlink" href="#lotf_classic" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> LOTF CLASSIC model for glue model<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to use the Learn-of-the-flight feature" data-toggle="popover" href="/topics/LOTF">topic_LOTF</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 5<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [1/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Gold, 8 atom supercell, with PAW.
Test lotf_nitex, lotf_classic, lotf_version, lotf_nneigx.
These variables, concerning LOTF method, are taken into account only if the
enable_lotf=&quot;yes&quot; is used in configuration." data-toggle="popover" href="/tests/paral/Input/t41.abi" target="_blank">t41.abi</a></li>
</ul>
</details>
<p>Glue model used in LOTF. For the moment it is imposed to be 5.</p>
<h2 id="lotf_nitex"><strong>lotf_nitex</strong><a class="headerlink" href="#lotf_nitex" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> LOTF Number of ITerations<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to use the Learn-of-the-flight feature" data-toggle="popover" href="/topics/LOTF">topic_LOTF</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 10<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [1/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Gold, 8 atom supercell, with PAW.
Test lotf_nitex, lotf_classic, lotf_version, lotf_nneigx.
These variables, concerning LOTF method, are taken into account only if the
enable_lotf=&quot;yes&quot; is used in configuration." data-toggle="popover" href="/tests/paral/Input/t41.abi" target="_blank">t41.abi</a></li>
</ul>
</details>
<p>Set the number of Molecular Dynamics iterations which are computed by LOTF.</p>
<h2 id="lotf_nneigx"><strong>lotf_nneigx</strong><a class="headerlink" href="#lotf_nneigx" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> LOTF max Number of NEIGhbours<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to use the Learn-of-the-flight feature" data-toggle="popover" href="/topics/LOTF">topic_LOTF</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 5<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [1/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Gold, 8 atom supercell, with PAW.
Test lotf_nitex, lotf_classic, lotf_version, lotf_nneigx.
These variables, concerning LOTF method, are taken into account only if the
enable_lotf=&quot;yes&quot; is used in configuration." data-toggle="popover" href="/tests/paral/Input/t41.abi" target="_blank">t41.abi</a></li>
</ul>
</details>
<p>Set the max number of Neighbours used in the LOTF method.
For the moment it is imposed to be 40.</p>
<h2 id="lotf_version"><strong>lotf_version</strong><a class="headerlink" href="#lotf_version" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> LOTF VERSION of MD algorithm<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to use the Learn-of-the-flight feature" data-toggle="popover" href="/topics/LOTF">topic_LOTF</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 2<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [1/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Gold, 8 atom supercell, with PAW.
Test lotf_nitex, lotf_classic, lotf_version, lotf_nneigx.
These variables, concerning LOTF method, are taken into account only if the
enable_lotf=&quot;yes&quot; is used in configuration." data-toggle="popover" href="/tests/paral/Input/t41.abi" target="_blank">t41.abi</a></li>
</ul>
</details>
<p>Set the MD algorithm in the LOTF method. For the moment it is imposed to be 2.</p>
<h2 id="macro_uj"><strong>macro_uj</strong><a class="headerlink" href="#macro_uj" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> MACRO variable that activates the determination of the U and J parameter (for the PAW+U calculations)<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform a DFT+U calculation" data-toggle="popover" href="/topics/DFT+U">topic_DFT+U</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [4/1314] in all abinit tests, [1/178] in abinit tutorials</summary>
<ul>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
AFII NiO 4-atom cell | LRUJ utility | LMac 2022
Linear Response Hubbard U and Hund&#x27;s J (LRUJ)
post-processing utility for the determination of
said parameters in situ and ab initio" data-toggle="popover" href="/tests/tutorial/Input/tlruj_2.abi" target="_blank">tlruj_2.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Preliminary step for test 108:
bcc Fe ferromagnetic structure. Relatively low cut-offs and few k-points.
This test is done within GGA and magnetism in PAW formalism.
Wavefunction printed to be used in v9#106 and v9#107 tests.
Density is printed out to prepare v9#108 test." data-toggle="popover" href="/tests/v9/Input/t105.abi" target="_blank">t105.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compute U in bcc Fe in 2 atomic supercell with the ujdet
intrinsic subroutine (using a two-point linear regression)." data-toggle="popover" href="/tests/v9/Input/t106.abi" target="_blank">t106.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compute the Hund&#x27;s J in bcc Fe in 2 atom cell with ujdet
intrinsic subroutine (using a two-point linear regression); generate
input LRUJ.nc files for lruj post-processing utility" data-toggle="popover" href="/tests/v9/Input/t107.abi" target="_blank">t107.abi</a></li>
</ul>
</details>
<p>Sets proper input values for the determination of U and J i.e. for <a class="wikilink codevar-wikilink" href="/variables/dev#pawujat">pawujat</a>
(first atom treated with PAW+U), <a class="wikilink codevar-wikilink" href="/variables/files#irdwfk">irdwfk</a> (=1), <a class="wikilink codevar-wikilink" href="/variables/basic#tolvrs">tolvrs</a> (=10^(-8)),
<a class="wikilink codevar-wikilink" href="/variables/basic#nstep">nstep</a> (=255), <a class="wikilink codevar-wikilink" href="/variables/gstate#diemix">diemix</a> (=0.45), <a class="wikilink codevar-wikilink" href="/variables/ffield#atvshift">atvshift</a> (<a class="wikilink codevar-wikilink" href="/variables/dev#pawujat">pawujat</a>) <a class="wikilink codevar-wikilink" href="/variables/dev#pawujv">pawujv</a>).
Do not overwrite these variables manually unless you know what you are doing.</p>
<ul>
<li><strong>macro_uj</strong>  = 1 (and <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 2) Standard procedure to determine U on atom pawujat through a shift of the potential on both spin channels.</li>
<li><strong>macro_uj</strong>  = 1 (and <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 1) Non standard procedure to determine U from potential shift on atom pawujat (experimental).</li>
<li><strong>macro_uj</strong>  = 2 (and <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 2) Non standard procedure to determine U from potential shift on atom pawujat through a shift on spin channel 1 on this atom and the response on this channel (experimental).</li>
<li><strong>macro_uj</strong>  = 3 (and <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 2) Standard procedure to determine J from potential shift on spin channel 1 on atom pawujat and response on spin channel 2 (experimental).</li>
</ul>
<p>Determination of U and J can be done only if the symmetry of the atomic
arrangement is reduced and the atom pawujat is not connected to any other atom
by symmetry relations (either input reduced symmetries manually, define
concerned atom as a separate atomic species or shift concerned atom from ideal
position).</p>
<h2 id="maxnsym"><strong>maxnsym</strong><a class="headerlink" href="#maxnsym" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> MAXimum Number of SYMetries<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify a crystal, with atomic positions and symmetries" data-toggle="popover" href="/topics/crystal">topic_crystal</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 384<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [2/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW: test of some variables reserved to experienced users or developers
BCC iron, ferromagnetic, GGA, PAW. Also tests maxnsym keyword." data-toggle="popover" href="/tests/v5/Input/t06.abi" target="_blank">t06.abi</a></li>
</ul>
</details>
<p>Gives the maximum number of spatial symmetries allowed in the memory.
The default value is sufficient for most applications. It might have to be
increased in the case of the use of a supercell (unit cell identically
repeated).</p>
<h2 id="mem_test"><strong>mem_test</strong><a class="headerlink" href="#mem_test" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> MEMory TEST<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to control the flow of ABINIT" data-toggle="popover" href="/topics/Control">topic_Control</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [1/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test MPI-FFT with 2 processors, istwfk=2 and bandpp 2" data-toggle="popover" href="/tests/paral/Input/t29.abi" target="_blank">t29.abi</a></li>
</ul>
</details>
<p>This variable controls the memory test done in the <code>memana</code> routine. Possible values:</p>
<ul>
<li>0 no test on the available memory is performed</li>
<li>1 the routine tries to allocate the estimated memory, for testing purposes, and if a failure occurs, the routine stops.</li>
<li>2 like 1, but before stopping, the routine will provide an estimation of the available memory.</li>
</ul>
<h2 id="mixprec"><strong>mixprec</strong><a class="headerlink" href="#mixprec" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> MIXed PRECision<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to tune the speed and memory usage" data-toggle="popover" href="/topics/TuningSpeedMem">topic_TuningSpeedMem</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Moderately used, [21/1314] in all abinit tests, [10/178] in abinit tutorials</summary>
<ul>
<li>gwr_suite:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code." data-toggle="popover" href="/tests/gwr_suite/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nsppol 2. Should produce similar results" data-toggle="popover" href="/tests/gwr_suite/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Calculation of the GW corrections with GWR code.
Similar to t01.abi but with nspinor 2 and SOC." data-toggle="popover" href="/tests/gwr_suite/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz.
Ground state with LOBPCG + RMM-DIIS eigensolver and paral_kgb parallelism with 4 MPI procs." data-toggle="popover" href="/tests/paral/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GWR calculations for crystalline alpha-quartz.Test g/tau parallelism." data-toggle="popover" href="/tests/paral/Input/t78.abi" target="_blank">t78.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="
E-ph for mobility in semiconductors" data-toggle="popover" href="/tests/tutorespfn/Input/teph4mob_5.abi" target="_blank">teph4mob_5.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
E-ph for mobility in semiconductors" data-toggle="popover" href="/tests/tutorespfn/Input/teph4mob_6.abi" target="_blank">teph4mob_6.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
E-ph for mobility in semiconductors" data-toggle="popover" href="/tests/tutorespfn/Input/teph4mob_7.abi" target="_blank">teph4mob_7.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements and Cumulant + DM mobilities in Silicon." data-toggle="popover" href="/tests/v10/Input/t107.abi" target="_blank">t107.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements in Diamond." data-toggle="popover" href="/tests/v8/Input/t44.abi" target="_blank">t44.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements." data-toggle="popover" href="/tests/v9/Input/t57.abi" target="_blank">t57.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the Fan-Migdal self-energy matrix elements in LiF." data-toggle="popover" href="/tests/v9/Input/t60.abi" target="_blank">t60.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the imaginary part of the Fan-Migdal self-energy matrix elements." data-toggle="popover" href="/tests/v9/Input/t61.abi" target="_blank">t61.abi</a> &hellip;</li>
</ul>
</details>
<p>This variable activates FFT transforms in single precision.
The code thus works in mixed-precision mode in the sense that all the high-level
operations are done in double-precision while the FFT of wavefunctions, densities and potentials
are done with workspace arrays in single precision.</p>
<p>This option <strong>requires</strong> the linkage with external FFT libraries (FFTW3 or MKL-DFTI, see also <a class="wikilink codevar-wikilink" href="/variables/dev#fftalg">fftalg</a>)
Tests showed a speedup of ~25% in calculations in which FFTs (in particular fourwf%pot) represent the dominant part.
Typical examples are EPH calculation with <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> = 7.</p>
<p>At present (December 12, 2025 ), only selected kernels support mixed-precision, in particular MPI-FFTs
in mixed precision <strong>are not yet supported</strong>.</p>
<h2 id="mqgrid"><strong>mqgrid</strong><a class="headerlink" href="#mqgrid" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Maximum number of Q-space GRID points for pseudopotentials<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform numerically precise calculations with planewaves or projector- augmented waves and pseudopotentials" data-toggle="popover" href="/topics/Planewaves">topic_Planewaves</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 3001<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [8/1314] in all abinit tests, [1/178] in abinit tutorials</summary>
<ul>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-toggle="popover" href="/tests/tutoparal/Input/tucalc_crpa_2.abi" target="_blank">tucalc_crpa_2.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW: test of some variables reserved to experienced users
Silicon with few k-points and low cut-off" data-toggle="popover" href="/tests/v4/Input/t17.abi" target="_blank">t17.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the strain perturbation.
LaAs in a randomly distorted version of its normal rocksalt structure
using a non-standard norm conserving potential produced by DRH
for this test.  Distorted structures were used for most development
work so that no components of the strain 2nd derivatives would be
zero by symmetry.  A La compound was chosen because its f nonlocal
potential makes a significant contribution to the result (10%
for a well-converged result although only 1% for the low value
of ecut used here), so it tests that the very complex routines
for the strain derivatives of the nonlocal energy are behaving
properly.  (Choices in constructing this La potential were
restricted by current limitations of the treatment of fhi-
format potentials, and it should not be used for physics results.)" data-toggle="popover" href="/tests/v4/Input/t62.abi" target="_blank">t62.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute density, WFC and KSS files." data-toggle="popover" href="/tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-toggle="popover" href="/tests/v7/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-toggle="popover" href="/tests/v7/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute cRPA screened interaction U in the d-dp(b) model" data-toggle="popover" href="/tests/v7/Input/t78.abi" target="_blank">t78.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute cRPA screened interaction U by excluding an energy window to compute epsilon" data-toggle="popover" href="/tests/v7/Input/t79.abi" target="_blank">t79.abi</a></li>
</ul>
</details>
<p>Govern the size of the one-dimensional information related to
pseudopotentials, in reciprocal space: potentials, or projector functions.</p>
<h2 id="nbdblock"><strong>nbdblock</strong><a class="headerlink" href="#nbdblock" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of BanDs in a BLOCK<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to tune the speed and memory usage" data-toggle="popover" href="/topics/TuningSpeedMem">topic_TuningSpeedMem</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [2/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of Ca, simple cubic , 2  k-point. Testing GS  energy and lobpcg algorithm." data-toggle="popover" href="/tests/v4/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of Ca, simple cubic , 2  k-point.
Testing GS  PAW  energy and lobpcg algorithm." data-toggle="popover" href="/tests/v4/Input/t94.abi" target="_blank">t94.abi</a></li>
</ul>
</details>
<p>In case of non-standard, blocked algorithms for the optimization of the
wavefunctions (that is, if <a class="wikilink codevar-wikilink" href="/variables/dev#wfoptalg">wfoptalg</a> = 4):</p>
<ul>
<li>if <a class="wikilink codevar-wikilink" href="/variables/dev#wfoptalg">wfoptalg</a> = 4,  <strong>nbdblock</strong>  defines the number of blocks (the number of bands in the block is then <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>/ <strong>nbdblock</strong>  ).</li>
</ul>
<h2 id="nc_xccc_gspace"><strong>nc_xccc_gspace</strong><a class="headerlink" href="#nc_xccc_gspace" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Norm-Conserving pseudopotentials - use XC Core-Correction in G-SPACE<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform numerically precise calculations with planewaves or projector- augmented waves and pseudopotentials" data-toggle="popover" href="/topics/Planewaves">topic_Planewaves</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0 if <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 0,
1 if <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1,
0 otherwise.</p>
<p><em>Comment:</em> 0 when <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> = 0, 1 when <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> = 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [3/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Nickel ferromagnetic fcc structure with an ONCVPSP pseudo containing valence density.
We test several improvements that are available when the NC file contains the PS valence charge.
More specifically, we test the initialization of the density from atomic quantities (initro.F90),
the correction to the forces due to the residuals and the extrapolation of the density
for structural relaxations (well, xred is fixed by symmetry).
We also test the treatment of the core charge in G-space in the case of GS calculations
By default, abinit handles XCCC in real space, here we use nc_xccc_gspace==1 to treat it
in G-space using the same approach as the one used in PAW." data-toggle="popover" href="/tests/v7/Input/t10.abi" target="_blank">t10.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
This tests uses psps8 files with model core charges and valence charge densities.
We test the initialization of rhor1, rhog1 from atomic quantities and the
treatment of the non-linear core correction in G-space (nc_xccc_gspace)." data-toggle="popover" href="/tests/v7/Input/t45.abi" target="_blank">t45.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Copper atom isolated in a box, mGGA Norm conserving
Tests the reading of the upf2 potential, and inputs related to the model core kinetic energy density, then their usage.
nc_xccc_gspace 0 calculates model core contribution in real space, and is much cleaner (0 kinE and density outside NLCC radius)
Density (+kinE) mixing works much better than potential mixing: in the vacuum the mGGA potential is very sensitive" data-toggle="popover" href="/tests/v9/Input/t95.abi" target="_blank">t95.abi</a></li>
</ul>
</details>
<p>Historically, Abinit treats the model core charge used for the non-linear core
correction in real space. Alternatively, it is possible to instruct the code
to compute the core charge in G-space following the same approach used in the
PAW code. The G-space formalism is more accurate than the interpolation in
real space, especially when derivatives of the model core charge are needed,
e.g. DFPT. Preliminary tests showed that the violation of the acoustic sum
rule is reduced when  <strong>nc_xccc_gspace</strong>  == 1, especially for LDA. It is worth
stressing, however, that  <strong>nc_xccc_gspace</strong>  == 1 should be used only in
conjunction with NC pseudos with a model core charge that decays quickly in
G-space. Several NC pseudos available in the Abinit table are not optimized
for the G-space formalism and users are strongly invited to perform
convergence studies with respect to <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> before activating this option in production runs.</p>
<h2 id="nctime"><strong>nctime</strong><a class="headerlink" href="#nctime" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> NetCdf TIME between output of molecular dynamics informations<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform a molecular dynamics calculation" data-toggle="popover" href="/topics/MolecularDynamics">topic_MolecularDynamics</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [4/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si2 molecule, static, spin-polarized.
Same system as test 49 of v2, except that nctime is non-zero.
Test ionmov=6 (Verlet) as well as ionmov=7." data-toggle="popover" href="/tests/etsf_io/Input/t21.abi" target="_blank">t21.abi</a></li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Gold, 8 atom supercell, with PAW.
Test lotf_nitex, lotf_classic, lotf_version, lotf_nneigx.
These variables, concerning LOTF method, are taken into account only if the
enable_lotf=&quot;yes&quot; is used in configuration." data-toggle="popover" href="/tests/paral/Input/t41.abi" target="_blank">t41.abi</a></li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Short MD traj to test restarxf -1" data-toggle="popover" href="/tests/v10/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Short MD traj restarting from HIST file using restarxf -1" data-toggle="popover" href="/tests/v10/Input/t82.abi" target="_blank">t82.abi</a></li>
</ul>
</details>
<p>When  <strong>nctime</strong>  is non-zero, the molecular dynamics information is output in
NetCDF format, every  <strong>nctime</strong>  time step. Here is the content of an example file:</p>
<div class="highlight"><pre><span></span><code>    netcdf md32.outH_moldyn1 {
    dimensions:
       time = UNLIMITED; // (11 currently)
       DimTensor = 6;
       DimCoord = 3;
       NbAtoms = 32;
       DimVector = 3;
       DimScalar = 1;
    variables:
       double E_pot(time);
          E_pot:units = &quot;hartree&quot;;
       double E_kin(time);
          E_kin:units = &quot;hartree&quot;;
       double Stress(time, DimTensor);
          Stress:units = &quot;hartree/Bohr^3&quot;;
       double Position(time, DimCoord, NbAtoms);
          Position:units = &quot;Bohr&quot;;
       double Celerity(time, DimCoord, NbAtoms);
          Celerity:units = &quot;Bohr/(atomic time unit)&quot;;
       double PrimitiveVector1(DimVector);
       double PrimitiveVector2(DimVector);
       double PrimitiveVector3(DimVector);
       double Cell_Volume(DimScalar);
          Cell_Volume:units = &quot;Bohr^3&quot;;
    }
</code></pre></div>
<h2 id="nloc_alg"><strong>nloc_alg</strong><a class="headerlink" href="#nloc_alg" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Non LOCal ALGorithm<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to tune the speed and memory usage" data-toggle="popover" href="/topics/TuningSpeedMem">topic_TuningSpeedMem</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 4<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [9/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
MgO FCC crystal, with very low cut-off, and 32 k points.
Pseudopotentials WITHOUT a non-linear core correction.
Compute the dynamical matrices at q(0.25 0.5 0.498) and q(0.25 0.5 0.5).
The results should be very close to each other, but were not in pre v2.1
versions, because the symmetry was not treated correctly for the
highest-symmetry q vector q(0.25 0.5 0.5) (test case found by PTepesch)." data-toggle="popover" href="/tests/v2/Input/t37.abi" target="_blank">t37.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
MgO FCC crystal, with very low cut-off, and 32 k points.
Pseudopotentials WITH a non-linear core correction.
Compute the dynamical matrix at q(0.5 0.5 0.5) .
Also test the non-type-ordering of atoms." data-toggle="popover" href="/tests/v2/Input/t38.abi" target="_blank">t38.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the pspcod=8 input format (contributed by D.R. Hamann)
This format is primarily intended to offer a flexible platform
for those who wish to experiment with their own features in
norm-conserving pseudopotentials.  A full description and discussion
is given on the ABINIT wiki
https://wiki.abinit.org/doku.php?id=developers:pseudos:psp8_format
This test case, CaO, is an
example of self-interaction-corrected pseudopotentials in the
style of D. Vogel, P. Krueger, and J. Pollmann, Phys. Rev. B 52,
14 316 (1995).  The bandgap (direct) in the test example, 11.2eV,
is in excellent agreement with experiment, but is rather strongly
dependent on the radius at which the self-interaction-correction
of Ca is (smoothly) cut off.  The sic pseudopotentials used in
this test should not be considered anything but early-stage
experiments and should not be used for any other purpose." data-toggle="popover" href="/tests/v4/Input/t20.abi" target="_blank">t20.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the strain perturbation.
Si in the usual diamond structrure using a Troullier-Martins
potential including a model core charge.  The datasets
include an initial ground state run, 2 pairs of 5 ground
state runs with incrementally strained lattice vectors rprim
(xx and yz strains -0.00004, -0.00002, 0, 0.00002, 0.00004),
and one response function run for the strain 2nd derivatives.
This set is illustrative of the kind of testing used extensively
in developing the strain perturbation portions of the code.
The numerical 2nd derivatives of the energy wrt strains were
computed by applying a 5-point derivative formula to ucvol*sigma(i,j),
where the sigmas are the stresses calculated in the series
of ground state calculations.  These agree with the analytic
2nd derivatives calculated in the response function run to ~1.E-7
for the data given here.  The cartesian internal strain (mixed
second derivative wrt strain and atomic coordinate) agrees to ~1E-8.
Note that such numerical tests of the internal strain are only valid
if the forces are zero (relaxed or by symmetry).  Otherwise, the
reduced-coordinate 2nd derivatives must be used for such tests
because the conversion to cartesian coordinates is itself strain-
dependent and will introduce changes in the computed derivatives.
In the actual development tests, stricter converence criteria were
used (tolvrs=1.E-24) as well as larger cutoffs, and agreement was
obtained at the 1.E-9 level.  The model core charge contributes the
largest component of the error.
ADDITIONAL NOTE :
It should be noted that numerical derivative tests of the internal
strain should be done by comparing the &quot;2nd-order matrix&quot; with numerical
strain derivatives of the gradients wrt reduced atomic coordinates.
These are not normally part of the GS output, but can be obtained by
uncommenting the DEBUG section at the end of prtxf.F90.
Comparisons between numerical strain derivatives of the cartesian
forces and the cartesian internal strain tensor will be incorrect
unless the coordinates have been relaxed and the forces are zero
within a tight tolerance." data-toggle="popover" href="/tests/v4/Input/t61.abi" target="_blank">t61.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the strain perturbation.
LaAs in a randomly distorted version of its normal rocksalt structure
using a non-standard norm conserving potential produced by DRH
for this test.  Distorted structures were used for most development
work so that no components of the strain 2nd derivatives would be
zero by symmetry.  A La compound was chosen because its f nonlocal
potential makes a significant contribution to the result (10%
for a well-converged result although only 1% for the low value
of ecut used here), so it tests that the very complex routines
for the strain derivatives of the nonlocal energy are behaving
properly.  (Choices in constructing this La potential were
restricted by current limitations of the treatment of fhi-
format potentials, and it should not be used for physics results.)" data-toggle="popover" href="/tests/v4/Input/t62.abi" target="_blank">t62.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Quick test on AlAs (PAW) to check that different nloc_alg options give the correct energy.
Case istwfk=1." data-toggle="popover" href="/tests/v9/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Quick test on AlAs (PAW) to check that different nloc_alg options give the correct energy.
Case istwfk&gt;=2." data-toggle="popover" href="/tests/v9/Input/t72.abi" target="_blank">t72.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Quick test on AlAs (PAW) to check that different cprj_update_lvl options give the correct energy.
Compute forces and stress at the end of the run." data-toggle="popover" href="/tests/v9/Input/t73.abi" target="_blank">t73.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Quick test on AlAs (PAW) to check that different cprj_update_lvl options give the correct energy.
Compute forces at every iteration, compute stress at the end of the run." data-toggle="popover" href="/tests/v9/Input/t74.abi" target="_blank">t74.abi</a></li>
</ul>
</details>
<p>Allows to choose the algorithm for non-local operator application.
The default value is  <strong>nloc_alg</strong>  = 4, and the meaning of this variable depends on <a class="wikilink codevar-wikilink" href="/variables/dev#useylm">useylm</a>.</p>
<p>For <a class="wikilink codevar-wikilink" href="/variables/dev#useylm">useylm</a> = 0:</p>
<p>On super-scalar architectures,  <strong>nloc_alg</strong>  = 4 is the best.
  More detailed explanations:</p>
<ul>
<li><strong>nloc_alg</strong>  = 2: Should be efficient on vector machines. It is indeed the
    fastest algorithm for the NEC, but actual tests on Fujitsu machine did not
    gave better performances than the other options.</li>
<li><strong>nloc_alg</strong>  = 3: same as  <strong>nloc_alg</strong>  == 2, but the loop order is inverted.</li>
<li><strong>nloc_alg</strong>  = 4: same as  <strong>nloc_alg</strong>  == 3, but maximal use of registers has
     been coded. This should be especially efficient on scalar and super-scalar
     machines. This has been confirmed by tests.</li>
</ul>
<p>For <a class="wikilink codevar-wikilink" href="/variables/dev#useylm">useylm</a> = 1:</p>
<p>With spherical harmonics, the computation of the scalar product between a wave function <span class="arithmatex">\(\psi\)</span> and the projector <span class="arithmatex">\(p_{a,nlm}\)</span> writes:</p>
<div class="arithmatex">\[ &lt;p_{a,nlm}|\psi&gt; = \frac{4\pi}\Omega \sum_{G} e^{iG.R_a} i^l ffnl_a(G,nlm) c(G) \]</div>
<p>where <span class="arithmatex">\(\Omega\)</span> is the unit cell volume, <span class="arithmatex">\(G\)</span> a vector of the reciprocal lattice, <span class="arithmatex">\(R_a\)</span> the atomic position, <span class="arithmatex">\(nlm\)</span> are atomic quantum numbers, <span class="arithmatex">\(ffnl_a(G,nlm)\)</span> real scalars and <span class="arithmatex">\(c(G)\)</span> the coefficients of the wave-function <span class="arithmatex">\(\psi\)</span>.
This is computed in &ldquo;opernla_ylm&rdquo; routine, for every <span class="arithmatex">\(nlm\)</span> indices.
The non-local term of the Hamiltonian has a similar structure:</p>
<div class="arithmatex">\[ &lt;G|H_{non-local}|\psi&gt; = \frac{4\pi}\Omega \sum_a \sum_{nlm} e^{-iG.R_a} (-i)^l ffnl_a(G,nlm) fac_a(nlm) \]</div>
<p>where <span class="arithmatex">\(fac_a(nlm)\)</span> are complex scalars.
This is computed in &ldquo;opernlb_ylm&rdquo; routine, for every <span class="arithmatex">\(G\)</span> vectors.</p>
<p>In both &ldquo;opernla_ylm&rdquo; and &ldquo;opernlb_ylm&rdquo; routines, these operations are implemented straightforwardly, taking advantage of the real or pure imaginary nature of some terms.
These implementations are used if  <strong>nloc_alg</strong>  = 4 (the default), or if derivatives are needed.
However, for both operations, a part of the computation can be done as a matrix-vector multiplication:</p>
<div class="arithmatex">\[ \sum_{G} ffnl_a(G,nlm) c(G) e^{iG.R_a} = \left(ffnl_a\right)_{nlm,G} \left( vect \right)_G \]</div>
<p>and:</p>
<div class="arithmatex">\[ \sum_{nlm} ffnl_a(G,nlm) fac_a(nlm) = \left(ffnl_a\right)_{G,nlm} \left( fac_a \right)_{nlm} \]</div>
<p>We note that in both cases the matrix is real, whereas the vector is complex.
An alternative implementation is proposed in &ldquo;opernla_ylm_mv&rdquo; and &ldquo;opernlb_ylm_mv&rdquo; routines, but only for ground-state quantities.
Forces and stress terms are always computed with &ldquo;opernla_ylm&rdquo; and &ldquo;opernlb_ylm&rdquo;.
The matrix-vector multiplication is implemented either using two calls of BLAS &ldquo;dgemv&rdquo; routine (one call for the real part and one for the imaginary part) with  <strong>nloc_alg</strong>  = 2, or straightforwardly with  <strong>nloc_alg</strong>  = 3.</p>
<p>Tests showed that the most efficient implementation is machine and system dependent, so it is very hard to determine which implementation to use a priori.
Furthermore, in some cases one implementation is the most efficient for &ldquo;opernla&rdquo; operation, but not for &ldquo;opernlb&rdquo;.
So a mix of different implementations can be used with other values of  <strong>nloc_alg</strong> , as shown in the following table:</p>
<table>
<thead>
<tr>
<th>nloc_alg</th>
<th>opernla</th>
<th>opernlb</th>
</tr>
</thead>
<tbody>
<tr>
<td>2</td>
<td>mv-dgemv</td>
<td>mv-dgemv</td>
</tr>
<tr>
<td>3</td>
<td>mv</td>
<td>mv</td>
</tr>
<tr>
<td>4 (default)</td>
<td>native</td>
<td>native</td>
</tr>
<tr>
<td>5</td>
<td>mv-dgemv</td>
<td>mv</td>
</tr>
<tr>
<td>6</td>
<td>mv</td>
<td>mv-dgemv</td>
</tr>
<tr>
<td>7</td>
<td>mv-dgemv</td>
<td>native</td>
</tr>
<tr>
<td>8</td>
<td>native</td>
<td>mv</td>
</tr>
<tr>
<td>9</td>
<td>mv</td>
<td>native</td>
</tr>
<tr>
<td>10</td>
<td>native</td>
<td>mv-dgemv</td>
</tr>
</tbody>
</table>
<p>where &ldquo;native&rdquo; stands for &ldquo;opernlX_ylm&rdquo; routines, &ldquo;mv&rdquo; for &ldquo;opernlX_ylm_mv&rdquo; routines with straightforward implementation, and &ldquo;mv-dgemv&rdquo; for &ldquo;opernlX_ylm_mv&rdquo; routines with BLAS calls.</p>
<p>The number of &ldquo;opernla&rdquo; and &ldquo;opernlb&rdquo; operations done in dataset can be written in the output using <a class="wikilink codevar-wikilink" href="/variables/dev#nonlop_ylm_count">nonlop_ylm_count</a>.</p>
<p>Note: internally,  <strong>nloc_alg</strong>  is stored in <code>dtset%nloalg(1)</code>. See also
<a class="wikilink codevar-wikilink" href="/variables/dev#nloc_mem">nloc_mem</a> for the tuning of the memory used in the non-local operator application.</p>
<h2 id="nloc_mem"><strong>nloc_mem</strong><a class="headerlink" href="#nloc_mem" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Non LOCal MEMOry<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to tune the speed and memory usage" data-toggle="popover" href="/topics/TuningSpeedMem">topic_TuningSpeedMem</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 2 if <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1,
1 otherwise.</p>
<p><em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [2/1314] in all abinit tests, [1/178] in abinit tutorials</summary>
<ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
Gold, 8 atom supercell, with PAW.
Test lotf_nitex, lotf_classic, lotf_version, lotf_nneigx.
These variables, concerning LOTF method, are taken into account only if the
enable_lotf=&quot;yes&quot; is used in configuration." data-toggle="popover" href="/tests/paral/Input/t41.abi" target="_blank">t41.abi</a></li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Generation of GSTORE.nc file" data-toggle="popover" href="/tests/tutorespfn/Input/teph4isotc_6.abi" target="_blank">teph4isotc_6.abi</a></li>
</ul>
</details>
<p>Controls the memory use for the application of the non-local operator.
More detailed explanations:</p>
<ul>
<li><strong>nloc_mem</strong>  == 1: (k+G) vectors are not precomputed, in order to save memory space.</li>
<li><strong>nloc_mem</strong>  == 2: (k+G) vectors are precomputed, once per k-point.</li>
<li><strong>nloc_mem</strong>  == -1 or -2: Negative values of  <strong>nloc_mem</strong>  correspond
  positive ones, where the phase precomputation has been suppressed, in order to
  save memory space, as an array <code>double precision: ph3d(2,npw,[[natom]])</code> is
  saved (typically half the space needed for the wavefunctions at 1 k point -
  this corresponds to the silicon case). However, the computation of phases
  inside nonlop is somehow time-consuming.</li>
</ul>
<p>Note: internally, sign( <strong>nloc_mem</strong> ) is stored in <code>dtset%nloalg(2)</code> and
abs( <strong>nloc_mem</strong> )-1 is stored in <code>dtset%nloalg(3)</code>. See also <a class="wikilink codevar-wikilink" href="/variables/dev#nloc_alg">nloc_alg</a> for the
algorithm for the non-local operator application.</p>
<h2 id="nnsclo"><strong>nnsclo</strong><a class="headerlink" href="#nnsclo" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of Non-Self Consistent LOops<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to control the SCF cycle" data-toggle="popover" href="/topics/SCFControl">topic_SCFControl</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Moderately used, [57/1314] in all abinit tests, [6/178] in abinit tutorials</summary>
<ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="Hypothetical NaTi molecule. Test the diagonalisation scheme with wavelets" data-toggle="popover" href="/tests/bigdft/Input/t14.abi" target="_blank">t14.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H in a box (PAW). PAW projectors are fitted to Gaussians." data-toggle="popover" href="/tests/bigdft/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H in a box (PAW). PAW projectors are fitted to Gaussians." data-toggle="popover" href="/tests/bigdft/Input/t32.abi" target="_blank">t32.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Helium atom in a box. NC, only local potential (too smooth to reproduce experiment).
Simple system for testing Hartree-Fock and the SCF algorithms with OpenMP GPU. Start from PBE." data-toggle="popover" href="/tests/gpu_omp/Input/t29.abi" target="_blank">t29.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT tests on Antiferromagnetic NiO (4 atoms), check DMFT loop with Hubbard I, DMFT
self-consistency and density self-consistency : computes occupations and energy." data-toggle="popover" href="/tests/gpu_omp/Input/t46.abi" target="_blank">t46.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC options only. Not realistic" data-toggle="popover" href="/tests/gpu_omp/Input/t49.abi" target="_blank">t49.abi</a> &hellip;</li>
<li>gwr_suite:  <a class="wikilink abifile-wikilink" data-tippy-content="Hartree-Fock with time-reversal, then CC4S output" data-toggle="popover" href="/tests/gwr_suite/Input/t10.abi" target="_blank">t10.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Hartree-Fock without time-reversal, then CC4S output" data-toggle="popover" href="/tests/gwr_suite/Input/t11.abi" target="_blank">t11.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for Vanadium using off diag CTQMC code" data-toggle="popover" href="/tests/paral/Input/t83.abi" target="_blank">t83.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for Vanadium using off diag CTQMC code with KGB parallelism" data-toggle="popover" href="/tests/paral/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for SrVO3 using Hubard I code with KGB parallelism" data-toggle="popover" href="/tests/paral/Input/t86.abi" target="_blank">t86.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute band structure" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_1.abi" target="_blank">tdmft_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Tutorial DFT+DMFT on SrVO3" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_2.abi" target="_blank">tdmft_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute band structure" data-toggle="popover" href="/tests/tutoparal/Input/tucalc_crpa_1.abi" target="_blank">tucalc_crpa_1.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_5.abi" target="_blank">tw90_5.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Sixth step (part 2) of the tutorial on electron-positron annihilation
Doppler spectrum calculation within PAW - 12 valence electrons
Si, 2 atoms in the box" data-toggle="popover" href="/tests/tutorial/Input/tpositron_7.abi" target="_blank">tpositron_7.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated carbon atom, with PseudosTM_pwteter/6c.pspnc pseudopotential
Test a non-spherical, spin-polarized atom, with nsym=2.
In order to have a fast computation, the cut-off, 19Ha,
is not large enough for good convergence, as well as the box size 9x9x9.
With better convergence parameters, it can be used to find
the atomization energy of carbon-containing molecules." data-toggle="popover" href="/tests/v1/Input/t33.abi" target="_blank">t33.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond : vacancy.
This test is for testing a large number of atoms (63 atoms), with a large
number of plane waves (unlike test42).
Small number of line minimisations, of course." data-toggle="popover" href="/tests/v1/Input/t40.abi" target="_blank">t40.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the geometry builder :
- H2O molecule repeated four times, with rotations and translations
- Si (100) unreconstructed surface : 2*2*2 objects of eight atoms
- 16 H atoms at the bottom
This test is not realistic (it would take too much time)." data-toggle="popover" href="/tests/v1/Input/t42.abi" target="_blank">t42.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Again H2 molecule in a big box (like test 33).
With the same configuration and parameters as test 33,
investigate the treatment of unoccupied states :
use nband 2 and occopt 1 , causing occ 2.0 1.0 . The same results
as with test 33 are obtained." data-toggle="popover" href="/tests/v2/Input/t34.abi" target="_blank">t34.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O2 (nsppol=2, non-linear XC core correction, GGA)
Similar to test50, except use iscf=6 ." data-toggle="popover" href="/tests/v2/Input/t51.abi" target="_blank">t51.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of Ca, simple cubic , 2  k-point.
Testing GS  PAW  energy and lobpcg algorithm." data-toggle="popover" href="/tests/v4/Input/t94.abi" target="_blank">t94.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
FCC Gadolinium. PAW + U calculation
Test the imposition of the density matrix (10 first steps) and related variables.
Test of partial DOS is also done (through the diff of DOS_AT0001)" data-toggle="popover" href="/tests/v5/Input/t19.abi" target="_blank">t19.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline Silicon
Computation of the non-self-consistent kinetic energy at fixed density." data-toggle="popover" href="/tests/v5/Input/t60.abi" target="_blank">t60.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for rsprc preconditionner (not already effective)
simple scf calculation
following part of the code are tested:
04rsprc/prcrscgres2.F90
01cg/*" data-toggle="popover" href="/tests/v5/Input/t74.abi" target="_blank">t74.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT tests on ferromagnetic NiO (2 atoms), check DMFT for several
values of dmft_solv : computes occupations and energy." data-toggle="popover" href="/tests/v6/Input/t45.abi" target="_blank">t45.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT tests on Antiferromagnetic NiO (4 atoms), check DMFT loop with Hubbard I, DMFT
self-consistency and density self-consistency : computes occupations and energy." data-toggle="popover" href="/tests/v6/Input/t46.abi" target="_blank">t46.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute density, WFC and KSS files." data-toggle="popover" href="/tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-toggle="popover" href="/tests/v7/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-toggle="popover" href="/tests/v7/Input/t25.abi" target="_blank">t25.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Geometry optimization with LBFGS" data-toggle="popover" href="/tests/v8/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Geometry optimization with FIRE (ionmov 15)" data-toggle="popover" href="/tests/v8/Input/t17.abi" target="_blank">t17.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Compute U in bcc Fe in 2 atomic supercell with the ujdet
intrinsic subroutine (using a two-point linear regression)." data-toggle="popover" href="/tests/v9/Input/t106.abi" target="_blank">t106.abi</a> &hellip;</li>
</ul>
</details>
<p>Gives the maximum number of non-self-consistent loops of <a class="wikilink codevar-wikilink" href="/variables/gstate#nline">nline</a> line
minimisations, in the SCF case (when <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> &gt;0). In the case <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> &lt;=0,
the number of non-self-consistent loops is determined by <a class="wikilink codevar-wikilink" href="/variables/basic#nstep">nstep</a>.</p>
<ul>
<li>
<p>The Default value of 0 &ndash; for standard plane-wave calculations &ndash; corresponds
to make the two first fixed potential determinations of wavefunctions have 2
non-self consistent loops, and the next ones to have only 1 non-self
consistent loop.</p>
</li>
<li>
<p>The Default value of 0 &ndash; for wavelets calculations (<a class="wikilink codevar-wikilink" href="/variables/basic#usewvl">usewvl</a> = 1) &ndash;
corresponds to make 2 steps with 3 non-self consistent loops, 2 steps with 2
non-self consistent loops, then the next ones with 1 non-self consistent loop.</p>
</li>
<li>
<p>A negative value corresponds to make the abs( <strong>nnsclo</strong> ) first fixed potential determinations
of wavefunctions have 5 non-self consistent loops, and the next ones to have only 1 non-self
consistent loop.</p>
</li>
</ul>
<h2 id="nnsclohf"><strong>nnsclohf</strong><a class="headerlink" href="#nnsclohf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of Non-Self Consistent LOops for (Hartree)-Fock exact exchange<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to use hybrid functionals" data-toggle="popover" href="/topics/Hybrids">topic_Hybrids</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1 if <a class="wikilink codevar-wikilink" href="/variables/internal#usefock">%usefock</a> == 1,
0 otherwise.</p>
<p><em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [8/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Helium atom in a box. NC, only local potential (too smooth to reproduce experiment).
Simple system for testing Hartree-Fock and the SCF algorithms with OpenMP GPU. Start from PBE." data-toggle="popover" href="/tests/gpu_omp/Input/t29.abi" target="_blank">t29.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test of PBE0 in sequential case" data-toggle="popover" href="/tests/v7/Input/t65.abi" target="_blank">t65.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of PBE0 in sequential case" data-toggle="popover" href="/tests/v7/Input/t66.abi" target="_blank">t66.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of Fock in sequential case, with auxiliary XC functional." data-toggle="popover" href="/tests/v7/Input/t67.abi" target="_blank">t67.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of Fock in sequential case, with simple mixing and NC psps" data-toggle="popover" href="/tests/v7/Input/t69.abi" target="_blank">t69.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of Fock in sequential case, with simple mixing and PAW" data-toggle="popover" href="/tests/v7/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test of Fock in sequential case, with RMM-DIIS and NC psps
The energy computation is not variational. While residm and vres2 converge
quite fast, the total energy convergence is lagging behind ..." data-toggle="popover" href="/tests/v7/Input/t72.abi" target="_blank">t72.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Helium atom in a box. NC, only local potential (too smooth to reproduce experiment).
Simple system for testing Hartree-Fock and the SCF algorithms. Start from PBE." data-toggle="popover" href="/tests/v7/Input/t73.abi" target="_blank">t73.abi</a></li>
</ul>
</details>
<p>Gives the maximum number of loops with non-self-consistent occupied states
used to calculate Fock exact exchange, in the SCF case.
The Default value is 0 when <a class="wikilink codevar-wikilink" href="/variables/internal#usefock">%usefock</a> = 0. Default value is 1 when
<a class="wikilink codevar-wikilink" href="/variables/internal#usefock">%usefock</a> = 1 and correspond to update occupied wavefunctions at each self-consistent loop.</p>
<h2 id="nonlop_ylm_count"><strong>nonlop_ylm_count</strong><a class="headerlink" href="#nonlop_ylm_count" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> NON LOcal Operator (YLM version) COUNTer<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to tune the speed and memory usage" data-toggle="popover" href="/topics/TuningSpeedMem">topic_TuningSpeedMem</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em>   </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [4/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Quick test on AlAs (PAW) to check that different nloc_alg options give the correct energy.
Case istwfk=1." data-toggle="popover" href="/tests/v9/Input/t71.abi" target="_blank">t71.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Quick test on AlAs (PAW) to check that different nloc_alg options give the correct energy.
Case istwfk&gt;=2." data-toggle="popover" href="/tests/v9/Input/t72.abi" target="_blank">t72.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Quick test on AlAs (PAW) to check that different cprj_update_lvl options give the correct energy.
Compute forces and stress at the end of the run." data-toggle="popover" href="/tests/v9/Input/t73.abi" target="_blank">t73.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Quick test on AlAs (PAW) to check that different cprj_update_lvl options give the correct energy.
Compute forces at every iteration, compute stress at the end of the run." data-toggle="popover" href="/tests/v9/Input/t74.abi" target="_blank">t74.abi</a></li>
</ul>
</details>
<p>This variable is similar than <a class="wikilink codevar-wikilink" href="/variables/dev#fft_count">fft_count</a>, but for non-local operations instead of FFT ones.</p>
<p>The non-local contribution of the wave-function <span class="arithmatex">\(\psi\)</span> to the energy writes:</p>
<div class="arithmatex">\[ E_{non-local} = \sum_a\sum_{i,j} &lt;\psi|p_{a,i}&gt; e_{a,ij} &lt;p_{a,j}|\psi&gt; \]</div>
<p>and the Hamiltonian applied to a wave-function is:</p>
<div class="arithmatex">\[ H_{non-local}|\psi&gt; = \sum_a\sum_{ij} |p_{a,i}&gt; D_{a,ij} &lt;p_{a,i}|\psi&gt; \]</div>
<p>The index &ldquo;a&rdquo; stands for atoms (<a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>), while &ldquo;i&rdquo; and &ldquo;j&rdquo; indices run over the set of available projectors of the pseudo-potential.
<span class="arithmatex">\(e_{a,ij}\)</span> and <span class="arithmatex">\(D_{a,ij}\)</span> are scalars.
In the PAW formalism (<a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> = 1), the overlap operator has the same structure than <span class="arithmatex">\(H_{non-local}\)</span>.
The most time-consuming parts of the computation of non-local terms are:</p>
<ul>
<li>
<p>the computation of <span class="arithmatex">\(&lt;p_{a,i}|\psi&gt;\)</span> for every &ldquo;a&rdquo; and &ldquo;i&rdquo;</p>
</li>
<li>
<p>the computation of <span class="arithmatex">\(\sum_a\sum_i |p_{a,i}&gt; f_{a,i}\)</span> where <span class="arithmatex">\(f_{a,i} = \sum_j D_{a,ij} &lt;p_{a,j}|\psi&gt;\)</span></p>
</li>
</ul>
<p>With the use of spherical harmonics (<a class="wikilink codevar-wikilink" href="/variables/dev#useylm">useylm</a> = 1), the first operation is done in the routine &ldquo;opernla_ylm&rdquo;, and the second one in &ldquo;opernlb_ylm&rdquo;.
Both operations scale like <span class="arithmatex">\(O\left(N_{at}N_{proj}N_{pw}\right)\)</span> where <span class="arithmatex">\(N_{at}\)</span> is the number of atoms (<a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>), <span class="arithmatex">\(N_{proj}\)</span> the number of projectors <span class="arithmatex">\(|p_{a,i}&gt;\)</span> per atom, and <span class="arithmatex">\(N_{pw}\)</span> the number of plane waves.
For systems with many atoms these two operations are the most time consuming, and can take a huge portion of the total computational time.
For that reason, it is interesting to count the number of non-local operations in a dataset, which is done with  <strong>nonlop_ylm_count</strong>  = 1 (or any non-zero value).</p>
<p>This feature is not equivalent to what other profiling tools would give (as the one included in Abinit, see <a class="wikilink codevar-wikilink" href="/variables/gstate#timopt">timopt</a>), because the amount of work done inside the routines
depends on input options which vary during the computation.
For example, one can compute the application of both the Hamiltonian and the overlap operator in one call.
The counting activated by  <strong>nonlop_ylm_count</strong>  takes into account these effects.
Also, one can count several datasets separately in one run.</p>
<p>For now, this feature is available only in the following context:</p>
<ul>
<li>
<p><a class="wikilink codevar-wikilink" href="/variables/dev#useylm">useylm</a> = 1: use of spherical harmonics</p>
</li>
<li>
<p><a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> = 0: ground-state computation</p>
</li>
<li>
<p><a class="wikilink codevar-wikilink" href="/variables/paral#paral_kgb">paral_kgb</a> = 0: simple parallelization over k-points</p>
</li>
</ul>
<p>If the counting is activated, a little report is written in abinit output.
Here an example:</p>
<div class="codehilite"><pre><span></span><code><span class="nb">---</span><span class="c"> NONLOP YLM COUNTERS </span><span class="nb">-----------------------------------------------------</span>
<span class="c">Number of Calls in nonlop_ylm : NC =      2</span>
<span class="c">total Number of Bands         : NB =     64</span>
<span class="c">                     | total count (TC) |            TC/NC |         TC/NC/NB</span>
<span class="nb">-----------------------------------------------------------------------------</span>
<span class="c">opernla_ylm          |             1152 |              576 |              9</span><span class="nt">.</span><span class="c">0</span>
<span class="c">opernla_ylm_mv(dgemv)|             4022 |             2011 |             31</span><span class="nt">.</span><span class="c">4</span>
<span class="c">opernlb_ylm_mv       |             3254 |             1627 |             25</span><span class="nt">.</span><span class="c">4</span>
<span class="nb">-----------------------------------------------------------------------------</span>
</code></pre></div>

<p>The total count (TC) corresponds to the number of calls of the routine.
In a call of &ldquo;nonlop_ylm&rdquo;, the sum over atoms is divided by the number of atomic types, and then by blocks of 10 atoms, so in &ldquo;opernl&rdquo; routines the sum run over at most 10 atoms (of the same type).
As a consequence, &ldquo;opernl&rdquo; routines are called NC times in one call of &ldquo;nonlop_ylm&rdquo; to compute the sum over all atoms.
Finally, NB is the total number of bands, including the empty ones, summed over the k-points.</p>
<p>With this report, one can look at the effect of <a class="wikilink codevar-wikilink" href="/variables/gstate#cprj_in_memory">cprj_in_memory</a> and <a class="wikilink codevar-wikilink" href="/variables/dev#cprj_update_lvl">cprj_update_lvl</a> on the total number of calls.</p>
<p>As shown in the example, several versions of &ldquo;opernla_ylm&rdquo; and &ldquo;opernlb_ylm&rdquo; routines are implemented.
The choice of the implementation has an effect on performances and is controlled by <a class="wikilink codevar-wikilink" href="/variables/dev#nloc_alg">nloc_alg</a>.</p>
<h2 id="normpawu"><strong>normpawu</strong><a class="headerlink" href="#normpawu" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> NORMalize atomic PAW+U projector<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform a DFT+U calculation" data-toggle="popover" href="/topics/DFT+U">topic_DFT+U</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/basic#ntypat">ntypat</a>)<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [0/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
</details>
<p>Defines whether the atomic wave function (used as projectors in PAW+U) should
be renormalized to 1 within PAW sphere.</p>
<ul>
<li><strong>normpawu</strong>  = 0: leave projector</li>
<li><strong>normpawu</strong>  = 1: renormalize</li>
</ul>
<h2 id="npulayit"><strong>npulayit</strong><a class="headerlink" href="#npulayit" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Number of PULAY ITerations for SC mixing<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to select the SCF algorithm" data-toggle="popover" href="/topics/SCFAlgorithms">topic_SCFAlgorithms</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 7<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> in [7,17]<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [13/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Fe2 dimer in a big box, treated with non-collinear magnetism.
First dataset is the metallic treatment, second dataset
is a fixed occupation number treatment. Dataset 3 to 5 start from
other initial magnetization direction
Only 5 or 2 steps. The run is not invariant
against changing the initial magnetization direction.
If the wavefunctions were completely optimized in the
first fixed potential, the run should be invariant ..." data-toggle="popover" href="/tests/gpu_omp/Input/t35.abi" target="_blank">t35.abi</a></li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/paral/Input/t99.abi" target="_blank">t99.abi</a></li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
Fe2 dimer in a big box, treated with non-collinear magnetism.
First dataset is the metallic treatment, second dataset
is a fixed occupation number treatment. Dataset 3 to 5 start from
other initial magnetization direction
Only 5 or 2 steps. The run is not invariant
against changing the initial magnetization direction.
If the wavefunctions were completely optimized in the
first fixed potential, the run should be invariant ..." data-toggle="popover" href="/tests/v3/Input/t47.abi" target="_blank">t47.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Aluminum FCC. Only one k point. Preparation of the conductivity test number 79.
Of course, 1 k point is much to small to allow to get the correct conductivity,
but it is for testing purposes only." data-toggle="popover" href="/tests/v3/Input/t78.abi" target="_blank">t78.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
O in arbitrary structure. 1 k point, low ecut. Experimental PAW pseudopotential.
The aim of this test is to test the differents mixing scheme in PAW formalism.
Different values of iscf, pawmixdg and pawoptmix are choosen.
Features tested:
- mixing on density or potential (mod(iscf,10))
- different mixing schemes (iscf)
- inclusion of spherical part in residual (pawoptmix)
- mixing on coarse or fine grid (pawmixdg)
- mixing factor for spherical part (pawsphmix)
All mixing schemes give the same total energy." data-toggle="popover" href="/tests/v4/Input/t07.abi" target="_blank">t07.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Ni molecule in a big box.
Test the use of the atvshift variable
First dataset : no shift, the ten states number 9 to 18
come from the 3d atomic states, the state number 19 is a bonding 4s state.
States number 16 and 17 are degenerate 3d pi antibonding states (m=1 and -1).
State number 18 is a 3d sigma antibonding state (m=0).
Second dataset : add a 0.001 atomic shift to the m=0 potential. Most of the
levels change by less than 0.0002 (and their energy decrease), except state number
9 (a 3d sigma bonding state (m=0)), that goes from -0.24020 to -0.23982 (+0.0004)
and state number 18, that goes from -0.15439 to 0.15399 (+0.0004).
Third dataset : add a 0.001 atomic shift to the m=1 and m=-1 potentials.
All the levels are affected (likely the m=1 and -1 orbitals adjust, and cause modification
of the potential), but the states 10, 11, 16, and 17 increase their energy, while the
other state see their energy decrease.
Acting separately on the m=1 potential or the m=-1 cause (correctly) the breaking
of the degeneracy.
This test was not easy to make portable. The problem lies in the fact that when the density
becomes negative, due to Bragg oscillations, the xc kernel can be extremely large, and when
use for the prediction of the residual of the forces, the differences between machines
can be extremely large. IN order to see this effect, put ecut 7 and npulayit 7 (its default value)." data-toggle="popover" href="/tests/v5/Input/t15.abi" target="_blank">t15.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO antiferromagnetic. Test of prtfatbnd==2
2 Ni and 2 O atoms in an fcc supercell.
The cut-offs are unrealistic.
The aim of this test is to verify:
* Computation of band structure in PAW+U
* Calculation of partial DOS (diffs of partial DOS is not done)
* Calculation of Fatbands (diff of a fatband file is done)" data-toggle="popover" href="/tests/v5/Input/t20.abi" target="_blank">t20.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for DFT+U features.
2 Ni and 2 O atoms in an fcc supercell.
The cut-offs are unrealistic.
The aim of this test is to verify:
* Antiferromagnetism and PAW+U
* Use of an initial and constant density matrix during the first SCF iterations" data-toggle="popover" href="/tests/v5/Input/t37.abi" target="_blank">t37.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v7/Input/t27.abi" target="_blank">t27.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test entropy calculation for SrVO3 within DMFT" data-toggle="popover" href="/tests/v7/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test restart of entropy calculation for SrVO3 within DMFT" data-toggle="popover" href="/tests/v7/Input/t31.abi" target="_blank">t31.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a></li>
</ul>
</details>
<p>Gives the number of previous iterations involved in Pulay mixing (mixing
during electronic SC iterations).</p>
<h2 id="nscforder"><strong>nscforder</strong><a class="headerlink" href="#nscforder" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Nth - SCaling Function ORDER<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to treat adequately the Coulomb interaction, especially in charged cells," data-toggle="popover" href="/topics/Coulomb">topic_Coulomb</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 16<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Moderately used, [17/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT. Very quick built-in test, to check that BigDFT is installed." data-toggle="popover" href="/tests/bigdft/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with steepest decent
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with DIIS
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. Forces are computed." data-toggle="popover" href="/tests/bigdft/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
SiH4 molecule with default parameters. This routine tests the program with several different atoms." data-toggle="popover" href="/tests/bigdft/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
5. Galaborane molecule to test the HGH pseudo-potentials.
WARNING : BigDFT try to read an additional line giving rcutoff and rloc, present in some pseudopotentials.
If such a line exist after the value defined by lmax, but does NOT contain proper rcutoff and rloc (e.g. 0.0), BigDFT might fail by hanging
or SEGFAULT, without giving proper error message. This is difficult to debug." data-toggle="popover" href="/tests/bigdft/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
SiH4 molecule with truncated convergence to test the computation of the tail
correction (see the tl_radius) parameter in the input file." data-toggle="popover" href="/tests/bigdft/Input/t09.abi" target="_blank">t09.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with geometry optimisation using BFGS (test the reformating part of the code)." data-toggle="popover" href="/tests/bigdft/Input/t10.abi" target="_blank">t10.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Pt single atom with semi-core electrons, Krack pseudopotentials (pspcod = 10),
and colinear spin polarisation (GGA functional)." data-toggle="popover" href="/tests/bigdft/Input/t12.abi" target="_blank">t12.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for real space computation (using a wavelet based poisson solver),
no forces, just an H atom in an empty box. The cut-off is unrealistic. This
test tests the following part of the code :
* psp spline generation for real space ;
* local part of potential from pseudo ;
* ion-ion interaction computation (instead of Ewald) ;
* Hartree potential with Poisson&#x27;s solver." data-toggle="popover" href="/tests/bigdft/Input/t20.abi" target="_blank">t20.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H in a box (PAW). PAW projectors are fitted to Gaussians." data-toggle="popover" href="/tests/bigdft/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="H in a box (PAW). PAW projectors are fitted to Gaussians." data-toggle="popover" href="/tests/bigdft/Input/t32.abi" target="_blank">t32.abi</a></li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a></li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT" data-toggle="popover" href="/tests/built-in/Input/testin_bigdft.abi" target="_blank">testin_bigdft.abi</a></li>
</ul>
</details>
<p>This variable controls the order of used scaling functions when the Hartree
potential is computed using the Poisson solver (see <a class="wikilink codevar-wikilink" href="/variables/gstate#icoulomb">icoulomb</a> input
variable). This variable is of seldom use since the default value is large
enough. Nonetheless, possible values are 8, 14, 16, 20, 24, 30, 40, 50, 60,
100. Values greater than 20 are included in ABINIT for test purposes only.</p>
<h2 id="optforces"><strong>optforces</strong><a class="headerlink" href="#optforces" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> OPTions for the calculation of FORCES<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to tune the computation of forces and stresses" data-toggle="popover" href="/topics/ForcesStresses">topic_ForcesStresses</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1 if <a class="wikilink codevar-wikilink" href="/variables/basic#toldff">toldff</a> or <a class="wikilink codevar-wikilink" href="/variables/basic#tolrff">tolrff</a> != 0,
2 otherwise.</p>
<p><em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Moderately used, [101/1314] in all abinit tests, [18/178] in abinit tutorials</summary>
<ul>
<li>bigdft:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT. Very quick built-in test, to check that BigDFT is installed." data-toggle="popover" href="/tests/bigdft/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with steepest decent
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
H2 molecule with default parameters. No forces are computed, with DIIS
for the direct minimisation of the wavefunctions." data-toggle="popover" href="/tests/bigdft/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>bigdft_paral:  <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="O2 in a box (NC). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, potential/density mixing and parallelism" data-toggle="popover" href="/tests/bigdft_paral/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="CO2 in a box (PAW). ABINIT routines are used (wvl_bigdft_comp=0)
Test: DIIS, density mixing" data-toggle="popover" href="/tests/bigdft_paral/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="H atom within BigDFT" data-toggle="popover" href="/tests/built-in/Input/testin_bigdft.abi" target="_blank">testin_bigdft.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/gpu_kokkos/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Orbital magnetism with nspinor 2" data-toggle="popover" href="/tests/gpu_omp/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO: 2 Ni and 2 O atoms in an fcc supercell, using OpenMP GPU.
Different combinations of nsppol/nspden/nspinor/pawspnorb are tested in the PAW+U formalism:
1- non-magnetic                     nsppol/nspden/nspinor=1/1/1
2- non-magnetic DFT+U               nsppol/nspden/nspinor=1/1/1
3- ferro-magnetic DFT+U             nsppol/nspden/nspinor=2/2/1
4- antiferro-magnetic DFT+U         nsppol/nspden/nspinor=1/2/1
Cut-off and k-points are unrealistic." data-toggle="popover" href="/tests/gpu_omp/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO: 2 Ni and 2 O atoms in an fcc supercell, using OpenMP GPU.
Different combinations of nsppol/nspden/nspinor/pawspnorb are tested in the PAW+U formalism:
5- non-collinear magnetism          nsppol/nspden/nspinor=1/4/2
6- non-collinear magnetism DFT+U    nsppol/nspden/nspinor=1/4/2
7- non-collinear magnetism DFT+U+SO nsppol/nspden/nspinor=1/4/2
8- non-magnetic DFT+U+SO            nsppol/nspden/nspinor=1/1/2
Cut-off and k-points are unrealistic." data-toggle="popover" href="/tests/gpu_omp/Input/t33.abi" target="_blank">t33.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). PAW,istwfk&gt;1,dilatmx&gt;1,npband=4" data-toggle="popover" href="/tests/paral/Input/t19.abi" target="_blank">t19.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). PAW,istwfk&gt;1,dilatmx&gt;1,npband=4" data-toggle="popover" href="/tests/paral/Input/t20.abi" target="_blank">t20.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test for input variable slk_rankpp" data-toggle="popover" href="/tests/paral/Input/t31.abi" target="_blank">t31.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW Berrys Phase calculation of forces in finite electric fields
(contributed by J. Zwanziger, adapted from efield tutorial.)
Cannot be executed with more than 1 MPI node." data-toggle="popover" href="/tests/seq/Input/tsv7_70.abi" target="_blank">tsv7_70.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_1.abi" target="_blank">tw90_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW calculation)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_2.abi" target="_blank">tw90_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Silane SiH4. Generation of Wannier functions via Wannier90 code." data-toggle="popover" href="/tests/tutoplugs/Input/tw90_3.abi" target="_blank">tw90_3.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="
AlAs in hypothetical wurzite (hexagonal) structure
Structural optimization run" data-toggle="popover" href="/tests/tutorespfn/Input/telast_1.abi" target="_blank">telast_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlP in hypothetical wurzite (hexagonal) structure
Response function calculation for:
* rigid-atom elastic tensor
* rigid-atom piezoelectric tensor
* interatomic force constants at gamma
* Born effective charges" data-toggle="popover" href="/tests/tutorespfn/Input/telast_2.abi" target="_blank">telast_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
AlP in hypothetical wurzite (hexagonal) structure
Finite-difference calculation for c-axis strain increment +/- 0.0001" data-toggle="popover" href="/tests/tutorespfn/Input/telast_4.abi" target="_blank">telast_4.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
example of orbmag calculation of chemical shielding. system is
Ne atom at center of an empty box." data-toggle="popover" href="/tests/tutorial/Input/tnuc_4.abi" target="_blank">tnuc_4.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
First step of the tutorial on electron-positron annihilation
Positron lifetime calculation within PAW
Si, 2 atoms in the box" data-toggle="popover" href="/tests/tutorial/Input/tpositron_1.abi" target="_blank">tpositron_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Input for Positron tutorial
Second step of the tutorial on electron-positron annihilation
Positron lifetime calculation within PAW
Si monovacancy, &quot;conventional&quot; scheme" data-toggle="popover" href="/tests/tutorial/Input/tpositron_2.abi" target="_blank">tpositron_2.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Test oracle and nbdbuf=-101 in chebfi. cprj_in_memory=0 or 1. PAW,istwfk=1." data-toggle="popover" href="/tests/v10/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test oracle and nbdbuf=-101 in chebfi. cprj_in_memory=0 or 1. PAW,istwfk=1." data-toggle="popover" href="/tests/v10/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test oracle and nbdbuf=-101 in chebfi. cprj_in_memory=0 or 1. PAW,istwfk=1." data-toggle="popover" href="/tests/v10/Input/t09.abi" target="_blank">t09.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the computation of the positron lifetime
(using the two-component DFT) within PAW.
A cubic box with 4 Al atoms at experimental volume.
Low cut-offs, few k-points.
Datasets 2 to 3 use ixcpositron=2
i.e. LDA electron-positron correlation provided by Puska,
Seitsonen, and Nieminen (PRB 52, 10947).
Datasets 4 to 5 use ixcpositron=11
i.e. LDA zero positron density limit parametrized by Arponen
and Pajanne and fitted by Sterne and Kaiser (PRB 43, 13892).
Dataset 1 performs a simple electronic GS calculation and store the density.
Dataset 2 performs a positronic GS calculation in presence of
the electronic density computed by dataset 1 (positron=1).
Dataset 3 performs an electronic GS calculation in presence of
the positronic density computed by dataset 2 (positron=2).
Dataset 4 performs an automatic electronic/positronic GS calculation
without storage of the wave-functions (positron=-1).
Dataset 5 performs an automatic electronic/positronic GS calculation
with storage of the wave-functions (positron=-10).
Each dataset computes the positron lifetime and annihilation rate
after the SCF iterations." data-toggle="popover" href="/tests/v5/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO: 2 Ni and 2 O atoms in an fcc supercell.
Different combinations of nsppol/nspden/nspinor/pawspnorb are tested in the PAW+U formalism:
1- non-magnetic                     nsppol/nspden/nspinor=1/1/1
2- non-magnetic DFT+U               nsppol/nspden/nspinor=1/1/1
3- ferro-magnetic DFT+U             nsppol/nspden/nspinor=2/2/1
4- antiferro-magnetic DFT+U         nsppol/nspden/nspinor=1/2/1
5- non-collinear magnetism          nsppol/nspden/nspinor=1/4/2
6- non-collinear magnetism DFT+U    nsppol/nspden/nspinor=1/4/2
7- non-collinear magnetism DFT+U+SO nsppol/nspden/nspinor=1/4/2
8- non-magnetic DFT+U+SO            nsppol/nspden/nspinor=1/1/2
Cut-off and k-points are unrealistic." data-toggle="popover" href="/tests/v5/Input/t16.abi" target="_blank">t16.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test new integration method and grid options for the integral
along the imaginary axis in contour deformation calculations." data-toggle="popover" href="/tests/v67mbpt/Input/t22.abi" target="_blank">t22.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
LiH rocksalt structure with a negative lithium vacancy
test thee potential alignement usepotzero=0,1" data-toggle="popover" href="/tests/v7/Input/t26.abi" target="_blank">t26.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test presence of nuclear magnetic dipole moments on atomic sites" data-toggle="popover" href="/tests/v7/Input/t32.abi" target="_blank">t32.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of the computation of the electron-positron Doppler broadening
(using the two-component DFT) within PAW.
A cubic box with 4 Al atoms at experimental volume.
Low cut-offs, few k-points.
Computes the positron lifetime and well as the electron-positron
pairs momentum distributions, after the SCF iterations." data-toggle="popover" href="/tests/v7/Input/t35.abi" target="_blank">t35.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Geometry optimization with LBFGS" data-toggle="popover" href="/tests/v8/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Geometry optimization with FIRE (ionmov 15)" data-toggle="popover" href="/tests/v8/Input/t17.abi" target="_blank">t17.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding for isolated neon atom" data-toggle="popover" href="/tests/v9/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Quick test on AlAs (PAW) to check that different cprj_update_lvl options give the correct energy.
Compute forces and stress at the end of the run." data-toggle="popover" href="/tests/v9/Input/t73.abi" target="_blank">t73.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Quick test on AlAs (PAW) to check that different cprj_update_lvl options give the correct energy.
Compute forces at every iteration, compute stress at the end of the run." data-toggle="popover" href="/tests/v9/Input/t74.abi" target="_blank">t74.abi</a> &hellip;</li>
</ul>
</details>
<p>Allows to choose options for the calculation of forces.</p>
<ul>
<li><strong>optforces</strong> = 0: the forces are set to zero, and many steps of the computation of forces are skipped</li>
<li><strong>optforces</strong> = 1: calculation of forces at each SCF iteration, allowing to use forces as criterion to stop the SCF cycles</li>
<li><strong>optforces</strong> = 2: calculation of forces at the end of the SCF iterations (like the stresses)</li>
</ul>
<h2 id="optnlxccc"><strong>optnlxccc</strong><a class="headerlink" href="#optnlxccc" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> OPTion for the calculation of Non-Linear eXchange-Correlation Core Correction<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the exchange and correlation functionals" data-toggle="popover" href="/topics/xc">topic_xc</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [1/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
diamond Si. Compare 2 pseudopotentials made with the APE code, in fhi and UPF formats." data-toggle="popover" href="/tests/v5/Input/t45.abi" target="_blank">t45.abi</a></li>
</ul>
</details>
<p>Allows to choose options for the calculation of non-linear XC correction. At
present, only relevant for the FHI type of pseudopotentials, with pspcod=6.</p>
<ul>
<li><strong>optnlxccc</strong> = 1: uses the old <code>psp6cc.f</code> routine, with inconsistent treatment of real-space derivatives of the core
  function (computed in this routine, while splined in the other parts of the code)</li>
<li><strong>optnlxccc</strong> = 2: consistent calculation derivatives, in the <code>psp6cc_dhr.f</code> routine from DHamann.</li>
</ul>
<h2 id="ortalg"><strong>ortalg</strong><a class="headerlink" href="#ortalg" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> ORThogonalisation ALGorithm<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to tune the speed and memory usage" data-toggle="popover" href="/topics/TuningSpeedMem">topic_TuningSpeedMem</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> -2 if <a class="wikilink codevar-wikilink" href="/variables/dev#wfoptalg">wfoptalg</a> &gt;= 10 ,
2 otherwise.</p>
<p><em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [12/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file." data-toggle="popover" href="/tests/built-in/Input/testin_etsf_io.abi" target="_blank">testin_etsf_io.abi</a></li>
<li>etsf_io:  <a class="wikilink abifile-wikilink" data-tippy-content="Ca atom with PAW, writing a ETSF_IO wavefunction file.
Very quick built-in test, to check that ETSF_IO is installed." data-toggle="popover" href="/tests/etsf_io/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ca atom in PAW. Test the output of density in PAW formalism with ETSF_IO.
Also test the output of the wavefunctions in PAW formalism with ETSF_IO." data-toggle="popover" href="/tests/etsf_io/Input/t09.abi" target="_blank">t09.abi</a></li>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="
8-atom Si cube to set up brdmin and MD runs with natfix.
Output also DEN, POT and GEO files" data-toggle="popover" href="/tests/fast/Input/t27.abi" target="_blank">t27.abi</a></li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Diamond : vacancy.
This test is for testing a large number of atoms (63 atoms), with a large
number of plane waves (unlike test42).
Small number of line minimisations, of course." data-toggle="popover" href="/tests/v1/Input/t40.abi" target="_blank">t40.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Mo surface, with 10 atom per cell. Not very large, but the
number of bands make it a medium-size problem : 36 bands." data-toggle="popover" href="/tests/v1/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test the geometry builder :
- H2O molecule repeated four times, with rotations and translations
- Si (100) unreconstructed surface : 2*2*2 objects of eight atoms
- 16 H atoms at the bottom
This test is not realistic (it would take too much time)." data-toggle="popover" href="/tests/v1/Input/t42.abi" target="_blank">t42.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si 8-atom cube. Test the symmetrizer : generate
the full set of atoms from the symmetry operations and
an irreducible set of atoms." data-toggle="popover" href="/tests/v1/Input/t90.abi" target="_blank">t90.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Ca in orthorhombic structure. 1 k point, low ecut.
Perform a test of GS total energy computation, using an
experimental PAW pseudopotential (pspcod=7)." data-toggle="popover" href="/tests/v4/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
O in orthorhombic structure. 1 k point, low ecut. Experimental PAW pseudopotential.
The aim of this test is to verify that different values
of input variable &#x27;ortalg&#x27; give the same results for
total energy. &#x27;ortalg&#x27; is use in the conjugate gradient
algorithm which solves, in the case of PAW calculations,
a generalized eigenproblem (H.|Psi&gt;=Lambda.S|Psi&gt;).
Three datasets are perfomed ; they must give the same
total energies values (when converged)." data-toggle="popover" href="/tests/v4/Input/t05.abi" target="_blank">t05.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of Ca, simple cubic , 2  k-point. Testing GS  energy and lobpcg algorithm." data-toggle="popover" href="/tests/v4/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of Ca, simple cubic , 2  k-point.
Testing GS  PAW  energy and lobpcg algorithm." data-toggle="popover" href="/tests/v4/Input/t94.abi" target="_blank">t94.abi</a></li>
</ul>
</details>
<p>Allows to choose the algorithm for orthogonalisation.
Positive or zero values make two projections per line minimisation, one before
the preconditioning, one after. This is the clean application of the band-by-
band CG gradient for finding eigenfunctions.
Negative values make only one projection per line minimisation.
The orthogonalisation step is twice faster, but the convergence is less good.
This actually calls to a better understanding of this effect.
<strong>ortalg</strong> = 0, 1 or -1 is the conventional coding.
<strong>ortalg</strong> = 2 or -2 try to make better use of existing registers on the
particular machine one is running.
More demanding use of registers is provided by <strong>ortalg</strong> = 3 or -3, and so on.
The maximal value is presently 4 and -4.
Tests have shown that <strong>ortalg</strong> = 2 or -2 is suitable for use on the available platforms.</p>
<h2 id="papiopt"><strong>papiopt</strong><a class="headerlink" href="#papiopt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAPI OPTion<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to control the flow of ABINIT" data-toggle="popover" href="/topics/Control">topic_Control</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [0/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
</details>
<p><a href="http://icl.cs.utk.edu/papi/index.html">PAPI</a> aims to provide the tool
designer and application engineer with a consistent interface and methodology
for use of the performance counter hardware found in most major
microprocessors. PAPI enables software engineers to see, in near real time,
the relation between software performance and processor events.
This option can be used only when ABINIT has been compiled with the <code>--enable-papi</code> configure option.
If <strong>papiopt</strong> = 1, then PAPI counters are used instead of the usual time()
routine. All the timing output of ABINIT is then done with PAPI values. The
measurements are more accurate and give also access to the flops of the calculation.</p>
<h2 id="pawprt_b"><strong>pawprt_b</strong><a class="headerlink" href="#pawprt_b" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAW PRinT band<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [0/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
</details>
<p>Forces the output of the all-electron wavefunction for only a single band.
To be used in conjunction with: <a class="wikilink codevar-wikilink" href="/variables/paw#pawprtwf">pawprtwf</a> = 1 and <a class="wikilink codevar-wikilink" href="/variables/dev#pawprt_k">pawprt_k</a>.
The indexing of the bands start with one for the lowest occupied band and goes up from there.</p>
<h2 id="pawprt_k"><strong>pawprt_k</strong><a class="headerlink" href="#pawprt_k" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAW PRinT K-point<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a PAW calculation" data-toggle="popover" href="/topics/PAW">topic_PAW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [0/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
</details>
<p>Forces the output of the all-electron wavefunction for only a single k-point.
To be used in conjunction with: <a class="wikilink codevar-wikilink" href="/variables/paw#pawprtwf">pawprtwf</a> = 1 and <a class="wikilink codevar-wikilink" href="/variables/dev#pawprt_b">pawprt_b</a>.
The indexing follows the order in output of the internal variable <strong>kpt</strong> in
the beginning of the run.</p>
<h2 id="pawujat"><strong>pawujat</strong><a class="headerlink" href="#pawujat" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAW+macro_UJ, ATom number<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform a DFT+U calculation" data-toggle="popover" href="/topics/DFT+U">topic_DFT+U</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Comment:</em>  i.e. the first atom treated with PAW+U.<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [3/1314] in all abinit tests, [1/178] in abinit tutorials</summary>
<ul>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
AFII NiO 4-atom cell | LRUJ utility | LMac 2022
Linear Response Hubbard U and Hund&#x27;s J (LRUJ)
post-processing utility for the determination of
said parameters in situ and ab initio" data-toggle="popover" href="/tests/tutorial/Input/tlruj_2.abi" target="_blank">tlruj_2.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Compute U in bcc Fe in 2 atomic supercell with the ujdet
intrinsic subroutine (using a two-point linear regression)." data-toggle="popover" href="/tests/v9/Input/t106.abi" target="_blank">t106.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compute the Hund&#x27;s J in bcc Fe in 2 atom cell with ujdet
intrinsic subroutine (using a two-point linear regression); generate
input LRUJ.nc files for lruj post-processing utility" data-toggle="popover" href="/tests/v9/Input/t107.abi" target="_blank">t107.abi</a></li>
</ul>
</details>
<p>Determines the atom for which U (or J) should be determined. See also <a class="wikilink codevar-wikilink" href="/variables/dev#macro_uj">macro_uj</a>.</p>
<h2 id="pawujrad"><strong>pawujrad</strong><a class="headerlink" href="#pawujrad" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAW+macro_UJ, sphere RADius<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform a DFT+U calculation" data-toggle="popover" href="/topics/DFT+U">topic_DFT+U</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 20 a.u.<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [1/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Compute U in bcc Fe in 2 atomic supercell with the ujdet
intrinsic subroutine (using a two-point linear regression)." data-toggle="popover" href="/tests/v9/Input/t106.abi" target="_blank">t106.abi</a></li>
</ul>
</details>
<p>The sphere radius serves to extrapolate the U value calculated at r_paw to a
larger sphere radius. See also <a class="wikilink codevar-wikilink" href="/variables/dev#macro_uj">macro_uj</a>. As most projector functions are
localized within r_paw to 80%, 20 a.u. contains 100% of the wavefunction and
corresponds to r_paw -&gt; .</p>
<h2 id="pawujv"><strong>pawujv</strong><a class="headerlink" href="#pawujv" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PAW+macro_UJ, potential shift (V)<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform a DFT+U calculation" data-toggle="popover" href="/topics/DFT+U">topic_DFT+U</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.1 eV<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [3/1314] in all abinit tests, [1/178] in abinit tutorials</summary>
<ul>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
AFII NiO 4-atom cell | LRUJ utility | LMac 2022
Linear Response Hubbard U and Hund&#x27;s J (LRUJ)
post-processing utility for the determination of
said parameters in situ and ab initio" data-toggle="popover" href="/tests/tutorial/Input/tlruj_2.abi" target="_blank">tlruj_2.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Compute U in bcc Fe in 2 atomic supercell with the ujdet
intrinsic subroutine (using a two-point linear regression)." data-toggle="popover" href="/tests/v9/Input/t106.abi" target="_blank">t106.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compute the Hund&#x27;s J in bcc Fe in 2 atom cell with ujdet
intrinsic subroutine (using a two-point linear regression); generate
input LRUJ.nc files for lruj post-processing utility" data-toggle="popover" href="/tests/v9/Input/t107.abi" target="_blank">t107.abi</a></li>
</ul>
</details>
<p>Amplitude of the potential shift for the determination of U (or J). See also <a class="wikilink codevar-wikilink" href="/variables/dev#macro_uj">macro_uj</a>.</p>
<h2 id="plowan_bandf"><strong>plowan_bandf</strong><a class="headerlink" href="#plowan_bandf" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Projected Local Orbital WANnier functions BAND Final<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform Wannier functions calculation" data-toggle="popover" href="/topics/Wannier">topic_Wannier</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [8/1314] in all abinit tests, [1/178] in abinit tutorials</summary>
<ul>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-toggle="popover" href="/tests/tutoparal/Input/tucalc_crpa_2.abi" target="_blank">tucalc_crpa_2.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute density, WFC and KSS files." data-toggle="popover" href="/tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-toggle="popover" href="/tests/v7/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-toggle="popover" href="/tests/v7/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute band structure
in the d orbital Wannier basis" data-toggle="popover" href="/tests/v7/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute
a simplified interpolated band structure" data-toggle="popover" href="/tests/v7/Input/t77.abi" target="_blank">t77.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute cRPA screened interaction U in the d-dp(b) model" data-toggle="popover" href="/tests/v7/Input/t78.abi" target="_blank">t78.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute cRPA screened interaction U by excluding an energy window to compute epsilon" data-toggle="popover" href="/tests/v7/Input/t79.abi" target="_blank">t79.abi</a></li>
</ul>
</details>
<p>Gives the upper band to include in the calculation of Wannier functions</p>
<h2 id="plowan_bandi"><strong>plowan_bandi</strong><a class="headerlink" href="#plowan_bandi" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Projected Local Orbital WANnier functions BAND Initial<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform Wannier functions calculation" data-toggle="popover" href="/topics/Wannier">topic_Wannier</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [8/1314] in all abinit tests, [1/178] in abinit tutorials</summary>
<ul>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-toggle="popover" href="/tests/tutoparal/Input/tucalc_crpa_2.abi" target="_blank">tucalc_crpa_2.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute density, WFC and KSS files." data-toggle="popover" href="/tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-toggle="popover" href="/tests/v7/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-toggle="popover" href="/tests/v7/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute band structure
in the d orbital Wannier basis" data-toggle="popover" href="/tests/v7/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute
a simplified interpolated band structure" data-toggle="popover" href="/tests/v7/Input/t77.abi" target="_blank">t77.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute cRPA screened interaction U in the d-dp(b) model" data-toggle="popover" href="/tests/v7/Input/t78.abi" target="_blank">t78.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute cRPA screened interaction U by excluding an energy window to compute epsilon" data-toggle="popover" href="/tests/v7/Input/t79.abi" target="_blank">t79.abi</a></li>
</ul>
</details>
<p>Gives the lower band to include in the calculation of Wannier functions</p>
<h2 id="plowan_compute"><strong>plowan_compute</strong><a class="headerlink" href="#plowan_compute" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Projected Local Orbital WANnier functions COMPUTATION<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform Wannier functions calculation" data-toggle="popover" href="/topics/Wannier">topic_Wannier</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [8/1314] in all abinit tests, [1/178] in abinit tutorials</summary>
<ul>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-toggle="popover" href="/tests/tutoparal/Input/tucalc_crpa_2.abi" target="_blank">tucalc_crpa_2.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute density, WFC and KSS files." data-toggle="popover" href="/tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-toggle="popover" href="/tests/v7/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-toggle="popover" href="/tests/v7/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute band structure
in the d orbital Wannier basis" data-toggle="popover" href="/tests/v7/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute
a simplified interpolated band structure" data-toggle="popover" href="/tests/v7/Input/t77.abi" target="_blank">t77.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute cRPA screened interaction U in the d-dp(b) model" data-toggle="popover" href="/tests/v7/Input/t78.abi" target="_blank">t78.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute cRPA screened interaction U by excluding an energy window to compute epsilon" data-toggle="popover" href="/tests/v7/Input/t79.abi" target="_blank">t79.abi</a></li>
</ul>
</details>
<p>Activate computation of Projected Local Orbital Wannier functions (PLO
Wannier) and corresponding band structure. Variables <a class="wikilink codevar-wikilink" href="/variables/dev#plowan_bandi">plowan_bandi</a>,
<a class="wikilink codevar-wikilink" href="/variables/dev#plowan_bandf">plowan_bandf</a>, <a class="wikilink codevar-wikilink" href="/variables/dev#plowan_natom">plowan_natom</a>, <a class="wikilink codevar-wikilink" href="/variables/dev#plowan_nbl">plowan_nbl</a>, <a class="wikilink codevar-wikilink" href="/variables/dev#plowan_iatom">plowan_iatom</a>,
<a class="wikilink codevar-wikilink" href="/variables/dev#plowan_lcalc">plowan_lcalc</a>, <a class="wikilink codevar-wikilink" href="/variables/dev#plowan_projcalc">plowan_projcalc</a> are mandatory to precise the nature of
the projections.</p>
<ul>
<li>0 &rarr; Default value: do not activate calculation of PLO Wannier.</li>
<li>1 &rarr; Compute PLO Wannier and band structure</li>
<li>2 &rarr; Compute PLO Wannier and band structure. In this case, the
  coupling in k-space between blocks of Wannier functions belonging to
  different angular momenta or atoms is removed.</li>
</ul>
<p>Other related variables are <a class="wikilink codevar-wikilink" href="/variables/dev#plowan_realspace">plowan_realspace</a>, <a class="wikilink codevar-wikilink" href="/variables/dev#plowan_nt">plowan_nt</a>,
<a class="wikilink codevar-wikilink" href="/variables/dev#plowan_it">plowan_it</a>. The implementation is not symmetrized over k-point and not
parallelized. (The calculation of projections is detailed in <a class="wikilink citation-wikilink" data-tippy-content="Plane-wave based electronic structure calculations for correlated materials using dynamical mean-field theory and projected local orbitals" data-toggle="popover" href="/theory/bibliography#amadon2008">[Amadon2008]</a> )</p>
<h2 id="plowan_iatom"><strong>plowan_iatom</strong><a class="headerlink" href="#plowan_iatom" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Projected Local Orbital WANnier functions, Index of ATOM<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform Wannier functions calculation" data-toggle="popover" href="/topics/Wannier">topic_Wannier</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [8/1314] in all abinit tests, [1/178] in abinit tutorials</summary>
<ul>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-toggle="popover" href="/tests/tutoparal/Input/tucalc_crpa_2.abi" target="_blank">tucalc_crpa_2.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute density, WFC and KSS files." data-toggle="popover" href="/tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-toggle="popover" href="/tests/v7/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-toggle="popover" href="/tests/v7/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute band structure
in the d orbital Wannier basis" data-toggle="popover" href="/tests/v7/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute
a simplified interpolated band structure" data-toggle="popover" href="/tests/v7/Input/t77.abi" target="_blank">t77.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute cRPA screened interaction U in the d-dp(b) model" data-toggle="popover" href="/tests/v7/Input/t78.abi" target="_blank">t78.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute cRPA screened interaction U by excluding an energy window to compute epsilon" data-toggle="popover" href="/tests/v7/Input/t79.abi" target="_blank">t79.abi</a></li>
</ul>
</details>
<p>Gives the indices of the <a class="wikilink codevar-wikilink" href="/variables/dev#plowan_natom">plowan_natom</a> atoms on which the projections will be done.</p>
<h2 id="plowan_it"><strong>plowan_it</strong><a class="headerlink" href="#plowan_it" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Projected Local Orbital WANnier functions,  Index of Translation.<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform Wannier functions calculation" data-toggle="popover" href="/topics/Wannier">topic_Wannier</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (3,<a class="wikilink codevar-wikilink" href="/variables/dev#plowan_nt">plowan_nt</a>)<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [2/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute band structure
in the d orbital Wannier basis" data-toggle="popover" href="/tests/v7/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute
a simplified interpolated band structure" data-toggle="popover" href="/tests/v7/Input/t77.abi" target="_blank">t77.abi</a></li>
</ul>
</details>
<p>Requires <a class="wikilink codevar-wikilink" href="/variables/dev#plowan_realspace">plowan_realspace</a> to be greater than 0 and <a class="wikilink codevar-wikilink" href="/variables/dev#plowan_nt">plowan_nt</a> to be
greater than 0. Precise a given set of selected real space translation by
using the real space vectors basis. These atoms are used to define Wannier
functions in real space. These real space Wannier functions are used as a
basis to compute the Hamiltonian.</p>
<h2 id="plowan_lcalc"><strong>plowan_lcalc</strong><a class="headerlink" href="#plowan_lcalc" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Projected Local Orbital WANnier functions,  L values to use for CALCulation<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform Wannier functions calculation" data-toggle="popover" href="/topics/Wannier">topic_Wannier</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (sum(<a class="wikilink codevar-wikilink" href="/variables/dev#plowan_nbl">plowan_nbl</a>))<br />
<em>Default value:</em> -1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [8/1314] in all abinit tests, [1/178] in abinit tutorials</summary>
<ul>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-toggle="popover" href="/tests/tutoparal/Input/tucalc_crpa_2.abi" target="_blank">tucalc_crpa_2.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute density, WFC and KSS files." data-toggle="popover" href="/tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-toggle="popover" href="/tests/v7/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-toggle="popover" href="/tests/v7/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute band structure
in the d orbital Wannier basis" data-toggle="popover" href="/tests/v7/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute
a simplified interpolated band structure" data-toggle="popover" href="/tests/v7/Input/t77.abi" target="_blank">t77.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute cRPA screened interaction U in the d-dp(b) model" data-toggle="popover" href="/tests/v7/Input/t78.abi" target="_blank">t78.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute cRPA screened interaction U by excluding an energy window to compute epsilon" data-toggle="popover" href="/tests/v7/Input/t79.abi" target="_blank">t79.abi</a></li>
</ul>
</details>
<p>Gives the <a class="wikilink codevar-wikilink" href="/variables/dev#plowan_nbl">plowan_nbl</a> values of angular momenta for each atom, in the order
of the atoms as given in <a class="wikilink codevar-wikilink" href="/variables/dev#plowan_iatom">plowan_iatom</a>.</p>
<h2 id="plowan_natom"><strong>plowan_natom</strong><a class="headerlink" href="#plowan_natom" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Projected Local Orbital WANnier functions, Number of ATOMs<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform Wannier functions calculation" data-toggle="popover" href="/topics/Wannier">topic_Wannier</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [8/1314] in all abinit tests, [1/178] in abinit tutorials</summary>
<ul>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-toggle="popover" href="/tests/tutoparal/Input/tucalc_crpa_2.abi" target="_blank">tucalc_crpa_2.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute density, WFC and KSS files." data-toggle="popover" href="/tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-toggle="popover" href="/tests/v7/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-toggle="popover" href="/tests/v7/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute band structure
in the d orbital Wannier basis" data-toggle="popover" href="/tests/v7/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute
a simplified interpolated band structure" data-toggle="popover" href="/tests/v7/Input/t77.abi" target="_blank">t77.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute cRPA screened interaction U in the d-dp(b) model" data-toggle="popover" href="/tests/v7/Input/t78.abi" target="_blank">t78.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute cRPA screened interaction U by excluding an energy window to compute epsilon" data-toggle="popover" href="/tests/v7/Input/t79.abi" target="_blank">t79.abi</a></li>
</ul>
</details>
<p>Gives the number of atoms on which the projection will be done</p>
<h2 id="plowan_nbl"><strong>plowan_nbl</strong><a class="headerlink" href="#plowan_nbl" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Projected Local Orbital WANnier functions,  NumBer of L values<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform Wannier functions calculation" data-toggle="popover" href="/topics/Wannier">topic_Wannier</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (<a class="wikilink codevar-wikilink" href="/variables/dev#plowan_natom">plowan_natom</a>)<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [8/1314] in all abinit tests, [1/178] in abinit tutorials</summary>
<ul>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-toggle="popover" href="/tests/tutoparal/Input/tucalc_crpa_2.abi" target="_blank">tucalc_crpa_2.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute density, WFC and KSS files." data-toggle="popover" href="/tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-toggle="popover" href="/tests/v7/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-toggle="popover" href="/tests/v7/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute band structure
in the d orbital Wannier basis" data-toggle="popover" href="/tests/v7/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute
a simplified interpolated band structure" data-toggle="popover" href="/tests/v7/Input/t77.abi" target="_blank">t77.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute cRPA screened interaction U in the d-dp(b) model" data-toggle="popover" href="/tests/v7/Input/t78.abi" target="_blank">t78.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute cRPA screened interaction U by excluding an energy window to compute epsilon" data-toggle="popover" href="/tests/v7/Input/t79.abi" target="_blank">t79.abi</a></li>
</ul>
</details>
<p>Gives the total number of angular momenta (over all atoms) to compute the projections.</p>
<h2 id="plowan_nt"><strong>plowan_nt</strong><a class="headerlink" href="#plowan_nt" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Projected Local Orbital WANnier functions,  Number of Translation on which the real space values of
energy are computed<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform Wannier functions calculation" data-toggle="popover" href="/topics/Wannier">topic_Wannier</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [2/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute band structure
in the d orbital Wannier basis" data-toggle="popover" href="/tests/v7/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute
a simplified interpolated band structure" data-toggle="popover" href="/tests/v7/Input/t77.abi" target="_blank">t77.abi</a></li>
</ul>
</details>
<p>Requires <a class="wikilink codevar-wikilink" href="/variables/dev#plowan_realspace">plowan_realspace</a> to be greater than 0. Gives a number of selected
atoms. These atoms are used to define Wannier functions in real space. These
real space Wannier functions are used as a basis to compute the Hamiltonian.</p>
<h2 id="plowan_projcalc"><strong>plowan_projcalc</strong><a class="headerlink" href="#plowan_projcalc" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Projected Local Orbital WANnier functions,  PROJectors values to use for CALCulation<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform Wannier functions calculation" data-toggle="popover" href="/topics/Wannier">topic_Wannier</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> (sum(<a class="wikilink codevar-wikilink" href="/variables/dev#plowan_nbl">plowan_nbl</a>))<br />
<em>Default value:</em> -1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [8/1314] in all abinit tests, [1/178] in abinit tutorials</summary>
<ul>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute U
The results of this test with 24 procs are non-reproducible at present ! See the huge tolerance. There must be a bug ..." data-toggle="popover" href="/tests/tutoparal/Input/tucalc_crpa_2.abi" target="_blank">tucalc_crpa_2.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute density, WFC and KSS files." data-toggle="popover" href="/tests/v7/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the calculation of dielectric function in constrained RPA for SrVO3. Uses KSS file from test 23" data-toggle="popover" href="/tests/v7/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test the computation of U in CRPA for SrVO3 for t2g and eg orbitals.
Uses KSS and SCR file from tests 23 and 24." data-toggle="popover" href="/tests/v7/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute band structure
in the d orbital Wannier basis" data-toggle="popover" href="/tests/v7/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute
a simplified interpolated band structure" data-toggle="popover" href="/tests/v7/Input/t77.abi" target="_blank">t77.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute cRPA screened interaction U in the d-dp(b) model" data-toggle="popover" href="/tests/v7/Input/t78.abi" target="_blank">t78.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="For SrVO3, compute cRPA screened interaction U by excluding an energy window to compute epsilon" data-toggle="popover" href="/tests/v7/Input/t79.abi" target="_blank">t79.abi</a></li>
</ul>
</details>
<p>Gives the <a class="wikilink codevar-wikilink" href="/variables/dev#plowan_nbl">plowan_nbl</a> values of projectors for each atom, in the order of
the atoms as given in <a class="wikilink codevar-wikilink" href="/variables/dev#plowan_iatom">plowan_iatom</a>. The index i for the projectors refers
to the i-th number on line orbitals of the PAW atomic data file.</p>
<h2 id="plowan_realspace"><strong>plowan_realspace</strong><a class="headerlink" href="#plowan_realspace" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Projected Local Orbital WANnier functions,  activate REAL SPACE calculation.<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform Wannier functions calculation" data-toggle="popover" href="/topics/Wannier">topic_Wannier</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [2/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute band structure
in the d orbital Wannier basis" data-toggle="popover" href="/tests/v7/Input/t76.abi" target="_blank">t76.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of Projected Wannier functions and compute
a simplified interpolated band structure" data-toggle="popover" href="/tests/v7/Input/t77.abi" target="_blank">t77.abi</a></li>
</ul>
</details>
<p>Can take the following values:</p>
<ul>
<li>0 &rarr; Default value: do not activate calculation of real space Wannier functions.</li>
<li>1 &rarr; Compute PLO Wannier in real space for analysis. These data can also be used
    in a following dataset to perform a Wannier interpolation.</li>
<li>2 &rarr; Do simple Wannier Interpolation for a given k points starting from real space Wannier function
    Hamiltonian computed in a preceding dataset.</li>
</ul>
<h2 id="prepscphon"><strong>prepscphon</strong><a class="headerlink" href="#prepscphon" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PREPare Self-Consistent PHONon calculation<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to print some useful quantities" data-toggle="popover" href="/topics/printing">topic_printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [0/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
</details>
<p>Print PCINFO, PHFREQ, and PHVEC files, for use with self-consistent phonon
runs, after a perturbation calculation. Only prints out files for the present
q-point, and there is presently no tool to symmetrize or merge these files, so
use anaddb instead (with prtscphon input variable). The abinit input variable
is destined to someday bypass the use of anaddb for scphon calculations.</p>
<h2 id="prtbltztrp"><strong>prtbltztrp</strong><a class="headerlink" href="#prtbltztrp" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT output for BoLTZTRaP code<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to print some useful quantities" data-toggle="popover" href="/topics/printing">topic_printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [2/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Print out geometry and eigenvalue files for analysis by the BoltzTraP code, for transport coefficients,
Seebeck, etc... Tests the prtbltztrp input variable" data-toggle="popover" href="/tests/v6/Input/t11.abi" target="_blank">t11.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of phonon linewidths and e-ph coupling parameter lambda." data-toggle="popover" href="/tests/v7/Input/t88.abi" target="_blank">t88.abi</a></li>
</ul>
</details>
<p>Print out geometry _BLZTRP_GEOM and eigenenergy _BLZTRP_EIGEN files for
the <a href="https://www.imc.tuwien.ac.at/forschungsbereich_theoretische_chemie/forschungsgruppen/prof_dr_gkh_madsen_theoretical_materials_chemistry/boltztrap/">BoltzTraP code</a> by Georg Madsen.</p>
<h2 id="prtcif"><strong>prtcif</strong><a class="headerlink" href="#prtcif" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT Crystallographic Information File<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to print some useful quantities" data-toggle="popover" href="/topics/printing">topic_printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [2/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
Print out CIF file for titanium bulk crystal prtcif variable. Hexagonal close packed Ti unit cell" data-toggle="popover" href="/tests/v6/Input/t08.abi" target="_blank">t08.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Print out CIF file for simple cubic Ti crystal, for reference purposes (conventional = primitive unit cell for symmetry ops)" data-toggle="popover" href="/tests/v6/Input/t09.abi" target="_blank">t09.abi</a></li>
</ul>
</details>
<p>If set to 1, a CIF file is output with the crystallographic data for the
present run (cell size shape and atomic positions).</p>
<h2 id="prtdipole"><strong>prtdipole</strong><a class="headerlink" href="#prtdipole" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT DIPOLE<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to print some useful quantities" data-toggle="popover" href="/topics/printing">topic_printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [1/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
NaCl molecule in a big box.
Test of the computation of the polarisation with the routine berryphase_new,
for different k-point grids : only 1 k-point, a line of k-points, and a full mesh of k-points.
Results with acell 20 10 10 are : -9.727 C/m^2, -9.975 C/m^2, -9.503 C/m^2
multiplied by the volume (in a.u.), gives -19454, -19950, -19006
Test provided by S. Leroux
Going to bigger cells make these results converge to the same value :
Results with acell 30 20 20 are : -1.771 C/m^2, -1.746 C/m^2, -1.747 C/m^2
multiplied by the volume (in a.u.), gives -21252, -20952, -20964
Results with acell 40 20 20 are : -1.3167C/m^2, -1.3057C/m^2, -1.3062C/m^2
multiplied by the volume (in a.u.), gives -21067, -20891, -20899
Results with acell 50 20 20 are : -1.0502C/m^2, -1.0444C/m^2, -1.0450C/m^2
multiplied by the volume (in a.u.), gives -21004, -20888, -20900" data-toggle="popover" href="/tests/v6/Input/t06.abi" target="_blank">t06.abi</a></li>
</ul>
</details>
<p>Print out dipole of unit cell, calculated in real space for the primitive cell
only. Under development.</p>
<h2 id="prtposcar"><strong>prtposcar</strong><a class="headerlink" href="#prtposcar" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT POSCAR file<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to print some useful quantities" data-toggle="popover" href="/topics/printing">topic_printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [1/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test prtposcar input variable. For simple SiO2 with 1 displaced atom,  output
POSCAR and FORCES files." data-toggle="popover" href="/tests/v7/Input/t01.abi" target="_blank">t01.abi</a></li>
</ul>
</details>
<p>Print out VASP-style POSCAR and FORCES files, for use with PHON or frophon
codes for frozen phonon calculations. See the associated script in</p>
<div class="text-center"><button id="uuid-2fa9bd72-c9f2-4bf6-a433-1695891b7112" class="md-button md-button--secondary"> View ../scripts/post_processing/phondisp2abi.py </button></div>
<div id="uuid-1e244d1b-d45c-461d-8143-9ff45655c238" class="my_dialog" title="../scripts/post_processing/phondisp2abi.py" hidden><div><div class="codehilite small-text"><pre><span></span><span class="ch">#! /usr/bin/python</span>

<span class="c1">#    Copyright (C) 2010-2025 ABINIT group</span>
<span class="c1">#</span>
<span class="c1">#    Written by Matthieu Verstraete in python (compatible v1.9).</span>
<span class="c1">#    This is free software, and you are welcome to redistribute it</span>
<span class="c1">#    under certain conditions (GNU General Public License,</span>
<span class="c1">#    see ~abinit/COPYING or http://www.gnu.org/copyleft/gpl.txt).</span>
<span class="c1">#</span>
<span class="c1">#    ABINIT is a project of the Universite Catholique de Louvain,</span>
<span class="c1">#    Corning Inc. and other collaborators, see ~abinit/doc/developers/contributors.txt.</span>
<span class="c1">#    Please read ~abinit/doc/biblio/generated_files/bib_acknow.html for suggested</span>
<span class="c1">#    acknowledgments of the ABINIT effort.</span>
<span class="c1">#</span>
<span class="c1">#    For more information, see https://www.abinit.org .</span>
<span class="c1">#</span>
<span class="c1">#  This script is to be used with the PHON code (or equivalent)</span>
<span class="c1">#  to calculate frozen phonon frequencies, free energies, etc...</span>
<span class="c1">#  It takes a DISP file of atomic displacements and an SPOSCAR file</span>
<span class="c1">#  with a with a supercell structure (VASP/PHON formats), and creates</span>
<span class="c1">#  the necessary lines for an abinit input file to calculate the</span>
<span class="c1">#  forces in displaced configurations.</span>
<span class="c1">#  See http://chianti.geol.ucl.ac.uk/~dario or</span>
<span class="c1">#  D. Alfe, Computer Physics Communications 180,2622-2633 (2009)</span>
<span class="c1"># </span>
<span class="c1">#  NOTE: the symmetries in the present (1.28 8/2010) version of PHON</span>
<span class="c1">#  are not functioning properly in some cases. It is your own</span>
<span class="c1">#  responsibility to check it, and has nothing to do with ABINIT.</span>
<span class="c1">#</span>
<span class="c1">#  How to use:</span>
<span class="c1">#</span>
<span class="c1">#  1) run abinit for the relaxed structure with prtposcar 1.</span>
<span class="c1">#  this creates a reference XXX_POSCAR file, which you should rename</span>
<span class="c1">#  POSCAR.</span>
<span class="c1">#  2) run phon with LSUPER=.true.  or (e.g.)  phonopy -d --dim=&quot;2 2 3&quot;</span>
<span class="c1">#     to create the SPOSCAR and DISP files</span>
<span class="c1">#  3) run this script (phondisp2abi.py).</span>
<span class="c1">#  4) copy script output to the abinit input file (removing duplicate</span>
<span class="c1">#  input variables etc...)</span>
<span class="c1">#  5) run abinit for each of the given datasets (and prtposcar 1 still)</span>
<span class="c1">#  6) concatenate the resulting XXX_FORCES files into one FORCES file</span>
<span class="c1">#  You also need to include the header lines for each displacement,</span>
<span class="c1">#  which are given by phondisp2abi.py in comments for each dataset</span>
<span class="c1">#  7) run phon again to get the desired phonons and properties.</span>
<span class="c1">#</span>
<span class="c1">#</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">string</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy.linalg</span>

<span class="c1">#</span>
<span class="c1">#  convert PHON DISP and SPOSCAR files into ABINIT datasets with appropriately displaced atoms</span>
<span class="c1">#</span>

<span class="n">fp_disp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;DISP&#39;</span><span class="p">)</span>
<span class="n">lines_disp</span> <span class="o">=</span> <span class="n">fp_disp</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
<span class="n">fp_sposcar</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;SPOSCAR&#39;</span><span class="p">)</span>
<span class="n">lines_sposcar</span> <span class="o">=</span> <span class="n">fp_sposcar</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

<span class="c1"># make unit cell input line</span>
<span class="n">rprimd</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">idir</span>  <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">lines_sposcar</span><span class="p">[</span><span class="mi">2</span><span class="o">+</span><span class="n">idir</span><span class="p">]</span>
    <span class="n">tokens</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span><span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>
    <span class="n">rprimd</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">idir</span><span class="p">]</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">rprimd</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">idir</span><span class="p">]</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">rprimd</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">idir</span><span class="p">]</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>


<span class="c1"># get equilibirum positions</span>
<span class="n">equilxred</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines_sposcar</span><span class="p">[</span><span class="mi">7</span><span class="p">:]:</span>
    <span class="n">equilxred</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span><span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">line</span><span class="p">))))</span>

<span class="c1"># output unit cell input line</span>
<span class="nb">print</span> <span class="s2">&quot;# Add this to the abinit input file to do the PHON displacements&quot;</span>
<span class="nb">print</span> <span class="s2">&quot;#   given in the DISP file, with respect to the supercell in SPOSCAR&quot;</span>
<span class="nb">print</span> <span class="s2">&quot;#&quot;</span>
<span class="nb">print</span> <span class="s2">&quot;# Remember the POSCAR files have sorted the atomic types so the positions&quot;</span>
<span class="nb">print</span> <span class="s2">&quot;#   and displacements are now type ordered (fix typat, spinat, etc!)&quot;</span>
<span class="nb">print</span> <span class="s2">&quot;#&quot;</span>
<span class="nb">print</span> <span class="s2">&quot;ndtset &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines_disp</span><span class="p">)</span>
<span class="nb">print</span> <span class="s2">&quot;# supercell lattice vectors &quot;</span>
<span class="nb">print</span> <span class="s2">&quot;acell 1 1 1 Angstr&quot;</span>
<span class="nb">print</span> <span class="s2">&quot;rprim&quot;</span>
<span class="nb">print</span> <span class="s2">&quot; </span><span class="si">%24.14f</span><span class="s2"> </span><span class="si">%24.14f</span><span class="s2"> </span><span class="si">%24.14f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rprimd</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">rprimd</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">rprimd</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> 
<span class="nb">print</span> <span class="s2">&quot; </span><span class="si">%24.14f</span><span class="s2"> </span><span class="si">%24.14f</span><span class="s2"> </span><span class="si">%24.14f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rprimd</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">rprimd</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">rprimd</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> 
<span class="nb">print</span> <span class="s2">&quot; </span><span class="si">%24.14f</span><span class="s2"> </span><span class="si">%24.14f</span><span class="s2"> </span><span class="si">%24.14f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">rprimd</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">rprimd</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">rprimd</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span> 


<span class="n">idtset</span><span class="o">=</span><span class="mi">1</span>
<span class="c1"># for each displacement,</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines_disp</span><span class="p">:</span>
    <span class="n">tokens</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="c1"># get displacement in reduced coordinates</span>
    <span class="n">iatom</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tokens</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">dispred</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span><span class="n">tokens</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]))</span>
<span class="c1"># add displacement to correct atom</span>
    <span class="n">xred</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">equilxred</span><span class="p">)</span>
    <span class="n">xred</span><span class="p">[</span><span class="n">iatom</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">xred</span><span class="p">[</span><span class="n">iatom</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dispred</span>

<span class="c1"># output xred for this dataset</span>
    <span class="nb">print</span> <span class="s2">&quot;# add the following line, without the #, to the FORCES file for this dtset, when concatenating&quot;</span>
    <span class="nb">print</span> <span class="s2">&quot;# </span><span class="si">%d</span><span class="s2"> </span><span class="si">%24.14f</span><span class="s2"> </span><span class="si">%24.14f</span><span class="s2"> </span><span class="si">%24.14f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">iatom</span><span class="p">,</span> <span class="n">dispred</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dispred</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">dispred</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="nb">print</span> <span class="s2">&quot;xred</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">idtset</span><span class="p">,)</span>
    <span class="k">for</span> <span class="n">xred_1at</span> <span class="ow">in</span> <span class="n">xred</span><span class="p">:</span>
        <span class="nb">print</span> <span class="s2">&quot; </span><span class="si">%24.14f</span><span class="s2"> </span><span class="si">%24.14f</span><span class="s2"> </span><span class="si">%24.14f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">xred_1at</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xred_1at</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">xred_1at</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="c1"># increment dataset counter</span>
    <span class="n">idtset</span><span class="o">=</span><span class="n">idtset</span><span class="o">+</span><span class="mi">1</span> 
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-1e244d1b-d45c-461d-8143-9ff45655c238", "#uuid-2fa9bd72-c9f2-4bf6-a433-1695891b7112") }); </script>

<p>for further details on interfacing with PHON, PHONOPY, etc&hellip;</p>
<h2 id="prtprocar"><strong>prtprocar</strong><a class="headerlink" href="#prtprocar" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> PRinT PROCAR file<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to print some useful quantities" data-toggle="popover" href="/topics/printing">topic_printing</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [1/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Density from test 105 is read; then a non self-consistent calculation
is done and the m-decomposed LDOS on the first atom is printed out.
The BCC structure is slightly distorted, in order to decrease the symmetry
and the degeneracies, and allow better portability.
(perhaps PROCAR file could be tested again)." data-toggle="popover" href="/tests/v9/Input/t108.abi" target="_blank">t108.abi</a></li>
</ul>
</details>
<p>Print out VASP-style PROCAR files, to generate &ldquo;fat band&rdquo; structures, where the
thickness is proportional to the atomic and angular momentum character. Used in
particular with the <a href="https://github.com/romerogroup/pyprocar">pyprocar</a>
package. The same fractions are used as with <a class="wikilink codevar-wikilink" href="/variables/files#prtdos">prtdos</a> 3, but output in the
VASP format. Attempts have been made to support spin polarized and spinor
calculations, but there may be subtle inconsistencies.</p>
<h2 id="recefermi"><strong>recefermi</strong><a class="headerlink" href="#recefermi" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> RECursion - initial guess  of the FERMI Energy<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform orbital-free calculations" data-toggle="popover" href="/topics/Recursion">topic_Recursion</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [3/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
He FCC solid in conventional cell (4 atoms).
Test the recursion algorithm (for high-temperature calculations).
Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t42.abi" target="_blank">t42.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for double grid (fine/coarse) system, the cutting
radius and the initial fermi energy in recursion method
Corresponding variables: recgratio, recrcut,recefermi respectively
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-toggle="popover" href="/tests/v5/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test for an electron gas by recursion method (Vtrial is set to zero)
Corresponding variable: rectesteg
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-toggle="popover" href="/tests/v5/Input/t76.abi" target="_blank">t76.abi</a></li>
</ul>
</details>
<p>Used in Recursion method (<a class="wikilink codevar-wikilink" href="/variables/dev#tfkinfunc">tfkinfunc</a> = 2). In the first SCF calculation it
fixes the initial guess for the Fermi energy.</p>
<h2 id="recgratio"><strong>recgratio</strong><a class="headerlink" href="#recgratio" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> RECursion - Grid RATIO<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform orbital-free calculations" data-toggle="popover" href="/topics/Recursion">topic_Recursion</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [2/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for double grid (fine/coarse) system, the cutting
radius and the initial fermi energy in recursion method
Corresponding variables: recgratio, recrcut,recefermi respectively
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-toggle="popover" href="/tests/v5/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test for an electron gas by recursion method (Vtrial is set to zero)
Corresponding variable: rectesteg
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-toggle="popover" href="/tests/v5/Input/t76.abi" target="_blank">t76.abi</a></li>
</ul>
</details>
<p>Used in Recursion method (<a class="wikilink codevar-wikilink" href="/variables/dev#tfkinfunc">tfkinfunc</a> = 2). It represents the ratio of the two
grid step:  <strong>recgratio</strong>  = fine_step/coarse_step and it is bigger or equal than
1. It introduces a double-grid system which permits to compute the electronic
density on a coarse grid, using a fine grid (defined by <a class="wikilink codevar-wikilink" href="/variables/gstate#ngfft">ngfft</a>) in the
discretisation of the green kernel (see <a class="wikilink codevar-wikilink" href="/variables/dev#recptrott">recptrott</a>). Successively the
density and the recursion coefficients are interpolated on the fine grid by
FFT interpolation. Note that ngfft/recgratio=number of points of the coarse
grid has to be compatible with the parallelization parameters.</p>
<h2 id="recnpath"><strong>recnpath</strong><a class="headerlink" href="#recnpath" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> RECursion - Number of point for PATH integral calculations<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform orbital-free calculations" data-toggle="popover" href="/topics/Recursion">topic_Recursion</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 500<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [3/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
He FCC solid in conventional cell (4 atoms).
Test the recursion algorithm (for high-temperature calculations).
Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t42.abi" target="_blank">t42.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for double grid (fine/coarse) system, the cutting
radius and the initial fermi energy in recursion method
Corresponding variables: recgratio, recrcut,recefermi respectively
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-toggle="popover" href="/tests/v5/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test for an electron gas by recursion method (Vtrial is set to zero)
Corresponding variable: rectesteg
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-toggle="popover" href="/tests/v5/Input/t76.abi" target="_blank">t76.abi</a></li>
</ul>
</details>
<p>Used in Recursion method (<a class="wikilink codevar-wikilink" href="/variables/dev#tfkinfunc">tfkinfunc</a> = 2). Determine the number of
discretisation points to compute some path integral in the recursion method;
those path integrals are used to compute the entropy and the eigenvalues
energy. during the latest SFC cycles.</p>
<h2 id="recnrec"><strong>recnrec</strong><a class="headerlink" href="#recnrec" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> RECursion - Number of RECursions<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform orbital-free calculations" data-toggle="popover" href="/topics/Recursion">topic_Recursion</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 10<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [3/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
He FCC solid in conventional cell (4 atoms).
Test the recursion algorithm (for high-temperature calculations).
Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t42.abi" target="_blank">t42.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for double grid (fine/coarse) system, the cutting
radius and the initial fermi energy in recursion method
Corresponding variables: recgratio, recrcut,recefermi respectively
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-toggle="popover" href="/tests/v5/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test for an electron gas by recursion method (Vtrial is set to zero)
Corresponding variable: rectesteg
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-toggle="popover" href="/tests/v5/Input/t76.abi" target="_blank">t76.abi</a></li>
</ul>
</details>
<p>Used in Recursion method (<a class="wikilink codevar-wikilink" href="/variables/dev#tfkinfunc">tfkinfunc</a> = 2). Determine the maximum order of
recursion, that is the dimension of the krylov space we use to compute
density. If the precision set by <a class="wikilink codevar-wikilink" href="/variables/dev#rectolden">rectolden</a> is reached before that order,
the recursion method automatically stops.</p>
<h2 id="recptrott"><strong>recptrott</strong><a class="headerlink" href="#recptrott" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> RECursion - TROTTer parameter<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform orbital-free calculations" data-toggle="popover" href="/topics/Recursion">topic_Recursion</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [3/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
He FCC solid in conventional cell (4 atoms).
Test the recursion algorithm (for high-temperature calculations).
Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t42.abi" target="_blank">t42.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for double grid (fine/coarse) system, the cutting
radius and the initial fermi energy in recursion method
Corresponding variables: recgratio, recrcut,recefermi respectively
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-toggle="popover" href="/tests/v5/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test for an electron gas by recursion method (Vtrial is set to zero)
Corresponding variable: rectesteg
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-toggle="popover" href="/tests/v5/Input/t76.abi" target="_blank">t76.abi</a></li>
</ul>
</details>
<p>Used in Recursion method (<a class="wikilink codevar-wikilink" href="/variables/dev#tfkinfunc">tfkinfunc</a> = 2). Determine the trotter parameter
used to compute the exponential of the hamiltonian in the recursion method:</p>
<div class="arithmatex">\[ e^{-\beta(-\Delta + V)} \approx
\left(
    e^{-\frac{\beta}{4c} V}
    e^{-\frac{\beta}{4c} \Delta}
    e^{-\frac{\beta}{4c} V}
\right)^{2c} \]</div>
<p>where <span class="arithmatex">\(c\)</span>= <strong>recptrott</strong> .
If set to 0, we use  <strong>recptrott</strong>  = <span class="arithmatex">\(1/2\)</span> in the above formula.
Increasing  <strong>recptrott</strong>  improve the
accuracy of the trotter formula, but increase the dicretisation error: it may
be necessary to increase <a class="wikilink codevar-wikilink" href="/variables/gstate#ngfft">ngfft</a>. The discretisation error is essentially
the discretisation error of the green kernel <span class="arithmatex">\(e^{\frac{c}{\beta|r|^2}}\)</span> on
the ngfft grid.</p>
<h2 id="recrcut"><strong>recrcut</strong><a class="headerlink" href="#recrcut" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> RECursion - CUTing Radius<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform orbital-free calculations" data-toggle="popover" href="/topics/Recursion">topic_Recursion</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [3/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
He FCC solid in conventional cell (4 atoms).
Test the recursion algorithm (for high-temperature calculations).
Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t42.abi" target="_blank">t42.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for double grid (fine/coarse) system, the cutting
radius and the initial fermi energy in recursion method
Corresponding variables: recgratio, recrcut,recefermi respectively
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-toggle="popover" href="/tests/v5/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test for an electron gas by recursion method (Vtrial is set to zero)
Corresponding variable: rectesteg
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-toggle="popover" href="/tests/v5/Input/t76.abi" target="_blank">t76.abi</a></li>
</ul>
</details>
<p>Used in Recursion method (<a class="wikilink codevar-wikilink" href="/variables/dev#tfkinfunc">tfkinfunc</a> = 2). Used to improve the computational
time in the case of the recursion method in a large cell: the density at a
point will be computed with taking account only of a sphere of radius  <strong>recrcut</strong> .</p>
<h2 id="rectesteg"><strong>rectesteg</strong><a class="headerlink" href="#rectesteg" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> RECursion - TEST on Electron Gas<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform orbital-free calculations" data-toggle="popover" href="/topics/Recursion">topic_Recursion</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [1/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test for an electron gas by recursion method (Vtrial is set to zero)
Corresponding variable: rectesteg
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-toggle="popover" href="/tests/v5/Input/t76.abi" target="_blank">t76.abi</a></li>
</ul>
</details>
<p>Used in Recursion method (<a class="wikilink codevar-wikilink" href="/variables/dev#tfkinfunc">tfkinfunc</a> = 2). It is used to test an electron gas
by putting the ion potential equal to zero.</p>
<h2 id="rectolden"><strong>rectolden</strong><a class="headerlink" href="#rectolden" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> RECursion - TOLerance on the difference of electronic DENsity<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform orbital-free calculations" data-toggle="popover" href="/topics/Recursion">topic_Recursion</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Comment:</em> Default value to be changed.<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [3/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
He FCC solid in conventional cell (4 atoms).
Test the recursion algorithm (for high-temperature calculations).
Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t42.abi" target="_blank">t42.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for double grid (fine/coarse) system, the cutting
radius and the initial fermi energy in recursion method
Corresponding variables: recgratio, recrcut,recefermi respectively
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-toggle="popover" href="/tests/v5/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test for an electron gas by recursion method (Vtrial is set to zero)
Corresponding variable: rectesteg
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-toggle="popover" href="/tests/v5/Input/t76.abi" target="_blank">t76.abi</a></li>
</ul>
</details>
<p>Used in Recursion method (<a class="wikilink codevar-wikilink" href="/variables/dev#tfkinfunc">tfkinfunc</a> = 2). Sets a tolerance for differences
of electronic density that, reached TWICE successively, will cause one SCF
cycle to stop. That electronic density difference is computed in the infinity
norm (that is, it is computed point-by-point, and then the maximum difference is computed).</p>
<h2 id="symmorphi"><strong>symmorphi</strong><a class="headerlink" href="#symmorphi" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> SYMMORPHIc symmetry operation selection<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to specify a crystal, with atomic positions and symmetries" data-toggle="popover" href="/topics/crystal">topic_crystal</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to perform a GW calculation, including self-consistency" data-toggle="popover" href="/topics/GW">topic_GW</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Moderately used, [38/1314] in all abinit tests, [7/178] in abinit tutorials</summary>
<ul>
<li>fast:  <a class="wikilink abifile-wikilink" data-tippy-content="
Restart 05 again, but use ALL 48 cubic symmetries (the above tests
don&#x27;t bother with the nonsymmorphic ones) to test nonsymmorphic symmetrization." data-toggle="popover" href="/tests/fast/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Orbital magnetism with nspinor 2" data-toggle="popover" href="/tests/gpu_omp/Input/t31.abi" target="_blank">t31.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW Berrys Phase calculation of Born effective charge in AlAs by
finite electric fields (contributed by J. Zwanziger, adapted from efield
tutorial). The need to have the number of points a multiple of the number of processor is not convenient ..." data-toggle="popover" href="/tests/paral/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PAW Berrys Phase calculation of Born effective charge in AlAs by
finite electric fields (contributed by J. Zwanziger, adapted from efield
tutorial). The need to have the number of points a multiple of the number of processor is not convenient ..." data-toggle="popover" href="/tests/paral/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PAW Berrys Phase calculation of Born effective charge in AlAs by
finite electric fields (contributed by J. Zwanziger, adapted from efield
tutorial). The need to have the number of points a multiple of the number of processor is not convenient ..." data-toggle="popover" href="/tests/paral/Input/t07.abi" target="_blank">t07.abi</a> &hellip;</li>
<li>seq:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW Berrys Phase calculation of forces in finite electric fields
(contributed by J. Zwanziger, adapted from efield tutorial.)
Cannot be executed with more than 1 MPI node." data-toggle="popover" href="/tests/seq/Input/tsv7_70.abi" target="_blank">tsv7_70.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_03.abi" target="_blank">tdfpt_03.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (NC pseudopotentials)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_1.abi" target="_blank">tw90_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test interface with Wannier90 (PAW calculation)" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_2.abi" target="_blank">tw90_2.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test Wannier90 interface with NC pseudopotentials" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_4.abi" target="_blank">tw90_4.abi</a> &hellip;</li>
<li>tutorial:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum : computation of the total energy
Determination of the surface energy of aluminum :
convergence with respect to the number of vacuum layers." data-toggle="popover" href="/tests/tutorial/Input/tbase4_7.abi" target="_blank">tbase4_7.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline aluminum : computation of the total energy

Determination of the surface energy of aluminum :
convergence with respect to the number of vacuum layers." data-toggle="popover" href="/tests/tutorial/Input/tbase4_8.abi" target="_blank">tbase4_8.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
example of orbmag calculation of chemical shielding. system is
Ne atom at center of an empty box." data-toggle="popover" href="/tests/tutorial/Input/tnuc_4.abi" target="_blank">tnuc_4.abi</a> &hellip;</li>
<li>v1:  <a class="wikilink abifile-wikilink" data-tippy-content="
Al2 molecule, inversion point shifted from the origin, ixc=0,
kpt=1/4 1/4 1/4, nsym=4.
Large number of bands (20 instead of 3).
8 first SCF steps with simple mixing algorithm, mixing factor 1/5.
Slow convergence.
Computation of the hermitian dielectric matrix at the 8th step.
The inverse of the dielectric matrix is then used as preconditioning.
A factor of 20 is gained on each step. Largest eigenvalue value of the
dielectric matrix is 5.712 (a mixing factor of 1/3 would have
been enough, but 1/5 is faster). A second eigenvalue is close : 5.531 ." data-toggle="popover" href="/tests/v1/Input/t51.abi" target="_blank">t51.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding in solid AlP using mGGA" data-toggle="popover" href="/tests/v10/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Orbital magnetism with nspinor 2 and mGGA" data-toggle="popover" href="/tests/v10/Input/t42.abi" target="_blank">t42.abi</a> &hellip;</li>
<li>v2:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test the symmetry finder for all the Bravais lattices,
with different input formats (rprim or angdeg), and for
non-conventional choices of axes as well.
Uses two atoms of the same type, placed at (0 0 0) and (0.1 0 0), thus
breaking many symmetries, while the inversion needs a non-symmorphic
translation." data-toggle="popover" href="/tests/v2/Input/t54.abi" target="_blank">t54.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si FCC, in primitive cell (2 atoms/cell).
Test self-consistent HF (3 iterations)." data-toggle="popover" href="/tests/v4/Input/t87.abi" target="_blank">t87.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si FCC, in primitive cell (2 atoms/cell).
Test self-consistent model GW (2 iterations) following Faleev et al. [PRL 93, 126406 (2004)]." data-toggle="popover" href="/tests/v4/Input/t88.abi" target="_blank">t88.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
PbFCl in the matlockite structure P4/nmm. 6 atoms per cell.
Compute a set of matrix elements of the dynamical matrix,
for q wavevector 0.5 0.5 0.5 .
In this test case, the symmetry operations have an important
non-symmorphic character. There was a bug in the treatment
of this material, prior to v5.2.4 ." data-toggle="popover" href="/tests/v5/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Bcc Hydrogen, r_s=2.6 a.u AF
Check the GW+spin calculation with and without symmetries" data-toggle="popover" href="/tests/v5/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz
Calculation of the GW corrections with and without non-symmorphic operations" data-toggle="popover" href="/tests/v5/Input/t64.abi" target="_blank">t64.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
PAW Berrys Phase calculation of Born effective charge in AlAs by
finite differences (contributed by J. Zwanziger, adapted from efield tutorial).

MG: Very problematic in parallel (run get stuck!)" data-toggle="popover" href="/tests/v6/Input/t42.abi" target="_blank">t42.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
PAW Berrys Phase calculation of Born effective charge in AlAs by
finite electric fields (contributed by J. Zwanziger, adapted from efield tutorial.)
Cannot be executed with more than 1 MPI node." data-toggle="popover" href="/tests/v6/Input/t43.abi" target="_blank">t43.abi</a> &hellip;</li>
<li>v67mbpt:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz
Calculation of the GW corrections with non-symmorphic operations, PAW case.
but with a set of translated atoms. PAW case.
Ordered set of atoms ;
non-ordered set of atoms ;
translated atoms.
Similar to v5#64, for PAW." data-toggle="popover" href="/tests/v67mbpt/Input/t06.abi" target="_blank">t06.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz
Calculation of the GW corrections with non-symmorphic operations,
but with a non-ordered set of atoms. Norm-conserving case.
Similar to v6#97." data-toggle="popover" href="/tests/v67mbpt/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz
Calculation of the GW corrections with non-symmorphic operations,
but with a set of translated atoms. Norm-conserving case.
Similar to v6#97." data-toggle="popover" href="/tests/v67mbpt/Input/t08.abi" target="_blank">t08.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="Test presence of nuclear magnetic dipole moments on atomic sites" data-toggle="popover" href="/tests/v7/Input/t32.abi" target="_blank">t32.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding for isolated neon atom" data-toggle="popover" href="/tests/v9/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Calculate chemical shielding in solid AlP" data-toggle="popover" href="/tests/v9/Input/t140.abi" target="_blank">t140.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Orbital magnetism with nspinor 2" data-toggle="popover" href="/tests/v9/Input/t141.abi" target="_blank">t141.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="
Cannot be executed in parallel (mlwfovl_qp)
Si fcc, in primitive cell (2 atoms/cell)
Test of self-consistent model GW (2 iterations) following Faleev et al.,
[PRL 93, 126406 (2004)] followed by construction of quasiparticle
maximally-localized wannier functions [Hamann &amp; Vanderbilt,
arXiv:0810.3616v1 (cond-mat.mtrl-sci)].  Cutoffs are set for test-
acceptable speed, and the results are poorly converged.  The input
file is sufficiently annotated to serve as a model.  Note that well-
converged GW calculations are extremely time consuming, and in general
it is advisable to run the SCGW part separately on a parallel system,
and then run a separate serial job modeled on the last dataset,
substituting &quot;irdwfk&quot; and &quot;irdqps&quot; for &quot;getwfk&quot; and &quot;getqps,&quot; with
appropriate links to the files produced in the serial run.  Note that
the _DEN file from the first dataset is also needed as input, although
the discontinued &quot;irdden&quot; input variable is not needed or supported.
Note that acceptable names for the secondary input file needed by the
wannier90 library are wannier90.win, w90.win, abo_DSn_w90.win (ndtset
&gt;0) and abo_w90.win (ndtset=0), where abo is the 4th line of the .files
file and n is the wannier dataset." data-toggle="popover" href="/tests/wannier90/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
</ul>
</details>
<p>With  <strong>symmorphi</strong>  = 1, symmetry operations with a non-symmorphic vector are
allowed. With  <strong>symmorphi</strong>  = 0, they are not allowed. In the latter case, if
the symmetry operations are specified in the input file, the code will stop
and print an error message if a non-symmorphic vector is encountered. By
contrast, if the symmetry operations are to be determined automatically (if
<a class="wikilink codevar-wikilink" href="/variables/basic#nsym">nsym</a> = 0), then the set of symmetries will not include the non-symmorphic
operations.</p>
<p>Note: this feature exist because in a previous status of the GW calculations,
non-symmorphic symmetry operations could not be exploited. Thus, the k points
were restricted to the IBZ. In order to prepare GW calculations, and to
perform GW calculations,  <strong>symmorphi</strong>  = 0 was to be used, together with <a class="wikilink codevar-wikilink" href="/variables/basic#nsym">nsym</a> = 0.</p>
<h2 id="tfkinfunc"><strong>tfkinfunc</strong><a class="headerlink" href="#tfkinfunc" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Thomas-Fermi KINetic energy FUNCtional<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform orbital-free calculations" data-toggle="popover" href="/topics/Recursion">topic_Recursion</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [7/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
He FCC solid in conventional cell (4 atoms).
Test the recursion algorithm (for high-temperature calculations).
Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t42.abi" target="_blank">t42.abi</a></li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of molecular dynamics of B atoms, in the isokinetic
ensemble, based on the Thomas-Fermi functional (very fast, even with 32 atoms)." data-toggle="popover" href="/tests/v4/Input/t97.abi" target="_blank">t97.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for double grid (fine/coarse) system, the cutting
radius and the initial fermi energy in recursion method
Corresponding variables: recgratio, recrcut,recefermi respectively
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-toggle="popover" href="/tests/v5/Input/t75.abi" target="_blank">t75.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test for an electron gas by recursion method (Vtrial is set to zero)
Corresponding variable: rectesteg
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-toggle="popover" href="/tests/v5/Input/t76.abi" target="_blank">t76.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Boron, 32 atoms - Thomas-Fermi method (without orbitals)
Test the temperature-dependent XC functional (ixc=50)
Ichimaru et al Phys. Rep. 149, 91-205 (1987)
Test the von Weizsacker gradient correction (tfkinfunc=11 or 12)" data-toggle="popover" href="/tests/v7/Input/t11.abi" target="_blank">t11.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of molecular dynamics of B atoms, in the isokinetic
ensemble, based on the Thomas-Fermi functional (very fast, even with 32 atoms).
Fix the position of one atom." data-toggle="popover" href="/tests/v8/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of molecular dynamics of B atoms, in the isokinetic
ensemble, based on the Thomas-Fermi functional (very fast, even with 32 atoms).
Fix the position of one atom along one direction." data-toggle="popover" href="/tests/v8/Input/t22.abi" target="_blank">t22.abi</a></li>
</ul>
</details>
<ul>
<li>
<p><strong>tfkinfunc</strong>  = 1: Thomas-Fermi kinetic functional (explicit functional of the density) is used instead of Kohn-Sham kinetic
  energy functional (implicit functional of the density through Kohn-Sham wavefunctions). See <a class="wikilink citation-wikilink" data-tippy-content="Gradient correction to the statistical electronic free energy at nonzero temperatures: Application to equation-of-state calculations" data-toggle="popover" href="/theory/bibliography#perrot1979">[Perrot1979]</a>.</p>
</li>
<li>
<p><strong>tfkinfunc</strong>  = 11: Thomas-Fermi-Weizsacker kinetic functional with Gradient Corrections is used.
The convergence of a calculation with this functional needs to be initialized
from a calculation without Gradient Correction. This is automatically done
with  <strong>tfkinfunc</strong>  = 11. For the initialization steps, the <a class="wikilink codevar-wikilink" href="/variables/dev#tfw_toldfe">tfw_toldfe</a>
criterion is used. When it is reached, then the Gradient Correction is added
and the SCF cycle continues.
Note: to obtain the convergence of a Molecular Dynamics simulation with TFW,
it is necessary to find the best set of preconditionning parameters
(<a class="wikilink codevar-wikilink" href="/variables/gstate#diemix">diemix</a>, <a class="wikilink codevar-wikilink" href="/variables/gstate#diemac">diemac</a>, <a class="wikilink codevar-wikilink" href="/variables/gstate#dielng">dielng</a>) and the best value of <a class="wikilink codevar-wikilink" href="/variables/dev#npulayit">npulayit</a> (if
the default Pulay mixing is used).</p>
</li>
<li>
<p><strong>tfkinfunc</strong>  = 12: same as <strong>tfkinfunc</strong> =11, but without the initialization steps.
  Gradient correction is directly added.</p>
</li>
<li>
<p><strong>tfkinfunc</strong>  = 2: the Recursion Method is used in order to compute electronic density,
  entropy, Fermi energy and eigenvalues energy. This method computes the density
  without computing any orbital, is efficient at high temperature, with a efficient
  parallelization (almost perfect scalability).
  When that option is in use, the <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> input variable is no longer a convergence
  parameter; <a class="wikilink codevar-wikilink" href="/variables/gstate#ngfft">ngfft</a> becomes the main convergence parameter: you should adapt ecut
  for the ngfft grid you need (it is not yet automatically computed).
  Other convergence parameter are for the energetic values: <a class="wikilink codevar-wikilink" href="/variables/dev#recnrec">recnrec</a>, <a class="wikilink codevar-wikilink" href="/variables/dev#recptrott">recptrott</a>, <a class="wikilink codevar-wikilink" href="/variables/dev#recnpath">recnpath</a>.</p>
</li>
</ul>
<p>Since the convergence of the self-consistent cycle is determined directly by
the convergence of the density: <a class="wikilink codevar-wikilink" href="/variables/basic#toldfe">toldfe</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#toldff">toldff</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#tolrff">tolrff</a>,
<a class="wikilink codevar-wikilink" href="/variables/basic#tolvrs">tolvrs</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a> are not used, and are replaced by <a class="wikilink codevar-wikilink" href="/variables/dev#rectolden">rectolden</a>; the
energetic values, except for the fermi energy, are only computed during the
latest SFC cycle: the output file will show a jump of the total energy at the
end, but it is not because of a bad convergence behavior. Computational speed
can be improved by the use of <a class="wikilink codevar-wikilink" href="/variables/dev#recrcut">recrcut</a> and <a class="wikilink codevar-wikilink" href="/variables/dev#recgratio">recgratio</a>. The recursion
method has not been tested in the case of non cubic cell or with the use of
symmetries.
In the recursion method the following variables are set to: <a class="wikilink codevar-wikilink" href="/variables/dev#useylm">useylm</a> = 1,
<a class="wikilink codevar-wikilink" href="/variables/internal#userec">%userec</a> = 1.</p>
<h2 id="tfw_toldfe"><strong>tfw_toldfe</strong><a class="headerlink" href="#tfw_toldfe" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Thomas-Fermi-Weizsacker: TOLerance on the DiFference of total Energy, for initialization steps<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform orbital-free calculations" data-toggle="popover" href="/topics/Recursion">topic_Recursion</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1.0E-6 or <a class="wikilink codevar-wikilink" href="/variables/basic#toldfe">toldfe</a> is present<br />
<em>Only relevant if:</em> <a class="wikilink codevar-wikilink" href="/variables/dev#tfkinfunc">tfkinfunc</a> = 11<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [1/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Boron, 32 atoms - Thomas-Fermi method (without orbitals)
Test the temperature-dependent XC functional (ixc=50)
Ichimaru et al Phys. Rep. 149, 91-205 (1987)
Test the von Weizsacker gradient correction (tfkinfunc=11 or 12)" data-toggle="popover" href="/tests/v7/Input/t11.abi" target="_blank">t11.abi</a></li>
</ul>
</details>
<p>This input variable has the same definition as <a class="wikilink codevar-wikilink" href="/variables/basic#toldfe">toldfe</a> and is only relevant
when <a class="wikilink codevar-wikilink" href="/variables/dev#tfkinfunc">tfkinfunc</a> = 11.
It sets a tolerance for absolute differences of total energy that, reached
TWICE successively, will cause the initialization steps (without gradient
correction) to stop and the gradient correction to be added.
Can be specified in Ha (the default), Ry, eV or Kelvin, since it has the <a class="wikilink" href="/guide/abinit#parameters">ENERGY</a> characteristics.</p>
<h2 id="tolrde"><strong>tolrde</strong><a class="headerlink" href="#tolrde" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> TOLerance on the Relative Difference of Eigenenergies<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to control the SCF cycle" data-toggle="popover" href="/topics/SCFControl">topic_SCFControl</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.005<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Moderately used, [18/1314] in all abinit tests, [1/178] in abinit tutorials</summary>
<ul>
<li>atompaw:  <a class="wikilink abifile-wikilink" data-tippy-content="Bulk Nickel, using the atomic data file generated in test 03" data-toggle="popover" href="/tests/atompaw/Input/t04.abi" target="_blank">t04.abi</a></li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield), using GEMM nonlop.
Related tests: v8 83 and gpu_omp t25" data-toggle="popover" href="/tests/gpu_omp/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5 .
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t22.abi" target="_blank">t22.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5, using GEMM nonlop.
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5, using OpenMP GPU.
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t24.abi" target="_blank">t24.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (stresses), using GEMM nonlop.
Related tests: v8 t83 and gpu_omp t21 ." data-toggle="popover" href="/tests/gpu_omp/Input/t25.abi" target="_blank">t25.abi</a></li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="BaTiO3 linear response calculation" data-toggle="popover" href="/tests/tutoparal/Input/tdfpt_04.abi" target="_blank">tdfpt_04.abi</a></li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6)." data-toggle="popover" href="/tests/v8/Input/t81.abi" target="_blank">t81.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6).
Test the polarized case (with a non-polarized system). Must give same results than t81.in" data-toggle="popover" href="/tests/v8/Input/t82.abi" target="_blank">t82.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield)." data-toggle="popover" href="/tests/v8/Input/t83.abi" target="_blank">t83.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6)." data-toggle="popover" href="/tests/v8/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield).
Test the polarized case (with a non-polarized system). Must give same results than t83.in" data-toggle="popover" href="/tests/v8/Input/t85.abi" target="_blank">t85.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6).
Test the polarized case (with a non-polarized system). Must give same results than t84.in" data-toggle="popover" href="/tests/v8/Input/t86.abi" target="_blank">t86.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Preparation for a nonlinear calculation : GS + linear response (ddk+phonon+efield).
Give same results than t83.in if tolwfr is increased and the Monkhorst-Pack k-grid is used." data-toggle="popover" href="/tests/v8/Input/t87.abi" target="_blank">t87.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6).
Give same results than t84.in if tolwfr is increased and the Monkhorst-Pack k-grid is used." data-toggle="popover" href="/tests/v8/Input/t88.abi" target="_blank">t88.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
&#x27;Full&#x27; DFPT computation of third derivatives in Nonlinear (dataset 7).
Preceded by resolution of Second-order Sternheimer equations (dataset 5 and 6).
Give same results than t84.in if tolwfr is increased and the Monkhorst-Pack k-grid is used." data-toggle="popover" href="/tests/v8/Input/t89.abi" target="_blank">t89.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q=0.5 .
Works with pseudo Psdj_paw_pbe_std/Fe.xml , where usexcnhat=0 . See test v9#42 for the usexcnhat==1 case." data-toggle="popover" href="/tests/v9/Input/t41.abi" target="_blank">t41.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5 .
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/v9/Input/t42.abi" target="_blank">t42.abi</a></li>
</ul>
</details>
<p>Sets a tolerance for the ratio of differences of eigenenergies in the line
minimisation conjugate-gradient algorithm. It compares the decrease of the
eigenenergy due to the last line minimisation, with the one observed for the
first line minimisation. When the ratio is lower than  <strong>tolrde</strong> , the next
line minimisations are skipped.
The number of line minimisations is limited by <a class="wikilink codevar-wikilink" href="/variables/gstate#nline">nline</a> anyhow.
This stopping criterion is present only for band-by-band conjugate gradient (<a class="wikilink codevar-wikilink" href="/variables/dev#wfoptalg">wfoptalg</a> different than 1,4,14 and 114) and <a class="wikilink codevar-wikilink" href="/variables/gstate#rmm_diis">rmm_diis</a>, but both GS and RF calculations.
In RF calculations,  <strong>tolrde</strong>  is actually doubled before comparing with the above-mentioned ratio, for historical reasons.</p>
<h2 id="use_gemm_nonlop"><strong>use_gemm_nonlop</strong><a class="headerlink" href="#use_gemm_nonlop" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> USE the GEMM routine for the application of the NON-Local OPerator<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a parallel calculation" data-toggle="popover" href="/topics/parallelism">topic_parallelism</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Comment:</em> because it is not usually worth using it unless bandpp is large and it requires additional memory<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [10/1314] in all abinit tests, [1/178] in abinit tutorials</summary>
<ul>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t06.abi" target="_blank">t06.abi</a></li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
BCC iron, ferromagnetic, GGA, PAW.
Test DFPT phonon q/=0.5, using GEMM nonlop.
Works with 26fe.paw, where usexcnhat/=0 . See test v9#41 for the usexcnhat==0 case.
The portability is very low (see tolabs). There is a suspicion of initializing problem.
The convergence seems OK though." data-toggle="popover" href="/tests/gpu_omp/Input/t23.abi" target="_blank">t23.abi</a></li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*np_spkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over bands and spins:
npband*npfft*np_spkpt=2*1*2=4 processors.
In addition, we also test here various features of bandfft-kpt parallelisation
In particular, the bandpp, istwfk=2 and wfoptalg=14 variables." data-toggle="popover" href="/tests/paral/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Chebyshev, C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Also test gemm_nonlop" data-toggle="popover" href="/tests/paral/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test for input variable slk_rankpp" data-toggle="popover" href="/tests/paral/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz.
Ground state with LOBPCG + RMM-DIIS eigensolver and paral_kgb parallelism with 4 MPI procs." data-toggle="popover" href="/tests/paral/Input/t63.abi" target="_blank">t63.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline silicon
Ground state with LOBPCG + RMM-DIIS eigensolver and paral_kgb parallelism with 4 MPI procs." data-toggle="popover" href="/tests/paral/Input/t64.abi" target="_blank">t64.abi</a></li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="
NaI with a sligthly expanded lattice, to allow self-localisation of a hole polaron, using pSIC technique.
Realistic ecut and reasonable k point sampling, but small cell of only 8 atoms for testing.
The present test at a set of decreasing I-I interatomic distances
Parallelism until 12 procs is quite efficient. However, setting npband 2 does not bring noticeable improvement.
Although this is still subject for further investigation, the hypothesis is that the density/xc/potential part
is not improved with npband 2, while it is actually a major contribution, even with 32 bands.
Timing analysis is to be performed." data-toggle="popover" href="/tests/tutoparal/Input/tpsic_02.abi" target="_blank">tpsic_02.abi</a></li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="GS calculation with the CG + RMM-DIIS eigensolver and NC pseudos" data-toggle="popover" href="/tests/v9/Input/t29.abi" target="_blank">t29.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
GS calculation with the CG + RMM-DIIS eigensolver and PAW GGA-PBE pseudos." data-toggle="popover" href="/tests/v9/Input/t30.abi" target="_blank">t30.abi</a></li>
</ul>
</details>
<p>This keyword tells abinit to use a BLAS3 routine to speed up the computation of
the non-local operator. This requires the pre-computation of a large matrix,
and has a significant memory overhead. In exchange, it provides improved
performance when used on several bands at once (Chebyshev or LOBPCG algorithm
with [[bandpp] &gt; 1]</p>
<p>The memory overhead is proportional to the number of atoms, the number of
plane waves, and the number of projectors per atom. It can be mitigated by
distributing the array with <a class="wikilink codevar-wikilink" href="/variables/paral#npfft">npfft</a>
The performance depends crucially on having a good BLAS installed. Provided
the BLAS supports OpenMP, this option also yields very good scaling for the
nonlocal operator.</p>
<p>This option is available only if <a class="wikilink codevar-wikilink" href="/variables/dev#useylm">useylm</a> is 1. ABINIT will automatically set <a class="wikilink codevar-wikilink" href="/variables/dev#useylm">useylm</a> to 1
if  <strong>use_gemm_nonlop</strong>  is set to 1 in the input file (actually, this is only needed when NC pseudos are used as
PAW already uses 1 for <a class="wikilink codevar-wikilink" href="/variables/dev#useylm">useylm</a>).</p>
<h2 id="use_nonscf_gkk"><strong>use_nonscf_gkk</strong><a class="headerlink" href="#use_nonscf_gkk" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> USE NON-SCF calculation of GKK matrix elements (electron phonon)<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to compute the matrix elements of the electron-phonon interaction" data-toggle="popover" href="/topics/ElPhonInt">topic_ElPhonInt</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Comment:</em> Default is 0 for the moment. Do not use non-scf method.<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [5/1314] in all abinit tests, [1/178] in abinit tutorials</summary>
<ul>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="
the sequence of datasets makes the ground states and
all of the explicit perturbations of the single
Al atom in all directions, for the irreducible
qpoints in a 2x2x2 grid.
Note that the q-point grid must be a sub-grid of the k-point grid (here 4x4x4)" data-toggle="popover" href="/tests/tutorespfn/Input/teph_legacy_1.abi" target="_blank">teph_legacy_1.abi</a></li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
FCC Aluminium - get phonons and ddk in preparation for an electron-phonon coupling run.
a few extra features are used compared to the tutorial." data-toggle="popover" href="/tests/v5/Input/t85.abi" target="_blank">t85.abi</a></li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="Ground state and phonons of hcp TiNb alloy" data-toggle="popover" href="/tests/v6/Input/t72.abi" target="_blank">t72.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Ground state and phonons of hcp Ti (similar to test 72, but grid 2 2 4)" data-toggle="popover" href="/tests/v6/Input/t90.abi" target="_blank">t90.abi</a></li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Ground state and phonons of bcc Li" data-toggle="popover" href="/tests/v7/Input/t90.abi" target="_blank">t90.abi</a></li>
</ul>
</details>
<p>When this flag is activated during a phonon calculation with abinit, all of
the perturbations are cycled through, but only the symmetry-irreducible ones
are calculated self-consistently. For the others the perturbed density is
rotated by the appropriate symop and the gkk matrix elements are calculated
non-self-consistently. As they do not depend on the perturbed wave functions,
they are correct from the first iteration, and nstep is set to 1 for those
perturbations. Note that the resulting 1DEN files are simply the
rotate/symmetric ones and that the resulting 1WF files are garbage (completely
unconverged) except the matrix elements in the header (equivalent to GKK
files, but please use the latter much smaller files for el-ph calculations).
The new default behavior with  <strong>use_nonscf_gkk</strong>  = 1 should be transparent for
the user, with the same output files but a much quicker execution.</p>
<p>Caveat: Note that very tight convergence of ground state and phonon
calculations is necessary to get good GKK matrix elements! <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a> = 1.e-24
or so is recommended everywhere. There may be problems using use_nonscf_gkk =
1 with non-symmorphic symmetries - please check (at least) that lifetimes for
phonons go to 0 for acoustic modes at Gamma.</p>
<h2 id="usedmft"><strong>usedmft</strong><a class="headerlink" href="#usedmft" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> USE Dynamical Mean Field Theory<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform a DMFT calculation" data-toggle="popover" href="/topics/DMFT">topic_DMFT</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Moderately used, [29/1314] in all abinit tests, [1/178] in abinit tutorials</summary>
<ul>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT tests on Antiferromagnetic NiO (4 atoms), check DMFT loop with Hubbard I, DMFT
self-consistency and density self-consistency : computes occupations and energy." data-toggle="popover" href="/tests/gpu_omp/Input/t46.abi" target="_blank">t46.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT on Gd (f-orbitals) without spin-orbit coupling : compute occupations and energy." data-toggle="popover" href="/tests/gpu_omp/Input/t47.abi" target="_blank">t47.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="(Apparently the documentation section of this test has been lost)" data-toggle="popover" href="/tests/gpu_omp/Input/t48.abi" target="_blank">t48.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for Vanadium using off diag CTQMC code" data-toggle="popover" href="/tests/paral/Input/t83.abi" target="_blank">t83.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for Vanadium using off diag CTQMC code with KGB parallelism" data-toggle="popover" href="/tests/paral/Input/t84.abi" target="_blank">t84.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="DFT+DMFT for SrVO3 using Hubard I code with KGB parallelism" data-toggle="popover" href="/tests/paral/Input/t86.abi" target="_blank">t86.abi</a> &hellip;</li>
<li>tutoparal:  <a class="wikilink abifile-wikilink" data-tippy-content="Tutorial DFT+DMFT on SrVO3" data-toggle="popover" href="/tests/tutoparal/Input/tdmft_2.abi" target="_blank">tdmft_2.abi</a> &hellip;</li>
<li>v6:  <a class="wikilink abifile-wikilink" data-tippy-content="
NiO with 4 atoms. Check of the modified self-consistent loop over electronic density for DMFT. This
calculation use LDA occupations for the test and is not running the DMFT part (dmftcheck2=-1)." data-toggle="popover" href="/tests/v6/Input/t07.abi" target="_blank">t07.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT tests on ferromagnetic NiO (2 atoms), check DMFT for several
values of dmft_solv : computes occupations and energy." data-toggle="popover" href="/tests/v6/Input/t45.abi" target="_blank">t45.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
DMFT tests on Antiferromagnetic NiO (4 atoms), check DMFT loop with Hubbard I, DMFT
self-consistency and density self-consistency : computes occupations and energy." data-toggle="popover" href="/tests/v6/Input/t46.abi" target="_blank">t46.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="(Apparently the documentation section of this test has been lost)" data-toggle="popover" href="/tests/v7/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v7/Input/t27.abi" target="_blank">t27.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC options only. Not realistic" data-toggle="popover" href="/tests/v7/Input/t28.abi" target="_blank">t28.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density" data-toggle="popover" href="/tests/v8/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test CT-QMC within DMFT in ABINIT and QMC solver from TRIQS for VSrO3 NSCF over density. This test is different the t01.in because the reference for triqs1.4 and triqs2.0 are different." data-toggle="popover" href="/tests/v8/Input/t01_triqs2_0.abi" target="_blank">t01_triqs2_0.abi</a> &hellip;</li>
</ul>
</details>
<p>If set to 1, enable the use of DFT+DMFT, see in particular the important
variables <a class="wikilink codevar-wikilink" href="/variables/dmft#dmft_solv">dmft_solv</a>, <a class="wikilink codevar-wikilink" href="/variables/dmft#dmftbandi">dmftbandi</a>, <a class="wikilink codevar-wikilink" href="/variables/dmft#dmftbandf">dmftbandf</a>, <a class="wikilink codevar-wikilink" href="/variables/dmft#dmft_nwli">dmft_nwli</a>,
<a class="wikilink codevar-wikilink" href="/variables/dmft#dmft_nwlo">dmft_nwlo</a>, <a class="wikilink codevar-wikilink" href="/variables/dmft#dmft_tollc">dmft_tollc</a>, <a class="wikilink codevar-wikilink" href="/variables/dmft#dmft_tolfreq">dmft_tolfreq</a>, and <a class="wikilink codevar-wikilink" href="/variables/dmft#dmft_iter">dmft_iter</a>.</p>
<p>If set to 10, enable the use of DFT+DMFT using the Wannier90 interface
and the python invocation for calling an external many-body code to
perform the DMFT step. Typically, we use the TRIQS library.
The relevant keywords in that case are only <a class="wikilink codevar-wikilink" href="/variables/dmft#dmftbandi">dmftbandi</a> and <a class="wikilink codevar-wikilink" href="/variables/dmft#dmftbandf">dmftbandf</a>
to specify the bands used for the projection, and <a class="wikilink codevar-wikilink" href="/variables/w90#w90iniprj">w90iniprj</a> with other
Wannier90 specific keywords for the Wannier90 part. More information
will be provided in the future. The rest of the discussion related to this
keyword is in the case where  <strong>usedmft</strong>  is set to 1.</p>
<p>The current implementation uses Wannier functions obtained from
<a class="wikilink citation-wikilink" data-tippy-content="Plane-wave based electronic structure calculations for correlated materials using dynamical mean-field theory and projected local orbitals" data-toggle="popover" href="/theory/bibliography#amadon2008">projected local orbitals</a> as
correlated orbitals (see <a class="wikilink codevar-wikilink" href="/variables/dmft#dmftbandi">dmftbandi</a> and <a class="wikilink codevar-wikilink" href="/variables/dmft#dmftbandf">dmftbandf</a> input variables to define them).</p>
<p>The Green functions are computed on a mesh of linear Matsubara frequencies.
However, most of the code uses logarithmic Matsubara grid to lower the
computational cost. Both <a class="wikilink codevar-wikilink" href="/variables/dmft#dmft_nwli">dmft_nwli</a> and <a class="wikilink codevar-wikilink" href="/variables/dmft#dmft_nwlo">dmft_nwlo</a> are thus convergence parameters.</p>
<p>DMFT is currently available for collinear (<a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> = 1) polarized or
unpolarized calculations (<a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> = <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 2 or <a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> = <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 1)
and for non collinear calculations (<a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> = 2,<a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> = 4,<a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 1).
However it is not yet available for collinear antiferromagnetic calculations
(<a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> = 2,<a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 1) and non collinear non magnetic calculations
(<a class="wikilink codevar-wikilink" href="/variables/gstate#nspden">nspden</a> = 1, <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> = 1,<a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> = 2). CTQMC calculations
(<a class="wikilink codevar-wikilink" href="/variables/dmft#dmft_solv">dmft_solv</a> = 5) are not yet possible if <a class="wikilink codevar-wikilink" href="/variables/gstate#nspinor">nspinor</a> = 2.</p>
<p>Only static calculations without relaxation or dynamics are possible (forces
and stress are not computed in the scheme: so the computed values should NOT
be trusted).</p>
<p>When correlated density matrices are diagonal, all values of <a class="wikilink codevar-wikilink" href="/variables/paw#upawu">upawu</a> and
<a class="wikilink codevar-wikilink" href="/variables/paw#jpawu">jpawu</a> are possible. If the correlated density matrices are non diagonal,
only <a class="wikilink codevar-wikilink" href="/variables/paw#jpawu">jpawu</a> = 0 is implemented.</p>
<p>Relevant direct output quantities from converged DMFT calculations are total
energy and occupation of correlated orbitals. For Hubbard I calculation
(<a class="wikilink codevar-wikilink" href="/variables/dmft#dmft_solv">dmft_solv</a> = 2), total and partial spectral functions can be obtained with
prtdos=1 and can be found in files OUTSpFunc* (where OUT is the root for
output files). For CTQMC calculations (<a class="wikilink codevar-wikilink" href="/variables/dmft#dmft_solv">dmft_solv</a> = 5), imaginary time
impurity Green function are output of the calculations and can be used to
produce spectral function using an external Maximum Entropy Code.</p>
<p>A typical DFT+DMFT calculation involves two runs. First, a DFT calculation is
fully converged (even unoccupied wavefunctions have to be converged). Then,
the DFT+DMFT calculation is started using DFT wavefunctions or density files.
As DFT+DMFT calculations (with CTQMC) are computationally expensive, it is
convenient to use prtden=-1, to write DEN file at each DFT iteration, in order
to be able to restart the calculation easily.</p>
<p>For details of the implementation with Wannier functions see <a class="wikilink citation-wikilink" data-tippy-content="Plane-wave based electronic structure calculations for correlated materials using dynamical mean-field theory and projected local orbitals" data-toggle="popover" href="/theory/bibliography#amadon2008">[Amadon2008]</a>,
for self-consistency and Hubbard I
implementation see <a class="wikilink citation-wikilink" data-tippy-content="A self-consistent DFT + DMFT scheme in the projector augmented wave method: Applications to cerium, $Ce_2O_3$ and Pu2O3with the Hubbard I solver and comparison to DFT +U" data-toggle="popover" href="/theory/bibliography#amadon2012">[Amadon2012]</a>. If  <strong>usedmft</strong>  = 1 and <a class="wikilink codevar-wikilink" href="/variables/gw#nbandkss">nbandkss</a>/=0, then, the DFT+DMFT
calculation is not done and only projections are computed at the end of the
calculation. They can be used by an external code or used to compute the
screened interaction (see variable <a class="wikilink codevar-wikilink" href="/variables/gw#ucrpa">ucrpa</a>).</p>
<h2 id="usepotzero"><strong>usepotzero</strong><a class="headerlink" href="#usepotzero" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> USE POTential ZERO<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to treat adequately the Coulomb interaction, especially in charged cells," data-toggle="popover" href="/topics/Coulomb">topic_Coulomb</a>, <a class="wikilink topic-wikilink" data-tippy-content="How to become convinced that results are numerically correct" data-toggle="popover" href="/topics/Verification">topic_Verification</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [1/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
LiH rocksalt structure with a negative lithium vacancy
test thee potential alignement usepotzero=0,1" data-toggle="popover" href="/tests/v7/Input/t26.abi" target="_blank">t26.abi</a></li>
</ul>
</details>
<p>Fix the convention for the choice of the average value of the Hartree potential, as described in <a class="wikilink citation-wikilink" data-tippy-content="Consistent treatment of charged systems within periodic boundary conditions: The projector augmented-wave and pseudopotential methods revisited" data-toggle="popover" href="/theory/bibliography#bruneval2014">[Bruneval2014]</a>.</p>
<ul>
<li>
<p><strong>usepotzero</strong>  = 0, the usual convention: the smooth potential is set to zero average value.</p>
</li>
<li>
<p><strong>usepotzero</strong>  = 1, the new convention: the all-electron physical potential is set to zero average value.</p>
</li>
<li>
<p><strong>usepotzero</strong>  = 2, the QE/PWscf convention: the potential of equivalent point charges is set to
  zero average value (convention also valid for NC pseudopotentials).</p>
</li>
</ul>
<h2 id="useria"><strong>useria</strong><a class="headerlink" href="#useria" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> USER Integer variable A<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to modify ABINIT behaviour for developers" data-toggle="popover" href="/topics/Dev">topic_Dev</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [1/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test to prepare a SOC conductivity calculation (test v9#t102)
Ground state calculation for 4 Al atoms
The number of bands is unrealistic. This test produces files that are inputs for test 103.
It tests the following parts of the code:
optic_paw_core
Note that, in addition to the psp file, the spinor core wave functions file is needed." data-toggle="popover" href="/tests/v9/Input/t102.abi" target="_blank">t102.abi</a></li>
</ul>
</details>
<p>These are user-definable integers which the user may input and then utilize in
subroutines of his/her own design. They are not used in the official versions
of the ABINIT code, and should ease independent developments (hopefully
integrated in the official version afterwards).
Internally, they are available in the dtset structured datatype, e.g. <code>dtset%useria</code>.</p>
<h2 id="userib"><strong>userib</strong><a class="headerlink" href="#userib" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> USER Integer variable B<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to modify ABINIT behaviour for developers" data-toggle="popover" href="/topics/Dev">topic_Dev</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [0/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
</details>
<p>These are user-definable integers which the user may input and then utilize in
subroutines of his/her own design. They are not used in the official versions
of the ABINIT code, and should ease independent developments (hopefully
integrated in the official version afterwards).
Internally, they are available in the dtset structured datatype, e.g. <code>dtset%useria</code>.</p>
<h2 id="useric"><strong>useric</strong><a class="headerlink" href="#useric" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> USER Integer variable C<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to modify ABINIT behaviour for developers" data-toggle="popover" href="/topics/Dev">topic_Dev</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [0/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
</details>
<p>These are user-definable integers which the user may input and then utilize in
subroutines of his/her own design. They are not used in the official versions
of the ABINIT code, and should ease independent developments (hopefully
integrated in the official version afterwards).
Internally, they are available in the dtset structured datatype, e.g. <code>dtset%useria</code>.</p>
<h2 id="userid"><strong>userid</strong><a class="headerlink" href="#userid" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> USER Integer variable D<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to modify ABINIT behaviour for developers" data-toggle="popover" href="/topics/Dev">topic_Dev</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [0/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
</details>
<p>These are user-definable integers which the user may input and then utilize in
subroutines of his/her own design. They are not used in the official versions
of the ABINIT code, and should ease independent developments (hopefully
integrated in the official version afterwards).
Internally, they are available in the dtset structured datatype, e.g. <code>dtset%useria</code>.</p>
<h2 id="userie"><strong>userie</strong><a class="headerlink" href="#userie" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> USER Integer variable E<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to modify ABINIT behaviour for developers" data-toggle="popover" href="/topics/Dev">topic_Dev</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [0/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
</details>
<p>These are user-definable integers which the user may input and then utilize in
subroutines of his/her own design. They are not used in the official versions
of the ABINIT code, and should ease independent developments (hopefully
integrated in the official version afterwards).
Internally, they are available in the dtset structured datatype, e.g. <code>dtset%useria</code>.</p>
<h2 id="userra"><strong>userra</strong><a class="headerlink" href="#userra" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> USER Real variable A<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to modify ABINIT behaviour for developers" data-toggle="popover" href="/topics/Dev">topic_Dev</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [0/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
</details>
<p>These are user-definable with the same purpose as <a class="wikilink codevar-wikilink" href="/variables/dev#useria">useria</a> and cie.</p>
<h2 id="userrb"><strong>userrb</strong><a class="headerlink" href="#userrb" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> USER Real variable B<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to modify ABINIT behaviour for developers" data-toggle="popover" href="/topics/Dev">topic_Dev</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [0/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
</details>
<p>These are user-definable with the same purpose as <a class="wikilink codevar-wikilink" href="/variables/dev#useria">useria</a> and cie.</p>
<h2 id="userrc"><strong>userrc</strong><a class="headerlink" href="#userrc" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> USER Real variable C<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to modify ABINIT behaviour for developers" data-toggle="popover" href="/topics/Dev">topic_Dev</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [0/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
</details>
<p>These are user-definable with the same purpose as <a class="wikilink codevar-wikilink" href="/variables/dev#useria">useria</a> and cie.</p>
<h2 id="userrd"><strong>userrd</strong><a class="headerlink" href="#userrd" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> USER Real variable D<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to modify ABINIT behaviour for developers" data-toggle="popover" href="/topics/Dev">topic_Dev</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [0/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
</details>
<p>These are user-definable with the same purpose as <a class="wikilink codevar-wikilink" href="/variables/dev#useria">useria</a> and cie.</p>
<h2 id="userre"><strong>userre</strong><a class="headerlink" href="#userre" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> USER Real variable E<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to modify ABINIT behaviour for developers" data-toggle="popover" href="/topics/Dev">topic_Dev</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0.0<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [0/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
</details>
<p>These are user-definable with the same purpose as <a class="wikilink codevar-wikilink" href="/variables/dev#useria">useria</a> and cie.</p>
<h2 id="useylm"><strong>useylm</strong><a class="headerlink" href="#useylm" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> USE YLM (the spherical harmonics)<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to tune the speed and memory usage" data-toggle="popover" href="/topics/TuningSpeedMem">topic_TuningSpeedMem</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1 if <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> == 1,
1 if <a class="wikilink codevar-wikilink" href="/variables/paral#gpu_option">gpu_option</a> &gt; 0,
1 if <a class="wikilink codevar-wikilink" href="/variables/dev#tfkinfunc">tfkinfunc</a> == 1,
0 otherwise.</p>
<p><em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Moderately used, [32/1314] in all abinit tests, [5/178] in abinit tutorials</summary>
<ul>
<li>built-in:  <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands." data-toggle="popover" href="/tests/built-in/Input/testin_wannier90.abi" target="_blank">testin_wannier90.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Test for input variable slk_rankpp" data-toggle="popover" href="/tests/paral/Input/t31.abi" target="_blank">t31.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz.
Ground state with LOBPCG + RMM-DIIS eigensolver and paral_kgb parallelism with 4 MPI procs." data-toggle="popover" href="/tests/paral/Input/t63.abi" target="_blank">t63.abi</a> &hellip;</li>
<li>tutoplugs:  <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use...
example for post-processing mode of ABINIT-Wannier90 with wfk_task" data-toggle="popover" href="/tests/tutoplugs/Input/tw90_7.abi" target="_blank">tw90_7.abi</a> &hellip;</li>
<li>tutorespfn:  <a class="wikilink abifile-wikilink" data-tippy-content="Computation of e-ph matrix g(k,q) along high-symmetry path." data-toggle="popover" href="/tests/tutorespfn/Input/teph4zpr_9.abi" target="_blank">teph4zpr_9.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Linear response function and long-wave magnitudes calculation for Silicon" data-toggle="popover" href="/tests/tutorespfn/Input/tlw_1.abi" target="_blank">tlw_1.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Dynamic Quadrupoles Calculation for GaP" data-toggle="popover" href="/tests/tutorespfn/Input/tlw_4.abi" target="_blank">tlw_4.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Dynamic Quadrupoles Calculation for BaTiO3" data-toggle="popover" href="/tests/v10/Input/t43.abi" target="_blank">t43.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
1. Si diamond. Usual geometry, k points, psps. One of the two
atoms is displaced in order to have non-zeroforces.
Test whether energy and forces (and soon stresses) are correctly
given, even with use of spherical harmonics.
Perform first computation with the use of Legendre polynomials;
Then perform a computation with the use of spherical harmonics.
Both must give the same results." data-toggle="popover" href="/tests/v4/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
2. Generate first-order responses for GaAs (zinc-blende) (from test v2 #98).
Compute responses at Gamma:
1) Ground state calculation, with a k-point sampling in the IBZ only;
2) Computation of the ddk response;
3) Computation of the dynamical matrix at Gamma, as well as the
Born effective charges, and the dielectric tensor ;
Perform five datasets:
* First dataset is the ground state calculation,
* Second dataset compute ddk perturbation
with the use of Legendre Polynomials for the nl operator,
* Third dataset compute phonon and elec. field perturbation
with the use of Legendre Polynomials for the nl operator,
* Fourth dataset compute ddk perturbation
with the use of spherical harmonics for the nl operator,
* Fifth dataset compute phonon and elec. field perturbation
with the use of spherical harmonics for the nl operator.
Datasets 2 and 3 must give the same results as 4 and 5." data-toggle="popover" href="/tests/v4/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si in diamond structure. 2 k points, low ecut.
Perform a test of &quot;Phoney pseudopotential with Hamann grid&quot;,
using spherical harmonics in the computation of the nonlocal
operator.
Perform two datasets:
First dataset with the use of Legendre Polynomials,
Second dataset with the use of spherical harmonics (useylm=1).
Both datasets must give the same results." data-toggle="popover" href="/tests/v4/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>v7:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of phonon linewidths and e-ph coupling parameter lambda." data-toggle="popover" href="/tests/v7/Input/t88.abi" target="_blank">t88.abi</a> &hellip;</li>
<li>v8:  <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of the Fan-Migdal + Debye-Waller self-energy matrix elements in Diamond." data-toggle="popover" href="/tests/v8/Input/t44.abi" target="_blank">t44.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Calculation of velocity matrix elements (DDK) with
optdriver 8 and wfk_task4 &quot;wfk_ddk&quot;." data-toggle="popover" href="/tests/v8/Input/t59.abi" target="_blank">t59.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="GS calculation with the CG + RMM-DIIS eigensolver and NC pseudos" data-toggle="popover" href="/tests/v9/Input/t29.abi" target="_blank">t29.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs, zinc-blende structure.
GS calculation with the CG + RMM-DIIS eigensolver and PAW GGA-PBE pseudos." data-toggle="popover" href="/tests/v9/Input/t30.abi" target="_blank">t30.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="GGA Linear response function and long-wave magnitudes calculation for Silicon" data-toggle="popover" href="/tests/v9/Input/t46.abi" target="_blank">t46.abi</a> &hellip;</li>
<li>wannier90:  <a class="wikilink abifile-wikilink" data-tippy-content="GaAs crystal with few bands. Very quick built-in test, to check that Wannier90 is installed." data-toggle="popover" href="/tests/wannier90/Input/t00.abi" target="_blank">t00.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Gallium Arsenide, zinc-blende. 8 bands. prtwant=2
Should still be completed by the call to wannier90, and subsequent fldiff use..." data-toggle="popover" href="/tests/wannier90/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="The same as in 01 but using PAW." data-toggle="popover" href="/tests/wannier90/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
</ul>
</details>
<p>When this flag is activated, the non-local operator is applied using an
algorithm based on spherical harmonics. Non-local projectors are used with
their usual form:</p>
<div class="arithmatex">\[P_{lmn}(r) = Y_{lm}(r) p_{ln}(r)\]</div>
<p>When  <strong>useylm</strong>  = 0, the sum over <span class="arithmatex">\(Y_{lm}\)</span> can be reduced to a Legendre polynomial form.</p>
<h2 id="vloc_rcut"><strong>vloc_rcut</strong><a class="headerlink" href="#vloc_rcut" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> VLOCal Radial CUToff<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">LENGTH</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to perform numerically precise calculations with planewaves or projector- augmented waves and pseudopotentials" data-toggle="popover" href="/topics/Planewaves">topic_Planewaves</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 6.0<br />
<em>Added in version:</em> 9.8.0  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [1/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Crystalline alpha-quartz: GS calculations with UPF2 pseudos.
Test scalar-relativistic pseudos with useylm 0 and 1." data-toggle="popover" href="/tests/v9/Input/t130.abi" target="_blank">t130.abi</a></li>
</ul>
</details>
<p>This variable defines the cutoff for the radial mesh used to compute <code>epsatm</code>
(the alpha term in the total energy due to the pseudos) and the Bessel transform
for the local part in the case of NC pseudos given in UPF2 format.</p>
<p>This parameter can be used to cut off the numerical noise arising from the large-r tail when integrating V_loc(r) - Z_v/r.
In QE, vloc_rcut is harcoded to 10 Bohr but numerical experiments showed that such value leads to oscillations
in the second order derivatives of the vloc form factors.
For this reason, the default value in Abinit is set to 6.0.</p>
<h2 id="wfoptalg"><strong>wfoptalg</strong><a class="headerlink" href="#wfoptalg" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> WaveFunction OPTimisation ALGorithm<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to select the SCF algorithm" data-toggle="popover" href="/topics/SCFAlgorithms">topic_SCFAlgorithms</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> <a class="wikilink" data-tippy-content="This is an external parameter
typically compilation parameters, available libraries, or number of processors.
You can change these parameters at compile or runtime usually.
" data-toggle="popover" href="/variables/external_parameters#auto_from_psp" title="Means that the value is read from the PSP file">AUTO_FROM_PSP</a><br />
<em>Comment:</em> 0 when <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> = 0 (norm-conserving pseudopotentials), 10 when <a class="wikilink codevar-wikilink" href="/variables/internal#usepaw">%usepaw</a> = 1 (PAW); 114 if <a class="wikilink codevar-wikilink" href="/variables/paral#paral_kgb">paral_kgb</a> = 1.<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Moderately used, [105/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>gpu:  <a class="wikilink abifile-wikilink" data-tippy-content="
GaAs phonons calculation - norm-conserving psp
Test the automatic detection of the GPU and the automatic setting of
gpu_option keyword according to the requested calculation.
Ground-states calculations should be run with gpu_option activated
(except if set to 0 in input file) while response fonction calculations
should be run with gpu_option deactivated (at present : ABINIT v9.10)." data-toggle="popover" href="/tests/gpu/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure
Test the use of GPU within Projector Augmented-Wave formalism.
Test ferromagnetic and non-collinear magnetism.
ABINIT v7.0: GPU is not used when nspinor=2" data-toggle="popover" href="/tests/gpu/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>gpu_kokkos:  <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/gpu_kokkos/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="
Silicon - diamond structure - PAW - volume relaxation
Test the use of GPU within Projector Augmented-Wave formalism.
Test structure relaxation (multiple calls to gstate routine)." data-toggle="popover" href="/tests/gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
NiO - DFT+U - fcc structure - anitferro - PAW
Test the use of MPI+GPU" data-toggle="popover" href="/tests/gpu_omp/Input/t02.abi" target="_blank">t02.abi</a> &hellip;</li>
<li>hpc_gpu_omp:  <a class="wikilink abifile-wikilink" data-tippy-content="Uranim oxide (UO2) - 54 atoms (GGA) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t01.abi" target="_blank">t01.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t02.abi" target="_blank">t02.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="31 gold atoms (one vacancy) - HPC test" data-toggle="popover" href="/tests/hpc_gpu_omp/Input/t03.abi" target="_blank">t03.abi</a> &hellip;</li>
<li>mpiio:  <a class="wikilink abifile-wikilink" data-tippy-content="
Si, Bulk, 2 atoms , paral_kgb.
Test of ground state with different occs(7 and 0),
and also ionmov 2. Only with 0 and 4 procs." data-toggle="popover" href="/tests/mpiio/Input/t21.abi" target="_blank">t21.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
C-diamond, Bulk, 2 atoms, paral_kgb, with PAW.
Test the triple parallelisation.
We cannot check the distribution npband*npfft*np_spkpt=2*2*2=8 processors,
this number being not allowed in the test procedure.
Here, we only test the parallelisation over bands and spins:
npband*npfft*np_spkpt=2*1*2=4 processors.
In addition, we also test here various features of bandfft-kpt parallelisation
In particular, the bandpp, istwfk=2 and wfoptalg=14 variables." data-toggle="popover" href="/tests/mpiio/Input/t25.abi" target="_blank">t25.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Si, Bulk, 2 atoms , parallel IO. Test of ground state
Only with 4 procs, no sequential version (tests accesswf 1)" data-toggle="popover" href="/tests/mpiio/Input/t49.abi" target="_blank">t49.abi</a> &hellip;</li>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (chebfi2). Test atoms not ordered by types. PAW,istwfk=1." data-toggle="popover" href="/tests/paral/Input/t18.abi" target="_blank">t18.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). PAW,istwfk&gt;1,dilatmx&gt;1,npband=4" data-toggle="popover" href="/tests/paral/Input/t19.abi" target="_blank">t19.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare cprj_in_memory=1 with cprj_in_memory=0 (lobpcg2 and chebfi2). PAW,istwfk&gt;1,dilatmx&gt;1,npband=4" data-toggle="popover" href="/tests/paral/Input/t20.abi" target="_blank">t20.abi</a> &hellip;</li>
<li>v10:  <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,NC)." data-toggle="popover" href="/tests/v10/Input/t03.abi" target="_blank">t03.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,PAW)." data-toggle="popover" href="/tests/v10/Input/t04.abi" target="_blank">t04.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Compare chebfi2 with respect to other algorithms (istwfk&gt;1,NC)." data-toggle="popover" href="/tests/v10/Input/t05.abi" target="_blank">t05.abi</a> &hellip;</li>
<li>v3:  <a class="wikilink abifile-wikilink" data-tippy-content="
8 Silicon atoms + 1 interstitial Mg atom.
Try to get the inner bands (close to the Fermi energy),
not the lower ones, thanks to wfoptalg=2.
It works, but it does not seem very efficient.
Still subject of study." data-toggle="popover" href="/tests/v3/Input/t45.abi" target="_blank">t45.abi</a> &hellip;</li>
<li>v4:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test of Ca, simple cubic , 2  k-point. Testing GS  energy and lobpcg algorithm." data-toggle="popover" href="/tests/v4/Input/t93.abi" target="_blank">t93.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test of Ca, simple cubic , 2  k-point.
Testing GS  PAW  energy and lobpcg algorithm." data-toggle="popover" href="/tests/v4/Input/t94.abi" target="_blank">t94.abi</a> &hellip;</li>
<li>v5:  <a class="wikilink abifile-wikilink" data-tippy-content="
Simple test for double grid (fine/coarse) system, the cutting
radius and the initial fermi energy in recursion method
Corresponding variables: recgratio, recrcut,recefermi respectively
Corresponding code: 68_recursion
Other test: paral/tT,v5/t76" data-toggle="popover" href="/tests/v5/Input/t75.abi" target="_blank">t75.abi</a> &hellip;</li>
<li>v9:  <a class="wikilink abifile-wikilink" data-tippy-content="
Test various values of nbdbuf with lobpcg (114)." data-toggle="popover" href="/tests/v9/Input/t201.abi" target="_blank">t201.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="
Test tolwfr_diago with lobpcg (114)." data-toggle="popover" href="/tests/v9/Input/t202.abi" target="_blank">t202.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Simple input (from fast/t03) to test nblock_lobpcg variable" data-toggle="popover" href="/tests/v9/Input/t205.abi" target="_blank">t205.abi</a> &hellip;</li>
</ul>
</details>
<p>Allows one to choose the algorithm for the optimisation of the wavefunctions.
The different possibilities are:</p>
<ul>
<li>
<p><strong>wfoptalg</strong>  = 0: The standard <strong>state-by-state conjugate gradient</strong> algorithm, which does not allow for parallelization over states. A detailed description of this algorithm can be found in <a class="wikilink citation-wikilink" data-tippy-content="Iterative minimization techniques for ab initio total-energy calculations: Molecular dynamics and conjugate gradients" data-toggle="popover" href="/theory/bibliography#payne1992">[Payne1992]</a>.</p>
</li>
<li>
<p><strong>wfoptalg</strong>  = 10:  (For PAW) The standard <strong>state-by-state conjugate gradient</strong> algorithm (as described in <a class="wikilink citation-wikilink" data-tippy-content="Iterative minimization techniques for ab initio total-energy calculations: Molecular dynamics and conjugate gradients" data-toggle="popover" href="/theory/bibliography#payne1992">[Payne1992]</a>) with no parallelization over states. This version includes <strong>modifications</strong> described in <a class="wikilink citation-wikilink" data-tippy-content="Efficient iterative schemes for ab initio total-energy calculations using a plane-wave basis set" data-toggle="popover" href="/theory/bibliography#kresse1996">[Kresse1996]</a>, such as a modified kinetic energy, improved preconditioning, minimal orthogonalization, etc.</p>
</li>
<li>
<p><strong>wfoptalg</strong>  = 2: <strong>Minimization of the residual</strong> with respect to different shifts to cover the entire set of occupied bands. This allows for parallelization over blocks of states (or bands), with the number of states per block defined by <a class="wikilink codevar-wikilink" href="/variables/dev#nbdblock">nbdblock</a>.</p>
<blockquote>
<p>Note: This algorithm is experimental and possibly obsolete.</p>
</blockquote>
</li>
<li>
<p><strong>wfoptalg</strong>  = 3: <strong>Residual minimization</strong> with respect to a shift. This is available only in the non-self-consistent case (<a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> = -2) and is used to find eigenvalues and wavefunctions near a prescribed value.</p>
</li>
<li>
<p><strong>wfoptalg</strong>  = 4 (see also  <strong>wfoptalg</strong>  = 14 or 114): A parallel implementation of the <strong>Locally Optimal Block Preconditioned Conjugate Gradient (LOBPCG)</strong> method, based on <a class="wikilink citation-wikilink" data-tippy-content="Toward the Optimal Preconditioned Eigensolver: Locally Optimal Block Preconditioned Conjugate Gradient Method" data-toggle="popover" href="/theory/bibliography#knyazev2001">[Knyazev2001]</a>. This implementation relies on the Matlab program by Knyazev <a class="wikilink citation-wikilink" data-tippy-content="Block Locally Optimal Preconditioned Eigenvalue Xolvers (BLOPEX) in Hypre and PETSc" data-toggle="popover" href="/theory/bibliography#knyazev2007">[Knyazev2007]</a>. For further details, see <a class="wikilink citation-wikilink" data-tippy-content="Large-scale ab initio calculations based on three levels of parallelization" data-toggle="popover" href="/theory/bibliography#bottin2008">[Bottin2008]</a>.</p>
<blockquote>
<p>Recommendation: use  <strong>wfoptalg</strong>  = 114, which is the modern and improved version of this algorithm.</p>
</blockquote>
</li>
<li>
<p><strong>wfoptalg</strong>  = 14: Similar to  <strong>wfoptalg</strong>  = 4, <strong>Locally Optimal Block Preconditioned Conjugate Gradient (LOBPCG)</strong>, but with two key differences: (1) the preconditioning of block vectors is independent of the kinetic energy of each band, which improves convergence; and (2) orthogonalization after the LOBPCG algorithm is no longer performed, enhancing efficiency.</p>
<blockquote>
<p>Recommendation: use  <strong>wfoptalg</strong>  = 114 for a more modern and optimized version of this algorithm.</p>
</blockquote>
</li>
<li>
<p><strong>wfoptalg</strong>  = 114: A modern and highly efficient version of  <strong>wfoptalg</strong>  = 14 (<strong>Locally Optimal Block Preconditioned Conjugate Gradient</strong>), particularly suited for parallel computations. It performs well with a small number of blocks and can utilize OpenMP if ABINIT is compiled with a multithreaded linear algebra library.</p>
<blockquote>
<p>Note: When using more than one thread, <a class="wikilink codevar-wikilink" href="/variables/paral#npfft">npfft</a> cannot be used.</p>
</blockquote>
</li>
<li>
<p><strong>wfoptalg</strong>  = 1: A spectrum filtering algorithm based on <strong>Chebyshev filtering</strong>, designed for use with a large number of processors. It is suitable when the LOBPCG algorithm no longer scales efficiently. The degree of the polynomial filter can be adjusted with <a class="wikilink codevar-wikilink" href="/variables/gstate#mdeg_filter">mdeg_filter</a> (formerly <a class="wikilink codevar-wikilink" href="/variables/gstate#nline">nline</a>). For more information, see the <a href="/theory/howto_chebfi.pdf">performance guide</a> and <a class="wikilink citation-wikilink" data-tippy-content="Parallel eigensolvers in plane-wave Density Functional Theory" data-toggle="popover" href="/theory/bibliography#levitt2015">[Levitt2015]</a>.</p>
<blockquote>
<p>Recommendation: use  <strong>wfoptalg</strong>  = 111, which is the modern and improved version of this algorithm.
See <strong>notes</strong> in the &rdquo; <strong>wfoptalg</strong>  = 111&rdquo; section.</p>
</blockquote>
</li>
<li>
<p><strong>wfoptalg</strong>  = 111: A <strong>modern and highly efficient version</strong> of  <strong>wfoptalg</strong>  = 1, a spectrum filtering algorithm based on <strong>Chebyshev filtering</strong>, designed for use with a large number of processors. The degree of the polynomial filter can be adjusted with <a class="wikilink codevar-wikilink" href="/variables/gstate#mdeg_filter">mdeg_filter</a> (formerly <a class="wikilink codevar-wikilink" href="/variables/gstate#nline">nline</a>). For more information, see the <a href="/theory/howto_chebfi.pdf">performance guide</a> and <a class="wikilink citation-wikilink" data-tippy-content="Parallel eigensolvers in plane-wave Density Functional Theory" data-toggle="popover" href="/theory/bibliography#levitt2015">[Levitt2015]</a>.</p>
<blockquote>
<p><strong>Notes</strong>:</p>
<ul>
<li>
<p>For more performance, try enabling <a class="wikilink codevar-wikilink" href="/variables/dev#use_gemm_nonlop">use_gemm_nonlop</a> (default on <a class="wikilink" data-tippy-content="This is an external parameter
typically compilation parameters, available libraries, or number of processors.
You can change these parameters at compile or runtime usually.
" data-toggle="popover" href="/variables/external_parameters#gpu" title="True if ABINIT has been compiled using one of the GPU implementations (CUDA, OPENMP_OFFLOAD, KOKKOS)">GPU</a>).</p>
</li>
<li>
<p>This algorithm struggles to converge the last bands, so it is advisable to use slightly more bands than required. When using <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr_diago">tolwfr_diago</a>, it is mandatory to set <a class="wikilink codevar-wikilink" href="/variables/gstate#nbdbuf">nbdbuf</a>.</p>
</li>
<li>
<p>By design, this algorithm cannot use preconditioning and, therefore, cannot handle <a class="wikilink codevar-wikilink" href="/variables/rlx#ecutsm">ecutsm</a>. Consequently, <em>Pulay stresses</em> are not corrected. If stresses are important for the calculation (e.g., when pressure is required), it is necessary to slightly increase the plane-wave cutoff (<a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a>). ## <strong>xc_denpos</strong> </p>
</li>
</ul>
</blockquote>
</li>
</ul>
<p><em>Mnemonics:</em> eXchange-Correlation - DENsity POSitivity value<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the exchange and correlation functionals" data-toggle="popover" href="/topics/xc">topic_xc</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 1e-14<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [1/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Carbon atom
Test the mGGA functionals generating directly XC potentials.
To make the test more portable, we generate GGA-PBE wave functions as starting point.
Similar to test 08, but with smaller acell and ecut.
Without the use of a &quot;large&quot; xc_denpos, Tran-Blaha is hard to converge. Hypothesis : there is a strong non-linear
region, preventing the Anderson method to work effectively.
Note that the default iscf (=7) does not allow to converge with the default xc_denpos !
By contrast, things are much better behaved with xc_denpos on the order of 1.0e-7 ." data-toggle="popover" href="/tests/libxc/Input/t13.abi" target="_blank">t13.abi</a></li>
</ul>
</details>
<p>For the evaluation of the exchange-correlation functionals, the density cannot
be negative, or even too small (e.g. the LDA exchange kernel behaves like the
density at power -(&#8532;), and the density is used at the denominator of
different factors in GGAs and metaGGAs.  <strong>xc_denpos</strong>  is the smallest value
that the density can assume at the time of the evaluation of a XC functional,
in ABINIT. When then computed density drops below  <strong>xc_denpos</strong>  before
attacking the evaluation of the XC functional, then it will be (only for that
purpose) replaced by  <strong>xc_denpos</strong> . Note that the evaluation of the gradients
or other quantities that are density-dependent is performed before this replacement.</p>
<p>It has been observed that the SCF cycle of the Tran-Blaha mGGA can be quite
hard to make converge, for systems for which there is some vacuum. In this
case, setting first <a class="wikilink codevar-wikilink" href="/variables/dev#xc_taupos">xc_taupos</a> to 1.0e-7 &hellip; 1.0e-6, and increasing if necessary  <strong>xc_denpos</strong> 
has been seen to allow good convergence. Of course, this will affect the numerical results somehow,
and one should play a bit with this value to avoid incorrect calculations.</p>
<h2 id="xc_taupos"><strong>xc_taupos</strong><a class="headerlink" href="#xc_taupos" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> eXchange-Correlation - TAU kinetic energy DENsity POSitivity value<br />
<em>Characteristics:</em> <a class="wikilink" href="/guide/abinit#parameters">DEVELOP</a><br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the exchange and correlation functionals" data-toggle="popover" href="/topics/xc">topic_xc</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> <a class="wikilink codevar-wikilink" href="/variables/dev#xc_denpos">xc_denpos</a><br />
<em>Added in version:</em> 9.10.4  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [2/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="Testing TB09 XC functional within PAW approach.
Cristalline silicon
Also testing the following variables:
- xc_taupos : filtering of the kinetic energy density
- getkden   : read KE density from previous dataset
- irdkden   : read KE density from an external file" data-toggle="popover" href="/tests/libxc/Input/t23.abi" target="_blank">t23.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Testing TB09 XC functional within PAW approach.
Cristalline silicon
Also testing the following variables:
- xc_taupos : filtering of the kinetic energy density
- getkden   : read KE density from previous dataset
- irdkden   : read KE density from an external file" data-toggle="popover" href="/tests/libxc/Input/t24.abi" target="_blank">t24.abi</a></li>
</ul>
</details>
<p>For the evaluation of the meta-GGA exchange-correlation functionals,
the kinetic energy density (usually named tau) cannot be negative, or even too small.
 <strong>xc_taupos</strong>  is the smallest value that the kinetic energy density can assume
at the time of the evaluation of a XC functional, in ABINIT.
When then computed kinetic energy density drops below  <strong>xc_taupos</strong>  before
attacking the evaluation of the XC functional, then it will be replaced by <a class="wikilink codevar-wikilink" href="/variables/dev#xc_denpos">xc_denpos</a>.</p>
<p>It has been observed that the SCF cycle using meta-GGA functionals can be quite
hard to make converge, for systems for which there is some vacuum. In this
case, setting  <strong>xc_taupos</strong>  to 1.0e-7 &hellip; 1.0e-6 has been seen to allow good
convergence. Of course, this will affect the numerical results somehow, and
one should play a bit with this value to avoid incorrect calculations.</p>
<h2 id="xc_tb09_c"><strong>xc_tb09_c</strong><a class="headerlink" href="#xc_tb09_c" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> Value of the c parameter in the eXchange-Correlation TB09 functional<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters related to the exchange and correlation functionals" data-toggle="popover" href="/topics/xc">topic_xc</a><br />
<em>Variable type:</em> real<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 99.99<br />
<em>Added in version:</em> before_v9  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [1/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>libxc:  <a class="wikilink abifile-wikilink" data-tippy-content="
Isolated Carbon atom
Test the mGGA functionals generating directly XC potentials.
To make the test more portable, we generate GGA-PBE wave functions as starting point.
Similar to test 08, but with smaller acell and ecut.
Without the use of a &quot;large&quot; xc_denpos, Tran-Blaha is hard to converge. Hypothesis : there is a strong non-linear
region, preventing the Anderson method to work effectively.
Note that the default iscf (=7) does not allow to converge with the default xc_denpos !
By contrast, things are much better behaved with xc_denpos on the order of 1.0e-7 ." data-toggle="popover" href="/tests/libxc/Input/t13.abi" target="_blank">t13.abi</a></li>
</ul>
</details>
<p>The modified Becke-Johnson exchange-correlation functional by
<a class="wikilink citation-wikilink" data-tippy-content="Accurate Band Gaps of Semiconductors and Insulators with a Semilocal Exchange-Correlation Potential" data-toggle="popover" href="/theory/bibliography#tran2009">Tran and Blaha</a> (acronym TB09, used when <a class="wikilink codevar-wikilink" href="/variables/basic#ixc">ixc</a>=-12208, which needs <a class="wikilink codevar-wikilink" href="/variables/gstate#usekden">usekden</a>=1) reads:</p>
<div class="arithmatex">\[ V_x(r) =
c V_x^{BR}(r) +
(3c - 2) \frac{1}{\pi} \sqrt{\frac{5}{12}}
\sqrt{2 \frac{t(r)}{\rho(r)}} \]</div>
<p>where <span class="arithmatex">\(\rho(r)\)</span> is the electron density,
<span class="arithmatex">\(t(r)\)</span> is the kinetic-energy density, and
<span class="arithmatex">\(V_x^{BR}(r)\)</span> is the Becke-Roussel potential.</p>
<p>In this equation the parameter <span class="arithmatex">\(c\)</span> can be evaluated at each SCF step according
to the following equation:</p>
<div class="arithmatex">\[ c = \alpha + \beta
\left( \frac{1}{V_{cell}}
\int_{V_{cell}} \frac{|\nabla \rho(r)|}{\rho(r)}
d^3r \right)^{1/2} \]</div>
<p>The <span class="arithmatex">\(c\)</span> parameter is evaluated thanks to the previous equation when xc_tb09_c is
equal to the &ldquo;magic&rdquo; default value 99.99. The <span class="arithmatex">\(c\)</span> parameter can also be fixed to
some (property-optimized or material-optimized) value by using this variable.</p>
<h2 id="xg_nonlop_option"><strong>xg_nonlop_option</strong><a class="headerlink" href="#xg_nonlop_option" title="Permanent link">&para;</a></h2>
<p><em>Mnemonics:</em> OPTION for XG_NONLOP routines<br />
<em>Mentioned in topic(s):</em> <a class="wikilink topic-wikilink" data-tippy-content="How to tune the speed and memory usage" data-toggle="popover" href="/topics/TuningSpeedMem">topic_TuningSpeedMem</a><br />
<em>Variable type:</em> integer<br />
<em>Dimensions:</em> scalar<br />
<em>Default value:</em> 0<br />
<em>Added in version:</em> 10.2.2  </p>
<details class="note">
<summary>Test list (click to open). Rarely used, [2/1314] in all abinit tests, [0/178] in abinit tutorials</summary>
<ul>
<li>paral:  <a class="wikilink abifile-wikilink" data-tippy-content="Compare xg_nonlop_option=0 and 1 (chebfi2 only). PAW,istwfk=1,npband=4" data-toggle="popover" href="/tests/paral/Input/t35.abi" target="_blank">t35.abi</a>, <a class="wikilink abifile-wikilink" data-tippy-content="Test cprj_in_memory=1 with xg_nonlop_option=0 or 1 (releveant for chebfi2 only). PAW,nspinor=2,npband=4" data-toggle="popover" href="/tests/paral/Input/t38.abi" target="_blank">t38.abi</a></li>
</ul>
</details>
<p>When using <a class="wikilink codevar-wikilink" href="/variables/gstate#cprj_in_memory">cprj_in_memory</a>=1 with <a class="wikilink codevar-wikilink" href="/variables/dev#wfoptalg">wfoptalg</a>==111, the non-local terms of the Hamiltonian (see <a class="wikilink codevar-wikilink" href="/variables/gstate#cprj_in_memory">cprj_in_memory</a>)
can be computed in two different ways, corresponding to  <strong>xg_nonlop_option</strong> =0 or 1.
 <strong>xg_nonlop_option</strong> =0 requires more memory than  <strong>xg_nonlop_option</strong> =1, but much less MPI communications, so it is more efficient.</p>







  
  






                

<!--
Add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
               <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
               <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
               <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li>
            <a href="https://gmatteo.github.io/abinit/about/release-notes/"
               data-toggle="popover" data-tippy-content="About">
               <i class="fa fa-info-circle"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/developers/git_and_gitlab/"
               data-toggle="popover" data-tippy-content="Developers">
               <i class="fa fa-terminal"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/theory/geometry/"
               data-toggle="popover" data-tippy-content="Theory">
               <i class="fa fa-book"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/faq/configuration_and_compilation/"
               data-toggle="popover" data-tippy-content="FAQ">
               <i class="fa fa-graduation-cap"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/tutorial/"
               data-toggle="popover" data-tippy-content="Tutorials">
               <i class="fa fa-file-text-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/variables/"
               data-toggle="popover" data-tippy-content="Variables">
               <i class="fa fa-question"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/topics/features/"
               data-toggle="popover" data-tippy-content="Topics">
               <i class="fa fa-user-circle-o"></i>
            </a>
          </li>
        
          <li>
            <a href=""
               data-toggle="popover" data-tippy-content="User Guides">
               <i class="fa "></i>
            </a>
          </li>
        
        </ul>
      </div>
    </div>
  </div>
</div>

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="footer.title">
      
        <a href="../bse/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Bethe-Salpeter
            </div>
          </div>
        </a>
      
      
        <a href="../dmft/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              DMFT
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 10.4.7</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020-2024 The Abinit Group
            
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/abinit/abinit" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305m-317.51 213.508V175.185l142.739 81.205z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="http://www.facebook.com/abinit.org" target="_blank" rel="noopener" title="www.facebook.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256c0 120 82.7 220.8 194.2 248.5V334.2h-52.8V256h52.8v-33.7c0-87.1 39.4-127.5 125-127.5 16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287v175.9C413.8 494.8 512 386.9 512 256"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/hashtag/abinit" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
</div>
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "header.autohide"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": "10.4.7"}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
  </body>
</html>