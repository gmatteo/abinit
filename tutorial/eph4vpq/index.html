
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Abinit documentation">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <link rel="canonical" href="https://gmatteo.github.io/abinit/tutorial/eph4vpq/">
      
      
        <link rel="prev" href="../eph4zpr/">
      
      
        <link rel="next" href="../eph_legacy/">
      
      
      <link rel="icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.43">
    
    
      
        <title>eph for variational polaron equations - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
    
      
    

    <!--
    IMPORTANT: Don't use boostrap in particular boostrap.css since it comes into conflict with mkdocs-material theme.
    Prefer low-level tools based on Jquery or JS library such as Tippyjs to get the work done.
    -->

    <!-- Jquery from Google CDN -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>
    -->

    <!-- jQuery Modal -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />

    <!-- Tippyjs for popovers https://atomiks.github.io/tippyjs/ -->
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />

    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <!-- MathJax support
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    -->

    <!-- This version is compatible with plotly. -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script>

    <!-- Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "boldsymbol.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // Workaround for bm package. See https://github.com/mathjax/MathJax/issues/1219
                bm: ["{\\boldsymbol #1}",1],
                // Mathcal symbols
                mcL: "{\\mathcal{L}}",
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // Acronyms
                KS: "{\\text{KS}}",
                eph: "{\\text{e-ph}}",
                ee: "{\\text{e-e}}",
                phph: "{\\text{ph-ph}}",
                FM: "{\\text{FM}}",
                DW: "{\\text{DW}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // Symbols commonly used (k-points, eigenvalues ...)
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                bg: "{\\bf g}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kG: "{\\bf k + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                nk: "{n \\kk}",
                mk: "{, \\kk}",
                nks: "{n \\kk\\sigma}",
                mks: "{m \\kk\\sigma}",
                enk: "{\\varepsilon_\\nk}",
                emkq: "{\\varepsilon_{m\\kk+\\qq}}",
                qnu: "{\\qq \\nu}",
                wqnu: "{\\omega_{\\qnu}}",
                vnk: "{\\mathbf{v}_{n\\kk}}",
                vmkq: "{\\mathbf{v}_{m\\kk+\\qq}}",
                vnka: "{\\mathrm{v}_{n\\kk,\\alpha}}",
                vnkb: "{\\mathrm{v}_{n\\kk,\\beta}}",
                ef: "{\\varepsilon_F}",
                // EPH quantities
                gkkp: "{g_{mn\\nu}(\\kk,\\qq)}",
                gkq: "{g_{mn\\nu}(\\kk,\\qq)}",
                //\newcommand{\gkkpL}{g_{mn\nu}^\Lc(\kb,\qb)}
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                Gove: "{\\overline{G}}",
                Gund: "{\\underline{G}}",
                // Greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    

    

    <!-- Load fonts used for input variables -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#self-trapped-polarons-variational-polaron-equations" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="abinit" class="md-header__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            abinit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              eph for variational polaron equations
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../installation/" class="md-tabs__link">
          
  
  User Guides

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../topics/features/" class="md-tabs__link">
          
  
  Topics

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../variables/" class="md-tabs__link">
          
  
  Variables

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../faq/configuration_and_compilation/" class="md-tabs__link">
          
  
  FAQ

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../theory/geometry/" class="md-tabs__link">
          
  
  Theory

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../developers/git_and_gitlab/" class="md-tabs__link">
          
  
  Developers

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../about/release-notes/" class="md-tabs__link">
          
  
  About

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="abinit" class="md-nav__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    abinit
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    User Guides
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            User Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_1" >
        
          
          <label class="md-nav__link" for="__nav_1_1" id="__nav_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Installation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_1">
            <span class="md-nav__icon md-icon"></span>
            Installation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HowTo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_MacOS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MacOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_Ubuntu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ubuntu
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_CentOS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CentOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_EasyBuild/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EasyBuild
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_gpu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GPUs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NewUser
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abitk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abitk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/aim/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aim
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/anaddb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Anaddb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/atdep/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aTDEP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/cut3d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cut3d
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/fold2bloch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fold2Bloch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgddb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mrgddb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgscr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mrgscr
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/multibinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multibinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/optic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/respfn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Respfn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/spacegroup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spacegroup
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Topics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Topics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Topic List
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Abipy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abipy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/APPA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    APPA
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Artificial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Artificial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/aTDEP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aTDEP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomCentered/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AtomCentered
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomManipulator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AtomManipulator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomTypes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AtomTypes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Bader/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bader
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Band2eps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Band2eps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Berry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Berry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BandOcc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BandOcc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BSE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BSE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BoundingProcess/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BoundingProcess
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedDFT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ConstrainedDFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedPol/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ConstrainedPol
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Coulomb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coulomb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CrossingBarriers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CrossingBarriers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CalcUJ/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CalcUJ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/crystal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Crystal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFT%2BU/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFT+U
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DeltaSCF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DeltaSCF
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DensityPotential/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DensityPotential
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Dev/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dev
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFPT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DMFT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DMFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DynamicsMultibinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DynamicsMultibinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EffectiveMass/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EffectiveMass
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EFG/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EFG
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Elastic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Elastic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonInt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ElPhonInt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonTransport/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ElPhonTransport
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecDOS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ElecDOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecBandStructure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ElecBandStructure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ExtFPMD/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ExtFPMD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FileFormats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FileFormats
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FitProcess/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FitProcess
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ForcesStresses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForcesStresses
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FrequencyMeshMBPT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FrequencyMeshMBPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoConstraints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GeoConstraints
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoOpt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GeoOpt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Git/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GSintroduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GSintroduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GW/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWR/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GWR
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWls/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GWls
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Hybrids/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hybrids
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/k-points/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    K points
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeModel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LatticeModel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeWannier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LatticeWannier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LWFModel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LWFModel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LDAminushalf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LDAminushalf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LOTF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LOTF
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/longwave/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Longwave
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Macroave/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Macroave
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagField/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MagField
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagMom/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MagMom
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MolecularDynamics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MolecularDynamics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/multidtset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multidtset
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/NMR/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NMR
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/nonlinear/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nonlinear
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Optic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Output/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Output
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/parallelism/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallelism
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PAW/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PAW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PIMD/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PIMD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Planewaves/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Planewaves
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Phonons/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phonons
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononBands/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PhononBands
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononWidth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PhononWidth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Polaron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Polaron
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PortabilityNonRegression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PortabilityNonRegression
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/positron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Positron
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/printing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Printing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PseudosPAW/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PseudosPAW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/q-points/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Q points
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RandStopPow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RandStopPow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Recursion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Recursion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RPACorrEn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RPACorrEn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RTTDDFT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RTTDDFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFControl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SCFControl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFAlgorithms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SCFAlgorithms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SelfEnergy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SelfEnergy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SmartSymm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SmartSymm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/spinpolarisation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spinpolarisation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SpinDynamicsMultibinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SpinDynamicsMultibinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/STM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    STM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Susceptibility/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Susceptibility
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDDFT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TDDFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDepES/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TDepES
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Temperature/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Temperature
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TransPath/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TransPath
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TuningSpeedMem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TuningSpeedMem
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Unfolding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unfolding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/UnitCell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UnitCell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/vdw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vdw
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Verification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Verification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wannier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wannier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wavelets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wavelets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/xc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Xc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/external_resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    External Resources
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Variables
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Variables
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    All Variables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Abinit
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Abinit
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/basic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/bse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bethe-Salpeter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dev/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dmft/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DMFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/eph/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Electron-Phonon
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/ffield/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Varff
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File-handling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/geo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geometry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/gstate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ground-State
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/gw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/internal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Internal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/paral/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallelism
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/paw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PAW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dfpt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/rlx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Relaxation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/rttddft/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RTTDDFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/vdw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VdW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/w90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wannier90
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/anaddb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Anaddb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/atdep/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aTDEP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/multibinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multibinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/optic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/aim/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aim
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/external_parameters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    External Parameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/varset_stats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Statistics
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Basic tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Basic tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../base1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    basic1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../base2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    basic2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../base3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    basic3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../base4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    basic4
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../abinit_build/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ABINIT_build
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paw1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PAW1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../polarization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Polarization & finite field
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rf1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFPT1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rf2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFPT2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basepar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallelism
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_10" >
        
          
          <label class="md-nav__link" for="__nav_4_10" id="__nav_4_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ABINIT postprocessors
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_10">
            <span class="md-nav__icon md-icon"></span>
            ABINIT postprocessors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../atdep1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aTDEP1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cut3d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cut3D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fold2bloch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fold2bloch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../optic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    optic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wannier90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wannier90
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../z2pack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Z2pack
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_11" >
        
          
          <label class="md-nav__link" for="__nav_4_11" id="__nav_4_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DFT beyond basics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_11">
            <span class="md-nav__icon md-icon"></span>
            DFT beyond basics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nuc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    properties at the nucleus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dftu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFT+U
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ucalc_crpa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cRPA U(J)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lruj/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linear Response U(J)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paw2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PAW2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paw3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PAW3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../positron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    positron
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_12" >
        
          
          <label class="md-nav__link" for="__nav_4_12" id="__nav_4_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Many-Body Theory & excitations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_12">
            <span class="md-nav__icon md-icon"></span>
            Many-Body Theory & excitations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gw1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GW1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gw2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GW2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gwr_intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GWR_intro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gwr1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GWR1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bethe-Salpeter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dmft/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DMFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tddft/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TDDFT (Casida)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rttddft/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RT-TDDFT
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_13" checked>
        
          
          <label class="md-nav__link" for="__nav_4_13" id="__nav_4_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DFPT & electron-phonon
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_13_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_13">
            <span class="md-nav__icon md-icon"></span>
            DFPT & electron-phonon
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../elastic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    elastic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nlo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nonlinear
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lattice_wannier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lattice_wannier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lw_quad/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    quadrupoles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eph_intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph_intro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eph4mob/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph for mobilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eph4zpr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph for zero-point renormalization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    eph for variational polaron equations
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    eph for variational polaron equations
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#formalism" class="md-nav__link">
    <span class="md-ellipsis">
      Formalism
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Formalism">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#self-trapped-polarons" class="md-nav__link">
    <span class="md-ellipsis">
      Self-trapped polarons
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variational-polaron-equations" class="md-nav__link">
    <span class="md-ellipsis">
      Variational Polaron Equations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#typical-workflow-for-self-trapped-polaron-calculations" class="md-nav__link">
    <span class="md-ellipsis">
      Typical workflow for self-trapped polaron calculations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      Getting started
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-extract-useful-info-from-the-output-files" class="md-nav__link">
    <span class="md-ellipsis">
      How to extract useful info from the output files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-merge-partial-ddb-files-with-mrgddb" class="md-nav__link">
    <span class="md-ellipsis">
      How to merge partial DDB files with mrgddb
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-merge-partial-pot-files-with-mrgdv" class="md-nav__link">
    <span class="md-ellipsis">
      How to merge partial POT files with mrgdv
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#computing-the-wfk-files" class="md-nav__link">
    <span class="md-ellipsis">
      Computing the WFK files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#small-hole-polaron-computing-the-gstore-files" class="md-nav__link">
    <span class="md-ellipsis">
      Small hole polaron: computing the GSTORE files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#small-hole-polaron-variational-optimization-of-binding-energy" class="md-nav__link">
    <span class="md-ellipsis">
      Small hole polaron: variational optimization of binding energy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#small-hole-polaron-extrapolation-to-the-infinite-size-supercell" class="md-nav__link">
    <span class="md-ellipsis">
      Small hole polaron: extrapolation to the infinite-size supercell
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#small-hole-polaron-multiple-states-and-visualiziation" class="md-nav__link">
    <span class="md-ellipsis">
      Small hole polaron: multiple states and visualiziation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#large-electron-polaron" class="md-nav__link">
    <span class="md-ellipsis">
      Large electron polaron
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eph_legacy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph_legacy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eph_tdep_legacy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph_tdep_legacy
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_14" >
        
          
          <label class="md-nav__link" for="__nav_4_14" id="__nav_4_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Multibinit
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_14">
            <span class="md-nav__icon md-icon"></span>
            Multibinit
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../multibinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    introduction to multibinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lattice_model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lattice_model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spin_model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spin_model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lwf_model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lwf_model
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_15" >
        
          
          <label class="md-nav__link" for="__nav_4_15" id="__nav_4_15_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Advanced parallelism
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_15">
            <span class="md-nav__icon md-icon"></span>
            Advanced parallelism
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paral_bandpw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_band_PW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paral_gswvl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_wavelets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paral_moldyn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_MD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paral_images/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_images
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paral_dfpt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_DFPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paral_mbt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_MBPT
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            FAQ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/configuration_and_compilation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration and compilation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/general_questions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General questions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/pre_and_post_processing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pre/Post processing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/ground_state/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ground state
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/dfpt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/Troubleshooting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Troubleshooting (old-dokuwiki)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/tuning_abinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tuning (old-dokuwiki)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Theory
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Theory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/geometry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geometry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/spherical_harmonics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spherical Harmonics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/wavefunctions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wavefunctions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/noncollinear/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Noncollinear
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/pseudopotentials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pseudopotentials
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/mbt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Many-Body Perturbation Theory
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bethe-Salpeter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/documents/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Documents
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acknowledgments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Acknowledgments
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bibliography/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bibliography
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acronyms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Acronyms
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Developers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Developers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/git_and_gitlab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git and Gitlab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/developers_howto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HowTo for developers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/abimkdocs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abimkdocs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/markdown/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Markdown
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_5" >
        
          
          <label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Test Suite
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_5">
            <span class="md-nav__icon md-icon"></span>
            Test Suite
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test list
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite_howto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Suite Howto
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/new_testsuite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YAML-based test suite Howto
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/yaml_tools_api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YAML-based test suite Python tools and API
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/XgType/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XgType
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_7" >
        
          
          <label class="md-nav__link" for="__nav_7_7" id="__nav_7_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pseudos
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_7">
            <span class="md-nav__icon md-icon"></span>
            Pseudos
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp1_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp3_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp45_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp45
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp5spinorbit_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp5
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp6_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp6
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp8_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp8
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/codestats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code stats
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/autoconf_examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Autoconf_examples
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testlink/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Page for linkcheck
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    About
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            About
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/release-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release Notes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/history/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    History
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#formalism" class="md-nav__link">
    <span class="md-ellipsis">
      Formalism
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Formalism">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#self-trapped-polarons" class="md-nav__link">
    <span class="md-ellipsis">
      Self-trapped polarons
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variational-polaron-equations" class="md-nav__link">
    <span class="md-ellipsis">
      Variational Polaron Equations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#typical-workflow-for-self-trapped-polaron-calculations" class="md-nav__link">
    <span class="md-ellipsis">
      Typical workflow for self-trapped polaron calculations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      Getting started
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-extract-useful-info-from-the-output-files" class="md-nav__link">
    <span class="md-ellipsis">
      How to extract useful info from the output files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-merge-partial-ddb-files-with-mrgddb" class="md-nav__link">
    <span class="md-ellipsis">
      How to merge partial DDB files with mrgddb
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-merge-partial-pot-files-with-mrgdv" class="md-nav__link">
    <span class="md-ellipsis">
      How to merge partial POT files with mrgdv
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#computing-the-wfk-files" class="md-nav__link">
    <span class="md-ellipsis">
      Computing the WFK files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#small-hole-polaron-computing-the-gstore-files" class="md-nav__link">
    <span class="md-ellipsis">
      Small hole polaron: computing the GSTORE files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#small-hole-polaron-variational-optimization-of-binding-energy" class="md-nav__link">
    <span class="md-ellipsis">
      Small hole polaron: variational optimization of binding energy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#small-hole-polaron-extrapolation-to-the-infinite-size-supercell" class="md-nav__link">
    <span class="md-ellipsis">
      Small hole polaron: extrapolation to the infinite-size supercell
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#small-hole-polaron-multiple-states-and-visualiziation" class="md-nav__link">
    <span class="md-ellipsis">
      Small hole polaron: multiple states and visualiziation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#large-electron-polaron" class="md-nav__link">
    <span class="md-ellipsis">
      Large electron polaron
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                

                  

  
  


<h1 id="self-trapped-polarons-variational-polaron-equations">Self-trapped polarons &amp; Variational Polaron Equations<a class="headerlink" href="#self-trapped-polarons-variational-polaron-equations" title="Permanent link">&para;</a></h1>
<p>This tutorial provides a guide on using the Variational Polaron Equations framework to compute
self-trapped polarons in semiconductors and insulators.</p>
<p>We start with a brief overview of the self-trapped polaron formation problem, followed by an
introducion to the theoretical formalism of the Variational Polaron Equations.
Then we demonstrate the practical aspects of computation of various polaronc properties using
small hole and large electron polarons in LiF as examples.
We also showcase the capabilities of <a href="https://github.com/abinit/abipy">AbiPy</a>  to post-process the results and perform typical
convergence studies.</p>
<p>It is assumed the user has already completed the two tutorials <a href="/tutorial/rf1">RF1</a> and <a href="/tutorial/rf2">RF2</a>,
and that they are familiar with the calculation of ground state (GS) and response properties
in particular phonons, Born effective charges and the high-frequency dielectric tensor.
The user should have read the <a href="/tutorial/eph_intro">introduction tutorial for the EPH code</a>
before running these examples.</p>
<p>This lesson should take about 2 hours.</p>
<h2 id="formalism">Formalism<a class="headerlink" href="#formalism" title="Permanent link">&para;</a></h2>
<h3 id="self-trapped-polarons"><strong>Self-trapped polarons</strong><a class="headerlink" href="#self-trapped-polarons" title="Permanent link">&para;</a></h3>
<p>In many condensed matter systems, interaction with phonons leads to the formation of <strong>polarons</strong>,
when a particle couples to the lattice vibrations of a system.
Instead of a free particle, it becomes a <strong>quasiparitcle</strong> with altered physical properties &ndash; a polaron.
In general, this notion applies to any particle irrespective of its type and statistics: electrons, holes,
excitions, magnons and so on.
In the present formalism, we treat only <strong>electron</strong> and <strong>hole polarons</strong>, which formation is mediated by the <strong>electron-phonon coupling</strong>.</p>
<p>Depending on the strenght of the electron-phonon coupling, one can distinguish different regimes.
In the weak-coupling limit, a charge carrier is coherent with phonon oscillations, dragging the associated phonon cloud.
This primarily leads to the band renormalization, and the physics can be captured by the <a href="/tutorial/eph4zpr">ZPR calculations</a>.
In the limit of strong-coupling, the picture is different: a carrier is trapped in the potential well, created by lattice deformation
&ndash; a phenomena called self-trapping or autolocalization.
This leads to the occurence of a localized polaronic state inside the bandgap, and may switch the transport regime from a band-like to hopping transport.
The intermediate regime between the strong-coupling and the weak-coupling limit is the most challenging to address and requires advanced techniques.
In the present formalism, we treat only the <strong>strong-coupling</strong> regime of polaron formation, i.e. <strong>self-trapped polarons</strong>.</p>
<p>The probabilty of a self-trapped electron or hole polaron formation can be described by its <strong>binding energy</strong>:</p>
<div class="arithmatex">\[\begin{equation}
\label{eq:epol}
    E_\mathrm{pol} = E\left( N \pm 1, \Delta \mathbf{\tau} \right) - E\left( N \pm 1, \Delta \mathbf{\tau} \equiv 0 \right),
\end{equation}\]</div>
<p>which is the difference of total energy of a charged system with <span class="arithmatex">\(N \pm 1\)</span> electrons in the <strong>distorted</strong> polaronic geometry and the pristine one.
Here, the lattice distortion is denoted by <span class="arithmatex">\(\Delta \tau\)</span> &ndash; collective atomic displacements from their equilibrium positions.
A stable polaronic configuration corresponds to <span class="arithmatex">\(E_\mathrm{pol} &lt; 0\)</span>.</p>
<p>Schematically, it can be illustrated by the following configurational diagram for total energy of a system
with <span class="arithmatex">\(N\pm1\)</span> electrons as a function of lattice distortion.</p>
<p><img alt="" src="../eph4vpq_assets/epol.png" /></p>
<p>This figure also contains some foreshadowing as it uses LiF to illustrate both configurations
of an extra electron in the system: delocalized and polaronic one.
By the end of the tutorial, the user will learn how to generate such figures themselves.</p>
<p>From the configurational diagram, it is seen that <span class="arithmatex">\(E_\mathrm{pol}\)</span> can be decomposed into two contributions:
the <strong>phonon energy</strong> <span class="arithmatex">\(E_\mathrm{ph}\)</span> arising purely from the lattice distortion, and the <strong>charge localization energy</strong> <span class="arithmatex">\(\varepsilon_\mathrm{loc}\)</span>,
which accounts for both electronic contribution and electron-phonon coupling.
Physically, the latter term corresponds to the energy of the localized polaronic state inside the bandgap, computed from the VBM/CBM in case of hole/electron polaron.</p>
<p>During the tutorial, the aformentioned quantities and other properties, characterizing the polaron formation, are computed within a Variational Polaron Equations, implemented in ABINIT.</p>
<h3 id="variational-polaron-equations"><strong>Variational Polaron Equations</strong><a class="headerlink" href="#variational-polaron-equations" title="Permanent link">&para;</a></h3>
<p>In DFT, the common approach to the polaronic problem is a direct geometry relaxation of a charged system with a compensating jellium background.
This approach is powerful and straightforward, but requires supercell calculations,
making it prohibitive for polarons with large spatial extension.
Also, standard DFT favors delocalization due the self-interaction, and self-interaction corrections
and special approaches have to be used to localize polarons <a class="wikilink citation-wikilink" data-tippy-content="Polarons free from many-body self-interaction in density functional theory" data-toggle="popover" href="/theory/bibliography#falletta2022">[Falletta2022]</a>.</p>
<p>However, it possible to avoid the need of charged supercell relaxation by reformulating the problem of polaron formation in reciprocal space.
This formalism was presented by Sio and coworkers in 2019 <a class="wikilink citation-wikilink" data-tippy-content="Ab initiotheory of polarons: Formalism and applications" data-toggle="popover" href="/theory/bibliography#sio2019">[Sio2019]</a>, and required the solution of
an effective polaronic Hamiltionian, parametrized from first-principles calculations.
For the underlying theory behind this formalism and derivations, the user may be interested to consult the original paper.</p>
<p>We take on the approach presented by Sio and coworkers, albeit we reformulate it into a <strong>variational</strong> form.
We refer to this formalism as <strong>Variational Polaron Equations</strong> or, simply, <strong>VarPEq</strong>.
The derivations of our formalism and relevant discussions can be found in <a class="wikilink citation-wikilink" data-tippy-content="Variational Polaron Equations Applied to the Anisotropic Frohlich Model" data-toggle="popover" href="/theory/bibliography#vasilchenko2022">[Vasilchenko2022]</a>.
In this approach, we utilize a variational expression for the polaron binding energy, enabling the application of efficient gradient-based optimization techniques.
Moreover, as we demonstrate in the tutorial, explicit treatment of the gradient allows us to probe systems for multiple degenerate polaronic states.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>In what follows, we assume uniform, equal and <span class="arithmatex">\(\Gamma\)</span>-centred <span class="arithmatex">\(\kk\)</span>- and <span class="arithmatex">\(\qq\)</span>-meshes
for electron and phonon subspace.
However, in principle, it is enough for these meshes to be commensurate.</p>
</div>
<p>The polaron formation is modeled in reciprocal space, where the BvK supercell is represented by the correspnding
<span class="arithmatex">\(\kk\)</span>-sampling of the Brillouin Zone, i.e. a <span class="arithmatex">\(2\times2\times2\)</span> <span class="arithmatex">\(\kk\)</span>-mesh corresponds to a <span class="arithmatex">\(2\times2\times2\)</span> supercell.
The polaron binding energy in a supercell of size <span class="arithmatex">\(N_p\)</span> is given by the variational expression</p>
<div class="arithmatex">\[\begin{equation}
\label{eq:varpeq}
    E_\mathrm{pol} \left( \boldsymbol{A}, \boldsymbol{B}  \right)
    = E_\mathrm{el} \left( \boldsymbol{A} \right)
    + E_\mathrm{ph} \left( \boldsymbol{B}  \right)
    + E_\mathrm{el\text{-}ph} \left( \boldsymbol{A}, \boldsymbol{B}  \right),
\end{equation}\]</div>
<p>where</p>
<div class="arithmatex">\[\begin{equation}
\label{eq:varpeq_el}
    E_\mathrm{el} \left( \boldsymbol{A} \right)
    = \frac{1}{N_p} \sum_{n\mathbf{k}}
    | A_{n\mathbf{k}} |^2
    \left( \varepsilon_{n\mathbf{k}} -
    \varepsilon_\mathrm{loc} \right)
    + \varepsilon_\mathrm{loc},
\end{equation}\]</div>
<div class="arithmatex">\[\begin{equation}
\label{eq:varpeq_ph}
    E_\mathrm{ph} \left( \boldsymbol{B} \right)
    = \frac{1}{N_p} \sum_{\mathbf{q}\nu}
    | B_{\mathbf{q}\nu} |^2
    \omega_{\mathbf{q}\nu},
\end{equation}\]</div>
<div class="arithmatex">\[\begin{equation}
\label{eq:varpeq_elph}
    E_\mathrm{el-ph} \left( \boldsymbol{A}, \boldsymbol{B} \right)
    = -\frac{1}{N_p^2} \sum_{\substack{mn\nu \\ \mathbf{kq}}}
    A^\ast_{m\mathbf{k+q}}
    B^\ast_{\mathbf{q}\nu} g_{mn\nu}(\mathbf{k, q})
    A_{n\mathbf{k}} + \mathrm{(c.c)}
\end{equation}\]</div>
<p>are the electronic, phonon and electron-phonon contribution to the binding energy, respectively.</p>
<p>In Eqs. (\ref{eq:varpeq}-\ref{eq:varpeq_elph}), <span class="arithmatex">\(\boldsymbol{A} \equiv \left\{ A_{n\mathbf{k}} \right\}\)</span> and <span class="arithmatex">\(\boldsymbol{B} \equiv \left\{ B_{\mathbf{q}\nu} \right\}\)</span>
are the variational coefficients, defining the polaron wavefunction <span class="arithmatex">\(\phi(\mathbf{r})\)</span> (charge localization) and lattice distortion <span class="arithmatex">\(\Delta \tau_{\kappa \alpha p}\)</span> as</p>
<div class="arithmatex">\[\begin{equation}
\label{eq:polaron_phi}
    \phi (\mathbf{r})
    =
    \frac{1}{\sqrt{N_p}}
    \sum_{n\mathbf{k}} A_{n\mathbf{k}} \psi_{n\mathbf{k}} (\mathbf{r}),
\end{equation}\]</div>
<p>and</p>
<div class="arithmatex">\[\begin{equation}
\label{eq:polaron_tau}
    \Delta \tau_{\kappa \alpha p} = - \frac{2}{N_p} \sum_{\mathbf{q}\nu}
    B^\ast_{\mathbf{q}\nu} \sqrt{ \dfrac{1}{2M_{\kappa}\omega_{\mathbf{q}\nu}} } e_{\kappa \alpha, \nu}(\mathbf{q}) e^{i\mathbf{q}\cdot\mathbf{R}_p}.
\end{equation}\]</div>
<p>Charge localization <span class="arithmatex">\(\varepsilon_\mathrm{loc}\)</span> is represented by the Lagrange multiplier that takes into account the normalization of the polaron wavefunction</p>
<div class="arithmatex">\[\begin{equation}
    \sum_{n\mathbf{k}} |A_{n\mathbf{k}}|^2 = N_p
\end{equation}\]</div>
<p>Eqs. (\ref{eq:varpeq}-\ref{eq:polaron_tau}) depend on the input paramters, that can be computed within a unit cell of a system:</p>
<ul>
<li>electronic bands <span class="arithmatex">\(\varepsilon_{n\mathbf{k}}\)</span> and Kohn-Sham wavefunctions <span class="arithmatex">\(\psi_{n\mathbf{k}}\)</span>;</li>
<li>phonon dispersion <span class="arithmatex">\(\omega_{\mathbf{q}\nu}\)</span> and eigenmodes <span class="arithmatex">\(e_{\kappa \alpha, \nu}(\mathbf{q})\)</span>;</li>
<li>electron-phonon matrix elements <span class="arithmatex">\(g_{mn\nu}(\mathbf{k, q})\)</span>.</li>
</ul>
<p>The variational expression can be optimized self-consistently.
At any charge distribution <span class="arithmatex">\(\boldsymbol{A}\)</span>, one can calculate the optimal deformation potential as</p>
<div class="arithmatex">\[\begin{equation} \label{eq:phgrad}
    B_{\mathbf{q}\nu} \left( \boldsymbol{A} \right)
    = \frac{1}{N_p}\sum_{mn\mathbf{k}}
    A^\ast_{m\mathbf{k+q}}
    \frac{g_{mn\nu}(\mathbf{k, q})}{\omega_{\mathbf{q}\nu}}
    A_{n\mathbf{k}}.
\end{equation}\]</div>
<p>Then, the optimal charge localization is given by the Lagrange multiplier</p>
<div class="arithmatex">\[\begin{equation}
    \varepsilon_{\rm loc}
    \left( \boldsymbol{A}, \boldsymbol{B} \right)
    = \frac{1}{N_p}
    \sum_{n\mathbf{k}} | A_{n\mathbf{k}} |^2 \varepsilon_{n\mathbf{k}}
    - \frac{1}{N_p^2} \sum_{\substack{mn\nu \\ \mathbf{kq}}}
    \left(
    A^*_{m\mathbf{k+q}}
    B^*_{\mathbf{q}\nu} g_{mn\nu}(\mathbf{k}, \mathbf{q})
    A_{n\mathbf{k}} + \text{c.c.}
    \right).
\end{equation}\]</div>
<p>The gradient of <span class="arithmatex">\(E_\mathrm{pol}\)</span> with respect to the electronic degrees of freedom is then obtained as</p>
<div class="arithmatex">\[\begin{equation}
\begin{split}
    D_{n\mathbf{k}} \bigl( \boldsymbol{A}, \boldsymbol{B}, \varepsilon_{\rm loc} \bigr)
    = &amp; \frac{2}{N_p} A_{n\mathbf{k}}
    \left( \varepsilon_{n\mathbf{k}} - \varepsilon_{\rm loc} \right) \\
    &amp; - \frac{2}{N_p^2}
    \sum_{m\nu\mathbf{q}}
    A_{m\mathbf{k-q}}
    B^\ast_{\mathbf{q}\nu} g_{nm\nu}(\mathbf{k-q}, \mathbf{q})
    +
    A_{m\mathbf{k+q}}
    B_{\mathbf{q}\nu} g^\ast_{mn\nu}(\mathbf{k}, \mathbf{q}).
\end{split}
\label{eq:elgrad}
\end{equation}\]</div>
<p>From this gradient, a new charge distribution <span class="arithmatex">\(\boldsymbol{A}\)</span> can be determined.
Eqs. (\ref{eq:phgrad}-\ref{eq:elgrad}) constitute the building blocks of any gradient-based algorithm for the binding energy optimization.
In ABINIT, we employ the preconditioned conjugate gradient algorithm <a class="wikilink citation-wikilink" data-tippy-content="Iterative minimization techniques for ab initio total-energy calculations: Molecular dynamics and conjugate gradients" data-toggle="popover" href="/theory/bibliography#payne1992">[Payne1992]</a>.
After the variational expression is minimized, the optimal <span class="arithmatex">\(\boldsymbol{A}\)</span> and <span class="arithmatex">\(\boldsymbol{B}\)</span> coefficients are determined and
the polaron in real space can be reconstructed via Eqs. (\ref{eq:polaron_phi}),(\ref{eq:polaron_tau}).
Schematically, the optimization process is described in the following chart:</p>
<p><img alt="" src="../eph4vpq_assets/flow.png" style="width:600px" /></p>
<h2 id="typical-workflow-for-self-trapped-polaron-calculations">Typical workflow for self-trapped polaron calculations<a class="headerlink" href="#typical-workflow-for-self-trapped-polaron-calculations" title="Permanent link">&para;</a></h2>
<p>As the description of the VarPEq formalism suggests, prior to the actual polaron calculations,
one needs to obtain the required input parameters,
describing the electronic and phonon subspaces, and the electron-phonon coupling.</p>
<p>A typical workflow for self-trapped polaron calculations involves the following steps
(see the <a href="/tutorial/eph_intro">introductory e-ph tutorial</a>):</p>
<ol>
<li>
<p><strong>GS calculation</strong> to obtain the WFK and the DEN file.
   The <span class="arithmatex">\(\kk\)</span>-mesh should be dense enough to converge both electronic and vibrational properties.</p>
</li>
<li>
<p><strong>DFPT calculations</strong> for all the IBZ <span class="arithmatex">\(\qq\)</span>-points corresponding to the <em>ab-initio</em> <a class="wikilink codevar-wikilink" href="/variables/eph#ddb_ngqpt">ddb_ngqpt</a> mesh
   that will be used to perform the Fourier interpolation of the dynamical matrix and of the DFPT potentials.
   In the simplest case, one uses a <span class="arithmatex">\(\qq\)</span>-mesh that is equal to the GS <span class="arithmatex">\(\kk\)</span>-mesh (sub-meshes are also fine)
   and the DFPT calculations can directly start from the WFK produced in step #1.
   Remember to compute <span class="arithmatex">\(\bm{\epsilon}^{\infty}\)</span>, <span class="arithmatex">\(\bm{Z}^*\)</span> (polar materials) and the dynamical quadrupoles
   <span class="arithmatex">\(\bm{Q}^*\)</span> as these quantities are needed for an accurate interpolation of phonon frequencies and DFPT potentials.</p>
</li>
<li>
<p><strong>NSCF computation</strong> of a WFK file on a much denser <span class="arithmatex">\(\kk\)</span>-mesh representing a BvK supercell hosting a polaron.
   The NSCF run uses the DEN file produced in step #1.
   Compute <strong>at least one</strong> unnocupied electronic state, so later on the code can check if a system has a gap.</p>
</li>
<li>
<p><strong>Merge the partial DDB and POT files</strong> with <em>mrgddb</em> and <em>mrgdv</em>, respectively.</p>
</li>
<li>
<p><strong>Compute a GSTORE file</strong> with <a class="wikilink codevar-wikilink" href="/variables/eph#eph_task">eph_task</a> 11.
   This step performs the interpolation of phonon frequencies and DFPT potentials and computes the electron-phonon
   matrix elements <span class="arithmatex">\(g_{mn\nu}(\mathbf{k,q})\)</span> on an arbitrary <a class="wikilink codevar-wikilink" href="/variables/eph#eph_ngqpt_fine">eph_ngqpt_fine</a> <span class="arithmatex">\(\mathbf{q}\)</span>-mesh for a set
   of bands <a class="wikilink codevar-wikilink" href="/variables/eph#gstore_brange">gstore_brange</a> or within an energy window <a class="wikilink codevar-wikilink" href="/variables/eph#gstore_erange">gstore_erange</a> near the band edge.
   The resulting GSTORE.nc <strong>is mandatory</strong> for VarPEq calculations.</p>
</li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>GSTORE computation requires ABINIT to be configured with support for parallel I/O for HDF5 and NetCDF libraries.
See, for example, the corresponding section in the installation <a href="/tutorial/abinit_build">tutorial</a></p>
<p>To verify, whether the installed libraries and ABINIT support the parallel I/O, try issuing</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span>h5pcc<span class="w"> </span>-showconfig<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;Parallel HDF5&quot;</span>
<span class="w">    </span>nc-config<span class="w"> </span>--has-parallel
<span class="w">    </span>abinit<span class="w"> </span>-b<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;Parallel I/O&quot;</span>
</code></pre></div>
<p>If any of these commands gives you a negative prompt, your installation may not work properly.</p>
</div>
<ol start="6">
<li>
<p>Start from the WFK, DDB and GSTORE.nc files produced in steps #3-5
   to perform <strong>VarPEq calculations</strong> with <a class="wikilink codevar-wikilink" href="/variables/eph#eph_task">eph_task</a> 13.</p>
</li>
<li>
<p><strong>Visualize polaron wavefuction and displacements</strong> using the VPQ.nc file produced in step #6
   and <a class="wikilink codevar-wikilink" href="/variables/eph#eph_task">eph_task</a> -13.</p>
</li>
</ol>
<h2 id="getting-started">Getting started<a class="headerlink" href="#getting-started" title="Permanent link">&para;</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Supposing you made your own installation of ABINIT, the input files to run the examples
are in the <em>~abinit/tests/</em> directory where <em>~abinit</em> is the <strong>absolute path</strong> of the abinit top-level directory.
If you have NOT made your own install, ask your system administrator where to find the package,
especially the executable and test files.</p>
<p>In case you work on your own PC or workstation, to make things easier, we suggest you define
some handy environment variables by executing the following lines in the terminal:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">ABI_HOME</span><span class="o">=</span>Replace_with_absolute_path_to_abinit_top_level_dir<span class="w"> </span><span class="c1"># Change this line</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/src/98_main/:<span class="nv">$PATH</span><span class="w">      </span><span class="c1"># Do not change this line: path to executable</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">ABI_TESTS</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/tests/<span class="w">             </span><span class="c1"># Do not change this line: path to tests dir</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">ABI_PSPDIR</span><span class="o">=</span><span class="nv">$ABI_TESTS</span>/Pspdir/<span class="w">  </span><span class="c1"># Do not change this line: path to pseudos dir</span>
</code></pre></div>
<p>Examples in this tutorial use these shell variables: copy and paste
the code snippets into the terminal (<strong>remember to set ABI_HOME first!</strong>) or, alternatively,
source the <code>set_abienv.sh</code> script located in the <em>~abinit</em> directory:</p>
<div class="highlight"><pre><span></span><code><span class="nb">source</span><span class="w"> </span>~abinit/set_abienv.sh
</code></pre></div>
<p>The &lsquo;export PATH&rsquo; line adds the directory containing the executables to your <a href="http://www.linfo.org/path_env_var.html">PATH</a>
so that you can invoke the code by simply typing <em>abinit</em> in the terminal instead of providing the absolute path.</p>
<p>To execute the tutorials, create a working directory (<code>Work*</code>) and
copy there the input files of the lesson.</p>
<p>Most of the tutorials do not rely on parallelism (except specific <a class="wikilink lesson-wikilink" href="/tutorial/basepar">tutorials on parallelism</a>).
However you can run most of the tutorial examples in parallel with MPI, see the <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a parallel calculation" data-toggle="popover" href="/topics/parallelism">topic on parallelism</a>.</p>
</div>
<p>Before beginning, you might consider to work in a different subdirectory as for the other tutorials.
Why not create Work_eph4vpq in $ABI_TESTS/tutorespfn/Input?</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span><span class="nv">$ABI_TESTS</span>/tutorespfn/Input
mkdir<span class="w"> </span>Work_eph4vpq
<span class="nb">cd</span><span class="w"> </span>Work_eph4vpq
</code></pre></div>
<p>In this tutorial, we prefer to focus on the use of the EPH code hence
we will be using <strong>precomputed</strong> DDB and POT files to bypass the DFPT part.
We also provide a DEN.nc file to initialize the NSCF calculations and a GSR.nc file
with electronic bands on a <span class="arithmatex">\(\kk\)</span>-path for <a href="https://github.com/abinit/abipy">AbiPy</a>  post-processing.</p>
<p>If <em>git</em> is installed on your machine, one can easily fetch the entire repository (29 MB) with:</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/abinit/LiF_eph_varpeq.git
</code></pre></div>
<p>Alternatively, use <em>wget</em>:</p>
<div class="highlight"><pre><span></span><code>wget<span class="w"> </span>https://github.com/abinit/LiF_eph_varpeq/archive/master.zip
</code></pre></div>
<p>or <em>curl</em>:</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-L<span class="w"> </span>https://github.com/abinit/LiF_eph_varpeq/archive/master.zip<span class="w"> </span>-o<span class="w"> </span>master.zip
</code></pre></div>
<p>or simply copy the tarball by clicking the &ldquo;download button&rdquo; available in the github web page,
unzip the file and rename the directory with:</p>
<div class="highlight"><pre><span></span><code>unzip<span class="w"> </span>master.zip
mv<span class="w"> </span>LiF_eph_varpeq-master<span class="w"> </span>LiF_eph_varpeq
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The directory with the precomputed files must be located in the same working directory
in which you will be executing the tutorial and must be named <code>LiF_eph_varpeq</code>.</p>
</div>
<p>The script used to precompute the files is available <a href="https://github.com/abinit/LiF_eph_varpeq/blob/main/run.sh">here</a>,
with the necessary <code>*abi</code> files provided in the same repository.</p>
<p>Note that several parameters have been tuned to reach a reasonable <strong>compromise between accuracy
and computational cost</strong> so do not expect the results obtained at the end of the lesson to be fully converged.
More specifically, we use norm-conserving pseudopotentials with a cutoff energy <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a>
of 30 Ha (too low, it should be ~45 Ha).
The DFPT computations is done for the set of irreducible <span class="arithmatex">\(\qq\)</span>-points corresponding
to a <span class="arithmatex">\(\Gamma\)</span>-centered 3x3x3 <span class="arithmatex">\(\qq\)</span> mesh (again, too coarse, it should be 6x6x6 for <em>ab initio</em> <span class="arithmatex">\(\mathbf{k/q}\)</span>-meshes).
<span class="arithmatex">\(\bm{Z}^*\)</span> and <span class="arithmatex">\(\bm{\ee}^\infty\)</span> are also computed with the same underconverged settings.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Note that there is no computation of quadrupoles <span class="arithmatex">\(\boldsymbol{Q}\)</span>, as we use LiF
as a prototypical insulator for polaron calculations.
In systems with Fm<span class="arithmatex">\(\overline{3}\)</span>m space group, <span class="arithmatex">\(\boldsymbol{Q} \equiv 0\)</span> by symmetry.</p>
<p>To check if a system has non-zero quadrupole, one can use the following command:</p>
<div class="codehilite"><pre><span></span><code>abistruct.py has_quad FILE
</code></pre></div>

<p>where FILE is any file providing a structure in ABINIT format (e.g. netcdf output files or .abi files)</p>
</div>
<h2 id="how-to-extract-useful-info-from-the-output-files">How to extract useful info from the output files<a class="headerlink" href="#how-to-extract-useful-info-from-the-output-files" title="Permanent link">&para;</a></h2>
<p>For post-processing, this tutorial will rely heavily on the AbiPy toolkit.
The installation notes and some examples can be found in the <a href="https://github.com/abinit/abipy">AbiPy</a>  repository.</p>
<p>As an example, to plot the band structure using the GS eigenvalues stored in the GSR.nc file of the tutorial&rsquo;s repo,
use the <a href="http://abinit.github.io/abipy/scripts/abiopen.html">abiopen.py</a>  script provided by AbiPy with the <code>-e</code> option:</p>
<div class="highlight"><pre><span></span><code>abiopen.py<span class="w"> </span>LiF_eph_varpeq/ebandso_GSR.nc<span class="w"> </span>-e
</code></pre></div>
<p><img alt="" src="../eph4vpq_assets/LiF_ebands.png" /></p>
<p>Note the VBM is triply degenerate if SOC is not used.
This suggests that we will have to use last three occupied bands for hole polaron calculations.
As the CBM has no degeneracy, only the first unoccupied band will be considered in electron polaron calculations.</p>
<h2 id="how-to-merge-partial-ddb-files-with-mrgddb">How to merge partial DDB files with mrgddb<a class="headerlink" href="#how-to-merge-partial-ddb-files-with-mrgddb" title="Permanent link">&para;</a></h2>
<p>Normally, after DFPT calculations, we need to merge partial DDB files.
This has already been done in the repository at the end of the
run <a href="https://github.com/abinit/LiF_eph_varpeq/blob/main/run.sh">script</a>
via the</p>
<div class="highlight"><pre><span></span><code>mrgddb<span class="w"> </span>out_DDB<span class="w"> </span>dfpt*DDB.nc
</code></pre></div>
<p>This command takes advantage of globbing and merges all the <strong>partial DDB files</strong> into
a single out_DDB file, containing information on all the calculated perturbations.</p>
<p>Since we are dealing with a polar material, it is worth checking whether our final DDB contains
Born effective charges and the electronic dielectric tensor.
Instead of running <em>anaddb</em> or <em>abinit</em> and then checking the output file,
we can simply use <a href="http://abinit.github.io/abipy/scripts/abiopen.html">abiopen.py</a>  with the <code>-p</code> option:</p>
<div class="highlight"><pre><span></span><code>abiopen.py<span class="w"> </span>LiF_eph_varpeq/out_DDB<span class="w"> </span>-p

<span class="o">==================================</span><span class="w"> </span>DDB<span class="w"> </span><span class="nv">Info</span><span class="w"> </span><span class="o">==================================</span>

Number<span class="w"> </span>of<span class="w"> </span>q-points<span class="w"> </span><span class="k">in</span><span class="w"> </span>DDB:<span class="w"> </span><span class="m">4</span>
guessed_ngqpt:<span class="w"> </span><span class="o">[</span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="o">]</span><span class="w"> </span><span class="o">(</span>guess<span class="w"> </span><span class="k">for</span><span class="w"> </span>the<span class="w"> </span>q-mesh<span class="w"> </span>divisions<span class="w"> </span>made<span class="w"> </span>by<span class="w"> </span>AbiPy<span class="o">)</span>
<span class="nv">ecut</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30</span>.000000,<span class="w"> </span><span class="nv">ecutsm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.000000,<span class="w"> </span><span class="nv">nkpt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">14</span>,<span class="w"> </span><span class="nv">nsym</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">48</span>,<span class="w"> </span><span class="nv">usepaw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
nsppol<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>nspinor<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>nspden<span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="nv">ixc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">11</span>,<span class="w"> </span><span class="nv">occopt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="nv">tsmear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.010000

Has<span class="w"> </span>total<span class="w"> </span>energy:<span class="w"> </span>False
Has<span class="w"> </span>forces:<span class="w"> </span>False
Has<span class="w"> </span>stress<span class="w"> </span>tensor:<span class="w"> </span>False

Has<span class="w"> </span><span class="o">(</span>at<span class="w"> </span>least<span class="w"> </span>one<span class="o">)</span><span class="w"> </span>atomic<span class="w"> </span>pertubation:<span class="w"> </span>True
Has<span class="w"> </span><span class="o">(</span>at<span class="w"> </span>least<span class="w"> </span>one<span class="w"> </span>diagonal<span class="o">)</span><span class="w"> </span>electric-field<span class="w"> </span>perturbation:<span class="w"> </span>True
Has<span class="w"> </span><span class="o">(</span>at<span class="w"> </span>least<span class="w"> </span>one<span class="o">)</span><span class="w"> </span>Born<span class="w"> </span>effective<span class="w"> </span>charge:<span class="w"> </span>True
Has<span class="w"> </span><span class="o">(</span>all<span class="o">)</span><span class="w"> </span>strain<span class="w"> </span>terms:<span class="w"> </span>False
Has<span class="w"> </span><span class="o">(</span>all<span class="o">)</span><span class="w"> </span>internal<span class="w"> </span>strain<span class="w"> </span>terms:<span class="w"> </span>False
Has<span class="w"> </span><span class="o">(</span>all<span class="o">)</span><span class="w"> </span>piezoelectric<span class="w"> </span>terms:<span class="w"> </span>False
Has<span class="w"> </span><span class="o">(</span>all<span class="o">)</span><span class="w"> </span>dynamical<span class="w"> </span>quadrupole<span class="w"> </span>terms:<span class="w"> </span>False
</code></pre></div>
<p>We can also invoke <em>anaddb</em> directly from python to have a quick look at the phonon dispersion:</p>
<div class="highlight"><pre><span></span><code>abiview.py ddb LiF_eph_varpeq/out_DDB

Computing phonon bands and DOS from DDB file with:
nqsmall: 10, ndivsm: 20,
asr: 2, chneut: 1, dipdip: 1, lo_to_splitting: automatic, dos_method: tetra
</code></pre></div>
<p>that produces the following figures:</p>
<p><img alt="" src="../eph4vpq_assets/LiF_DDB.png" /></p>
<p>The results seem reasonable: the acoustic modes go to zero linearly for <span class="arithmatex">\(\qq \rightarrow 0\)</span>
as we are dealing with a 3D system, no instability is present
and the phonon dispersion shows the LO-TO splitting typical of polar materials.</p>
<p>Note, however, that the acoustic sum-rule is automatically enforced by the code so
it is always a good idea to compare the results with/without <a class="wikilink codevar-wikilink" href="/variables/dfpt#asr">asr</a> as this
is an indirect indicator of the convergence/reliability of our calculations.
We can automate the process with the <em>ddb_asr</em> command of <a href="http://abinit.github.io/abipy/scripts/abiview.html">abiview.py</a> :</p>
<div class="highlight"><pre><span></span><code>abiview.py ddb_asr LiF_eph_varpeq/out_DDB
</code></pre></div>
<p>that produces the following figure:</p>
<p><img alt="" src="../eph4vpq_assets/LiF_asr.png" /></p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>In this case, the small breaking of the acoustic sum rule is mainly due the too low cutoff energy employed in our calculations.
In production, one should perform convergence tests wrt <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> and <span class="arithmatex">\(\qq\)</span>-mesh but since the goal of this lesson is to teach you how
to run polaron calculations, <strong>we ignore this problem and continue with the other examples</strong>.</p>
<p>PS: If you want to compute the phonons bands with/without <a class="wikilink codevar-wikilink" href="/variables/eph#dipdip">dipdip</a>, use:</p>
<div class="highlight"><pre><span></span><code>abiview.py ddb_dipdip LiF_eph_varpeq/out_DDB
</code></pre></div>
</div>
<h2 id="how-to-merge-partial-pot-files-with-mrgdv">How to merge partial POT files with mrgdv<a class="headerlink" href="#how-to-merge-partial-pot-files-with-mrgdv" title="Permanent link">&para;</a></h2>
<p>Now we can merge the DFPT potential with the <em>mrgdv</em> tool using the command.</p>
<div class="highlight"><pre><span></span><code>mrgdv<span class="w"> </span>&lt;<span class="w"> </span>teph4vpq_1.abi<span class="w"> </span>&gt;<span class="w"> </span>teph4vpq_1.stdout
</code></pre></div>
<p>and the following input file:</p>
<div class="text-center"><button id="uuid-84bc05a0-035a-4acd-9853-f3e2bd871376" class="md-button md-button--secondary"> View tests/tutorespfn/Input/teph4vpq_1.abi </button></div>
<div id="uuid-84956e7c-7656-4711-a18e-82dacf0ea1f0" class="my_dialog" title="tests/tutorespfn/Input/teph4vpq_1.abi" hidden><div><div class="codehilite small-text"><pre><span></span>teph4vpq_1_DVDB
<span class="m">16</span>
LiF_eph_varpeq/dfpto_DS1_POT7.nc
LiF_eph_varpeq/dfpto_DS1_POT8.nc
LiF_eph_varpeq/dfpto_DS1_POT9.nc
LiF_eph_varpeq/dfpto_DS2_POT1.nc
LiF_eph_varpeq/dfpto_DS2_POT10.nc
LiF_eph_varpeq/dfpto_DS2_POT4.nc
LiF_eph_varpeq/dfpto_DS3_POT1.nc
LiF_eph_varpeq/dfpto_DS3_POT2.nc
LiF_eph_varpeq/dfpto_DS3_POT4.nc
LiF_eph_varpeq/dfpto_DS3_POT5.nc
LiF_eph_varpeq/dfpto_DS4_POT1.nc
LiF_eph_varpeq/dfpto_DS4_POT4.nc
LiF_eph_varpeq/dfpto_DS5_POT1.nc
LiF_eph_varpeq/dfpto_DS5_POT3.nc
LiF_eph_varpeq/dfpto_DS5_POT4.nc
LiF_eph_varpeq/dfpto_DS5_POT6.nc

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = mrgdv</span>
<span class="c1">#%% exclude_builders = eos_nvhpc_*</span>
<span class="c1">#%% test_chain = teph4vpq_1.abi, teph4vpq_2.abi, teph4vpq_3.abi,</span>
<span class="c1">#%%              teph4vpq_4.abi, teph4vpq_5.abi, teph4vpq_6.abi,</span>
<span class="c1">#%%              teph4vpq_7.abi, teph4vpq_8.abi, teph4vpq_9.abi,</span>
<span class="c1">#%%              teph4vpq_10.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% use_git_submodule = LiF_eph_varpeq</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   teph4vpq_1.stdout, tolnlines= 0, tolabs=  0, tolrel=  0</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 1</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = V. Vasilchenko</span>
<span class="c1">#%% keywords = DFPT, EPH, POLARON</span>
<span class="c1">#%% description =</span>
<span class="c1">#%%   LiF, Fm-3m space group.</span>
<span class="c1">#%%   Preparatory run for VarPEq calculations.</span>
<span class="c1">#%%   Merge precomputed DFPT POT files stored in the LiF_eph_varpeq git submodule.</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-84956e7c-7656-4711-a18e-82dacf0ea1f0", "#uuid-84bc05a0-035a-4acd-9853-f3e2bd871376") }); </script>

<p>This can also be achieved by calling <em>mrgdv</em> with the <em>merge</em> argument, output filename and wildcard for the POT files</p>
<div class="highlight"><pre><span></span><code>mrgdv<span class="w"> </span>merge<span class="w"> </span>teph4vpq_1_DVDB<span class="w"> </span>LiF_eph_varpeq/dfpt*POT*nc
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The number at the end of the POT file corresponds to the (<em>idir</em>, <em>ipert</em>) perturbation for that
particular <span class="arithmatex">\(\qq\)</span>-point. The <em>pertcase</em> index is computed as:</p>
<div class="highlight"><pre><span></span><code><span class="n">pertcase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">idir</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">ipert</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<p>where <em>idir</em> gives the direction ([1, 2, 3]) and <em>ipert</em> specifies the perturbation type:</p>
<ul>
<li><em>ipert</em> in [1, &hellip;, <em>natom</em>] corresponds to atomic perturbations (reduced directions)</li>
<li><em>ipert</em> = <em>natom</em> + 1 corresponds d/dk  (reduced directions)</li>
<li><em>ipert</em> = <em>natom</em> + 2 corresponds the electric field</li>
<li><em>ipert</em> = <em>natom</em> + 3 corresponds the uniaxial stress (Cartesian directions)</li>
<li><em>ipert</em> = <em>natom</em> + 4 corresponds the shear stress.   (Cartesian directions)</li>
</ul>
<p>All DFPT POT files with 1 &lt;= pertcase &lt;= 3 x <a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a> therefore correspond to atomic pertubations
for a given <span class="arithmatex">\(\qq\)</span>-point.</p>
<p>The value of <em>pertcase</em> and <em>qpt</em> are reported in the ABINIT header.
To print the header to terminal, use <em>abitk</em> with the <em>hdr_print</em> command</p>
<div class="highlight"><pre><span></span><code><span class="w"> </span>abitk<span class="w"> </span>hdr_print<span class="w"> </span>LiF_eph_varpeq/dfpto_DS2_POT4.nc

<span class="w"> </span><span class="o">===============================================================================</span>
<span class="w"> </span>ECHO<span class="w"> </span>of<span class="w"> </span>part<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>ABINIT<span class="w"> </span>file<span class="w"> </span>header

<span class="w"> </span>First<span class="w"> </span>record<span class="w"> </span>:
.codvsn,headform,fform<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span>.3.4.6<span class="w">   </span><span class="m">80</span><span class="w">  </span><span class="m">111</span>

<span class="w"> </span>Second<span class="w"> </span>record<span class="w"> </span>:
<span class="w"> </span>bantot,intxc,ixc,natom<span class="w">  </span><span class="o">=</span><span class="w">    </span><span class="m">40</span><span class="w">     </span><span class="m">0</span><span class="w">    </span><span class="m">11</span><span class="w">     </span><span class="m">2</span>
<span class="w"> </span>ngfft<span class="o">(</span><span class="m">1</span>:3<span class="o">)</span>,nkpt<span class="w">         </span><span class="o">=</span><span class="w">    </span><span class="m">30</span><span class="w">    </span><span class="m">30</span><span class="w">    </span><span class="m">30</span><span class="w">     </span><span class="m">8</span>
<span class="w"> </span>nspden,nspinor<span class="w">          </span><span class="o">=</span><span class="w">     </span><span class="m">1</span><span class="w">     </span><span class="m">1</span>
<span class="w"> </span>nsppol,nsym,npsp,ntypat<span class="w"> </span><span class="o">=</span><span class="w">     </span><span class="m">1</span><span class="w">    </span><span class="m">48</span><span class="w">     </span><span class="m">2</span><span class="w">     </span><span class="m">2</span>
<span class="w"> </span>occopt,pertcase,usepaw<span class="w">  </span><span class="o">=</span><span class="w">     </span><span class="m">1</span><span class="w">     </span><span class="m">4</span><span class="w">     </span><span class="m">0</span>
<span class="w"> </span>ecut,ecutdg,ecutsm<span class="w">      </span><span class="o">=</span><span class="w">  </span><span class="m">3</span>.0000000000E+01<span class="w">  </span><span class="m">3</span>.0000000000E+01<span class="w">  </span><span class="m">0</span>.0000000000E+00
<span class="w"> </span><span class="nv">ecut_eff</span><span class="w">                </span><span class="o">=</span><span class="w">  </span><span class="m">3</span>.0000000000E+01
<span class="w"> </span>qptn<span class="o">(</span><span class="m">1</span>:3<span class="o">)</span><span class="w">               </span><span class="o">=</span><span class="w">  </span><span class="m">0</span>.0000000000E+00<span class="w">  </span><span class="m">0</span>.0000000000E+00<span class="w">  </span><span class="m">0</span>.0000000000E+00
<span class="w"> </span>rprimd<span class="o">(</span><span class="m">1</span>:3,1<span class="o">)</span><span class="w">           </span><span class="o">=</span><span class="w">  </span><span class="m">0</span>.0000000000E+00<span class="w">  </span><span class="m">3</span>.8375000000E+00<span class="w">  </span><span class="m">3</span>.8375000000E+00
<span class="w"> </span>rprimd<span class="o">(</span><span class="m">1</span>:3,2<span class="o">)</span><span class="w">           </span><span class="o">=</span><span class="w">  </span><span class="m">3</span>.8375000000E+00<span class="w">  </span><span class="m">0</span>.0000000000E+00<span class="w">  </span><span class="m">3</span>.8375000000E+00
<span class="w"> </span>rprimd<span class="o">(</span><span class="m">1</span>:3,3<span class="o">)</span><span class="w">           </span><span class="o">=</span><span class="w">  </span><span class="m">3</span>.8375000000E+00<span class="w">  </span><span class="m">3</span>.8375000000E+00<span class="w">  </span><span class="m">0</span>.0000000000E+00
<span class="w"> </span>stmbias,tphysel,tsmear<span class="w">  </span><span class="o">=</span><span class="w">  </span><span class="m">0</span>.0000000000E+00<span class="w">  </span><span class="m">0</span>.0000000000E+00<span class="w">  </span><span class="m">1</span>.0000000000E-02

<span class="w"> </span>The<span class="w"> </span>header<span class="w"> </span>contain<span class="w">   </span><span class="m">4</span><span class="w"> </span>additional<span class="w"> </span>records.
</code></pre></div>
<p>Use <code>--prtvol 1</code> to output more records.</p>
</div>
<p>Now we discuss in more detail the output file produced by <em>mrgdv</em></p>
<div class="text-center"><button id="uuid-ccd78d01-6074-4d7f-890a-78a622b08356" class="md-button md-button--secondary"> View tests/tutorespfn/Refs/teph4vpq_1.stdout </button></div>
<div id="uuid-90eaa493-32fe-4187-a7f6-b32f3d662f1d" class="my_dialog" title="tests/tutorespfn/Refs/teph4vpq_1.stdout" hidden><div><pre class="small-text">

.Version 10.3.4.7 of MRGDV, released Dec 2025.
.(MPI version, prepared for a aarch64_darwin23.5.0_gnu14.2 computer) 

.Copyright (C) 1998-2025 ABINIT group . 
 MRGDV comes with ABSOLUTELY NO WARRANTY.
 It is free software, and you are welcome to redistribute it
 under certain conditions (GNU General Public License,
 see ~abinit/COPYING or http://www.gnu.org/copyleft/gpl.txt).

 ABINIT is a project of the Universite Catholique de Louvain,
 Corning Inc. and other collaborators, see ~abinit/doc/developers/contributors.txt .
 Please read https://docs.abinit.org/theory/acknowledgments for suggested
 acknowledgments of the ABINIT effort.
 For more information, see https://www.abinit.org .

.Starting date : Sun 23 Feb 2025.
- ( at 12h21 )

-&gt;&gt; Enter name of output file: 
-&gt;&gt; Enter total number of DFPT POT files: 
-&gt;&gt; Enter name of POT file 1 : 
-&gt;&gt; Enter name of POT file 2 : 
-&gt;&gt; Enter name of POT file 3 : 
-&gt;&gt; Enter name of POT file 4 : 
-&gt;&gt; Enter name of POT file 5 : 
-&gt;&gt; Enter name of POT file 6 : 
-&gt;&gt; Enter name of POT file 7 : 
-&gt;&gt; Enter name of POT file 8 : 
-&gt;&gt; Enter name of POT file 9 : 
-&gt;&gt; Enter name of POT file 10 : 
-&gt;&gt; Enter name of POT file 11 : 
-&gt;&gt; Enter name of POT file 12 : 
-&gt;&gt; Enter name of POT file 13 : 
-&gt;&gt; Enter name of POT file 14 : 
-&gt;&gt; Enter name of POT file 15 : 
-&gt;&gt; Enter name of POT file 16 : 
- Reading header of file [1]: LiF_eph_varpeq/dfpto_DS1_POT7.nc
- Merging file [1]: LiF_eph_varpeq/dfpto_DS1_POT7.nc
- Reading header of file [2]: LiF_eph_varpeq/dfpto_DS1_POT8.nc
- Merging file [2]: LiF_eph_varpeq/dfpto_DS1_POT8.nc
- Reading header of file [3]: LiF_eph_varpeq/dfpto_DS1_POT9.nc
- Merging file [3]: LiF_eph_varpeq/dfpto_DS1_POT9.nc
- Reading header of file [4]: LiF_eph_varpeq/dfpto_DS2_POT1.nc
- Merging file [4]: LiF_eph_varpeq/dfpto_DS2_POT1.nc
- Reading header of file [5]: LiF_eph_varpeq/dfpto_DS2_POT10.nc
- Merging file [5]: LiF_eph_varpeq/dfpto_DS2_POT10.nc
- Reading header of file [6]: LiF_eph_varpeq/dfpto_DS2_POT4.nc
- Merging file [6]: LiF_eph_varpeq/dfpto_DS2_POT4.nc
- Reading header of file [7]: LiF_eph_varpeq/dfpto_DS3_POT1.nc
- Merging file [7]: LiF_eph_varpeq/dfpto_DS3_POT1.nc
- Reading header of file [8]: LiF_eph_varpeq/dfpto_DS3_POT2.nc
- Merging file [8]: LiF_eph_varpeq/dfpto_DS3_POT2.nc
- Reading header of file [9]: LiF_eph_varpeq/dfpto_DS3_POT4.nc
- Merging file [9]: LiF_eph_varpeq/dfpto_DS3_POT4.nc
- Reading header of file [10]: LiF_eph_varpeq/dfpto_DS3_POT5.nc
- Merging file [10]: LiF_eph_varpeq/dfpto_DS3_POT5.nc
- Reading header of file [11]: LiF_eph_varpeq/dfpto_DS4_POT1.nc
- Merging file [11]: LiF_eph_varpeq/dfpto_DS4_POT1.nc
- Reading header of file [12]: LiF_eph_varpeq/dfpto_DS4_POT4.nc
- Merging file [12]: LiF_eph_varpeq/dfpto_DS4_POT4.nc
- Reading header of file [13]: LiF_eph_varpeq/dfpto_DS5_POT1.nc
- Merging file [13]: LiF_eph_varpeq/dfpto_DS5_POT1.nc
- Reading header of file [14]: LiF_eph_varpeq/dfpto_DS5_POT3.nc
- Merging file [14]: LiF_eph_varpeq/dfpto_DS5_POT3.nc
- Reading header of file [15]: LiF_eph_varpeq/dfpto_DS5_POT4.nc
- Merging file [15]: LiF_eph_varpeq/dfpto_DS5_POT4.nc
- Reading header of file [16]: LiF_eph_varpeq/dfpto_DS5_POT6.nc
- Merging file [16]: LiF_eph_varpeq/dfpto_DS5_POT6.nc
 Merged successfully 16 files
- Analyzing DVDB file: teph4vpq_1_DVDB ...
- dvdb_new , wall:  0.01 [s] , cpu:  0.00 [s] &lt;&lt;&lt; TIME
 ==== Info on the dvdb% object ====
 DVDB version: 2
 File path: teph4vpq_1_DVDB
 Number of v1scf potentials: 16
 Number of q-points in DVDB: 4
-P Number of CPUs for parallelism over perturbations: 1
-P Number of perturbations treated by this CPU: 6
 Option for symmetrization of v1scf(r): 0
 List of q-points: min(10, nqpt)
[ 1 ] [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
[ 2 ] [ 3.3333E-01,  0.0000E+00,  0.0000E+00]
[ 3 ] [ 3.3333E-01,  3.3333E-01,  0.0000E+00]
[ 4 ] [-3.3333E-01,  3.3333E-01,  0.0000E+00]
 Have dielectric tensor: no
 Have Born effective charges: no
 Have quadrupoles: no
 Have electric field: no
 Treatment of long-range part in V1scf (add_lr): 1
 Damping factor for Gaussian filter (qdamp):   0.1
 qpoint: [ 0.0000E+00,  0.0000E+00,  0.0000E+00] is present in the DVDB file
 The list of irreducible perturbations for this q vector is:
    1)  idir= 1, ipert=   1, type=independent, found=Yes
    2)  idir= 2, ipert=   1, type=symmetric, found=No
    3)  idir= 3, ipert=   1, type=symmetric, found=No
    4)  idir= 1, ipert=   2, type=independent, found=Yes
    5)  idir= 2, ipert=   2, type=symmetric, found=No
    6)  idir= 3, ipert=   2, type=symmetric, found=No

 qpoint: [ 3.3333E-01,  0.0000E+00,  0.0000E+00] is present in the DVDB file
 The list of irreducible perturbations for this q vector is:
    1)  idir= 1, ipert=   1, type=independent, found=Yes
    2)  idir= 2, ipert=   1, type=independent, found=Yes
    3)  idir= 3, ipert=   1, type=symmetric, found=No
    4)  idir= 1, ipert=   2, type=independent, found=Yes
    5)  idir= 2, ipert=   2, type=independent, found=Yes
    6)  idir= 3, ipert=   2, type=symmetric, found=No

 qpoint: [ 3.3333E-01,  3.3333E-01,  0.0000E+00] is present in the DVDB file
 The list of irreducible perturbations for this q vector is:
    1)  idir= 1, ipert=   1, type=independent, found=Yes
    2)  idir= 2, ipert=   1, type=symmetric, found=No
    3)  idir= 3, ipert=   1, type=symmetric, found=No
    4)  idir= 1, ipert=   2, type=independent, found=Yes
    5)  idir= 2, ipert=   2, type=symmetric, found=No
    6)  idir= 3, ipert=   2, type=symmetric, found=No

 qpoint: [-3.3333E-01,  3.3333E-01,  0.0000E+00] is present in the DVDB file
 The list of irreducible perturbations for this q vector is:
    1)  idir= 1, ipert=   1, type=independent, found=Yes
    2)  idir= 2, ipert=   1, type=symmetric, found=No
    3)  idir= 3, ipert=   1, type=independent, found=Yes
    4)  idir= 1, ipert=   2, type=independent, found=Yes
    5)  idir= 2, ipert=   2, type=symmetric, found=No
    6)  idir= 3, ipert=   2, type=independent, found=Yes

 All the independent perturbations are available
 Done

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-90eaa493-32fe-4187-a7f6-b32f3d662f1d", "#uuid-ccd78d01-6074-4d7f-890a-78a622b08356") }); </script>

<p>For each <span class="arithmatex">\(\qq\)</span>-point found in the partial POT files,
the code prints a lists with the atomic perturbations that have been merged in the database.</p>
<div class="highlight"><pre><span></span><code> qpoint: [ 0.0000E+00,  0.0000E+00,  0.0000E+00] is present in the DVDB file
 The list of irreducible perturbations for this q vector is:
    1)  idir= 1, ipert=   1, type=independent, found=Yes
    2)  idir= 2, ipert=   1, type=symmetric, found=No
    3)  idir= 3, ipert=   1, type=symmetric, found=No
    4)  idir= 1, ipert=   2, type=independent, found=Yes
    5)  idir= 2, ipert=   2, type=symmetric, found=No
    6)  idir= 3, ipert=   2, type=symmetric, found=No
</code></pre></div>
<p>The term <strong>symmetric</strong> means that this particular <em>(idir, ipert)</em> perturbation
can be reconstructed by symmetry from the other <strong>independent</strong> entries with the same <span class="arithmatex">\(\qq\)</span>-point.
If all the independent entries are available, the code prints the following message at the end of the output file:</p>
<div class="highlight"><pre><span></span><code> All the independent perturbations are available
 Done
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you don&rsquo;t get this message, the DVDB <strong>cannot be used</strong> by the EPH code.
In this case, check carefully your DFPT input files and the list of POT files that have been merged.</p>
<p>Also, note that it is not possible to change the value of <a class="wikilink codevar-wikilink" href="/variables/basic#nsym">nsym</a> at the level of the EPH calculation
as symmetries are automatically inherited from the previous GS/DFPT calculations.
To perform calculations without symmetries, one should set <a class="wikilink codevar-wikilink" href="/variables/basic#nsym">nsym</a> to 1 (no spatial symmetries)
and use <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> 4 to disable time-reversal symmetry in all the input files.</p>
</div>
<h2 id="computing-the-wfk-files">Computing the WFK files<a class="headerlink" href="#computing-the-wfk-files" title="Permanent link">&para;</a></h2>
<p>At this point we have all the ingredients (<strong>DDB</strong> and <strong>DVDB</strong>) required to compute/interpolate
the e-ph scattering potentials, and we can finally start to generate the WFK files.</p>
<p>For our first NSCF calculation, we compute wavefunctions on <span class="arithmatex">\(\Gamma\)</span>-centered <span class="arithmatex">\(\kk\)</span>-meshes (3x3x3, 4x4x4, 5x5x5, and 13x13x13)
with 6 bands (5 occupied + 1 unnocupied).
The first three wavefunctions will be used in calculations of small hole polaron in LiF.
The latter will be used for the large electron polaron in LiF.
Note the use of <a class="wikilink codevar-wikilink" href="/variables/files#getden_filepath">getden_filepath</a> to read the precomputed DEN.nc file instead of <a class="wikilink codevar-wikilink" href="/variables/files#getden">getden</a> or <a class="wikilink codevar-wikilink" href="/variables/files#irdden">irdden</a>.</p>
<p>You may now run the NSCF calculation by issuing:</p>
<div class="highlight"><pre><span></span><code>abinit<span class="w"> </span>teph4vpq_2.abi<span class="w"> </span>&gt;<span class="w"> </span>teph4vpq_2.log<span class="w"> </span><span class="m">2</span>&gt;<span class="w"> </span>err<span class="w"> </span><span class="p">&amp;</span>
</code></pre></div>
<p>with the input file given by:</p>
<div class="text-center"><button id="uuid-3e6e64bb-9cd7-4b9c-83f5-f62002017218" class="md-button md-button--secondary"> View tests/tutorespfn/Input/teph4vpq_2.abi </button></div>
<div id="uuid-fbd9a2bc-dc22-4964-a563-83def62a2753" class="my_dialog" title="tests/tutorespfn/Input/teph4vpq_2.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># LiF: non-SCF computation of groundstate wavefunctions</span>
<span class="c1"># (preparatory run for VarPEq polaron calculations)</span>

<span class="w"> </span>ndtset<span class="w"> </span><span class="m">4</span>

<span class="c1"># DTSET 1-3: Gamma-centred k-meshes from 3x3x3 to 5x5x5 (for small hole polaron)</span>
<span class="w"> </span>ngkpt1<span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span>
<span class="w"> </span>ngkpt2<span class="w">  </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">4</span>
<span class="w"> </span>ngkpt3<span class="w">  </span><span class="m">5</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">5</span>

<span class="c1"># DTSET 4: Gamma-centred k-meshes from 13x13x13 (for large electron polaron)</span>
<span class="w"> </span>ngkpt4<span class="w">  </span><span class="m">13</span><span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">13</span>

<span class="w"> </span>nshiftk<span class="w">  </span><span class="m">1</span>
<span class="w"> </span>shiftk<span class="w">   </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.0

<span class="c1">################################################################################</span>
<span class="c1">###                          Common input variables                          ###</span>
<span class="c1">################################################################################</span>

<span class="c1"># Number of bands</span>
<span class="w"> </span>nband<span class="w">  </span><span class="m">6</span><span class="w">  </span><span class="c1"># NOTE: for subsequent VarPEq runs at least one unnocupied band</span>
<span class="w">           </span><span class="c1"># has to be included; here, 5 occupied + 1 unnocupied</span>

<span class="c1"># Definition of the planewave basis</span>
<span class="w"> </span>ecut<span class="w">  </span><span class="m">30</span>

<span class="c1"># non-SCF optimization</span>
<span class="w"> </span>iscf<span class="w">   </span>-2
<span class="w"> </span>tolwfr<span class="w">  </span>1e-20
<span class="w"> </span>nstep<span class="w">   </span><span class="m">100</span>

<span class="c1"># Files</span>
<span class="w"> </span>getden_filepath<span class="w"> </span><span class="s2">&quot;LiF_eph_varpeq/gso_DEN.nc&quot;</span><span class="w"> </span><span class="c1"># Read the precomputed DEN stored in git submodule</span>
<span class="w">                                             </span><span class="c1"># NOTE: for the input parameters used to produce</span>
<span class="w">                                             </span><span class="c1"># the DEN file, consult the LiF_eph_varpeq/gs.abi</span>

<span class="c1"># Pseudopotentials</span>
<span class="w"> </span>pp_dirpath<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">/Psdj_nc_sr_05_pbe_std_psp8&quot;</span>
<span class="w"> </span>pseudos<span class="w"> </span><span class="s2">&quot;Li.psp8, F.psp8&quot;</span>

<span class="c1"># Structure</span>
<span class="w"> </span>natom<span class="w">   </span><span class="m">2</span>
<span class="w"> </span>ntypat<span class="w">  </span><span class="m">2</span>
<span class="w"> </span>typat<span class="w">   </span><span class="m">1</span><span class="w"> </span><span class="m">2</span>
<span class="w"> </span>znucl<span class="w">   </span><span class="m">3</span><span class="w"> </span><span class="m">9</span>
<span class="w"> </span>xred<span class="w">    </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.0
<span class="w">         </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5

<span class="w"> </span>acell<span class="w"> </span><span class="m">3</span>*7.675
<span class="w"> </span>rprim<span class="w"> </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5
<span class="w">       </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.5
<span class="w">       </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% exclude_builders = eos_nvhpc_*</span>
<span class="c1">#%% test_chain = teph4vpq_1.abi, teph4vpq_2.abi, teph4vpq_3.abi,</span>
<span class="c1">#%%              teph4vpq_4.abi, teph4vpq_5.abi, teph4vpq_6.abi,</span>
<span class="c1">#%%              teph4vpq_7.abi, teph4vpq_8.abi, teph4vpq_9.abi,</span>
<span class="c1">#%%              teph4vpq_10.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% use_git_submodule = LiF_eph_varpeq</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   teph4vpq_2.abo, tolnlines = 100, tolabs = 1e-5, tolrel = 1e-3</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 10</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = V. Vasilchenko</span>
<span class="c1">#%% keywords = DFPT, EPH, POLARON</span>
<span class="c1">#%% description =</span>
<span class="c1">#%%   LiF, Fm-3m space group.</span>
<span class="c1">#%%   Preparatory run for VarPEq calculations.</span>
<span class="c1">#%%   Non-SCF computation of groundstate wavefunctions.</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-fbd9a2bc-dc22-4964-a563-83def62a2753", "#uuid-3e6e64bb-9cd7-4b9c-83f5-f62002017218") }); </script>

<h2 id="small-hole-polaron-computing-the-gstore-files">Small hole polaron: computing the GSTORE files<a class="headerlink" href="#small-hole-polaron-computing-the-gstore-files" title="Permanent link">&para;</a></h2>
<p>For <strong>our first GSTORE calculation</strong>, we compute the electron-phonon matrix elements
required for the small hole polaron optimization.
With this example, we discuss the most important <code>gstore_</code> input variables and the concept of the GSTORE file.
First of all, you may want to start immediately the computation by issuing:</p>
<div class="highlight"><pre><span></span><code>abinit<span class="w"> </span>teph4vpq_3.abi<span class="w"> </span>&gt;<span class="w"> </span>teph4vpq_3.log<span class="w"> </span><span class="m">2</span>&gt;<span class="w"> </span>err<span class="w"> </span><span class="p">&amp;</span>
</code></pre></div>
<p>with the following input file:</p>
<div class="text-center"><button id="uuid-d0896250-cf78-4b6c-a833-17dd5321b740" class="md-button md-button--secondary"> View tests/tutorespfn/Input/teph4vpq_3.abi </button></div>
<div id="uuid-88101cc4-fdb0-4098-a934-748ebdd15a79" class="my_dialog" title="tests/tutorespfn/Input/teph4vpq_3.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># LiF: computation of electron-phonon matrix elements for 3x3x3, 4x4x4, 5x5x5</span>
<span class="c1"># k/q-grids in a dataset mode. The results are stored in GSTORE.nc NetCDF file</span>
<span class="c1"># (preparatory run for VarPEq hole polaron calculations)</span>

<span class="c1"># NOTE that dataset mode is used only for the tutorial</span>
<span class="c1"># In production, it is advisable to compute each GSTORE file in a separate run</span>

<span class="w"> </span>ndtset<span class="w"> </span><span class="m">3</span>

<span class="w"> </span>optdriver<span class="w">  </span><span class="m">7</span><span class="w">   </span><span class="c1"># Electron-phonon driver</span>
<span class="w"> </span>eph_task<span class="w">   </span><span class="m">11</span><span class="w">  </span><span class="c1"># Activate the e-ph matrix elements computation via GSTORE</span>

<span class="c1"># Electron-phonon matrix elements parameters</span>
<span class="w"> </span>gstore_cplex<span class="w">  </span><span class="m">2</span><span class="w">     </span><span class="c1"># Complex e-ph matrix elements   (mandatory for VarPEq)</span>
<span class="w"> </span>gstore_kzone<span class="w">  </span><span class="s2">&quot;bz&quot;</span><span class="w">  </span><span class="c1"># Use full BZ for k and q meshes (mandatory for VarPEq)</span>
<span class="w"> </span>gstore_qzone<span class="w">  </span><span class="s2">&quot;bz&quot;</span>
<span class="w"> </span>gstore_brange<span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">5</span><span class="w">  </span><span class="c1"># Bands participating in the hole polaron formation:</span>
<span class="w">                    </span><span class="c1"># from 3 to 5 (triply degenerate valence band maximum)</span>

<span class="c1"># Wavefunction</span>
<span class="c1"># Read the WFK file from the preparatory run</span>
<span class="w"> </span>getwfk_filepath1<span class="w"> </span><span class="s2">&quot;teph4vpq_2o_DS1_WFK&quot;</span><span class="w">  </span><span class="c1"># 3x3x3 k-mesh</span>
<span class="w"> </span>getwfk_filepath2<span class="w"> </span><span class="s2">&quot;teph4vpq_2o_DS2_WFK&quot;</span><span class="w">  </span><span class="c1"># 4x4x4 k-mesh</span>
<span class="w"> </span>getwfk_filepath3<span class="w"> </span><span class="s2">&quot;teph4vpq_2o_DS3_WFK&quot;</span><span class="w">  </span><span class="c1"># 5x5x5 k-mesh</span>

<span class="w"> </span>ngkpt1<span class="w">   </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w">  </span><span class="c1"># These parameters have to consistent with the WFK file</span>
<span class="w"> </span>ngkpt2<span class="w">   </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">4</span>
<span class="w"> </span>ngkpt3<span class="w">   </span><span class="m">5</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">5</span>

<span class="w"> </span>kptopt<span class="w">   </span><span class="m">1</span>
<span class="w"> </span>nshiftk<span class="w">  </span><span class="m">1</span>
<span class="w"> </span>shiftk<span class="w">   </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
<span class="w"> </span>nband<span class="w">    </span><span class="m">6</span>
<span class="w"> </span>ecut<span class="w">     </span><span class="m">30</span>

<span class="c1"># Phonons</span>
<span class="w"> </span>getddb_filepath
<span class="w"> </span><span class="s2">&quot;LiF_eph_varpeq/out_DDB&quot;</span><span class="w">  </span><span class="c1"># Read the precomputed DDB stored in git submodule</span>
<span class="w">                           </span><span class="c1"># NOTE: for the input parameters used to produce</span>
<span class="w">                           </span><span class="c1"># the DDB file, consult the LiF_eph_varpeq/dfpt.abi</span>

<span class="c1"># Scattering potentials</span>
<span class="w"> </span>getdvdb_filepath
<span class="w"> </span><span class="s2">&quot;teph4vpq_1_DVDB&quot;</span><span class="w">  </span><span class="c1"># Read the DVDB file from the preparatory run</span>

<span class="c1"># Phonons and scattering potentials interpolation</span>
<span class="w"> </span>ddb_ngqpt<span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w">       </span><span class="c1"># This has to be consistent with the DDB/DVDB files</span>
<span class="w"> </span>boxcutmin<span class="w">  </span><span class="m">1</span>.1<span class="w">         </span><span class="c1"># Optimal value that speeds up the interpolation</span>

<span class="w"> </span>eph_ngqpt_fine1<span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w">  </span><span class="c1"># Interpolate to 3x3x3 q-grid</span>
<span class="w"> </span>eph_ngqpt_fine2<span class="w">  </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w">  </span><span class="c1">#                4x4x4 q-grid</span>
<span class="w"> </span>eph_ngqpt_fine3<span class="w">  </span><span class="m">5</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">5</span><span class="w">  </span><span class="c1">#                5x5x5 q-grid</span>

<span class="c1"># Pseudopotentials</span>
<span class="w"> </span>pp_dirpath<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">/Psdj_nc_sr_05_pbe_std_psp8&quot;</span>
<span class="w"> </span>pseudos<span class="w"> </span><span class="s2">&quot;Li.psp8, F.psp8&quot;</span>

<span class="c1"># Structure</span>
<span class="w"> </span>natom<span class="w">   </span><span class="m">2</span>
<span class="w"> </span>ntypat<span class="w">  </span><span class="m">2</span>
<span class="w"> </span>typat<span class="w">   </span><span class="m">1</span><span class="w"> </span><span class="m">2</span>
<span class="w"> </span>znucl<span class="w">   </span><span class="m">3</span><span class="w"> </span><span class="m">9</span>
<span class="w"> </span>xred<span class="w">    </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.0
<span class="w">         </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5

<span class="w"> </span>acell<span class="w"> </span><span class="m">3</span>*7.675
<span class="w"> </span>rprim<span class="w"> </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5
<span class="w">       </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.5
<span class="w">       </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% exclude_builders = eos_nvhpc_*</span>
<span class="c1">#%% test_chain = teph4vpq_1.abi, teph4vpq_2.abi, teph4vpq_3.abi,</span>
<span class="c1">#%%              teph4vpq_4.abi, teph4vpq_5.abi, teph4vpq_6.abi,</span>
<span class="c1">#%%              teph4vpq_7.abi, teph4vpq_8.abi, teph4vpq_9.abi,</span>
<span class="c1">#%%              teph4vpq_10.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% use_git_submodule = LiF_eph_varpeq</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   teph4vpq_3.abo, tolnlines = 120, tolabs = 5e-6, tolrel = 1</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = V. Vasilchenko</span>
<span class="c1">#%% keywords = DFPT, EPH, POLARON</span>
<span class="c1">#%% description =</span>
<span class="c1">#%%   LiF, Fm-3m space group.</span>
<span class="c1">#%%   Preparatory run for VarPEq calculations (hole polaron).</span>
<span class="c1">#%%   Computation of electron-phonon matrix elements on 3x3x3, 4x4x4, 5x5x5</span>
<span class="c1">#%%   k/q-grids using GSTORE.</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-88101cc4-fdb0-4098-a934-748ebdd15a79", "#uuid-d0896250-cf78-4b6c-a833-17dd5321b740") }); </script>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>To run the examples in parallel with e.g 2 MPI processes use:</p>
<div class="highlight"><pre><span></span><code>mpirun<span class="w"> </span>-n<span class="w"> </span><span class="m">2</span><span class="w"> </span>abinit<span class="w"> </span>teph4vpq_3.abi<span class="w"> </span>&gt;<span class="w"> </span>teph4vpq_3.log<span class="w"> </span><span class="m">2</span>&gt;<span class="w"> </span>err<span class="w"> </span><span class="p">&amp;</span>
</code></pre></div>
<p>The EPH code will automatically distribute the workload using a predefined distribution scheme
(not necessarily the most efficient in terms of memory and wall-time).
The input variable <a class="wikilink codevar-wikilink" href="/variables/eph#eph_np_pqbks">eph_np_pqbks</a> can be used to specify manually the distribution scheme.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>GSTORE calculations imply various level of the MPI parallelism and parallel IO.
At the time of writing this tutorial, the bottleneck
for number of MPI processes is the number of <span class="arithmatex">\(\mathbf{k}/\mathbf{q}\)</span>-points in the IBZ.
Specifing more may lead to idle processes that are handled differently by different compileres.</p>
<p>As we use <a class="wikilink codevar-wikilink" href="/variables/basic#ndtset">ndtset</a> mode to compute three GSTORE files in a single run, the first dataset (3x3x3 <span class="arithmatex">\(\kk/\qq\)</span>-mesh)
will be the limiting factor, and <strong>here the maximum number of allowed MPI processes</strong> is 4.
In production, it is <strong>highly recommended</strong> to compute seperate GSTORE files in individual runs.</p>
</div>
<p>Let&rsquo;s now discuss the meaning of the different variables in more detail.
We use <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> 7 to enter the EPH code while <a class="wikilink codevar-wikilink" href="/variables/eph#eph_task">eph_task</a> 11 activates
the computation of the electron-phonon matrix elements via interpolation of the DFPT scattering potentials.</p>
<p>The paths to the external files (<strong>DDB</strong>, <strong>WFK</strong>, <strong>DVDB</strong>) are specified with the three variables:</p>
<ul>
<li><a class="wikilink codevar-wikilink" href="/variables/files#getddb_filepath">getddb_filepath</a></li>
<li><a class="wikilink codevar-wikilink" href="/variables/files#getwfk_filepath">getwfk_filepath</a></li>
<li><a class="wikilink codevar-wikilink" href="/variables/files#getdvdb_filepath">getdvdb_filepath</a>.</li>
</ul>
<p>This is an excerpt of the input file:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Electron-phonon matrix elements parameters</span>
<span class="w"> </span>gstore_cplex<span class="w">  </span><span class="m">2</span><span class="w">     </span><span class="c1"># Complex e-ph matrix elements   (mandatory for VarPEq)</span>
<span class="w"> </span>gstore_kzone<span class="w">  </span><span class="s2">&quot;bz&quot;</span><span class="w">  </span><span class="c1"># Use full BZ for k and q meshes (mandatory for VarPEq)</span>
<span class="w"> </span>gstore_qzone<span class="w">  </span><span class="s2">&quot;bz&quot;</span>
<span class="w"> </span>gstore_brange<span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">5</span><span class="w">   </span><span class="c1"># Bands participating in the hole polaron formation:</span>
<span class="w">                     </span><span class="c1"># from 3 to 5 (triply degenerate valence band maximum)</span>
<span class="c1"># Wavefunction</span>
<span class="c1"># Read the WFK file from the preparatory run</span>
<span class="w"> </span>getwfk_filepath1<span class="w"> </span><span class="s2">&quot;teph4vpq_2o_DS1_WFK&quot;</span><span class="w">  </span><span class="c1"># 3x3x3 k-mesh</span>
<span class="w"> </span>getwfk_filepath2<span class="w"> </span><span class="s2">&quot;teph4vpq_2o_DS2_WFK&quot;</span><span class="w">  </span><span class="c1"># 4x4x4 k-mesh</span>
<span class="w"> </span>getwfk_filepath3<span class="w"> </span><span class="s2">&quot;teph4vpq_2o_DS3_WFK&quot;</span><span class="w">  </span><span class="c1"># 5x5x5 k-mesh</span>

<span class="w"> </span>ngkpt1<span class="w">   </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w">  </span><span class="c1"># These parameters have to be consistent with the WFK file</span>
<span class="w"> </span>ngkpt2<span class="w">   </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">4</span>
<span class="w"> </span>ngkpt3<span class="w">   </span><span class="m">5</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">5</span>
<span class="w"> </span>...

<span class="c1"># Phonons</span>
<span class="w"> </span>getddb_filepath
<span class="w"> </span><span class="s2">&quot;LiF_eph_varpeq/out_DDB&quot;</span><span class="w">  </span><span class="c1"># Read the precomputed DDB stored in git submodule</span>
<span class="w">                           </span><span class="c1"># NOTE: for the input parameters used to produce</span>
<span class="w">                           </span><span class="c1"># the DDB file, consult the LiF_eph_varpeq/dfpt.abi</span>

<span class="c1"># Scattering potentials</span>
<span class="w"> </span>getdvdb_filepath
<span class="w"> </span><span class="s2">&quot;teph4vpq_1_DVDB&quot;</span><span class="w">  </span><span class="c1"># Read the DVDB file from the preparatory run</span>

<span class="c1"># Phonons and scattering potentials interpolation</span>
<span class="w"> </span>ddb_ngqpt<span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w">       </span><span class="c1"># This has to be consistent with the DDB/DVDB files</span>
<span class="w"> </span>...

<span class="w"> </span>eph_ngqpt_fine1<span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w">  </span><span class="c1"># Interpolate to 3x3x3 q-grid</span>
<span class="w"> </span>eph_ngqpt_fine2<span class="w">  </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w">  </span><span class="c1">#                4x4x4 q-grid</span>
<span class="w"> </span>eph_ngqpt_fine3<span class="w">  </span><span class="m">5</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">5</span><span class="w">  </span><span class="c1">#                5x5x5 q-grid</span>
</code></pre></div>
<p>The mesh for electrons (<a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#shiftk">shiftk</a>) must
correspond to the one used for the input WFK file.
<a class="wikilink codevar-wikilink" href="/variables/eph#ddb_ngqpt">ddb_ngqpt</a> is set to 3x3x3 as this is the <span class="arithmatex">\(\qq\)</span>-mesh used in the DFPT part to generate the DDB and DVDB files,
but the integration in <span class="arithmatex">\(\qq\)</span>-space is performed with the <a class="wikilink codevar-wikilink" href="/variables/eph#eph_ngqpt_fine">eph_ngqpt_fine</a> mesh.
As <a class="wikilink codevar-wikilink" href="/variables/eph#eph_ngqpt_fine">eph_ngqpt_fine</a> differs from <a class="wikilink codevar-wikilink" href="/variables/eph#ddb_ngqpt">ddb_ngqpt</a>, the code will automatically activate
the interpolation of the DFPT potentials as discussed in the <a href="/tutorial/eph_intro">introduction to the EPH code</a>.</p>
<p>Polaron calculations require complex electron-phonon matrix elements, hence <a class="wikilink codevar-wikilink" href="/variables/eph#gstore_cplex">gstore_cplex</a> 2 is used.
As we will deal with small hole polaron, and the VBM in LiF is triply-degenerate, we select the last three occupied bands
via <a class="wikilink codevar-wikilink" href="/variables/eph#gstore_brange">gstore_brange</a> variable.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>At present, at the level of polaron computations, no symmetry is assumed for the electron-phonon matrix elements.
Hence these terms have to be computed in the full BZ for <span class="arithmatex">\(\kk\)</span> and <span class="arithmatex">\(\qq\)</span> vectors.
This behaviour is specified by the <a class="wikilink codevar-wikilink" href="/variables/eph#gstore_kzone">gstore_kzone</a> and <a class="wikilink codevar-wikilink" href="/variables/eph#gstore_qzone">gstore_qzone</a> variables.
As a result, for some systems GSTORE files may require a relatively large amount of phyical memory.</p>
<p>In principle, it is possible to utilize symmetries for matrix elements, albeit this requires the correct treatment of
the scattering between degenerate states via degenerate phonons <a class="wikilink citation-wikilink" data-tippy-content="Electron-phonon coupling from GW perturbation theory: Practical workflow combining BerkeleyGW, ABINIT, and EPW" data-toggle="popover" href="/theory/bibliography#li2024">[Li2024]</a>.
This feature, however, is not yet implemented.</p>
</div>
<p>We can now have a look at the main output file:</p>
<div class="text-center"><button id="uuid-97256570-3ff1-4942-a71a-3b42a7411f9f" class="md-button md-button--secondary"> View tests/tutorespfn/Refs/teph4vpq_3.abo </button></div>
<div id="uuid-14c50c6d-b613-498c-b057-fee30da5a665" class="my_dialog" title="tests/tutorespfn/Refs/teph4vpq_3.abo" hidden><div><pre class="small-text">

.Version 10.3.4.7 of ABINIT, released Dec 2025.
.(MPI version, prepared for a x86_64_linux_gnu13.2 computer) 

.Copyright (C) 1998-2025 ABINIT group . 
 ABINIT comes with ABSOLUTELY NO WARRANTY.
 It is free software, and you are welcome to redistribute it
 under certain conditions (GNU General Public License,
 see ~abinit/COPYING or http://www.gnu.org/copyleft/gpl.txt).

 ABINIT is a project of the Universite Catholique de Louvain,
 Corning Inc. and other collaborators, see ~abinit/doc/developers/contributors.txt .
 Please read https://docs.abinit.org/theory/acknowledgments for suggested
 acknowledgments of the ABINIT effort.
 For more information, see https://www.abinit.org .

.Starting date : Sun 23 Feb 2025.
- ( at 16h06 )

- input  file    -&gt; /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/vvasilchenko_varpeq_nosym/tests/TestBot_MPI1/tutorespfn_teph4vpq_1-teph4vpq_2-teph4vpq_3-teph4vpq_4-teph4vpq_5-teph4vpq_6-teph4vpq_7-teph4vpq_8-teph4vpq_9-teph4vpq_10/teph4vpq_3.abi
- output file    -&gt; teph4vpq_3.abo
- root for input  files -&gt; teph4vpq_3i
- root for output files -&gt; teph4vpq_3o

 DATASET    1 : space group Fm -3 m (#225); Bravais cF (face-center cubic)
================================================================================
 Values of the parameters that define the memory need for DATASET  1.
     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       5
     lnmax =       5     mgfft =      16  mpssoang =       3    mqgrid =    3001
     natom =       2  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      48    n1xccc =    2501    ntypat =       2
    occopt =       1   xclevel =       2
-    mband =           6        mffmem =           1         mkmem =           4
       mpw =         896          nfft =        4096          nkpt =           4
================================================================================
P This job should need less than                       2.929 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      0.330 Mbytes ; DEN or POT disk file :      0.033 Mbytes.
================================================================================

 DATASET    2 : space group Fm -3 m (#225); Bravais cF (face-center cubic)
================================================================================
 Values of the parameters that define the memory need for DATASET  2.
     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       5
     lnmax =       5     mgfft =      16  mpssoang =       3    mqgrid =    3001
     natom =       2  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      48    n1xccc =    2501    ntypat =       2
    occopt =       1   xclevel =       2
-    mband =           6        mffmem =           1         mkmem =           8
       mpw =         896          nfft =        4096          nkpt =           8
================================================================================
P This job should need less than                       3.302 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      0.658 Mbytes ; DEN or POT disk file :      0.033 Mbytes.
================================================================================

 DATASET    3 : space group Fm -3 m (#225); Bravais cF (face-center cubic)
================================================================================
 Values of the parameters that define the memory need for DATASET  3.
     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       5
     lnmax =       5     mgfft =      16  mpssoang =       3    mqgrid =    3001
     natom =       2  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      48    n1xccc =    2501    ntypat =       2
    occopt =       1   xclevel =       2
-    mband =           6        mffmem =           1         mkmem =          10
       mpw =         899          nfft =        4096          nkpt =          10
================================================================================
P This job should need less than                       3.492 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      0.825 Mbytes ; DEN or POT disk file :      0.033 Mbytes.
================================================================================

--------------------------------------------------------------------------------
------------- Echo of variables that govern the present computation ------------
--------------------------------------------------------------------------------
-
- outvars: echo of selected default values
-   iomode0 =  0 , fftalg0 =512 , wfoptalg0 =  0
-
- outvars: echo of global parameters not present in the input file
-  max_nthreads =    0
-
 -outvars: echo values of preprocessed input variables --------
            acell      7.6750000000E+00  7.6750000000E+00  7.6750000000E+00 Bohr
              amu      6.94100000E+00  1.89984032E+01
        boxcutmin      1.10000000E+00
        ddb_ngqpt        3    3    3
             ecut      3.00000000E+01 Hartree
   eph_ngqpt_fine1       3    3    3
   eph_ngqpt_fine2       4    4    4
   eph_ngqpt_fine3       5    5    5
         eph_task          11
-          fftalg         512
           istwfk1       2    0    0    0
           istwfk2       2    0    3    0    0    0    7    0
           istwfk3       2    0    0    0    0    0    0    0    0    0
              ixc          11
           jdtset        1    2    3
              kpt1     0.00000000E+00  0.00000000E+00  0.00000000E+00
                       3.33333333E-01  0.00000000E+00  0.00000000E+00
                       3.33333333E-01  3.33333333E-01  0.00000000E+00
                      -3.33333333E-01  3.33333333E-01  0.00000000E+00
              kpt2     0.00000000E+00  0.00000000E+00  0.00000000E+00
                       2.50000000E-01  0.00000000E+00  0.00000000E+00
                       5.00000000E-01  0.00000000E+00  0.00000000E+00
                       2.50000000E-01  2.50000000E-01  0.00000000E+00
                       5.00000000E-01  2.50000000E-01  0.00000000E+00
                      -2.50000000E-01  2.50000000E-01  0.00000000E+00
                       5.00000000E-01  5.00000000E-01  0.00000000E+00
                      -2.50000000E-01  5.00000000E-01  2.50000000E-01
              kpt3     0.00000000E+00  0.00000000E+00  0.00000000E+00
                       2.00000000E-01  0.00000000E+00  0.00000000E+00
                       4.00000000E-01  0.00000000E+00  0.00000000E+00
                       2.00000000E-01  2.00000000E-01  0.00000000E+00
                       4.00000000E-01  2.00000000E-01  0.00000000E+00
                      -4.00000000E-01  2.00000000E-01  0.00000000E+00
                      -2.00000000E-01  2.00000000E-01  0.00000000E+00
                       4.00000000E-01  4.00000000E-01  0.00000000E+00
                      -4.00000000E-01  4.00000000E-01  0.00000000E+00
                      -4.00000000E-01  4.00000000E-01  2.00000000E-01
         kptrlatt1       3    0    0      0    3    0      0    0    3
         kptrlatt2       4    0    0      0    4    0      0    0    4
         kptrlatt3       5    0    0      0    5    0      0    0    5
          kptrlen1     1.62811336E+01
          kptrlen2     2.17081782E+01
          kptrlen3     2.71352227E+01
P           mkmem1          4
P           mkmem2          8
P           mkmem3         10
            natom           2
            nband1          6
            nband2          6
            nband3          6
           ndtset           3
            ngfft          16      16      16
             nkpt1          4
             nkpt2          8
             nkpt3         10
             nsym          48
           ntypat           2
              occ1     2.000000  2.000000  2.000000  2.000000  2.000000  0.000000
              occ2     2.000000  2.000000  2.000000  2.000000  2.000000  0.000000
              occ3     2.000000  2.000000  2.000000  2.000000  2.000000  0.000000
        optdriver           7
            rprim      0.0000000000E+00  5.0000000000E-01  5.0000000000E-01
                       5.0000000000E-01  0.0000000000E+00  5.0000000000E-01
                       5.0000000000E-01  5.0000000000E-01  0.0000000000E+00
          spgroup         225
           symrel      1  0  0   0  1  0   0  0  1      -1  0  0   0 -1  0   0  0 -1
                       0 -1  1   0 -1  0   1 -1  0       0  1 -1   0  1  0  -1  1  0
                      -1  0  0  -1  0  1  -1  1  0       1  0  0   1  0 -1   1 -1  0
                       0  1 -1   1  0 -1   0  0 -1       0 -1  1  -1  0  1   0  0  1
                      -1  0  0  -1  1  0  -1  0  1       1  0  0   1 -1  0   1  0 -1
                       0 -1  1   1 -1  0   0 -1  0       0  1 -1  -1  1  0   0  1  0
                       1  0  0   0  0  1   0  1  0      -1  0  0   0  0 -1   0 -1  0
                       0  1 -1   0  0 -1   1  0 -1       0 -1  1   0  0  1  -1  0  1
                      -1  0  1  -1  1  0  -1  0  0       1  0 -1   1 -1  0   1  0  0
                       0 -1  0   1 -1  0   0 -1  1       0  1  0  -1  1  0   0  1 -1
                       1  0 -1   0  0 -1   0  1 -1      -1  0  1   0  0  1   0 -1  1
                       0  1  0   0  0  1   1  0  0       0 -1  0   0  0 -1  -1  0  0
                       1  0 -1   0  1 -1   0  0 -1      -1  0  1   0 -1  1   0  0  1
                       0 -1  0   0 -1  1   1 -1  0       0  1  0   0  1 -1  -1  1  0
                      -1  0  1  -1  0  0  -1  1  0       1  0 -1   1  0  0   1 -1  0
                       0  1  0   1  0  0   0  0  1       0 -1  0  -1  0  0   0  0 -1
                       0  0 -1   0  1 -1   1  0 -1       0  0  1   0 -1  1  -1  0  1
                       1 -1  0   0 -1  1   0 -1  0      -1  1  0   0  1 -1   0  1  0
                       0  0  1   1  0  0   0  1  0       0  0 -1  -1  0  0   0 -1  0
                      -1  1  0  -1  0  0  -1  0  1       1 -1  0   1  0  0   1  0 -1
                       0  0  1   0  1  0   1  0  0       0  0 -1   0 -1  0  -1  0  0
                       1 -1  0   0 -1  0   0 -1  1      -1  1  0   0  1  0   0  1 -1
                       0  0 -1   1  0 -1   0  1 -1       0  0  1  -1  0  1   0 -1  1
                      -1  1  0  -1  0  1  -1  0  0       1 -1  0   1  0 -1   1  0  0
            typat      1  2
              wtk1       0.03704    0.29630    0.22222    0.44444
              wtk2       0.01563    0.12500    0.06250    0.09375    0.37500    0.18750
                         0.04688    0.09375
              wtk3       0.00800    0.06400    0.06400    0.04800    0.19200    0.19200
                         0.09600    0.04800    0.09600    0.19200
           xangst      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.0307175380E+00  2.0307175380E+00  2.0307175380E+00
            xcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       3.8375000000E+00  3.8375000000E+00  3.8375000000E+00
             xred      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       5.0000000000E-01  5.0000000000E-01  5.0000000000E-01
            znucl        3.00000    9.00000

================================================================================

 chkinp: Checking input parameters for consistency, jdtset=   1.

 chkinp: Checking input parameters for consistency, jdtset=   2.

 chkinp: Checking input parameters for consistency, jdtset=   3.

================================================================================
== DATASET  1 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 1, }
dimensions: {natom: 2, nkpt: 4, mband: 6, nsppol: 1, nspinor: 1, nspden: 1, mpw: 896, }
cutoff_energies: {ecut:  30.0, pawecutdg:  -1.0, }
electrons: {nelect:   1.00000000E+01, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 7, eph_task: 11, }
...

 mkfilename: getwfk from: teph4vpq_2o_DS1_WFK

 mkfilename: getddb from: LiF_eph_varpeq/out_DDB

 mkfilename: getdvdb from: teph4vpq_1_DVDB

 Exchange-correlation functional for the present dataset will be:
  GGA: Perdew-Burke-Ernzerhof functional - ixc=11
 Citation for XC functional:
  J.P.Perdew, K.Burke, M.Ernzerhof, PRL 77, 3865 (1996)

- Reading GS states from WFK file: teph4vpq_2o_DS1_WFK
- Reading DDB from file: LiF_eph_varpeq/out_DDB
- Reading DVDB from file: teph4vpq_1_DVDB




  ==== Info on the Cryst% object ====
 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  0.0000000  3.8375000  3.8375000  G(1)= -0.1302932  0.1302932  0.1302932
 R(2)=  3.8375000  0.0000000  3.8375000  G(2)=  0.1302932 -0.1302932  0.1302932
 R(3)=  3.8375000  3.8375000  0.0000000  G(3)=  0.1302932  0.1302932 -0.1302932
 Unit cell volume ucvol=  1.1302517E+02 bohr^3
 Angles (23,13,12)=  6.00000000E+01  6.00000000E+01  6.00000000E+01 degrees
 Time-reversal symmetry is present
 Reduced atomic positions [iatom, xred, symbol]:
    1)    0.0000000  0.0000000  0.0000000  Li
    2)    0.5000000  0.5000000  0.5000000   F

 DDB file with 4 blocks has been read.

================================================================================

 Dielectric Tensor and Effective Charges 


 anaddb : Zero the imaginary part of the Dynamical Matrix at Gamma,
   and impose the ASR on the effective charges 

 The violation of the charge neutrality conditions
 by the effective charges is as follows :
    atom        electric field
 displacement     direction
       1               1       -0.065315        0.000000
       1               2        0.000000        0.000000
       1               3        0.000000        0.000000
       2               1        0.000000        0.000000
       2               2       -0.065315        0.000000
       2               3       -0.000000        0.000000
       3               1       -0.000000        0.000000
       3               2       -0.000000        0.000000
       3               3       -0.065315        0.000000

 Effective charge tensors after 
 imposition of the charge neutrality (if requested by user),
 and eventual restriction to some part :
   atom    displacement
         1         1    1.092224E+00   -9.389407E-16   -9.386159E-16
         1         2   -5.076227E-17    1.092224E+00    9.392655E-16
         1         3    5.076227E-17    9.389407E-16    1.092224E+00
         2         1   -1.092224E+00    9.389407E-16    9.386159E-16
         2         2    5.076227E-17   -1.092224E+00   -9.392655E-16
         2         3   -5.076227E-17   -9.389407E-16   -1.092224E+00
 Now, the imaginary part of the dynamical matrix is zeroed
- Found dielectric tensor and Born effective charges in DDB file: LiF_eph_varpeq/out_DDB
- Cannot find quadrupole tensor in DDB file: LiF_eph_varpeq/out_DDB
 Values initialized with zeros.
       Homogeneous q point set in the B.Z.
 Grid q points  :       27
  1)   0.00000000E+00  0.00000000E+00  0.00000000E+00
  2)   3.33333333E-01  0.00000000E+00  0.00000000E+00
  3)  -3.33333333E-01  0.00000000E+00  0.00000000E+00
  4)   0.00000000E+00  3.33333333E-01  0.00000000E+00
  5)   3.33333333E-01  3.33333333E-01  0.00000000E+00
  6)  -3.33333333E-01  3.33333333E-01  0.00000000E+00
  7)   0.00000000E+00 -3.33333333E-01  0.00000000E+00
  8)   3.33333333E-01 -3.33333333E-01  0.00000000E+00
  9)  -3.33333333E-01 -3.33333333E-01  0.00000000E+00
 10)   0.00000000E+00  0.00000000E+00  3.33333333E-01
 11)   3.33333333E-01  0.00000000E+00  3.33333333E-01
 12)  -3.33333333E-01  0.00000000E+00  3.33333333E-01
 13)   0.00000000E+00  3.33333333E-01  3.33333333E-01
 14)   3.33333333E-01  3.33333333E-01  3.33333333E-01
 15)  -3.33333333E-01  3.33333333E-01  3.33333333E-01
 16)   0.00000000E+00 -3.33333333E-01  3.33333333E-01
 17)   3.33333333E-01 -3.33333333E-01  3.33333333E-01
 18)  -3.33333333E-01 -3.33333333E-01  3.33333333E-01
 19)   0.00000000E+00  0.00000000E+00 -3.33333333E-01
 20)   3.33333333E-01  0.00000000E+00 -3.33333333E-01
 21)  -3.33333333E-01  0.00000000E+00 -3.33333333E-01
 22)   0.00000000E+00  3.33333333E-01 -3.33333333E-01
 23)   3.33333333E-01  3.33333333E-01 -3.33333333E-01
 24)  -3.33333333E-01  3.33333333E-01 -3.33333333E-01
 25)   0.00000000E+00 -3.33333333E-01 -3.33333333E-01
 26)   3.33333333E-01 -3.33333333E-01 -3.33333333E-01
 27)  -3.33333333E-01 -3.33333333E-01 -3.33333333E-01

 The interatomic forces have been obtained
 Average speed of sound partial sums:     0.2234217387E-02 (at units)
-                                   =           4.8878 [km/s]

 Debye frequency from partial sums:     0.1801153402E-02 (Ha)
-                                 =     0.1185102008E+02 (THz)
-Debye temperature from partial sums:     0.5687585851E+03 (K)

 Average speed of sound partial sums:     0.2234217387E-02 (at units)
-                                   =           4.8878 [km/s]

 Debye frequency from partial sums:     0.1801153402E-02 (Ha)
-                                 =     0.1185102008E+02 (THz)
-Debye temperature from partial sums:     0.5687585851E+03 (K)

- Writing phonon DOS to netcdf file: teph4vpq_3o_DS1_PHDOS.nc

--- Pseudopotential description ------------------------------------------------
- pspini: atom type   1  psp file is /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/vvasilchenko_varpeq_nosym/tests/Pspdir/Psdj_nc_sr_05_pbe_std_psp8/Li.psp8
- pspatm: opening atomic psp file    /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/vvasilchenko_varpeq_nosym/tests/Pspdir/Psdj_nc_sr_05_pbe_std_psp8/Li.psp8
- Li    ONCVPSP-3.2.3.1  r_core=   1.40824   1.10935
-  3.00000   3.00000    170503                znucl, zion, pspdat
    8   11    1    4       400   0.00000      pspcod,pspxc,lmax,lloc,mmax,r2well
    3.99000000000000    0.00000000000000    0.00000000000000   rchrg,fchrg,qchrg
     nproj     2     2
     extension_switch     1
  pspatm : epsatm=    2.74345787
         --- l  ekb(1:nproj) --&gt;
             0   -4.951544   -1.544797
             1   -2.250662   -0.474685
 pspatm: atomic psp has been read  and splines computed

- pspini: atom type   2  psp file is /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/vvasilchenko_varpeq_nosym/tests/Pspdir/Psdj_nc_sr_05_pbe_std_psp8/F.psp8
- pspatm: opening atomic psp file    /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/vvasilchenko_varpeq_nosym/tests/Pspdir/Psdj_nc_sr_05_pbe_std_psp8/F.psp8
- F     ONCVPSP-3.2.3.1  r_core=   1.30942   1.45782   1.60379
-  9.00000   7.00000    170504                znucl, zion, pspdat
    8   11    2    4       600   0.00000      pspcod,pspxc,lmax,lloc,mmax,r2well
    5.99000000000000    2.50000000000000    0.00000000000000   rchrg,fchrg,qchrg
     nproj     2     2     1
     extension_switch     1
  pspatm : epsatm=    4.87626060
         --- l  ekb(1:nproj) --&gt;
             0    6.519403    1.070094
             1   -3.955629   -1.291931
             2   -2.441503
 pspatm: atomic psp has been read  and splines computed

   7.61971847E+01                                ecore*ucvol(ha*bohr**3)
--------------------------------------------------------------------------------

 === Gstore parameters ===
 kzone: bz
 kfilter: none
 nkibz: 4
 nkbz: 27
 glob_nk_spin: [27]
 qzone: bz
 nqibz: 4
 nqbz: 27
 glob_nq_spin: [27]
 kptopt: 1
 qptopt: 1
 with_vk: 1

 gqk_cplex: 2
 gqk_bstart: 3
 gqk_bstop: 5
 gqk_nb: 3
 gqk_my_npert: 6
 gqk_my_nk: -1
 gqk_my_nq: -1

  === MPI distribution ===
P Number of CPUs for parallelism over perturbations: 1
P Number of perturbations treated by this CPU: 6
P Number of CPUs for parallelism over q-points: 1
P Number of CPUs for parallelism over k-points: 1
 DVDB file contains all q-points in the IBZ --&gt; Reading DFPT potentials from file.

 gstore_completed: 1
 gstore_done_qbz_spin: 27
 gqk%nb: 3
 gqk%glob_nq: 27
 gqk%glob_nk: 27
 E-PH matrix elements:
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
 |g(k,q)|^2 in Ha^2 for iq: 1 ik: 1 mode: 4
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
     1     1     4     1     1     1.458413E-24
     1     1     4     1     2     1.209049E-26
     1     1     4     1     3     1.720504E-27
     1     1     4     2     1     1.208968E-26
     1     1     4     2     2     4.975231E-25
     1     1     4     2     3     6.307039E-27
     1     1     4     3     1     1.720573E-27
     1     1     4     3     2     6.307222E-27
     1     1     4     3     3     2.061652E-25
 |g(k,q)|^2 in Ha^2 for iq: 1 ik: 1 mode: 6
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
     1     1     6     1     1     7.169195E-28
     1     1     6     1     2     3.297664E-25
     1     1     6     1     3     5.025685E-25
     1     1     6     2     1     3.297641E-25
     1     1     6     2     2     7.923151E-25
     1     1     6     2     3     6.757426E-25
     1     1     6     3     1     5.025618E-25
     1     1     6     3     2     6.757428E-25
     1     1     6     3     3     1.066013E-24
 |g(k,q)|^2 in Ha^2 for iq: 1 ik: 27 mode: 4
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
     1    27     4     1     1     3.093068E-27
     1    27     4     1     2     3.427028E-07
     1    27     4     1     3     1.031266E-06
     1    27     4     2     1     3.427028E-07
     1    27     4     2     2     1.842703E-25
     1    27     4     2     3     1.825717E-16
     1    27     4     3     1     1.031266E-06
     1    27     4     3     2     1.825717E-16
     1    27     4     3     3     6.768395E-26
 |g(k,q)|^2 in Ha^2 for iq: 1 ik: 27 mode: 6
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
     1    27     6     1     1     2.761310E-25
     1    27     6     1     2     1.374298E-06
     1    27     6     1     3     1.318098E-12
     1    27     6     2     1     1.374298E-06
     1    27     6     2     2     6.876552E-26
     1    27     6     2     3     1.931274E-16
     1    27     6     3     1     1.318098E-12
     1    27     6     3     2     1.931274E-16
     1    27     6     3     3     2.986686E-25
 |g(k,q)|^2 in Ha^2 for iq: 27 ik: 1 mode: 4
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
    27     1     4     1     1     2.419844E-06
    27     1     4     1     2     4.614318E-06
    27     1     4     1     3     3.500912E-07
    27     1     4     2     1     3.225681E-10
    27     1     4     2     2     1.248483E-06
    27     1     4     2     3     1.712025E-05
    27     1     4     3     1     3.377259E-08
    27     1     4     3     2     1.088504E-08
    27     1     4     3     3     1.532463E-09
 |g(k,q)|^2 in Ha^2 for iq: 27 ik: 1 mode: 6
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
    27     1     6     1     1     2.310794E-05
    27     1     6     1     2     4.329633E-05
    27     1     6     1     3     3.155267E-06
    27     1     6     2     1     6.329838E-13
    27     1     6     2     2     3.423089E-06
    27     1     6     2     3     4.756787E-05
    27     1     6     3     1     9.306980E-05
    27     1     6     3     2     4.327594E-05
    27     1     6     3     3     3.104917E-06
 |g(k,q)|^2 in Ha^2 for iq: 27 ik: 27 mode: 4
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
    27    27     4     1     1     1.080256E-06
    27    27     4     1     2     6.731334E-06
    27    27     4     1     3     5.904215E-06
    27    27     4     2     1     6.604648E-07
    27    27     4     2     2     3.512644E-06
    27    27     4     2     3     4.372777E-09
    27    27     4     3     1     2.807049E-06
    27    27     4     3     2     2.249460E-07
    27    27     4     3     3     2.020157E-06
 |g(k,q)|^2 in Ha^2 for iq: 27 ik: 27 mode: 6
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
    27    27     6     1     1     3.100464E-05
    27    27     6     1     2     6.417471E-05
    27    27     6     1     3     2.295926E-06
    27    27     6     2     1     9.446407E-07
    27    27     6     2     2     5.275272E-07
    27    27     6     2     3     8.719953E-05
    27    27     6     3     1     5.596086E-05
    27    27     6     3     2     2.159868E-05
    27    27     6     3     3     1.107545E-06

================================================================================
== DATASET  2 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 2, }
dimensions: {natom: 2, nkpt: 8, mband: 6, nsppol: 1, nspinor: 1, nspden: 1, mpw: 896, }
cutoff_energies: {ecut:  30.0, pawecutdg:  -1.0, }
electrons: {nelect:   1.00000000E+01, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 7, eph_task: 11, }
...

 mkfilename: getwfk from: teph4vpq_2o_DS2_WFK

 mkfilename: getddb from: LiF_eph_varpeq/out_DDB

 mkfilename: getdvdb from: teph4vpq_1_DVDB

 Exchange-correlation functional for the present dataset will be:
  GGA: Perdew-Burke-Ernzerhof functional - ixc=11
 Citation for XC functional:
  J.P.Perdew, K.Burke, M.Ernzerhof, PRL 77, 3865 (1996)

- Reading GS states from WFK file: teph4vpq_2o_DS2_WFK
- Reading DDB from file: LiF_eph_varpeq/out_DDB
- Reading DVDB from file: teph4vpq_1_DVDB




  ==== Info on the Cryst% object ====
 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  0.0000000  3.8375000  3.8375000  G(1)= -0.1302932  0.1302932  0.1302932
 R(2)=  3.8375000  0.0000000  3.8375000  G(2)=  0.1302932 -0.1302932  0.1302932
 R(3)=  3.8375000  3.8375000  0.0000000  G(3)=  0.1302932  0.1302932 -0.1302932
 Unit cell volume ucvol=  1.1302517E+02 bohr^3
 Angles (23,13,12)=  6.00000000E+01  6.00000000E+01  6.00000000E+01 degrees
 Time-reversal symmetry is present
 Reduced atomic positions [iatom, xred, symbol]:
    1)    0.0000000  0.0000000  0.0000000  Li
    2)    0.5000000  0.5000000  0.5000000   F

 DDB file with 4 blocks has been read.

================================================================================

 Dielectric Tensor and Effective Charges 


 anaddb : Zero the imaginary part of the Dynamical Matrix at Gamma,
   and impose the ASR on the effective charges 

 The violation of the charge neutrality conditions
 by the effective charges is as follows :
    atom        electric field
 displacement     direction
       1               1       -0.065315        0.000000
       1               2        0.000000        0.000000
       1               3        0.000000        0.000000
       2               1        0.000000        0.000000
       2               2       -0.065315        0.000000
       2               3       -0.000000        0.000000
       3               1       -0.000000        0.000000
       3               2       -0.000000        0.000000
       3               3       -0.065315        0.000000

 Effective charge tensors after 
 imposition of the charge neutrality (if requested by user),
 and eventual restriction to some part :
   atom    displacement
         1         1    1.092224E+00   -9.389407E-16   -9.386159E-16
         1         2   -5.076227E-17    1.092224E+00    9.392655E-16
         1         3    5.076227E-17    9.389407E-16    1.092224E+00
         2         1   -1.092224E+00    9.389407E-16    9.386159E-16
         2         2    5.076227E-17   -1.092224E+00   -9.392655E-16
         2         3   -5.076227E-17   -9.389407E-16   -1.092224E+00
 Now, the imaginary part of the dynamical matrix is zeroed
- Found dielectric tensor and Born effective charges in DDB file: LiF_eph_varpeq/out_DDB
- Cannot find quadrupole tensor in DDB file: LiF_eph_varpeq/out_DDB
 Values initialized with zeros.
       Homogeneous q point set in the B.Z.
 Grid q points  :       27
  1)   0.00000000E+00  0.00000000E+00  0.00000000E+00
  2)   3.33333333E-01  0.00000000E+00  0.00000000E+00
  3)  -3.33333333E-01  0.00000000E+00  0.00000000E+00
  4)   0.00000000E+00  3.33333333E-01  0.00000000E+00
  5)   3.33333333E-01  3.33333333E-01  0.00000000E+00
  6)  -3.33333333E-01  3.33333333E-01  0.00000000E+00
  7)   0.00000000E+00 -3.33333333E-01  0.00000000E+00
  8)   3.33333333E-01 -3.33333333E-01  0.00000000E+00
  9)  -3.33333333E-01 -3.33333333E-01  0.00000000E+00
 10)   0.00000000E+00  0.00000000E+00  3.33333333E-01
 11)   3.33333333E-01  0.00000000E+00  3.33333333E-01
 12)  -3.33333333E-01  0.00000000E+00  3.33333333E-01
 13)   0.00000000E+00  3.33333333E-01  3.33333333E-01
 14)   3.33333333E-01  3.33333333E-01  3.33333333E-01
 15)  -3.33333333E-01  3.33333333E-01  3.33333333E-01
 16)   0.00000000E+00 -3.33333333E-01  3.33333333E-01
 17)   3.33333333E-01 -3.33333333E-01  3.33333333E-01
 18)  -3.33333333E-01 -3.33333333E-01  3.33333333E-01
 19)   0.00000000E+00  0.00000000E+00 -3.33333333E-01
 20)   3.33333333E-01  0.00000000E+00 -3.33333333E-01
 21)  -3.33333333E-01  0.00000000E+00 -3.33333333E-01
 22)   0.00000000E+00  3.33333333E-01 -3.33333333E-01
 23)   3.33333333E-01  3.33333333E-01 -3.33333333E-01
 24)  -3.33333333E-01  3.33333333E-01 -3.33333333E-01
 25)   0.00000000E+00 -3.33333333E-01 -3.33333333E-01
 26)   3.33333333E-01 -3.33333333E-01 -3.33333333E-01
 27)  -3.33333333E-01 -3.33333333E-01 -3.33333333E-01

 The interatomic forces have been obtained
 Average speed of sound partial sums:     0.2234217387E-02 (at units)
-                                   =           4.8878 [km/s]

 Debye frequency from partial sums:     0.1801153402E-02 (Ha)
-                                 =     0.1185102008E+02 (THz)
-Debye temperature from partial sums:     0.5687585851E+03 (K)

 Average speed of sound partial sums:     0.2234217387E-02 (at units)
-                                   =           4.8878 [km/s]

 Debye frequency from partial sums:     0.1801153402E-02 (Ha)
-                                 =     0.1185102008E+02 (THz)
-Debye temperature from partial sums:     0.5687585851E+03 (K)

- Writing phonon DOS to netcdf file: teph4vpq_3o_DS2_PHDOS.nc
--------------------------------------------------------------------------------

 === Gstore parameters ===
 kzone: bz
 kfilter: none
 nkibz: 8
 nkbz: 64
 glob_nk_spin: [64]
 qzone: bz
 nqibz: 8
 nqbz: 64
 glob_nq_spin: [64]
 kptopt: 1
 qptopt: 1
 with_vk: 1

 gqk_cplex: 2
 gqk_bstart: 3
 gqk_bstop: 5
 gqk_nb: 3
 gqk_my_npert: 6
 gqk_my_nk: -1
 gqk_my_nq: -1

  === MPI distribution ===
P Number of CPUs for parallelism over perturbations: 1
P Number of perturbations treated by this CPU: 6
P Number of CPUs for parallelism over q-points: 1
P Number of CPUs for parallelism over k-points: 1
 Cannot find all IBZ q-points in the DVDB --&gt; Activating Fourier interpolation.

 gstore_completed: 1
 gstore_done_qbz_spin: 64
 gqk%nb: 3
 gqk%glob_nq: 64
 gqk%glob_nk: 64
 E-PH matrix elements:
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
 |g(k,q)|^2 in Ha^2 for iq: 1 ik: 1 mode: 4
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
     1     1     4     1     1     1.887083E-18
     1     1     4     1     2     1.061234E-19
     1     1     4     1     3     4.213120E-20
     1     1     4     2     1     1.061234E-19
     1     1     4     2     2     9.068487E-19
     1     1     4     2     3     1.186030E-18
     1     1     4     3     1     4.213120E-20
     1     1     4     3     2     1.186030E-18
     1     1     4     3     3     3.692817E-18
 |g(k,q)|^2 in Ha^2 for iq: 1 ik: 1 mode: 6
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
     1     1     6     1     1     1.390373E-19
     1     1     6     1     2     2.528168E-19
     1     1     6     1     3     9.706093E-19
     1     1     6     2     1     2.528168E-19
     1     1     6     2     2     7.301823E-24
     1     1     6     2     3     4.601545E-19
     1     1     6     3     1     9.706093E-19
     1     1     6     3     2     4.601545E-19
     1     1     6     3     3     3.883247E-19
 |g(k,q)|^2 in Ha^2 for iq: 1 ik: 64 mode: 4
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
     1    64     4     1     1     1.269541E-18
     1    64     4     1     2     4.401124E-07
     1    64     4     1     3     1.323776E-06
     1    64     4     2     1     4.401124E-07
     1    64     4     2     2     1.386140E-18
     1    64     4     2     3     1.656144E-16
     1    64     4     3     1     1.323776E-06
     1    64     4     3     2     1.656144E-16
     1    64     4     3     3     4.681217E-20
 |g(k,q)|^2 in Ha^2 for iq: 1 ik: 64 mode: 6
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
     1    64     6     1     1     9.493234E-20
     1    64     6     1     2     1.764353E-06
     1    64     6     1     3     1.518634E-12
     1    64     6     2     1     1.764353E-06
     1    64     6     2     2     8.317445E-19
     1    64     6     2     3     1.269487E-16
     1    64     6     3     1     1.518634E-12
     1    64     6     3     2     1.269487E-16
     1    64     6     3     3     8.585589E-20
 |g(k,q)|^2 in Ha^2 for iq: 64 ik: 1 mode: 4
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
    64     1     4     1     1     2.982377E-05
    64     1     4     1     2     1.431632E-05
    64     1     4     1     3     1.035617E-06
    64     1     4     2     1     1.036712E-09
    64     1     4     2     2     3.052294E-06
    64     1     4     2     3     4.210955E-05
    64     1     4     3     1     3.364558E-05
    64     1     4     3     2     6.437515E-05
    64     1     4     3     3     4.669669E-06
 |g(k,q)|^2 in Ha^2 for iq: 64 ik: 1 mode: 6
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
    64     1     6     1     1     6.623853E-07
    64     1     6     1     2     1.247714E-06
    64     1     6     1     3     6.734387E-08
    64     1     6     2     1     5.962298E-07
    64     1     6     2     2     1.239352E-06
    64     1     6     2     3     1.390384E-07
    64     1     6     3     1     2.357498E-06
    64     1     6     3     2     2.408679E-06
    64     1     6     3     3     2.362200E-06
 |g(k,q)|^2 in Ha^2 for iq: 64 ik: 64 mode: 4
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
    64    64     4     1     1     1.386566E-05
    64    64     4     1     2     3.299095E-05
    64    64     4     1     3     4.674019E-06
    64    64     4     2     1     2.365866E-06
    64    64     4     2     2     2.202858E-05
    64    64     4     2     3     5.250504E-05
    64    64     4     3     1     3.789930E-05
    64    64     4     3     2     5.476404E-07
    64    64     4     3     3     3.292718E-05
 |g(k,q)|^2 in Ha^2 for iq: 64 ik: 64 mode: 6
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
    64    64     6     1     1     9.987052E-08
    64    64     6     1     2     2.348186E-06
    64    64     6     1     3     5.611412E-08
    64    64     6     2     1     1.347810E-06
    64    64     6     2     2     6.182848E-09
    64    64     6     2     3     2.155357E-06
    64    64     6     3     1     1.661450E-07
    64    64     6     3     2     8.584110E-08
    64    64     6     3     3     3.633013E-07

================================================================================
== DATASET  3 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 3, }
dimensions: {natom: 2, nkpt: 10, mband: 6, nsppol: 1, nspinor: 1, nspden: 1, mpw: 899, }
cutoff_energies: {ecut:  30.0, pawecutdg:  -1.0, }
electrons: {nelect:   1.00000000E+01, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 7, eph_task: 11, }
...

 mkfilename: getwfk from: teph4vpq_2o_DS3_WFK

 mkfilename: getddb from: LiF_eph_varpeq/out_DDB

 mkfilename: getdvdb from: teph4vpq_1_DVDB

 Exchange-correlation functional for the present dataset will be:
  GGA: Perdew-Burke-Ernzerhof functional - ixc=11
 Citation for XC functional:
  J.P.Perdew, K.Burke, M.Ernzerhof, PRL 77, 3865 (1996)

- Reading GS states from WFK file: teph4vpq_2o_DS3_WFK
- Reading DDB from file: LiF_eph_varpeq/out_DDB
- Reading DVDB from file: teph4vpq_1_DVDB




  ==== Info on the Cryst% object ====
 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  0.0000000  3.8375000  3.8375000  G(1)= -0.1302932  0.1302932  0.1302932
 R(2)=  3.8375000  0.0000000  3.8375000  G(2)=  0.1302932 -0.1302932  0.1302932
 R(3)=  3.8375000  3.8375000  0.0000000  G(3)=  0.1302932  0.1302932 -0.1302932
 Unit cell volume ucvol=  1.1302517E+02 bohr^3
 Angles (23,13,12)=  6.00000000E+01  6.00000000E+01  6.00000000E+01 degrees
 Time-reversal symmetry is present
 Reduced atomic positions [iatom, xred, symbol]:
    1)    0.0000000  0.0000000  0.0000000  Li
    2)    0.5000000  0.5000000  0.5000000   F

 DDB file with 4 blocks has been read.

================================================================================

 Dielectric Tensor and Effective Charges 


 anaddb : Zero the imaginary part of the Dynamical Matrix at Gamma,
   and impose the ASR on the effective charges 

 The violation of the charge neutrality conditions
 by the effective charges is as follows :
    atom        electric field
 displacement     direction
       1               1       -0.065315        0.000000
       1               2        0.000000        0.000000
       1               3        0.000000        0.000000
       2               1        0.000000        0.000000
       2               2       -0.065315        0.000000
       2               3       -0.000000        0.000000
       3               1       -0.000000        0.000000
       3               2       -0.000000        0.000000
       3               3       -0.065315        0.000000

 Effective charge tensors after 
 imposition of the charge neutrality (if requested by user),
 and eventual restriction to some part :
   atom    displacement
         1         1    1.092224E+00   -9.389407E-16   -9.386159E-16
         1         2   -5.076227E-17    1.092224E+00    9.392655E-16
         1         3    5.076227E-17    9.389407E-16    1.092224E+00
         2         1   -1.092224E+00    9.389407E-16    9.386159E-16
         2         2    5.076227E-17   -1.092224E+00   -9.392655E-16
         2         3   -5.076227E-17   -9.389407E-16   -1.092224E+00
 Now, the imaginary part of the dynamical matrix is zeroed
- Found dielectric tensor and Born effective charges in DDB file: LiF_eph_varpeq/out_DDB
- Cannot find quadrupole tensor in DDB file: LiF_eph_varpeq/out_DDB
 Values initialized with zeros.
       Homogeneous q point set in the B.Z.
 Grid q points  :       27
  1)   0.00000000E+00  0.00000000E+00  0.00000000E+00
  2)   3.33333333E-01  0.00000000E+00  0.00000000E+00
  3)  -3.33333333E-01  0.00000000E+00  0.00000000E+00
  4)   0.00000000E+00  3.33333333E-01  0.00000000E+00
  5)   3.33333333E-01  3.33333333E-01  0.00000000E+00
  6)  -3.33333333E-01  3.33333333E-01  0.00000000E+00
  7)   0.00000000E+00 -3.33333333E-01  0.00000000E+00
  8)   3.33333333E-01 -3.33333333E-01  0.00000000E+00
  9)  -3.33333333E-01 -3.33333333E-01  0.00000000E+00
 10)   0.00000000E+00  0.00000000E+00  3.33333333E-01
 11)   3.33333333E-01  0.00000000E+00  3.33333333E-01
 12)  -3.33333333E-01  0.00000000E+00  3.33333333E-01
 13)   0.00000000E+00  3.33333333E-01  3.33333333E-01
 14)   3.33333333E-01  3.33333333E-01  3.33333333E-01
 15)  -3.33333333E-01  3.33333333E-01  3.33333333E-01
 16)   0.00000000E+00 -3.33333333E-01  3.33333333E-01
 17)   3.33333333E-01 -3.33333333E-01  3.33333333E-01
 18)  -3.33333333E-01 -3.33333333E-01  3.33333333E-01
 19)   0.00000000E+00  0.00000000E+00 -3.33333333E-01
 20)   3.33333333E-01  0.00000000E+00 -3.33333333E-01
 21)  -3.33333333E-01  0.00000000E+00 -3.33333333E-01
 22)   0.00000000E+00  3.33333333E-01 -3.33333333E-01
 23)   3.33333333E-01  3.33333333E-01 -3.33333333E-01
 24)  -3.33333333E-01  3.33333333E-01 -3.33333333E-01
 25)   0.00000000E+00 -3.33333333E-01 -3.33333333E-01
 26)   3.33333333E-01 -3.33333333E-01 -3.33333333E-01
 27)  -3.33333333E-01 -3.33333333E-01 -3.33333333E-01

 The interatomic forces have been obtained
 Average speed of sound partial sums:     0.2234217387E-02 (at units)
-                                   =           4.8878 [km/s]

 Debye frequency from partial sums:     0.1801153402E-02 (Ha)
-                                 =     0.1185102008E+02 (THz)
-Debye temperature from partial sums:     0.5687585851E+03 (K)

 Average speed of sound partial sums:     0.2234217387E-02 (at units)
-                                   =           4.8878 [km/s]

 Debye frequency from partial sums:     0.1801153402E-02 (Ha)
-                                 =     0.1185102008E+02 (THz)
-Debye temperature from partial sums:     0.5687585851E+03 (K)

- Writing phonon DOS to netcdf file: teph4vpq_3o_DS3_PHDOS.nc
--------------------------------------------------------------------------------

 === Gstore parameters ===
 kzone: bz
 kfilter: none
 nkibz: 10
 nkbz: 125
 glob_nk_spin: [125]
 qzone: bz
 nqibz: 10
 nqbz: 125
 glob_nq_spin: [125]
 kptopt: 1
 qptopt: 1
 with_vk: 1

 gqk_cplex: 2
 gqk_bstart: 3
 gqk_bstop: 5
 gqk_nb: 3
 gqk_my_npert: 6
 gqk_my_nk: -1
 gqk_my_nq: -1

  === MPI distribution ===
P Number of CPUs for parallelism over perturbations: 1
P Number of perturbations treated by this CPU: 6
P Number of CPUs for parallelism over q-points: 1
P Number of CPUs for parallelism over k-points: 1
 Cannot find all IBZ q-points in the DVDB --&gt; Activating Fourier interpolation.

 gstore_completed: 1
 gstore_done_qbz_spin: 125
 gqk%nb: 3
 gqk%glob_nq: 125
 gqk%glob_nk: 125
 E-PH matrix elements:
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
 |g(k,q)|^2 in Ha^2 for iq: 1 ik: 1 mode: 4
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
     1     1     4     1     1     1.887083E-18
     1     1     4     1     2     1.061234E-19
     1     1     4     1     3     4.213120E-20
     1     1     4     2     1     1.061234E-19
     1     1     4     2     2     9.068487E-19
     1     1     4     2     3     1.186030E-18
     1     1     4     3     1     4.213120E-20
     1     1     4     3     2     1.186030E-18
     1     1     4     3     3     3.692817E-18
 |g(k,q)|^2 in Ha^2 for iq: 1 ik: 1 mode: 6
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
     1     1     6     1     1     1.390373E-19
     1     1     6     1     2     2.528168E-19
     1     1     6     1     3     9.706093E-19
     1     1     6     2     1     2.528168E-19
     1     1     6     2     2     7.301823E-24
     1     1     6     2     3     4.601545E-19
     1     1     6     3     1     9.706093E-19
     1     1     6     3     2     4.601545E-19
     1     1     6     3     3     3.883247E-19
 |g(k,q)|^2 in Ha^2 for iq: 1 ik: 125 mode: 4
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
     1   125     4     1     1     1.409119E-18
     1   125     4     1     2     3.946299E-07
     1   125     4     1     3     1.187000E-06
     1   125     4     2     1     3.946299E-07
     1   125     4     2     2     1.394985E-18
     1   125     4     2     3     1.340972E-16
     1   125     4     3     1     1.187000E-06
     1   125     4     3     2     1.340972E-16
     1   125     4     3     3     4.722798E-20
 |g(k,q)|^2 in Ha^2 for iq: 1 ik: 125 mode: 6
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
     1   125     6     1     1     1.050033E-19
     1   125     6     1     2     1.582043E-06
     1   125     6     1     3     1.378220E-12
     1   125     6     2     1     1.582043E-06
     1   125     6     2     2     8.372807E-19
     1   125     6     2     3     8.509998E-17
     1   125     6     3     1     1.378220E-12
     1   125     6     3     2     8.509998E-17
     1   125     6     3     3     8.646705E-20
 |g(k,q)|^2 in Ha^2 for iq: 125 ik: 1 mode: 4
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
   125     1     4     1     1     1.103929E-05
   125     1     4     1     2     2.047513E-06
   125     1     4     1     3     3.613695E-06
   125     1     4     2     1     4.319360E-08
   125     1     4     2     2     4.085236E-08
   125     1     4     2     3     5.073040E-08
   125     1     4     3     1     5.122438E-06
   125     1     4     3     2     7.001263E-06
   125     1     4     3     3     1.572293E-07
 |g(k,q)|^2 in Ha^2 for iq: 125 ik: 1 mode: 6
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
   125     1     6     1     1     1.942357E-05
   125     1     6     1     2     1.143083E-06
   125     1     6     1     3     3.074398E-05
   125     1     6     2     1     2.181144E-05
   125     1     6     2     2     2.203688E-05
   125     1     6     2     3     2.233980E-05
   125     1     6     3     1     7.042868E-06
   125     1     6     3     2     6.802283E-05
   125     1     6     3     3     3.137934E-05
 |g(k,q)|^2 in Ha^2 for iq: 125 ik: 125 mode: 4
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
   125   125     4     1     1     1.434705E-06
   125   125     4     1     2     1.901380E-06
   125   125     4     1     3     1.017364E-06
   125   125     4     2     1     1.679023E-07
   125   125     4     2     2     2.563437E-06
   125   125     4     2     3     4.110854E-07
   125   125     4     3     1     1.058963E-07
   125   125     4     3     2     4.381606E-06
   125   125     4     3     3     2.095600E-06
 |g(k,q)|^2 in Ha^2 for iq: 125 ik: 125 mode: 6
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
   125   125     6     1     1     9.057477E-06
   125   125     6     1     2     2.903150E-05
   125   125     6     1     3     1.204815E-05
   125   125     6     2     1     9.384370E-06
   125   125     6     2     2     2.679433E-05
   125   125     6     2     3     6.694344E-05
   125   125     6     3     1     3.921016E-05
   125   125     6     3     2     3.282964E-05
   125   125     6     3     3     6.657912E-07

== END DATASET(S) ==============================================================
================================================================================

 -outvars: echo values of variables after computation  --------
            acell      7.6750000000E+00  7.6750000000E+00  7.6750000000E+00 Bohr
              amu      6.94100000E+00  1.89984032E+01
        boxcutmin      1.10000000E+00
        ddb_ngqpt        3    3    3
             ecut      3.00000000E+01 Hartree
   eph_ngqpt_fine1       3    3    3
   eph_ngqpt_fine2       4    4    4
   eph_ngqpt_fine3       5    5    5
         eph_task          11
           etotal1     0.0000000000E+00
           etotal2     0.0000000000E+00
           etotal3     0.0000000000E+00
            fcart1     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
            fcart2     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
            fcart3     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
-          fftalg         512
              ixc          11
           jdtset        1    2    3
         kptrlatt1       3    0    0      0    3    0      0    0    3
         kptrlatt2       4    0    0      0    4    0      0    0    4
         kptrlatt3       5    0    0      0    5    0      0    0    5
          kptrlen1     1.62811336E+01
          kptrlen2     2.17081782E+01
          kptrlen3     2.71352227E+01
P           mkmem1          4
P           mkmem2          8
P           mkmem3         10
            natom           2
            nband1          6
            nband2          6
            nband3          6
           ndtset           3
            ngfft          16      16      16
             nkpt1          4
             nkpt2          8
             nkpt3         10
             nsym          48
           ntypat           2
              occ1     2.000000  2.000000  2.000000  2.000000  2.000000  0.000000
              occ2     2.000000  2.000000  2.000000  2.000000  2.000000  0.000000
              occ3     2.000000  2.000000  2.000000  2.000000  2.000000  0.000000
        optdriver           7
            rprim      0.0000000000E+00  5.0000000000E-01  5.0000000000E-01
                       5.0000000000E-01  0.0000000000E+00  5.0000000000E-01
                       5.0000000000E-01  5.0000000000E-01  0.0000000000E+00
          spgroup         225
           strten1     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           strten2     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           strten3     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           symrel      1  0  0   0  1  0   0  0  1      -1  0  0   0 -1  0   0  0 -1
                       0 -1  1   0 -1  0   1 -1  0       0  1 -1   0  1  0  -1  1  0
                      -1  0  0  -1  0  1  -1  1  0       1  0  0   1  0 -1   1 -1  0
                       0  1 -1   1  0 -1   0  0 -1       0 -1  1  -1  0  1   0  0  1
                      -1  0  0  -1  1  0  -1  0  1       1  0  0   1 -1  0   1  0 -1
                       0 -1  1   1 -1  0   0 -1  0       0  1 -1  -1  1  0   0  1  0
                       1  0  0   0  0  1   0  1  0      -1  0  0   0  0 -1   0 -1  0
                       0  1 -1   0  0 -1   1  0 -1       0 -1  1   0  0  1  -1  0  1
                      -1  0  1  -1  1  0  -1  0  0       1  0 -1   1 -1  0   1  0  0
                       0 -1  0   1 -1  0   0 -1  1       0  1  0  -1  1  0   0  1 -1
                       1  0 -1   0  0 -1   0  1 -1      -1  0  1   0  0  1   0 -1  1
                       0  1  0   0  0  1   1  0  0       0 -1  0   0  0 -1  -1  0  0
                       1  0 -1   0  1 -1   0  0 -1      -1  0  1   0 -1  1   0  0  1
                       0 -1  0   0 -1  1   1 -1  0       0  1  0   0  1 -1  -1  1  0
                      -1  0  1  -1  0  0  -1  1  0       1  0 -1   1  0  0   1 -1  0
                       0  1  0   1  0  0   0  0  1       0 -1  0  -1  0  0   0  0 -1
                       0  0 -1   0  1 -1   1  0 -1       0  0  1   0 -1  1  -1  0  1
                       1 -1  0   0 -1  1   0 -1  0      -1  1  0   0  1 -1   0  1  0
                       0  0  1   1  0  0   0  1  0       0  0 -1  -1  0  0   0 -1  0
                      -1  1  0  -1  0  0  -1  0  1       1 -1  0   1  0  0   1  0 -1
                       0  0  1   0  1  0   1  0  0       0  0 -1   0 -1  0  -1  0  0
                       1 -1  0   0 -1  0   0 -1  1      -1  1  0   0  1  0   0  1 -1
                       0  0 -1   1  0 -1   0  1 -1       0  0  1  -1  0  1   0 -1  1
                      -1  1  0  -1  0  1  -1  0  0       1 -1  0   1  0 -1   1  0  0
            typat      1  2
           xangst      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.0307175380E+00  2.0307175380E+00  2.0307175380E+00
            xcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       3.8375000000E+00  3.8375000000E+00  3.8375000000E+00
             xred      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       5.0000000000E-01  5.0000000000E-01  5.0000000000E-01
            znucl        3.00000    9.00000

================================================================================


- Timing analysis has been suppressed with timopt=0



================================================================================

 Suggested references for the acknowledgment of ABINIT usage.

 The users of ABINIT have little formal obligations with respect to the ABINIT group
 (those specified in the GNU General Public License, http://www.gnu.org/copyleft/gpl.txt).
 However, it is common practice in the scientific literature,
 to acknowledge the efforts of people that have made the research possible.
 In this spirit, please find below suggested citations of work written by ABINIT developers,
 corresponding to implementations inside of ABINIT that you have used in the present run.
 Note also that it will be of great value to readers of publications presenting these results,
 to read papers enabling them to understand the theoretical formalism and details
 of the ABINIT implementation.
 For information on why they are suggested, see also https://docs.abinit.org/theory/acknowledgments.
-
- [1] The Abinit project: Impact, environment and recent developments.
- Computer Phys. Comm. 248, 107042 (2020).
- X.Gonze, B. Amadon, G. Antonius, F.Arnardi, L.Baguet, J.-M.Beuken,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, N.Brouwer, F.Bruneval,
- G.Brunin, T.Cavignac, J.-B. Charraud, Wei Chen, M.Cote, S.Cottenier,
- J.Denier, G.Geneste, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, Xu He, N.Helbig, N.Holzwarth, Y.Jia, F.Jollet,
- W.Lafargue-Dit-Hauret, K.Lejaeghere, M.A.L.Marques, A.Martin, C.Martins,
- H.P.C. Miranda, F.Naccarato, K. Persson, G.Petretto, V.Planes, Y.Pouillon,
- S.Prokhorenko, F.Ricci, G.-M.Rignanese, A.H.Romero, M.M.Schmitt, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, G.Zerah and J.W.Zwanzig
- Comment: the fifth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT20.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2020
-
- [2] Optimized norm-conserving Vanderbilt pseudopotentials.
- D.R. Hamann, Phys. Rev. B 88, 085117 (2013).
- Comment: Some pseudopotential generated using the ONCVPSP code were used.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#hamann2013
-
- [3] ABINIT: Overview, and focus on selected capabilities
- J. Chem. Phys. 152, 124102 (2020).
- A. Romero, D.C. Allan, B. Amadon, G. Antonius, T. Applencourt, L.Baguet,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, F.Bruneval,
- G.Brunin, D.Caliste, M.Cote,
- J.Denier, C. Dreyer, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, F.Jollet, G. Jomard,
- A.Martin, 
- H.P.C. Miranda, F.Naccarato, G.Petretto, N.A. Pike, V.Planes,
- S.Prokhorenko, T. Rangel, F.Ricci, G.-M.Rignanese, M.Royo, M.Stengel, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, J.Wiktor, J.W.Zwanziger, and X.Gonze.
- Comment: a global overview of ABINIT, with focus on selected capabilities .
- Note that a version of this paper, that is not formatted for J. Chem. Phys 
- is available at https://www.abinit.org/sites/default/files/ABINIT20_JPC.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#romero2020
-
- [4] Recent developments in the ABINIT software package.
- Computer Phys. Comm. 205, 106 (2016).
- X.Gonze, F.Jollet, F.Abreu Araujo, D.Adams, B.Amadon, T.Applencourt,
- C.Audouze, J.-M.Beuken, J.Bieder, A.Bokhanchuk, E.Bousquet, F.Bruneval
- D.Caliste, M.Cote, F.Dahm, F.Da Pieve, M.Delaveau, M.Di Gennaro,
- B.Dorado, C.Espejo, G.Geneste, L.Genovese, A.Gerossier, M.Giantomassi,
- Y.Gillet, D.R.Hamann, L.He, G.Jomard, J.Laflamme Janssen, S.Le Roux,
- A.Levitt, A.Lherbier, F.Liu, I.Lukacevic, A.Martin, C.Martins,
- M.J.T.Oliveira, S.Ponce, Y.Pouillon, T.Rangel, G.-M.Rignanese,
- A.H.Romero, B.Rousseau, O.Rubel, A.A.Shukri, M.Stankovski, M.Torrent,
- M.J.Van Setten, B.Van Troeye, M.J.Verstraete, D.Waroquier, J.Wiktor,
- B.Xu, A.Zhou, J.W.Zwanziger.
- Comment: the fourth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT16.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2016
-
- And optionally:
-
- [5] ABINIT: First-principles approach of materials and nanosystem properties.
- Computer Phys. Comm. 180, 2582-2615 (2009).
- X. Gonze, B. Amadon, P.-M. Anglade, J.-M. Beuken, F. Bottin, P. Boulanger, F. Bruneval,
- D. Caliste, R. Caracas, M. Cote, T. Deutsch, L. Genovese, Ph. Ghosez, M. Giantomassi
- S. Goedecker, D.R. Hamann, P. Hermet, F. Jollet, G. Jomard, S. Leroux, M. Mancini, S. Mazevet,
- M.J.T. Oliveira, G. Onida, Y. Pouillon, T. Rangel, G.-M. Rignanese, D. Sangalli, R. Shaltaf,
- M. Torrent, M.J. Verstraete, G. Zerah, J.W. Zwanziger
- Comment: the third generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT_CPC_v10.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2009
-
- Proc.   0 individual time (sec): cpu=         92.6  wall=         92.7

================================================================================

 Calculation completed.
.Delivered   3 WARNINGs and   8 COMMENTs to log file.
+Overall time at end (sec) : cpu=         92.6  wall=         92.7

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-14c50c6d-b613-498c-b057-fee30da5a665", "#uuid-97256570-3ff1-4942-a71a-3b42a7411f9f") }); </script>

<p>For each DATASET we find a section that summarizes the gstore parameters:</p>
<div class="highlight"><pre><span></span><code> === Gstore parameters ===
 kzone: bz
 kfilter: none
 nkibz: 4
 nkbz: 27
 glob_nk_spin: [27]
 qzone: bz
 nqibz: 4
 nqbz: 27
 glob_nq_spin: [27]
 kptopt: 1
 qptopt: 1
 with_vk: 1

 gqk_cplex: 2
 gqk_bstart: 3
 gqk_bstop: 5
 gqk_nb: 3
 gqk_my_npert: 6
 gqk_my_nk: -1
 gqk_my_nq: -1
</code></pre></div>
<p>Then we find another section related to the MPI parallelism.
In this case we are running in sequential but the output will change if we run in parallel (see also <a class="wikilink codevar-wikilink" href="/variables/eph#eph_np_pqbks">eph_np_pqbks</a>).
The final message informs the user that the EPH code will either read the qpts from file
(if the DVDB contains all of them, in case <a class="wikilink codevar-wikilink" href="/variables/eph#eph_ngqpt_fine">eph_ngqpt_fine</a> is not defined in the input)
or interpolate the scattering potentials from <a class="wikilink codevar-wikilink" href="/variables/eph#ddb_ngqpt">ddb_ngqpt</a> to <a class="wikilink codevar-wikilink" href="/variables/eph#eph_ngqpt_fine">eph_ngqpt_fine</a>.</p>
<div class="highlight"><pre><span></span><code>  === MPI distribution ===
P Number of CPUs for parallelism over perturbations: 1
P Number of perturbations treated by this CPU: 6
P Number of CPUs for parallelism over q-points: 1
P Number of CPUs for parallelism over k-points: 1
</code></pre></div>
<div class="highlight"><pre><span></span><code> DVDB file contains all q-points in the IBZ --&gt; Reading DFPT potentials from file.
</code></pre></div>
<p>or</p>
<div class="highlight"><pre><span></span><code> Cannot find eph_ngqpt_fine q-points in DVDB --&gt; Activating Fourier interpolation.
</code></pre></div>
<p>Finally, we have the section with the squared absolute values of specific matrix elements are printed.
This is mostly done for regression tests of ABINIT. Note, however, the <code>gstore_completed: 1</code> tag.
This indicates that all the matrix elments have been computed for the corresponding GSTORE file.</p>
<div class="highlight"><pre><span></span><code> gstore_completed: 1
 gstore_done_qbz_spin: 125
 gqk%nb: 3
 gqk%glob_nq: 125
 gqk%glob_nk: 125
 E-PH matrix elements:
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
 |g(k,q)|^2 in Ha^2 for iq: 1 ik: 1 mode: 4
    iq    ik  mode im_kq  in_k    |g|^2 in Ha^2
     1     1     4     1     1     3.315387E-18
     1     1     4     1     2     5.564496E-19
     1     1     4     1     3     6.911046E-19
     1     1     4     2     1     5.564496E-19
     1     1     4     2     2     3.620046E-18
     1     1     4     2     3     1.066932E-19
     1     1     4     3     1     6.911046E-19
     1     1     4     3     2     1.066932E-19
     1     1     4     3     3     3.147723E-18
...
</code></pre></div>
<p>The calculation has produced the following output files (e.g. for the first DATASET):</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ls<span class="w"> </span>teph4vpq_3o_DS1*

teph4vpq_3o_DS1_EBANDS.agr<span class="w"> </span>teph4vpq_3o_DS1_GSTORE.nc<span class="w">  </span>teph4vpq_3o_DS1_PHDOS.nc
</code></pre></div>
<p>where:</p>
<ul>
<li>EBANDS.agr &rarr; Electron bands in <a href="http://plasma-gate.weizmann.ac.il/Grace/">xmgrace</a>  format. See also <a class="wikilink codevar-wikilink" href="/variables/gstate#prtebands">prtebands</a></li>
<li>PHDOS.nc   &rarr; Phonon DOS in netcdf format (see <a class="wikilink codevar-wikilink" href="/variables/eph#prtphdos">prtphdos</a> is given by <a class="wikilink codevar-wikilink" href="/variables/eph#ph_ngqpt">ph_ngqpt</a>).</li>
<li>GSTORE.nc  &rarr; Netcdf file with electron-phonon matrix elements <span class="arithmatex">\(g_{mn\nu}(\mathbf{k,q})\)</span> and other related datastructures.</li>
</ul>
<p>All the matrix elements are stored in the <strong>GSTORE.nc</strong> NetCDF file for all <span class="arithmatex">\(\kk/\qq\)</span>-points, electronic states and phonon modes.
As usual, one can use <a href="http://abinit.github.io/abipy/scripts/abiopen.html">abiopen.py</a>  with the <code>-p</code> option (<code>--print</code>) to print a summary to terminal:</p>
<div class="highlight"><pre><span></span><code>$ abiopen.py teph4vpq_3o_DS1_GSTORE.nc -p
...
nsppol: 1
gstore_completed: True
gstore_cplex: 2
gstore_kzone: bz
gstore_kfilter: none
gstore_gmode: phonon
gstore_qzone: bz
gstore_with_vk: 1
gstore_kptopt: 1
gstore_qptopt: 1
gstore_brange_spin[0]: [2 5]
gstore_erange_spin[0]: [0. 0.]
gstore_glob_spin_nq[0]: 27
</code></pre></div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Pay attention to the gstore_completed tag. If set to False, some matrix elements may not have been computed.
This typically occurs if the job was interrupted, for example due to a timeout.</p>
<p>To restart a gstore computation, simply instruct the code to read the incomplete GSTORE.nc file
using <a class="wikilink codevar-wikilink" href="/variables/eph#getgstore_filepath">getgstore_filepath</a>, and rerun the same input file with <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> = 11.
If needed, you can disable this automatic restart capability by setting <a class="wikilink codevar-wikilink" href="/variables/eph#eph_restart">eph_restart</a> to 0.</p>
</div>
<h2 id="small-hole-polaron-variational-optimization-of-binding-energy">Small hole polaron: variational optimization of binding energy<a class="headerlink" href="#small-hole-polaron-variational-optimization-of-binding-energy" title="Permanent link">&para;</a></h2>
<p>At this point we have all the ingredients to start <strong>our first VarPEq calcualation</strong>.
This will be done for three <span class="arithmatex">\(\kk/\qq\)</span>-meshes of incrementally increasing sampling:
3x3x3, 4x4x4, and 5x5x5, which represent a supercell hosting the polaron.
For each mesh, we have already computed the mandatory inputs: <strong>WFK</strong> and <strong>GSTORE</strong> files.
We will also need the same <strong>DDB</strong> file used in the GSTORE calculations.</p>
<p>With this example, we can discuss the most important <code>vpq_</code> input variables and the concept of VarPEq calculations.
First of all, you may want to start the computation immediately by issuing:</p>
<div class="highlight"><pre><span></span><code>abinit<span class="w"> </span>teph4vpq_4.abi<span class="w"> </span>&gt;<span class="w"> </span>teph4vpq_4.log<span class="w"> </span><span class="m">2</span>&gt;<span class="w"> </span>err<span class="w"> </span><span class="p">&amp;</span>
</code></pre></div>
<p>with the following input file:</p>
<div class="text-center"><button id="uuid-75a247d3-4b3a-48d0-b044-0bdfc0c8821a" class="md-button md-button--secondary"> View tests/tutorespfn/Input/teph4vpq_4.abi </button></div>
<div id="uuid-5cd0a777-ee08-4025-977f-f5cd84a186c6" class="my_dialog" title="tests/tutorespfn/Input/teph4vpq_4.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># LiF: computation of a small hole polaron on 3x3x3, 4x4x4, 5x5x5 k/q-grids</span>
<span class="c1"># with long-range Frohlich correction.</span>

<span class="c1"># NOTE that dataset mode is used only for the tutorial</span>
<span class="c1"># In production, it is advisable to compute polaron on each grid in a separate run</span>

<span class="w"> </span>ndtset<span class="w"> </span><span class="m">3</span>

<span class="w"> </span>optdriver<span class="w">  </span><span class="m">7</span><span class="w">   </span><span class="c1"># Electron-phonon driver</span>
<span class="w"> </span>eph_task<span class="w">   </span><span class="m">13</span><span class="w">  </span><span class="c1"># Activate the Variational Polaron Equations solver</span>

<span class="c1"># Variational Polaron Equations parameters</span>
<span class="w"> </span>vpq_pkind<span class="w">  </span><span class="s2">&quot;hole&quot;</span><span class="w">  </span><span class="c1"># Hole polaron</span>
<span class="w"> </span>vpq_tolgrs<span class="w">  </span>1e-5<span class="w">   </span><span class="c1"># Tolerance on the gradient norm</span>

<span class="w"> </span><span class="c1"># these parameters are default but given here explicitly for clarity</span>
<span class="w"> </span>vpq_aseed<span class="w">      </span><span class="s2">&quot;gau_energy&quot;</span><span class="w">  </span><span class="c1"># Initial charge localization is Guassian-like</span>
<span class="w"> </span>vpq_gpr_energy<span class="w">  </span><span class="m">0</span>.<span class="w"> </span><span class="m">1</span>.<span class="w">        </span><span class="c1"># Gaussian parameters for initial charge</span>
<span class="w"> </span>vpq_nstates<span class="w">     </span><span class="m">1</span><span class="w">            </span><span class="c1"># Number of polaronic states</span>
<span class="w"> </span>vpq_nstep<span class="w">       </span><span class="m">50</span><span class="w">           </span><span class="c1"># Maximum number of optimization steps</span>

<span class="c1"># Frohlich correction</span>
<span class="w"> </span>eph_frohl_ntheta<span class="w">  </span><span class="m">32</span><span class="w">   </span><span class="c1"># Number of divisions for the spherical integration of</span>
<span class="w">                        </span><span class="c1"># the long-range part of electron-phonon energy.</span>
<span class="w">                        </span><span class="c1"># Non-zero value activates the computation of Frohlich</span>
<span class="w">                        </span><span class="c1"># corrections.</span>
<span class="w">                        </span><span class="c1"># ntheta=32 gives the optimal number of divisions for the</span>
<span class="w">                        </span><span class="c1"># spherical integration.</span>

<span class="w"> </span>vpq_avg_g<span class="w">  </span><span class="m">1</span><span class="w">  </span><span class="c1"># Apply Frohlich correction to e-ph coupling</span>


<span class="c1"># Electron-phonon matrix elements</span>
<span class="w"> </span>getgstore_filepath1<span class="w"> </span><span class="s2">&quot;teph4vpq_3o_DS1_GSTORE.nc&quot;</span><span class="w"> </span><span class="c1"># 3x3x3 k/q-mesh</span>
<span class="w"> </span>getgstore_filepath2<span class="w"> </span><span class="s2">&quot;teph4vpq_3o_DS2_GSTORE.nc&quot;</span><span class="w"> </span><span class="c1"># 4x4x4 k/q-mesh</span>
<span class="w"> </span>getgstore_filepath3<span class="w"> </span><span class="s2">&quot;teph4vpq_3o_DS3_GSTORE.nc&quot;</span><span class="w"> </span><span class="c1"># 5x5x5 k/q-mesh</span>

<span class="c1"># Wavefunction</span>
<span class="c1"># Read the WFK file from the preparatory run</span>
<span class="w"> </span>getwfk_filepath1<span class="w"> </span><span class="s2">&quot;teph4vpq_2o_DS1_WFK&quot;</span><span class="w">  </span><span class="c1"># 3x3x3 k-mesh</span>
<span class="w"> </span>getwfk_filepath2<span class="w"> </span><span class="s2">&quot;teph4vpq_2o_DS2_WFK&quot;</span><span class="w">  </span><span class="c1"># 4x4x4 k-mesh</span>
<span class="w"> </span>getwfk_filepath3<span class="w"> </span><span class="s2">&quot;teph4vpq_2o_DS3_WFK&quot;</span><span class="w">  </span><span class="c1"># 5x5x5 k-mesh</span>

<span class="w"> </span>ngkpt1<span class="w">   </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w">  </span><span class="c1"># These parameters have to consistent with the WFK file</span>
<span class="w"> </span>ngkpt2<span class="w">   </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">4</span>
<span class="w"> </span>ngkpt3<span class="w">   </span><span class="m">5</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">5</span>

<span class="w"> </span>kptopt<span class="w">   </span><span class="m">1</span>
<span class="w"> </span>nshiftk<span class="w">  </span><span class="m">1</span>
<span class="w"> </span>shiftk<span class="w">   </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
<span class="w"> </span>nband<span class="w">    </span><span class="m">6</span>
<span class="w"> </span>ecut<span class="w">     </span><span class="m">30</span>

<span class="c1"># Phonons</span>
<span class="w"> </span>ddb_ngqpt<span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w">          </span><span class="c1"># This has to be consistent with the DDB file</span>
<span class="w"> </span>getddb_filepath
<span class="w"> </span><span class="s2">&quot;LiF_eph_varpeq/out_DDB&quot;</span><span class="w">  </span><span class="c1"># Read the precomputed DDB stored in git submodule</span>
<span class="w">                           </span><span class="c1"># NOTE: for the input parameters used to produce</span>
<span class="w">                           </span><span class="c1"># the DDB file, consult the LiF_eph_varpeq/dfpt.abi</span>

<span class="c1"># Pseudopotentials</span>
<span class="w"> </span>pp_dirpath<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">/Psdj_nc_sr_05_pbe_std_psp8&quot;</span>
<span class="w"> </span>pseudos<span class="w"> </span><span class="s2">&quot;Li.psp8, F.psp8&quot;</span>

<span class="c1"># Structure</span>
<span class="w"> </span>natom<span class="w">   </span><span class="m">2</span>
<span class="w"> </span>ntypat<span class="w">  </span><span class="m">2</span>
<span class="w"> </span>typat<span class="w">   </span><span class="m">1</span><span class="w"> </span><span class="m">2</span>
<span class="w"> </span>znucl<span class="w">   </span><span class="m">3</span><span class="w"> </span><span class="m">9</span>
<span class="w"> </span>xred<span class="w">    </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.0
<span class="w">         </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5

<span class="w"> </span>acell<span class="w"> </span><span class="m">3</span>*7.675
<span class="w"> </span>rprim<span class="w"> </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5
<span class="w">       </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.5
<span class="w">       </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% exclude_builders = eos_nvhpc_*</span>
<span class="c1">#%% test_chain = teph4vpq_1.abi, teph4vpq_2.abi, teph4vpq_3.abi,</span>
<span class="c1">#%%              teph4vpq_4.abi, teph4vpq_5.abi, teph4vpq_6.abi,</span>
<span class="c1">#%%              teph4vpq_7.abi, teph4vpq_8.abi, teph4vpq_9.abi,</span>
<span class="c1">#%%              teph4vpq_10.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% use_git_submodule = LiF_eph_varpeq</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   teph4vpq_4.abo, tolnlines = 110, tolabs = 1e-4, tolrel = 2e-1</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 10</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = V. Vasilchenko</span>
<span class="c1">#%% keywords = DFPT, EPH, POLARON</span>
<span class="c1">#%% description =</span>
<span class="c1">#%%   LiF, Fm-3m space group.</span>
<span class="c1">#%%   Computation of a small hole polaron on 3x3x3, 4x4x4, 5x5x5 k/q-grids</span>
<span class="c1">#%%   via Variational Polaron Equations with long-range Frohlich correction.</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-5cd0a777-ee08-4025-977f-f5cd84a186c6", "#uuid-75a247d3-4b3a-48d0-b044-0bdfc0c8821a") }); </script>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>In this example, the GSTORE files have already been computed and will be reloaded from disk.
The EPH code will automatically distribute the workload and memory using a predifined distribution scheme.</p>
<p>The manual parallelism is possible over <span class="arithmatex">\(\kk\)</span>-, <span class="arithmatex">\(\qq\)</span>-points, pertubations and spin indices.
See the related <a class="wikilink codevar-wikilink" href="/variables/eph#eph_np_pqbks">eph_np_pqbks</a> input variable.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>We use <a class="wikilink codevar-wikilink" href="/variables/basic#ndtset">ndtset</a> mode to perform three polaron calculations in a single run.
Hence, the first dataset (3x3x3 <span class="arithmatex">\(\kk/\qq\)</span>-mesh) will be limiting factor for parallelism:
max 6 procs over pertubations (2*<a class="wikilink codevar-wikilink" href="/variables/basic#natom">natom</a>), and max 9 procs for <span class="arithmatex">\(\kk/\qq\)</span>-vectors each.
In production, it is <strong>highly recommended</strong> to compute seperate GSTORE files in individual runs.</p>
</div>
<p>Let&rsquo;s now discuss the meaning of the different variables in more detail.
As usual, we use <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> 7 to enter the EPH code while <a class="wikilink codevar-wikilink" href="/variables/eph#eph_task">eph_task</a> 13 activates
the solver for the variational polaron equations.</p>
<p>The paths to the mandatory external files (<strong>DDB</strong>, <strong>WFK</strong>, <strong>GSTORE</strong>) are specified
by the three variables:</p>
<ul>
<li><a class="wikilink codevar-wikilink" href="/variables/files#getddb_filepath">getddb_filepath</a></li>
<li><a class="wikilink codevar-wikilink" href="/variables/files#getwfk_filepath">getwfk_filepath</a></li>
<li><a class="wikilink codevar-wikilink" href="/variables/eph#getgstore_filepath">getgstore_filepath</a>.</li>
</ul>
<p>This is an excerpt of the input file:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Variational Polaron Equations parameters</span>
<span class="w"> </span>vpq_pkind<span class="w">  </span><span class="s2">&quot;hole&quot;</span><span class="w">  </span><span class="c1"># Hole polaron</span>
<span class="w"> </span>vpq_tolgrs<span class="w">  </span>1e-5<span class="w">   </span><span class="c1"># Tolerance on the gradient norm</span>

<span class="w"> </span><span class="c1"># these parameters are default but given here explicitly for clarity</span>
<span class="w"> </span>vpq_aseed<span class="w">      </span><span class="s2">&quot;gau_energy&quot;</span><span class="w">  </span><span class="c1"># Initial charge localization is Guassian-like</span>
<span class="w"> </span>vpq_gpr_energy<span class="w">  </span><span class="m">0</span>.<span class="w"> </span><span class="m">1</span>.<span class="w">        </span><span class="c1"># Gaussian parameters for initial charge</span>
<span class="w"> </span>vpq_nstates<span class="w">     </span><span class="m">1</span><span class="w">            </span><span class="c1"># Number of polaronic states</span>
<span class="w"> </span>vpq_nstep<span class="w">       </span><span class="m">50</span><span class="w">           </span><span class="c1"># Maximum number of optimization steps</span>

<span class="c1"># Frohlich correction</span>
<span class="w"> </span>eph_frohl_ntheta<span class="w">  </span><span class="m">32</span><span class="w">   </span><span class="c1"># Number of divisions for the spherical integration of</span>
<span class="w">                        </span><span class="c1"># the long-range part of electron-phonon energy.</span>
<span class="w">                        </span><span class="c1"># Non-zero value activates the computation of Frohlich</span>
<span class="w">                        </span><span class="c1"># corrections.</span>
<span class="w">                        </span><span class="c1"># ntheta=32 gives the optimal number of divisions for the</span>
<span class="w">                        </span><span class="c1"># spherical integration.</span>

<span class="w"> </span>vpq_avg_g<span class="w">  </span><span class="m">1</span><span class="w">  </span><span class="c1"># Apply Frohlich correction to e-ph coupling</span>


<span class="c1"># Electron-phonon matrix elements</span>
<span class="w"> </span>getgstore_filepath1<span class="w"> </span><span class="s2">&quot;teph4vpq_3o_DS1_GSTORE.nc&quot;</span><span class="w"> </span><span class="c1"># 3x3x3 k/q-mesh</span>
<span class="w"> </span>getgstore_filepath2<span class="w"> </span><span class="s2">&quot;teph4vpq_3o_DS2_GSTORE.nc&quot;</span><span class="w"> </span><span class="c1"># 4x4x4 k/q-mesh</span>
<span class="w"> </span>getgstore_filepath3<span class="w"> </span><span class="s2">&quot;teph4vpq_3o_DS3_GSTORE.nc&quot;</span><span class="w"> </span><span class="c1"># 5x5x5 k/q-mesh</span>

<span class="c1"># Wavefunction</span>
<span class="c1"># Read the WFK file from the preparatory run</span>
<span class="w"> </span>getwfk_filepath1<span class="w"> </span><span class="s2">&quot;teph4vpq_2o_DS1_WFK&quot;</span><span class="w">  </span><span class="c1"># 3x3x3 k-mesh</span>
<span class="w"> </span>getwfk_filepath2<span class="w"> </span><span class="s2">&quot;teph4vpq_2o_DS2_WFK&quot;</span><span class="w">  </span><span class="c1"># 4x4x4 k-mesh</span>
<span class="w"> </span>getwfk_filepath3<span class="w"> </span><span class="s2">&quot;teph4vpq_2o_DS3_WFK&quot;</span><span class="w">  </span><span class="c1"># 5x5x5 k-mesh</span>

<span class="w"> </span>ngkpt1<span class="w">   </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w">  </span><span class="c1"># These parameters have to consistent with the WFK file</span>
<span class="w"> </span>ngkpt2<span class="w">   </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">4</span>
<span class="w"> </span>ngkpt3<span class="w">   </span><span class="m">5</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">5</span>
<span class="w"> </span>...

<span class="c1"># Phonons</span>
<span class="w"> </span>ddb_ngqpt<span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w">          </span><span class="c1"># This has to be consistent with the DDB file</span>
<span class="w"> </span>getddb_filepath
<span class="w"> </span><span class="s2">&quot;LiF_eph_varpeq/out_DDB&quot;</span><span class="w">  </span><span class="c1"># Read the precomputed DDB stored in git submodule</span>
<span class="w">                           </span><span class="c1"># NOTE: for the input parameters used to produce</span>
<span class="w">                           </span><span class="c1"># the DDB file, consult the LiF_eph_varpeq/dfpt.abi</span>
</code></pre></div>
<p>The mesh for electrons (<a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#shiftk">shiftk</a>) must
correspond to the one used for the input WFK file.
<a class="wikilink codevar-wikilink" href="/variables/eph#ddb_ngqpt">ddb_ngqpt</a> is set to 3x3x3 as this is the <span class="arithmatex">\(\qq\)</span>-mesh used in the DFPT part to generate the DDB and DVDB files used previously in GSTORE.</p>
<p>Polaron calculations require an explicit <a class="wikilink codevar-wikilink" href="/variables/eph#vpq_pkind">vpq_pkind</a> variable specification which tells the code which polaron we are dealing with (here, <code>"hole"</code>).
In principle, this is <strong>the only mandatory</strong> <code>vpq_</code> variable, and other inputs take default values if not specified.</p>
<p>In our example, the initial guess for the electronic coefficients <span class="arithmatex">\(\boldsymbol{A}\)</span> is given by the combination of <a class="wikilink codevar-wikilink" href="/variables/eph#vpq_aseed">vpq_aseed</a> and <a class="wikilink codevar-wikilink" href="/variables/eph#vpq_gpr_energy">vpq_gpr_energy</a> variables.
The <a class="wikilink codevar-wikilink" href="/variables/eph#vpq_nstates">vpq_nstates</a> variable gives the number of polaronic states.
For each state, the solver will iterate until it converges on the gradient norm specified by the <a class="wikilink codevar-wikilink" href="/variables/eph#vpq_tolgrs">vpq_tolgrs</a> variable OR reaches the maximum number of iterations <a class="wikilink codevar-wikilink" href="/variables/eph#vpq_nstep">vpq_nstep</a>.</p>
<p>Here, we also use a Fr"ohlich correction for the electron-phonon matrix divergence at <span class="arithmatex">\(\Gamma\)</span>.
For a fixed <span class="arithmatex">\(\kk/\qq\)</span>-mesh, this trick brings the solution closer to the infinite-mesh limit, and also facilitates the convergence of our algorithm.
One activates this correction via <a class="wikilink codevar-wikilink" href="/variables/eph#vpq_avg_g">vpq_avg_g</a> tag and the specification of the <a class="wikilink codevar-wikilink" href="/variables/eph#eph_frohl_ntheta">eph_frohl_ntheta</a> variable.</p>
<p>We can now have a look at the main output file:</p>
<div class="text-center"><button id="uuid-67c3c176-c230-4581-878e-9e976275236e" class="md-button md-button--secondary"> View tests/tutorespfn/Refs/teph4vpq_4.abo </button></div>
<div id="uuid-44e985fa-c150-47d1-9573-8e2d0e0f87db" class="my_dialog" title="tests/tutorespfn/Refs/teph4vpq_4.abo" hidden><div><pre class="small-text">

.Version 10.3.4.7 of ABINIT, released Dec 2025.
.(MPI version, prepared for a x86_64_linux_gnu13.2 computer) 

.Copyright (C) 1998-2025 ABINIT group . 
 ABINIT comes with ABSOLUTELY NO WARRANTY.
 It is free software, and you are welcome to redistribute it
 under certain conditions (GNU General Public License,
 see ~abinit/COPYING or http://www.gnu.org/copyleft/gpl.txt).

 ABINIT is a project of the Universite Catholique de Louvain,
 Corning Inc. and other collaborators, see ~abinit/doc/developers/contributors.txt .
 Please read https://docs.abinit.org/theory/acknowledgments for suggested
 acknowledgments of the ABINIT effort.
 For more information, see https://www.abinit.org .

.Starting date : Sun 23 Feb 2025.
- ( at 16h07 )

- input  file    -&gt; /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/vvasilchenko_varpeq_nosym/tests/TestBot_MPI1/tutorespfn_teph4vpq_1-teph4vpq_2-teph4vpq_3-teph4vpq_4-teph4vpq_5-teph4vpq_6-teph4vpq_7-teph4vpq_8-teph4vpq_9-teph4vpq_10/teph4vpq_4.abi
- output file    -&gt; teph4vpq_4.abo
- root for input  files -&gt; teph4vpq_4i
- root for output files -&gt; teph4vpq_4o

 DATASET    1 : space group Fm -3 m (#225); Bravais cF (face-center cubic)
================================================================================
 Values of the parameters that define the memory need for DATASET  1.
     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       5
     lnmax =       5     mgfft =      30  mpssoang =       3    mqgrid =    3001
     natom =       2  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      48    n1xccc =    2501    ntypat =       2
    occopt =       1   xclevel =       2
-    mband =           6        mffmem =           1         mkmem =           4
       mpw =         896          nfft =       27000          nkpt =           4
================================================================================
P This job should need less than                      10.118 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      0.330 Mbytes ; DEN or POT disk file :      0.208 Mbytes.
================================================================================

 DATASET    2 : space group Fm -3 m (#225); Bravais cF (face-center cubic)
================================================================================
 Values of the parameters that define the memory need for DATASET  2.
     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       5
     lnmax =       5     mgfft =      30  mpssoang =       3    mqgrid =    3001
     natom =       2  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      48    n1xccc =    2501    ntypat =       2
    occopt =       1   xclevel =       2
-    mband =           6        mffmem =           1         mkmem =           8
       mpw =         896          nfft =       27000          nkpt =           8
================================================================================
P This job should need less than                      10.488 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      0.658 Mbytes ; DEN or POT disk file :      0.208 Mbytes.
================================================================================

 DATASET    3 : space group Fm -3 m (#225); Bravais cF (face-center cubic)
================================================================================
 Values of the parameters that define the memory need for DATASET  3.
     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       5
     lnmax =       5     mgfft =      30  mpssoang =       3    mqgrid =    3001
     natom =       2  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      48    n1xccc =    2501    ntypat =       2
    occopt =       1   xclevel =       2
-    mband =           6        mffmem =           1         mkmem =          10
       mpw =         899          nfft =       27000          nkpt =          10
================================================================================
P This job should need less than                      10.676 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      0.825 Mbytes ; DEN or POT disk file :      0.208 Mbytes.
================================================================================

--------------------------------------------------------------------------------
------------- Echo of variables that govern the present computation ------------
--------------------------------------------------------------------------------
-
- outvars: echo of selected default values
-   iomode0 =  0 , fftalg0 =512 , wfoptalg0 =  0
-
- outvars: echo of global parameters not present in the input file
-  max_nthreads =    0
-
 -outvars: echo values of preprocessed input variables --------
            acell      7.6750000000E+00  7.6750000000E+00  7.6750000000E+00 Bohr
              amu      6.94100000E+00  1.89984032E+01
        ddb_ngqpt        3    3    3
             ecut      3.00000000E+01 Hartree
 eph_frohl_ntheta          32
         eph_task          13
-          fftalg         512
           istwfk1       2    0    0    0
           istwfk2       2    0    3    0    0    0    7    0
           istwfk3       2    0    0    0    0    0    0    0    0    0
              ixc          11
           jdtset        1    2    3
              kpt1     0.00000000E+00  0.00000000E+00  0.00000000E+00
                       3.33333333E-01  0.00000000E+00  0.00000000E+00
                       3.33333333E-01  3.33333333E-01  0.00000000E+00
                      -3.33333333E-01  3.33333333E-01  0.00000000E+00
              kpt2     0.00000000E+00  0.00000000E+00  0.00000000E+00
                       2.50000000E-01  0.00000000E+00  0.00000000E+00
                       5.00000000E-01  0.00000000E+00  0.00000000E+00
                       2.50000000E-01  2.50000000E-01  0.00000000E+00
                       5.00000000E-01  2.50000000E-01  0.00000000E+00
                      -2.50000000E-01  2.50000000E-01  0.00000000E+00
                       5.00000000E-01  5.00000000E-01  0.00000000E+00
                      -2.50000000E-01  5.00000000E-01  2.50000000E-01
              kpt3     0.00000000E+00  0.00000000E+00  0.00000000E+00
                       2.00000000E-01  0.00000000E+00  0.00000000E+00
                       4.00000000E-01  0.00000000E+00  0.00000000E+00
                       2.00000000E-01  2.00000000E-01  0.00000000E+00
                       4.00000000E-01  2.00000000E-01  0.00000000E+00
                      -4.00000000E-01  2.00000000E-01  0.00000000E+00
                      -2.00000000E-01  2.00000000E-01  0.00000000E+00
                       4.00000000E-01  4.00000000E-01  0.00000000E+00
                      -4.00000000E-01  4.00000000E-01  0.00000000E+00
                      -4.00000000E-01  4.00000000E-01  2.00000000E-01
         kptrlatt1       3    0    0      0    3    0      0    0    3
         kptrlatt2       4    0    0      0    4    0      0    0    4
         kptrlatt3       5    0    0      0    5    0      0    0    5
          kptrlen1     1.62811336E+01
          kptrlen2     2.17081782E+01
          kptrlen3     2.71352227E+01
P           mkmem1          4
P           mkmem2          8
P           mkmem3         10
            natom           2
            nband1          6
            nband2          6
            nband3          6
           ndtset           3
            ngfft          30      30      30
             nkpt1          4
             nkpt2          8
             nkpt3         10
             nsym          48
           ntypat           2
              occ1     2.000000  2.000000  2.000000  2.000000  2.000000  0.000000
              occ2     2.000000  2.000000  2.000000  2.000000  2.000000  0.000000
              occ3     2.000000  2.000000  2.000000  2.000000  2.000000  0.000000
        optdriver           7
            rprim      0.0000000000E+00  5.0000000000E-01  5.0000000000E-01
                       5.0000000000E-01  0.0000000000E+00  5.0000000000E-01
                       5.0000000000E-01  5.0000000000E-01  0.0000000000E+00
          spgroup         225
           symrel      1  0  0   0  1  0   0  0  1      -1  0  0   0 -1  0   0  0 -1
                       0 -1  1   0 -1  0   1 -1  0       0  1 -1   0  1  0  -1  1  0
                      -1  0  0  -1  0  1  -1  1  0       1  0  0   1  0 -1   1 -1  0
                       0  1 -1   1  0 -1   0  0 -1       0 -1  1  -1  0  1   0  0  1
                      -1  0  0  -1  1  0  -1  0  1       1  0  0   1 -1  0   1  0 -1
                       0 -1  1   1 -1  0   0 -1  0       0  1 -1  -1  1  0   0  1  0
                       1  0  0   0  0  1   0  1  0      -1  0  0   0  0 -1   0 -1  0
                       0  1 -1   0  0 -1   1  0 -1       0 -1  1   0  0  1  -1  0  1
                      -1  0  1  -1  1  0  -1  0  0       1  0 -1   1 -1  0   1  0  0
                       0 -1  0   1 -1  0   0 -1  1       0  1  0  -1  1  0   0  1 -1
                       1  0 -1   0  0 -1   0  1 -1      -1  0  1   0  0  1   0 -1  1
                       0  1  0   0  0  1   1  0  0       0 -1  0   0  0 -1  -1  0  0
                       1  0 -1   0  1 -1   0  0 -1      -1  0  1   0 -1  1   0  0  1
                       0 -1  0   0 -1  1   1 -1  0       0  1  0   0  1 -1  -1  1  0
                      -1  0  1  -1  0  0  -1  1  0       1  0 -1   1  0  0   1 -1  0
                       0  1  0   1  0  0   0  0  1       0 -1  0  -1  0  0   0  0 -1
                       0  0 -1   0  1 -1   1  0 -1       0  0  1   0 -1  1  -1  0  1
                       1 -1  0   0 -1  1   0 -1  0      -1  1  0   0  1 -1   0  1  0
                       0  0  1   1  0  0   0  1  0       0  0 -1  -1  0  0   0 -1  0
                      -1  1  0  -1  0  0  -1  0  1       1 -1  0   1  0  0   1  0 -1
                       0  0  1   0  1  0   1  0  0       0  0 -1   0 -1  0  -1  0  0
                       1 -1  0   0 -1  0   0 -1  1      -1  1  0   0  1  0   0  1 -1
                       0  0 -1   1  0 -1   0  1 -1       0  0  1  -1  0  1   0 -1  1
                      -1  1  0  -1  0  1  -1  0  0       1 -1  0   1  0 -1   1  0  0
            typat      1  2
        vpq_avg_g           1
       vpq_tolgrs      1.0000000000E-05
              wtk1       0.03704    0.29630    0.22222    0.44444
              wtk2       0.01563    0.12500    0.06250    0.09375    0.37500    0.18750
                         0.04688    0.09375
              wtk3       0.00800    0.06400    0.06400    0.04800    0.19200    0.19200
                         0.09600    0.04800    0.09600    0.19200
           xangst      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.0307175380E+00  2.0307175380E+00  2.0307175380E+00
            xcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       3.8375000000E+00  3.8375000000E+00  3.8375000000E+00
             xred      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       5.0000000000E-01  5.0000000000E-01  5.0000000000E-01
            znucl        3.00000    9.00000

================================================================================

 chkinp: Checking input parameters for consistency, jdtset=   1.

 chkinp: Checking input parameters for consistency, jdtset=   2.

 chkinp: Checking input parameters for consistency, jdtset=   3.

================================================================================
== DATASET  1 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 1, }
dimensions: {natom: 2, nkpt: 4, mband: 6, nsppol: 1, nspinor: 1, nspden: 1, mpw: 896, }
cutoff_energies: {ecut:  30.0, pawecutdg:  -1.0, }
electrons: {nelect:   1.00000000E+01, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 7, eph_task: 13, }
...

 mkfilename: getwfk from: teph4vpq_2o_DS1_WFK

 mkfilename: getddb from: LiF_eph_varpeq/out_DDB

 mkfilename: getgstore from: teph4vpq_3o_DS1_GSTORE.nc

 Exchange-correlation functional for the present dataset will be:
  GGA: Perdew-Burke-Ernzerhof functional - ixc=11
 Citation for XC functional:
  J.P.Perdew, K.Burke, M.Ernzerhof, PRL 77, 3865 (1996)

- Reading GS states from WFK file: teph4vpq_2o_DS1_WFK
- Reading DDB from file: LiF_eph_varpeq/out_DDB




  ==== Info on the Cryst% object ====
 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  0.0000000  3.8375000  3.8375000  G(1)= -0.1302932  0.1302932  0.1302932
 R(2)=  3.8375000  0.0000000  3.8375000  G(2)=  0.1302932 -0.1302932  0.1302932
 R(3)=  3.8375000  3.8375000  0.0000000  G(3)=  0.1302932  0.1302932 -0.1302932
 Unit cell volume ucvol=  1.1302517E+02 bohr^3
 Angles (23,13,12)=  6.00000000E+01  6.00000000E+01  6.00000000E+01 degrees
 Time-reversal symmetry is present
 Reduced atomic positions [iatom, xred, symbol]:
    1)    0.0000000  0.0000000  0.0000000  Li
    2)    0.5000000  0.5000000  0.5000000   F

 DDB file with 4 blocks has been read.

================================================================================

 Dielectric Tensor and Effective Charges 


 anaddb : Zero the imaginary part of the Dynamical Matrix at Gamma,
   and impose the ASR on the effective charges 

 The violation of the charge neutrality conditions
 by the effective charges is as follows :
    atom        electric field
 displacement     direction
       1               1       -0.065315        0.000000
       1               2        0.000000        0.000000
       1               3        0.000000        0.000000
       2               1        0.000000        0.000000
       2               2       -0.065315        0.000000
       2               3       -0.000000        0.000000
       3               1       -0.000000        0.000000
       3               2       -0.000000        0.000000
       3               3       -0.065315        0.000000

 Effective charge tensors after 
 imposition of the charge neutrality (if requested by user),
 and eventual restriction to some part :
   atom    displacement
         1         1    1.092224E+00   -9.389407E-16   -9.386159E-16
         1         2   -5.076227E-17    1.092224E+00    9.392655E-16
         1         3    5.076227E-17    9.389407E-16    1.092224E+00
         2         1   -1.092224E+00    9.389407E-16    9.386159E-16
         2         2    5.076227E-17   -1.092224E+00   -9.392655E-16
         2         3   -5.076227E-17   -9.389407E-16   -1.092224E+00
 Now, the imaginary part of the dynamical matrix is zeroed
- Found dielectric tensor and Born effective charges in DDB file: LiF_eph_varpeq/out_DDB
- Cannot find quadrupole tensor in DDB file: LiF_eph_varpeq/out_DDB
 Values initialized with zeros.
       Homogeneous q point set in the B.Z.
 Grid q points  :       27
  1)   0.00000000E+00  0.00000000E+00  0.00000000E+00
  2)   3.33333333E-01  0.00000000E+00  0.00000000E+00
  3)  -3.33333333E-01  0.00000000E+00  0.00000000E+00
  4)   0.00000000E+00  3.33333333E-01  0.00000000E+00
  5)   3.33333333E-01  3.33333333E-01  0.00000000E+00
  6)  -3.33333333E-01  3.33333333E-01  0.00000000E+00
  7)   0.00000000E+00 -3.33333333E-01  0.00000000E+00
  8)   3.33333333E-01 -3.33333333E-01  0.00000000E+00
  9)  -3.33333333E-01 -3.33333333E-01  0.00000000E+00
 10)   0.00000000E+00  0.00000000E+00  3.33333333E-01
 11)   3.33333333E-01  0.00000000E+00  3.33333333E-01
 12)  -3.33333333E-01  0.00000000E+00  3.33333333E-01
 13)   0.00000000E+00  3.33333333E-01  3.33333333E-01
 14)   3.33333333E-01  3.33333333E-01  3.33333333E-01
 15)  -3.33333333E-01  3.33333333E-01  3.33333333E-01
 16)   0.00000000E+00 -3.33333333E-01  3.33333333E-01
 17)   3.33333333E-01 -3.33333333E-01  3.33333333E-01
 18)  -3.33333333E-01 -3.33333333E-01  3.33333333E-01
 19)   0.00000000E+00  0.00000000E+00 -3.33333333E-01
 20)   3.33333333E-01  0.00000000E+00 -3.33333333E-01
 21)  -3.33333333E-01  0.00000000E+00 -3.33333333E-01
 22)   0.00000000E+00  3.33333333E-01 -3.33333333E-01
 23)   3.33333333E-01  3.33333333E-01 -3.33333333E-01
 24)  -3.33333333E-01  3.33333333E-01 -3.33333333E-01
 25)   0.00000000E+00 -3.33333333E-01 -3.33333333E-01
 26)   3.33333333E-01 -3.33333333E-01 -3.33333333E-01
 27)  -3.33333333E-01 -3.33333333E-01 -3.33333333E-01

 The interatomic forces have been obtained
 Average speed of sound partial sums:     0.2234217387E-02 (at units)
-                                   =           4.8878 [km/s]

 Debye frequency from partial sums:     0.1801153402E-02 (Ha)
-                                 =     0.1185102008E+02 (THz)
-Debye temperature from partial sums:     0.5687585851E+03 (K)

 Average speed of sound partial sums:     0.2234217387E-02 (at units)
-                                   =           4.8878 [km/s]

 Debye frequency from partial sums:     0.1801153402E-02 (Ha)
-                                 =     0.1185102008E+02 (THz)
-Debye temperature from partial sums:     0.5687585851E+03 (K)

- Writing phonon DOS to netcdf file: teph4vpq_4o_DS1_PHDOS.nc

--- Pseudopotential description ------------------------------------------------
- pspini: atom type   1  psp file is /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/vvasilchenko_varpeq_nosym/tests/Pspdir/Psdj_nc_sr_05_pbe_std_psp8/Li.psp8
- pspatm: opening atomic psp file    /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/vvasilchenko_varpeq_nosym/tests/Pspdir/Psdj_nc_sr_05_pbe_std_psp8/Li.psp8
- Li    ONCVPSP-3.2.3.1  r_core=   1.40824   1.10935
-  3.00000   3.00000    170503                znucl, zion, pspdat
    8   11    1    4       400   0.00000      pspcod,pspxc,lmax,lloc,mmax,r2well
    3.99000000000000    0.00000000000000    0.00000000000000   rchrg,fchrg,qchrg
     nproj     2     2
     extension_switch     1
  pspatm : epsatm=    2.74345787
         --- l  ekb(1:nproj) --&gt;
             0   -4.951544   -1.544797
             1   -2.250662   -0.474685
 pspatm: atomic psp has been read  and splines computed

- pspini: atom type   2  psp file is /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/vvasilchenko_varpeq_nosym/tests/Pspdir/Psdj_nc_sr_05_pbe_std_psp8/F.psp8
- pspatm: opening atomic psp file    /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/vvasilchenko_varpeq_nosym/tests/Pspdir/Psdj_nc_sr_05_pbe_std_psp8/F.psp8
- F     ONCVPSP-3.2.3.1  r_core=   1.30942   1.45782   1.60379
-  9.00000   7.00000    170504                znucl, zion, pspdat
    8   11    2    4       600   0.00000      pspcod,pspxc,lmax,lloc,mmax,r2well
    5.99000000000000    2.50000000000000    0.00000000000000   rchrg,fchrg,qchrg
     nproj     2     2     1
     extension_switch     1
  pspatm : epsatm=    4.87626060
         --- l  ekb(1:nproj) --&gt;
             0    6.519403    1.070094
             1   -3.955629   -1.291931
             2   -2.441503
 pspatm: atomic psp has been read  and splines computed

   7.61971847E+01                                ecore*ucvol(ha*bohr**3)
--------------------------------------------------------------------------------

 Computing variational polaron equations from pre-existent GSTORE file: teph4vpq_3o_DS1_GSTORE.nc
 Initializing gstore object from: teph4vpq_3o_DS1_GSTORE.nc 

 === Gstore parameters ===
 kzone: bz
 kfilter: none
 nkibz: 4
 nkbz: 27
 glob_nk_spin: [27]
 qzone: bz
 nqibz: 4
 nqbz: 27
 glob_nq_spin: [27]
 kptopt: 1
 qptopt: 1
 with_vk: 1

 gqk_cplex: 2
 gqk_bstart: 3
 gqk_bstop: 5
 gqk_nb: 3
 gqk_my_npert: 6
 gqk_my_nk: -1
 gqk_my_nq: -1

  === MPI distribution ===
P Number of CPUs for parallelism over perturbations: 1
P Number of perturbations treated by this CPU: 6
P Number of CPUs for parallelism over q-points: 1
P Number of CPUs for parallelism over k-points: 1

  === Variational Polaron Equations ===

 Polaron:
   * Polaron kind: hole
   * BvK supercell: 3x3x3
   * Number of independent spin polarizations: 1
   * Number of polaronic states: 1
   * Filtering of electronic states: no

 Long-range corrections:
   * Frohlich correction: yes
   * Frohlich correction value: 9.265067E-01 eV
   * Frohlich correction included in matrix elements: yes

 Optimization parameters:
   * Initial seed: charge localization A_nk
   * Initial seed type: Gaussian, based on the electroic energies
   * Tolerance on the gradient norm: 1.00E-05
   * Maximum number of iterations per state: 50

 Solving the variational polaron equations for each state...
   * spin 1/1, pstate 1/1...
   Done

 Printing the optimization logs
   --------------------------------------------------------------------------------------
   * spin 1/1, pstate 1/1
   * values in the optimization log are in (a.u.)
   --------------------------------------------------------------------------------------
   Step        E_pol         E_el         E_ph       E_elph      epsilon     ||grad||
      1  -3.0118E-03   4.1093E-02   4.4105E-02  -8.8210E-02   4.7117E-02   1.0900E-02
      2  -2.4528E-02   1.9417E-02   4.3945E-02  -8.7891E-02   6.8473E-02   2.2198E-03
      3  -3.9895E-02   3.0152E-03   4.2910E-02  -8.5819E-02   8.2804E-02   4.9899E-03
      4  -4.1219E-02   1.7941E-03   4.3013E-02  -8.6026E-02   8.4232E-02   3.2342E-03
      5  -4.3429E-02   5.7134E-04   4.4000E-02  -8.8000E-02   8.7429E-02   1.8175E-03
      6  -4.7596E-02   2.6635E-03   5.0259E-02  -1.0052E-01   9.7855E-02   4.6156E-03
      7  -5.2013E-02   5.3656E-03   5.7378E-02  -1.1476E-01   1.0939E-01   6.3385E-03
      8  -5.6357E-02   8.0023E-03   6.4359E-02  -1.2872E-01   1.2072E-01   6.1036E-03
      9  -6.1355E-02   1.0869E-02   7.2224E-02  -1.4445E-01   1.3358E-01   2.7019E-03
     10  -6.3183E-02   1.1570E-02   7.4753E-02  -1.4951E-01   1.3794E-01   4.1322E-03
     11  -6.9062E-02   1.5656E-02   8.4718E-02  -1.6944E-01   1.5378E-01   6.5822E-03
     12  -7.5398E-02   2.2493E-02   9.7891E-02  -1.9578E-01   1.7329E-01   3.7150E-03
     13  -7.6048E-02   2.4094E-02   1.0014E-01  -2.0028E-01   1.7619E-01   2.3120E-03
     14  -7.6484E-02   2.6017E-02   1.0250E-01  -2.0500E-01   1.7899E-01   3.8701E-04
     15  -7.6489E-02   2.6203E-02   1.0269E-01  -2.0538E-01   1.7918E-01   2.9740E-04
     16  -7.6495E-02   2.6384E-02   1.0288E-01  -2.0576E-01   1.7937E-01   5.8606E-05
     17  -7.6495E-02   2.6413E-02   1.0291E-01  -2.0582E-01   1.7940E-01   4.1058E-05
     18  -7.6496E-02   2.6449E-02   1.0294E-01  -2.0589E-01   1.7944E-01   4.5147E-05
     19  -7.6499E-02   2.6426E-02   1.0293E-01  -2.0585E-01   1.7942E-01   6.9912E-05
     20  -7.6504E-02   2.6408E-02   1.0291E-01  -2.0582E-01   1.7942E-01   1.6566E-04
     21  -7.6524E-02   2.6393E-02   1.0292E-01  -2.0583E-01   1.7944E-01   2.8983E-04
     22  -7.6587E-02   2.6434E-02   1.0302E-01  -2.0604E-01   1.7961E-01   3.2629E-04
     23  -7.6771E-02   2.6522E-02   1.0329E-01  -2.0658E-01   1.8006E-01   5.2636E-04
     24  -7.7070E-02   2.6540E-02   1.0361E-01  -2.0722E-01   1.8068E-01   6.7279E-04
     25  -7.7399E-02   2.6568E-02   1.0397E-01  -2.0793E-01   1.8137E-01   5.2129E-04
     26  -7.7402E-02   2.6586E-02   1.0399E-01  -2.0798E-01   1.8139E-01   3.8787E-04
     27  -7.7484E-02   2.6715E-02   1.0420E-01  -2.0840E-01   1.8168E-01   7.4010E-04
     28  -7.7588E-02   2.6682E-02   1.0427E-01  -2.0854E-01   1.8186E-01   2.9851E-04
     29  -7.7616E-02   2.6588E-02   1.0420E-01  -2.0841E-01   1.8182E-01   2.7462E-04
     30  -7.7633E-02   2.6618E-02   1.0425E-01  -2.0850E-01   1.8188E-01   1.2264E-04
     31  -7.7633E-02   2.6646E-02   1.0428E-01  -2.0856E-01   1.8191E-01   5.7879E-05
     32  -7.7635E-02   2.6712E-02   1.0435E-01  -2.0870E-01   1.8198E-01   9.2345E-05
     33  -7.7637E-02   2.6646E-02   1.0428E-01  -2.0857E-01   1.8192E-01   5.4803E-05
     34  -7.7637E-02   2.6617E-02   1.0425E-01  -2.0851E-01   1.8189E-01   4.7289E-05
     35  -7.7638E-02   2.6658E-02   1.0430E-01  -2.0859E-01   1.8193E-01   1.9472E-05
     36  -7.7638E-02   2.6661E-02   1.0430E-01  -2.0860E-01   1.8194E-01   1.8142E-05
     37  -7.7638E-02   2.6652E-02   1.0429E-01  -2.0858E-01   1.8193E-01   1.9508E-05
     38  -7.7638E-02   2.6654E-02   1.0429E-01  -2.0858E-01   1.8193E-01   7.8249E-06
   --------------------------------------------------------------------------------------
   Converged: ||grad||=7.8249E-06 &lt; vpq_tolgrs=1.0000E-05
   E_pol (eV):  -2.11263471E+00
     eps (eV):   4.95055799E+00
   --------------------------------------------------------------------------------------

 Saving results to: teph4vpq_4o_DS1_VPQ.nc

================================================================================
== DATASET  2 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 2, }
dimensions: {natom: 2, nkpt: 8, mband: 6, nsppol: 1, nspinor: 1, nspden: 1, mpw: 896, }
cutoff_energies: {ecut:  30.0, pawecutdg:  -1.0, }
electrons: {nelect:   1.00000000E+01, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 7, eph_task: 13, }
...

 mkfilename: getwfk from: teph4vpq_2o_DS2_WFK

 mkfilename: getddb from: LiF_eph_varpeq/out_DDB

 mkfilename: getgstore from: teph4vpq_3o_DS2_GSTORE.nc

 Exchange-correlation functional for the present dataset will be:
  GGA: Perdew-Burke-Ernzerhof functional - ixc=11
 Citation for XC functional:
  J.P.Perdew, K.Burke, M.Ernzerhof, PRL 77, 3865 (1996)

- Reading GS states from WFK file: teph4vpq_2o_DS2_WFK
- Reading DDB from file: LiF_eph_varpeq/out_DDB




  ==== Info on the Cryst% object ====
 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  0.0000000  3.8375000  3.8375000  G(1)= -0.1302932  0.1302932  0.1302932
 R(2)=  3.8375000  0.0000000  3.8375000  G(2)=  0.1302932 -0.1302932  0.1302932
 R(3)=  3.8375000  3.8375000  0.0000000  G(3)=  0.1302932  0.1302932 -0.1302932
 Unit cell volume ucvol=  1.1302517E+02 bohr^3
 Angles (23,13,12)=  6.00000000E+01  6.00000000E+01  6.00000000E+01 degrees
 Time-reversal symmetry is present
 Reduced atomic positions [iatom, xred, symbol]:
    1)    0.0000000  0.0000000  0.0000000  Li
    2)    0.5000000  0.5000000  0.5000000   F

 DDB file with 4 blocks has been read.

================================================================================

 Dielectric Tensor and Effective Charges 


 anaddb : Zero the imaginary part of the Dynamical Matrix at Gamma,
   and impose the ASR on the effective charges 

 The violation of the charge neutrality conditions
 by the effective charges is as follows :
    atom        electric field
 displacement     direction
       1               1       -0.065315        0.000000
       1               2        0.000000        0.000000
       1               3        0.000000        0.000000
       2               1        0.000000        0.000000
       2               2       -0.065315        0.000000
       2               3       -0.000000        0.000000
       3               1       -0.000000        0.000000
       3               2       -0.000000        0.000000
       3               3       -0.065315        0.000000

 Effective charge tensors after 
 imposition of the charge neutrality (if requested by user),
 and eventual restriction to some part :
   atom    displacement
         1         1    1.092224E+00   -9.389407E-16   -9.386159E-16
         1         2   -5.076227E-17    1.092224E+00    9.392655E-16
         1         3    5.076227E-17    9.389407E-16    1.092224E+00
         2         1   -1.092224E+00    9.389407E-16    9.386159E-16
         2         2    5.076227E-17   -1.092224E+00   -9.392655E-16
         2         3   -5.076227E-17   -9.389407E-16   -1.092224E+00
 Now, the imaginary part of the dynamical matrix is zeroed
- Found dielectric tensor and Born effective charges in DDB file: LiF_eph_varpeq/out_DDB
- Cannot find quadrupole tensor in DDB file: LiF_eph_varpeq/out_DDB
 Values initialized with zeros.
       Homogeneous q point set in the B.Z.
 Grid q points  :       27
  1)   0.00000000E+00  0.00000000E+00  0.00000000E+00
  2)   3.33333333E-01  0.00000000E+00  0.00000000E+00
  3)  -3.33333333E-01  0.00000000E+00  0.00000000E+00
  4)   0.00000000E+00  3.33333333E-01  0.00000000E+00
  5)   3.33333333E-01  3.33333333E-01  0.00000000E+00
  6)  -3.33333333E-01  3.33333333E-01  0.00000000E+00
  7)   0.00000000E+00 -3.33333333E-01  0.00000000E+00
  8)   3.33333333E-01 -3.33333333E-01  0.00000000E+00
  9)  -3.33333333E-01 -3.33333333E-01  0.00000000E+00
 10)   0.00000000E+00  0.00000000E+00  3.33333333E-01
 11)   3.33333333E-01  0.00000000E+00  3.33333333E-01
 12)  -3.33333333E-01  0.00000000E+00  3.33333333E-01
 13)   0.00000000E+00  3.33333333E-01  3.33333333E-01
 14)   3.33333333E-01  3.33333333E-01  3.33333333E-01
 15)  -3.33333333E-01  3.33333333E-01  3.33333333E-01
 16)   0.00000000E+00 -3.33333333E-01  3.33333333E-01
 17)   3.33333333E-01 -3.33333333E-01  3.33333333E-01
 18)  -3.33333333E-01 -3.33333333E-01  3.33333333E-01
 19)   0.00000000E+00  0.00000000E+00 -3.33333333E-01
 20)   3.33333333E-01  0.00000000E+00 -3.33333333E-01
 21)  -3.33333333E-01  0.00000000E+00 -3.33333333E-01
 22)   0.00000000E+00  3.33333333E-01 -3.33333333E-01
 23)   3.33333333E-01  3.33333333E-01 -3.33333333E-01
 24)  -3.33333333E-01  3.33333333E-01 -3.33333333E-01
 25)   0.00000000E+00 -3.33333333E-01 -3.33333333E-01
 26)   3.33333333E-01 -3.33333333E-01 -3.33333333E-01
 27)  -3.33333333E-01 -3.33333333E-01 -3.33333333E-01

 The interatomic forces have been obtained
 Average speed of sound partial sums:     0.2234217387E-02 (at units)
-                                   =           4.8878 [km/s]

 Debye frequency from partial sums:     0.1801153402E-02 (Ha)
-                                 =     0.1185102008E+02 (THz)
-Debye temperature from partial sums:     0.5687585851E+03 (K)

 Average speed of sound partial sums:     0.2234217387E-02 (at units)
-                                   =           4.8878 [km/s]

 Debye frequency from partial sums:     0.1801153402E-02 (Ha)
-                                 =     0.1185102008E+02 (THz)
-Debye temperature from partial sums:     0.5687585851E+03 (K)

- Writing phonon DOS to netcdf file: teph4vpq_4o_DS2_PHDOS.nc
--------------------------------------------------------------------------------

 Computing variational polaron equations from pre-existent GSTORE file: teph4vpq_3o_DS2_GSTORE.nc
 Initializing gstore object from: teph4vpq_3o_DS2_GSTORE.nc 

 === Gstore parameters ===
 kzone: bz
 kfilter: none
 nkibz: 8
 nkbz: 64
 glob_nk_spin: [64]
 qzone: bz
 nqibz: 8
 nqbz: 64
 glob_nq_spin: [64]
 kptopt: 1
 qptopt: 1
 with_vk: 1

 gqk_cplex: 2
 gqk_bstart: 3
 gqk_bstop: 5
 gqk_nb: 3
 gqk_my_npert: 6
 gqk_my_nk: -1
 gqk_my_nq: -1

  === MPI distribution ===
P Number of CPUs for parallelism over perturbations: 1
P Number of perturbations treated by this CPU: 6
P Number of CPUs for parallelism over q-points: 1
P Number of CPUs for parallelism over k-points: 1

  === Variational Polaron Equations ===

 Polaron:
   * Polaron kind: hole
   * BvK supercell: 4x4x4
   * Number of independent spin polarizations: 1
   * Number of polaronic states: 1
   * Filtering of electronic states: no

 Long-range corrections:
   * Frohlich correction: yes
   * Frohlich correction value: 6.948800E-01 eV
   * Frohlich correction included in matrix elements: yes

 Optimization parameters:
   * Initial seed: charge localization A_nk
   * Initial seed type: Gaussian, based on the electroic energies
   * Tolerance on the gradient norm: 1.00E-05
   * Maximum number of iterations per state: 50

 Solving the variational polaron equations for each state...
   * spin 1/1, pstate 1/1...
   Done

 Printing the optimization logs
   --------------------------------------------------------------------------------------
   * spin 1/1, pstate 1/1
   * values in the optimization log are in (a.u.)
   --------------------------------------------------------------------------------------
   Step        E_pol         E_el         E_ph       E_elph      epsilon     ||grad||
      1   8.3660E-03   4.1216E-02   3.2850E-02  -6.5700E-02   2.4484E-02   6.7249E-03
      2  -1.1421E-02   2.1332E-02   3.2752E-02  -6.5505E-02   4.4173E-02   2.2814E-03
      3  -2.5459E-02   8.0735E-03   3.3532E-02  -6.7064E-02   5.8991E-02   2.1507E-03
      4  -3.0169E-02   6.8859E-03   3.7055E-02  -7.4109E-02   6.7223E-02   2.2300E-03
      5  -3.8190E-02   8.5199E-03   4.6710E-02  -9.3419E-02   8.4899E-02   5.3800E-03
      6  -4.7131E-02   1.1792E-02   5.8923E-02  -1.1785E-01   1.0605E-01   7.4602E-03
      7  -6.5630E-02   1.9804E-02   8.5434E-02  -1.7087E-01   1.5106E-01   7.5458E-03
      8  -7.5874E-02   2.5872E-02   1.0175E-01  -2.0349E-01   1.7762E-01   2.4648E-03
      9  -7.6675E-02   2.8618E-02   1.0529E-01  -2.1059E-01   1.8197E-01   4.2758E-04
     10  -7.6696E-02   2.8843E-02   1.0554E-01  -2.1108E-01   1.8224E-01   2.2148E-04
     11  -7.6705E-02   2.9110E-02   1.0582E-01  -2.1163E-01   1.8252E-01   1.3194E-04
     12  -7.6743E-02   2.8988E-02   1.0573E-01  -2.1146E-01   1.8247E-01   1.0165E-04
     13  -7.6746E-02   2.9082E-02   1.0583E-01  -2.1166E-01   1.8257E-01   9.5015E-05
     14  -7.6754E-02   2.9176E-02   1.0593E-01  -2.1186E-01   1.8268E-01   1.1922E-04
     15  -7.6757E-02   2.9033E-02   1.0579E-01  -2.1158E-01   1.8255E-01   5.2980E-05
     16  -7.6758E-02   2.8987E-02   1.0575E-01  -2.1149E-01   1.8250E-01   6.9306E-05
     17  -7.6760E-02   2.9060E-02   1.0582E-01  -2.1164E-01   1.8258E-01   3.6271E-05
     18  -7.6761E-02   2.9061E-02   1.0582E-01  -2.1164E-01   1.8258E-01   2.1248E-05
     19  -7.6761E-02   2.9046E-02   1.0581E-01  -2.1161E-01   1.8257E-01   3.1987E-05
     20  -7.6761E-02   2.9053E-02   1.0581E-01  -2.1163E-01   1.8258E-01   1.4752E-05
     21  -7.6761E-02   2.9063E-02   1.0582E-01  -2.1165E-01   1.8259E-01   1.3285E-05
     22  -7.6761E-02   2.9062E-02   1.0582E-01  -2.1165E-01   1.8258E-01   1.0372E-05
     23  -7.6762E-02   2.9056E-02   1.0582E-01  -2.1164E-01   1.8258E-01   5.9852E-06
   --------------------------------------------------------------------------------------
   Converged: ||grad||=5.9852E-06 &lt; vpq_tolgrs=1.0000E-05
   E_pol (eV):  -2.08878681E+00
     eps (eV):   4.96823014E+00
   --------------------------------------------------------------------------------------

 Saving results to: teph4vpq_4o_DS2_VPQ.nc

================================================================================
== DATASET  3 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 3, }
dimensions: {natom: 2, nkpt: 10, mband: 6, nsppol: 1, nspinor: 1, nspden: 1, mpw: 899, }
cutoff_energies: {ecut:  30.0, pawecutdg:  -1.0, }
electrons: {nelect:   1.00000000E+01, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 7, eph_task: 13, }
...

 mkfilename: getwfk from: teph4vpq_2o_DS3_WFK

 mkfilename: getddb from: LiF_eph_varpeq/out_DDB

 mkfilename: getgstore from: teph4vpq_3o_DS3_GSTORE.nc

 Exchange-correlation functional for the present dataset will be:
  GGA: Perdew-Burke-Ernzerhof functional - ixc=11
 Citation for XC functional:
  J.P.Perdew, K.Burke, M.Ernzerhof, PRL 77, 3865 (1996)

- Reading GS states from WFK file: teph4vpq_2o_DS3_WFK
- Reading DDB from file: LiF_eph_varpeq/out_DDB




  ==== Info on the Cryst% object ====
 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  0.0000000  3.8375000  3.8375000  G(1)= -0.1302932  0.1302932  0.1302932
 R(2)=  3.8375000  0.0000000  3.8375000  G(2)=  0.1302932 -0.1302932  0.1302932
 R(3)=  3.8375000  3.8375000  0.0000000  G(3)=  0.1302932  0.1302932 -0.1302932
 Unit cell volume ucvol=  1.1302517E+02 bohr^3
 Angles (23,13,12)=  6.00000000E+01  6.00000000E+01  6.00000000E+01 degrees
 Time-reversal symmetry is present
 Reduced atomic positions [iatom, xred, symbol]:
    1)    0.0000000  0.0000000  0.0000000  Li
    2)    0.5000000  0.5000000  0.5000000   F

 DDB file with 4 blocks has been read.

================================================================================

 Dielectric Tensor and Effective Charges 


 anaddb : Zero the imaginary part of the Dynamical Matrix at Gamma,
   and impose the ASR on the effective charges 

 The violation of the charge neutrality conditions
 by the effective charges is as follows :
    atom        electric field
 displacement     direction
       1               1       -0.065315        0.000000
       1               2        0.000000        0.000000
       1               3        0.000000        0.000000
       2               1        0.000000        0.000000
       2               2       -0.065315        0.000000
       2               3       -0.000000        0.000000
       3               1       -0.000000        0.000000
       3               2       -0.000000        0.000000
       3               3       -0.065315        0.000000

 Effective charge tensors after 
 imposition of the charge neutrality (if requested by user),
 and eventual restriction to some part :
   atom    displacement
         1         1    1.092224E+00   -9.389407E-16   -9.386159E-16
         1         2   -5.076227E-17    1.092224E+00    9.392655E-16
         1         3    5.076227E-17    9.389407E-16    1.092224E+00
         2         1   -1.092224E+00    9.389407E-16    9.386159E-16
         2         2    5.076227E-17   -1.092224E+00   -9.392655E-16
         2         3   -5.076227E-17   -9.389407E-16   -1.092224E+00
 Now, the imaginary part of the dynamical matrix is zeroed
- Found dielectric tensor and Born effective charges in DDB file: LiF_eph_varpeq/out_DDB
- Cannot find quadrupole tensor in DDB file: LiF_eph_varpeq/out_DDB
 Values initialized with zeros.
       Homogeneous q point set in the B.Z.
 Grid q points  :       27
  1)   0.00000000E+00  0.00000000E+00  0.00000000E+00
  2)   3.33333333E-01  0.00000000E+00  0.00000000E+00
  3)  -3.33333333E-01  0.00000000E+00  0.00000000E+00
  4)   0.00000000E+00  3.33333333E-01  0.00000000E+00
  5)   3.33333333E-01  3.33333333E-01  0.00000000E+00
  6)  -3.33333333E-01  3.33333333E-01  0.00000000E+00
  7)   0.00000000E+00 -3.33333333E-01  0.00000000E+00
  8)   3.33333333E-01 -3.33333333E-01  0.00000000E+00
  9)  -3.33333333E-01 -3.33333333E-01  0.00000000E+00
 10)   0.00000000E+00  0.00000000E+00  3.33333333E-01
 11)   3.33333333E-01  0.00000000E+00  3.33333333E-01
 12)  -3.33333333E-01  0.00000000E+00  3.33333333E-01
 13)   0.00000000E+00  3.33333333E-01  3.33333333E-01
 14)   3.33333333E-01  3.33333333E-01  3.33333333E-01
 15)  -3.33333333E-01  3.33333333E-01  3.33333333E-01
 16)   0.00000000E+00 -3.33333333E-01  3.33333333E-01
 17)   3.33333333E-01 -3.33333333E-01  3.33333333E-01
 18)  -3.33333333E-01 -3.33333333E-01  3.33333333E-01
 19)   0.00000000E+00  0.00000000E+00 -3.33333333E-01
 20)   3.33333333E-01  0.00000000E+00 -3.33333333E-01
 21)  -3.33333333E-01  0.00000000E+00 -3.33333333E-01
 22)   0.00000000E+00  3.33333333E-01 -3.33333333E-01
 23)   3.33333333E-01  3.33333333E-01 -3.33333333E-01
 24)  -3.33333333E-01  3.33333333E-01 -3.33333333E-01
 25)   0.00000000E+00 -3.33333333E-01 -3.33333333E-01
 26)   3.33333333E-01 -3.33333333E-01 -3.33333333E-01
 27)  -3.33333333E-01 -3.33333333E-01 -3.33333333E-01

 The interatomic forces have been obtained
 Average speed of sound partial sums:     0.2234217387E-02 (at units)
-                                   =           4.8878 [km/s]

 Debye frequency from partial sums:     0.1801153402E-02 (Ha)
-                                 =     0.1185102008E+02 (THz)
-Debye temperature from partial sums:     0.5687585851E+03 (K)

 Average speed of sound partial sums:     0.2234217387E-02 (at units)
-                                   =           4.8878 [km/s]

 Debye frequency from partial sums:     0.1801153402E-02 (Ha)
-                                 =     0.1185102008E+02 (THz)
-Debye temperature from partial sums:     0.5687585851E+03 (K)

- Writing phonon DOS to netcdf file: teph4vpq_4o_DS3_PHDOS.nc
--------------------------------------------------------------------------------

 Computing variational polaron equations from pre-existent GSTORE file: teph4vpq_3o_DS3_GSTORE.nc
 Initializing gstore object from: teph4vpq_3o_DS3_GSTORE.nc 

 === Gstore parameters ===
 kzone: bz
 kfilter: none
 nkibz: 10
 nkbz: 125
 glob_nk_spin: [125]
 qzone: bz
 nqibz: 10
 nqbz: 125
 glob_nq_spin: [125]
 kptopt: 1
 qptopt: 1
 with_vk: 1

 gqk_cplex: 2
 gqk_bstart: 3
 gqk_bstop: 5
 gqk_nb: 3
 gqk_my_npert: 6
 gqk_my_nk: -1
 gqk_my_nq: -1

  === MPI distribution ===
P Number of CPUs for parallelism over perturbations: 1
P Number of perturbations treated by this CPU: 6
P Number of CPUs for parallelism over q-points: 1
P Number of CPUs for parallelism over k-points: 1

  === Variational Polaron Equations ===

 Polaron:
   * Polaron kind: hole
   * BvK supercell: 5x5x5
   * Number of independent spin polarizations: 1
   * Number of polaronic states: 1
   * Filtering of electronic states: no

 Long-range corrections:
   * Frohlich correction: yes
   * Frohlich correction value: 5.559040E-01 eV
   * Frohlich correction included in matrix elements: yes

 Optimization parameters:
   * Initial seed: charge localization A_nk
   * Initial seed type: Gaussian, based on the electroic energies
   * Tolerance on the gradient norm: 1.00E-05
   * Maximum number of iterations per state: 50

 Solving the variational polaron equations for each state...
   * spin 1/1, pstate 1/1...
   Done

 Printing the optimization logs
   --------------------------------------------------------------------------------------
   * spin 1/1, pstate 1/1
   * values in the optimization log are in (a.u.)
   --------------------------------------------------------------------------------------
   Step        E_pol         E_el         E_ph       E_elph      epsilon     ||grad||
      1   1.1721E-02   4.1203E-02   2.9481E-02  -5.8962E-02   1.7760E-02   4.2553E-03
      2  -3.2540E-03   2.3921E-02   2.7175E-02  -5.4349E-02   3.0429E-02   1.3215E-03
      3  -1.5984E-02   1.0806E-02   2.6789E-02  -5.3579E-02   4.2773E-02   2.3608E-03
      4  -2.0425E-02   7.4643E-03   2.7889E-02  -5.5778E-02   4.8314E-02   1.8825E-03
      5  -2.8038E-02   4.2196E-03   3.2258E-02  -6.4516E-02   6.0296E-02   2.0607E-03
      6  -3.9061E-02   7.8994E-03   4.6961E-02  -9.3922E-02   8.6022E-02   4.2915E-03
      7  -5.6764E-02   1.6430E-02   7.3195E-02  -1.4639E-01   1.2996E-01   6.3241E-03
      8  -7.4777E-02   2.4965E-02   9.9742E-02  -1.9948E-01   1.7452E-01   2.6111E-03
      9  -7.6411E-02   2.8724E-02   1.0513E-01  -2.1027E-01   1.8154E-01   4.8921E-04
     10  -7.6460E-02   2.9204E-02   1.0566E-01  -2.1133E-01   1.8212E-01   1.7364E-04
     11  -7.6467E-02   2.9451E-02   1.0592E-01  -2.1184E-01   1.8238E-01   2.3522E-05
     12  -7.6467E-02   2.9482E-02   1.0595E-01  -2.1190E-01   1.8242E-01   2.4975E-05
     13  -7.6468E-02   2.9522E-02   1.0599E-01  -2.1198E-01   1.8246E-01   3.2206E-05
     14  -7.6469E-02   2.9461E-02   1.0593E-01  -2.1186E-01   1.8240E-01   1.2320E-05
     15  -7.6469E-02   2.9491E-02   1.0596E-01  -2.1192E-01   1.8243E-01   1.2992E-05
     16  -7.6469E-02   2.9496E-02   1.0596E-01  -2.1193E-01   1.8243E-01   1.1121E-05
     17  -7.6469E-02   2.9472E-02   1.0594E-01  -2.1188E-01   1.8241E-01   4.5754E-06
   --------------------------------------------------------------------------------------
   Converged: ||grad||=4.5754E-06 &lt; vpq_tolgrs=1.0000E-05
   E_pol (eV):  -2.08083457E+00
     eps (eV):   4.96364781E+00
   --------------------------------------------------------------------------------------

 Saving results to: teph4vpq_4o_DS3_VPQ.nc

== END DATASET(S) ==============================================================
================================================================================

 -outvars: echo values of variables after computation  --------
            acell      7.6750000000E+00  7.6750000000E+00  7.6750000000E+00 Bohr
              amu      6.94100000E+00  1.89984032E+01
        ddb_ngqpt        3    3    3
             ecut      3.00000000E+01 Hartree
 eph_frohl_ntheta          32
         eph_task          13
           etotal1     0.0000000000E+00
           etotal2     0.0000000000E+00
           etotal3     0.0000000000E+00
            fcart1     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
            fcart2     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
            fcart3     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
-          fftalg         512
              ixc          11
           jdtset        1    2    3
         kptrlatt1       3    0    0      0    3    0      0    0    3
         kptrlatt2       4    0    0      0    4    0      0    0    4
         kptrlatt3       5    0    0      0    5    0      0    0    5
          kptrlen1     1.62811336E+01
          kptrlen2     2.17081782E+01
          kptrlen3     2.71352227E+01
P           mkmem1          4
P           mkmem2          8
P           mkmem3         10
            natom           2
            nband1          6
            nband2          6
            nband3          6
           ndtset           3
            ngfft          30      30      30
             nkpt1          4
             nkpt2          8
             nkpt3         10
             nsym          48
           ntypat           2
              occ1     2.000000  2.000000  2.000000  2.000000  2.000000  0.000000
              occ2     2.000000  2.000000  2.000000  2.000000  2.000000  0.000000
              occ3     2.000000  2.000000  2.000000  2.000000  2.000000  0.000000
        optdriver           7
            rprim      0.0000000000E+00  5.0000000000E-01  5.0000000000E-01
                       5.0000000000E-01  0.0000000000E+00  5.0000000000E-01
                       5.0000000000E-01  5.0000000000E-01  0.0000000000E+00
          spgroup         225
           strten1     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           strten2     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           strten3     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           symrel      1  0  0   0  1  0   0  0  1      -1  0  0   0 -1  0   0  0 -1
                       0 -1  1   0 -1  0   1 -1  0       0  1 -1   0  1  0  -1  1  0
                      -1  0  0  -1  0  1  -1  1  0       1  0  0   1  0 -1   1 -1  0
                       0  1 -1   1  0 -1   0  0 -1       0 -1  1  -1  0  1   0  0  1
                      -1  0  0  -1  1  0  -1  0  1       1  0  0   1 -1  0   1  0 -1
                       0 -1  1   1 -1  0   0 -1  0       0  1 -1  -1  1  0   0  1  0
                       1  0  0   0  0  1   0  1  0      -1  0  0   0  0 -1   0 -1  0
                       0  1 -1   0  0 -1   1  0 -1       0 -1  1   0  0  1  -1  0  1
                      -1  0  1  -1  1  0  -1  0  0       1  0 -1   1 -1  0   1  0  0
                       0 -1  0   1 -1  0   0 -1  1       0  1  0  -1  1  0   0  1 -1
                       1  0 -1   0  0 -1   0  1 -1      -1  0  1   0  0  1   0 -1  1
                       0  1  0   0  0  1   1  0  0       0 -1  0   0  0 -1  -1  0  0
                       1  0 -1   0  1 -1   0  0 -1      -1  0  1   0 -1  1   0  0  1
                       0 -1  0   0 -1  1   1 -1  0       0  1  0   0  1 -1  -1  1  0
                      -1  0  1  -1  0  0  -1  1  0       1  0 -1   1  0  0   1 -1  0
                       0  1  0   1  0  0   0  0  1       0 -1  0  -1  0  0   0  0 -1
                       0  0 -1   0  1 -1   1  0 -1       0  0  1   0 -1  1  -1  0  1
                       1 -1  0   0 -1  1   0 -1  0      -1  1  0   0  1 -1   0  1  0
                       0  0  1   1  0  0   0  1  0       0  0 -1  -1  0  0   0 -1  0
                      -1  1  0  -1  0  0  -1  0  1       1 -1  0   1  0  0   1  0 -1
                       0  0  1   0  1  0   1  0  0       0  0 -1   0 -1  0  -1  0  0
                       1 -1  0   0 -1  0   0 -1  1      -1  1  0   0  1  0   0  1 -1
                       0  0 -1   1  0 -1   0  1 -1       0  0  1  -1  0  1   0 -1  1
                      -1  1  0  -1  0  1  -1  0  0       1 -1  0   1  0 -1   1  0  0
            typat      1  2
        vpq_avg_g           1
       vpq_tolgrs      1.0000000000E-05
           xangst      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.0307175380E+00  2.0307175380E+00  2.0307175380E+00
            xcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       3.8375000000E+00  3.8375000000E+00  3.8375000000E+00
             xred      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       5.0000000000E-01  5.0000000000E-01  5.0000000000E-01
            znucl        3.00000    9.00000

================================================================================


- Timing analysis has been suppressed with timopt=0



================================================================================

 Suggested references for the acknowledgment of ABINIT usage.

 The users of ABINIT have little formal obligations with respect to the ABINIT group
 (those specified in the GNU General Public License, http://www.gnu.org/copyleft/gpl.txt).
 However, it is common practice in the scientific literature,
 to acknowledge the efforts of people that have made the research possible.
 In this spirit, please find below suggested citations of work written by ABINIT developers,
 corresponding to implementations inside of ABINIT that you have used in the present run.
 Note also that it will be of great value to readers of publications presenting these results,
 to read papers enabling them to understand the theoretical formalism and details
 of the ABINIT implementation.
 For information on why they are suggested, see also https://docs.abinit.org/theory/acknowledgments.
-
- [1] The Abinit project: Impact, environment and recent developments.
- Computer Phys. Comm. 248, 107042 (2020).
- X.Gonze, B. Amadon, G. Antonius, F.Arnardi, L.Baguet, J.-M.Beuken,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, N.Brouwer, F.Bruneval,
- G.Brunin, T.Cavignac, J.-B. Charraud, Wei Chen, M.Cote, S.Cottenier,
- J.Denier, G.Geneste, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, Xu He, N.Helbig, N.Holzwarth, Y.Jia, F.Jollet,
- W.Lafargue-Dit-Hauret, K.Lejaeghere, M.A.L.Marques, A.Martin, C.Martins,
- H.P.C. Miranda, F.Naccarato, K. Persson, G.Petretto, V.Planes, Y.Pouillon,
- S.Prokhorenko, F.Ricci, G.-M.Rignanese, A.H.Romero, M.M.Schmitt, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, G.Zerah and J.W.Zwanzig
- Comment: the fifth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT20.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2020
-
- [2] Optimized norm-conserving Vanderbilt pseudopotentials.
- D.R. Hamann, Phys. Rev. B 88, 085117 (2013).
- Comment: Some pseudopotential generated using the ONCVPSP code were used.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#hamann2013
-
- [3] ABINIT: Overview, and focus on selected capabilities
- J. Chem. Phys. 152, 124102 (2020).
- A. Romero, D.C. Allan, B. Amadon, G. Antonius, T. Applencourt, L.Baguet,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, F.Bruneval,
- G.Brunin, D.Caliste, M.Cote,
- J.Denier, C. Dreyer, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, F.Jollet, G. Jomard,
- A.Martin, 
- H.P.C. Miranda, F.Naccarato, G.Petretto, N.A. Pike, V.Planes,
- S.Prokhorenko, T. Rangel, F.Ricci, G.-M.Rignanese, M.Royo, M.Stengel, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, J.Wiktor, J.W.Zwanziger, and X.Gonze.
- Comment: a global overview of ABINIT, with focus on selected capabilities .
- Note that a version of this paper, that is not formatted for J. Chem. Phys 
- is available at https://www.abinit.org/sites/default/files/ABINIT20_JPC.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#romero2020
-
- [4] Recent developments in the ABINIT software package.
- Computer Phys. Comm. 205, 106 (2016).
- X.Gonze, F.Jollet, F.Abreu Araujo, D.Adams, B.Amadon, T.Applencourt,
- C.Audouze, J.-M.Beuken, J.Bieder, A.Bokhanchuk, E.Bousquet, F.Bruneval
- D.Caliste, M.Cote, F.Dahm, F.Da Pieve, M.Delaveau, M.Di Gennaro,
- B.Dorado, C.Espejo, G.Geneste, L.Genovese, A.Gerossier, M.Giantomassi,
- Y.Gillet, D.R.Hamann, L.He, G.Jomard, J.Laflamme Janssen, S.Le Roux,
- A.Levitt, A.Lherbier, F.Liu, I.Lukacevic, A.Martin, C.Martins,
- M.J.T.Oliveira, S.Ponce, Y.Pouillon, T.Rangel, G.-M.Rignanese,
- A.H.Romero, B.Rousseau, O.Rubel, A.A.Shukri, M.Stankovski, M.Torrent,
- M.J.Van Setten, B.Van Troeye, M.J.Verstraete, D.Waroquier, J.Wiktor,
- B.Xu, A.Zhou, J.W.Zwanziger.
- Comment: the fourth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT16.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2016
-
- And optionally:
-
- [5] ABINIT: First-principles approach of materials and nanosystem properties.
- Computer Phys. Comm. 180, 2582-2615 (2009).
- X. Gonze, B. Amadon, P.-M. Anglade, J.-M. Beuken, F. Bottin, P. Boulanger, F. Bruneval,
- D. Caliste, R. Caracas, M. Cote, T. Deutsch, L. Genovese, Ph. Ghosez, M. Giantomassi
- S. Goedecker, D.R. Hamann, P. Hermet, F. Jollet, G. Jomard, S. Leroux, M. Mancini, S. Mazevet,
- M.J.T. Oliveira, G. Onida, Y. Pouillon, T. Rangel, G.-M. Rignanese, D. Sangalli, R. Shaltaf,
- M. Torrent, M.J. Verstraete, G. Zerah, J.W. Zwanziger
- Comment: the third generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT_CPC_v10.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2009
-
- Proc.   0 individual time (sec): cpu=         49.6  wall=         49.6

================================================================================

 Calculation completed.
.Delivered   0 WARNINGs and  10 COMMENTs to log file.
+Overall time at end (sec) : cpu=         49.6  wall=         49.6

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-44e985fa-c150-47d1-9573-8e2d0e0f87db", "#uuid-67c3c176-c230-4581-878e-9e976275236e") }); </script>

<p>Since first we load the GSTORE files, we find a section that summarizes the gstore parametes and MPI parallelism:</p>
<div class="highlight"><pre><span></span><code> Computing variational polaron equations from pre-existent GSTORE file: teph4vpq\_3o\_DS1_GSTORE.nc
 Initializing gstore object from: teph4vpq_3o_DS1_GSTORE.nc

 === Gstore parameters ===
  ...

  === MPI distribution ===
  ...
</code></pre></div>
<p>The following section promts the parameters of the VarPEq optimization and other related quantities:</p>
<div class="highlight"><pre><span></span><code>  === Variational Polaron Equations ===

 Polaron:
<span class="w">   </span><span class="k">*</span><span class="w"> </span>Polaron kind: hole
<span class="w">   </span><span class="k">*</span><span class="w"> </span>BvK supercell: 3x3x3
<span class="w">   </span><span class="k">*</span><span class="w"> </span>Number of independent spin polarizations: 1
<span class="w">   </span><span class="k">*</span><span class="w"> </span>Number of polaronic states: 1
<span class="w">   </span><span class="k">*</span><span class="w"> </span>Filtering of electronic states: no

 Long-range corrections:
<span class="w">   </span><span class="k">*</span><span class="w"> </span>Frohlich correction: yes
<span class="w">   </span><span class="k">*</span><span class="w"> </span>Frohlich correction value: 9.265067E-01 eV
<span class="w">   </span><span class="k">*</span><span class="w"> </span>Frohlich correction included in matrix elements: yes

 Optimization parameters:
<span class="w">   </span><span class="k">*</span><span class="w"> </span>Initial seed: charge localization A_nk
<span class="w">   </span><span class="k">*</span><span class="w"> </span>Initial seed type: Gaussian, based on the electroic energies
<span class="w">   </span><span class="k">*</span><span class="w"> </span>Tolerance on the gradient norm: 1.00E-05
<span class="w">   </span><span class="k">*</span><span class="w"> </span>Maximum number of iterations per state: 50
</code></pre></div>
<p>And, finally, the code enters the solver and prints the optimization log at the end of computation.</p>
<div class="highlight"><pre><span></span><code> Solving the variational polaron equations for each state...
<span class="w">   </span><span class="k">*</span><span class="w"> </span>spin 1/1, pstate 1/1...
   Done

 Printing the optimization logs
   --------------------------------------------------------------------------------------
<span class="w">   </span><span class="k">*</span><span class="w"> </span>spin 1/1, pstate 1/1
<span class="w">   </span><span class="k">*</span><span class="w"> </span>values in the optimization log are in (a.u.)
   --------------------------------------------------------------------------------------
   Step        E<span class="ge">_pol         E_</span>el         E<span class="ge">_ph       E_</span>elph      epsilon     ||grad||
      1  -3.0118E-03   4.1093E-02   4.4105E-02  -8.8210E-02   4.7117E-02   1.0900E-02
      2  -2.4528E-02   1.9417E-02   4.3945E-02  -8.7891E-02   6.8473E-02   2.2198E-03
      3  -3.9895E-02   3.0152E-03   4.2910E-02  -8.5819E-02   8.2804E-02   4.9899E-03
      4  -4.1219E-02   1.7941E-03   4.3013E-02  -8.6026E-02   8.4232E-02   3.2342E-03
      5  -4.3429E-02   5.7133E-04   4.4000E-02  -8.8000E-02   8.7429E-02   1.8175E-03
      6  -4.7595E-02   2.6635E-03   5.0259E-02  -1.0052E-01   9.7854E-02   4.6156E-03
      7  -5.2013E-02   5.3655E-03   5.7378E-02  -1.1476E-01   1.0939E-01   6.3385E-03
      8  -5.6356E-02   8.0023E-03   6.4359E-02  -1.2872E-01   1.2072E-01   6.1036E-03
      9  -6.1355E-02   1.0870E-02   7.2225E-02  -1.4445E-01   1.3358E-01   2.7021E-03
     10  -6.3184E-02   1.1570E-02   7.4754E-02  -1.4951E-01   1.3794E-01   4.1324E-03
     11  -6.9063E-02   1.5656E-02   8.4719E-02  -1.6944E-01   1.5378E-01   6.5822E-03
     12  -7.5399E-02   2.2493E-02   9.7892E-02  -1.9578E-01   1.7329E-01   3.7146E-03
     13  -7.6048E-02   2.4094E-02   1.0014E-01  -2.0028E-01   1.7619E-01   2.3119E-03
     14  -7.6484E-02   2.6017E-02   1.0250E-01  -2.0500E-01   1.7899E-01   3.8701E-04
     15  -7.6489E-02   2.6203E-02   1.0269E-01  -2.0538E-01   1.7918E-01   2.9740E-04
     16  -7.6495E-02   2.6384E-02   1.0288E-01  -2.0576E-01   1.7937E-01   5.8608E-05
     17  -7.6495E-02   2.6413E-02   1.0291E-01  -2.0582E-01   1.7940E-01   4.1064E-05
     18  -7.6496E-02   2.6449E-02   1.0294E-01  -2.0589E-01   1.7944E-01   4.5160E-05
     19  -7.6499E-02   2.6426E-02   1.0293E-01  -2.0585E-01   1.7942E-01   6.9919E-05
     20  -7.6504E-02   2.6408E-02   1.0291E-01  -2.0582E-01   1.7942E-01   1.6567E-04
     21  -7.6524E-02   2.6393E-02   1.0292E-01  -2.0583E-01   1.7944E-01   2.8985E-04
     22  -7.6587E-02   2.6434E-02   1.0302E-01  -2.0604E-01   1.7961E-01   3.2632E-04
     23  -7.6771E-02   2.6522E-02   1.0329E-01  -2.0658E-01   1.8006E-01   5.2643E-04
     24  -7.7070E-02   2.6540E-02   1.0361E-01  -2.0722E-01   1.8068E-01   6.7279E-04
     25  -7.7399E-02   2.6568E-02   1.0397E-01  -2.0793E-01   1.8137E-01   5.2144E-04
     26  -7.7402E-02   2.6586E-02   1.0399E-01  -2.0798E-01   1.8139E-01   3.8771E-04
     27  -7.7485E-02   2.6715E-02   1.0420E-01  -2.0840E-01   1.8168E-01   7.3990E-04
     28  -7.7588E-02   2.6682E-02   1.0427E-01  -2.0854E-01   1.8186E-01   2.9923E-04
     29  -7.7616E-02   2.6588E-02   1.0420E-01  -2.0841E-01   1.8182E-01   2.7317E-04
     30  -7.7633E-02   2.6620E-02   1.0425E-01  -2.0850E-01   1.8189E-01   1.2044E-04
     31  -7.7633E-02   2.6648E-02   1.0428E-01  -2.0856E-01   1.8191E-01   5.7835E-05
     32  -7.7636E-02   2.6711E-02   1.0435E-01  -2.0869E-01   1.8198E-01   9.0984E-05
     33  -7.7637E-02   2.6646E-02   1.0428E-01  -2.0857E-01   1.8192E-01   5.3464E-05
     34  -7.7637E-02   2.6617E-02   1.0425E-01  -2.0851E-01   1.8189E-01   4.7310E-05
     35  -7.7638E-02   2.6658E-02   1.0430E-01  -2.0859E-01   1.8193E-01   1.9031E-05
     36  -7.7638E-02   2.6661E-02   1.0430E-01  -2.0860E-01   1.8194E-01   1.8077E-05
     37  -7.7638E-02   2.6652E-02   1.0429E-01  -2.0858E-01   1.8193E-01   1.9269E-05
     38  -7.7638E-02   2.6654E-02   1.0429E-01  -2.0858E-01   1.8193E-01   7.3431E-06
   --------------------------------------------------------------------------------------
   Converged: ||grad||=7.3431E-06 &lt; vpq_tolgrs=1.0000E-05
   E_pol (eV):  -2.11263475E+00
     eps (eV):   4.95056023E+00
   --------------------------------------------------------------------------------------

 Saving results to: teph4vpq_4o_DS1_VPQ.nc
</code></pre></div>
<p>In the log above, one can see the convergence of the polaron binding energy <code>E_pol</code>, its individual electronic,
phonon and electron-phonon terms <code>E_el</code>, <code>E_ph</code>, and <code>E_elph</code>, as well as charge localization energy <code>epsilon</code>.
The <code>||grad||</code> column shows the evolution of the gradient norm over the iterations.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Note, however, that this log is given to get a first glimpse on the behaviour of the solver.
Complete results, including optimized <span class="arithmatex">\(\boldsymbol{A}\)</span> and <span class="arithmatex">\(\boldsymbol{B}\)</span> coefficients are saved
in the VPQ NetCDF at the end of computation.
We will heavily rely on these netcdf files for post-processing.</p>
</div>
<p>The calculation has produced the following output files (e.g. for the first DATASET):</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ls<span class="w"> </span>teph4vpq_4o_DS1*

teph4vpq_4o_DS1_EBANDS.agr<span class="w"> </span>teph4vpq_4o_DS1_PHDOS.nc<span class="w">   </span>teph4vpq_4o_DS1_VPQ.nc
</code></pre></div>
<p>where the most important is VPQ.nc &ndash; a NetCDF file with the optimization log,
optimized <span class="arithmatex">\(\boldsymbol{A}\)</span> and <span class="arithmatex">\(\boldsymbol{B}\)</span> coefficients and other relevant data.
We will heavily rely on these files and the <a href="https://github.com/abinit/abipy">AbiPy</a>  toolkit for post-processing our results.
As usual, one can use <a href="http://abinit.github.io/abipy/scripts/abiopen.html">abiopen.py</a>  with the <code>-e</code> option (<code>--expose</code>) to print a summary to terminal and visualize the optimization log:</p>
<p><img alt="" src="../eph4vpq_assets/LiF_hole_scf.png" /></p>
<p>The subplot on the left shows the evolution of the gradient norm.
Two subplots on the right show the convergence of energy terms and their log-scale difference wrt final values.
As the binding energy <span class="arithmatex">\(E_\mathrm{pol}\)</span> is the only variational quantity, on these two subplots it is shown by solid lines.</p>
<h2 id="small-hole-polaron-extrapolation-to-the-infinite-size-supercell">Small hole polaron: extrapolation to the infinite-size supercell<a class="headerlink" href="#small-hole-polaron-extrapolation-to-the-infinite-size-supercell" title="Permanent link">&para;</a></h2>
<p>As seen from our calculations, the small hole polaron is already being localized at 3x3x3 <span class="arithmatex">\(\kk/\qq\)</span>-mesh (3x3x3 supercell).
However, to evalute its binding energy in the infinite-size limit <span class="arithmatex">\(N_p \to \infty\)</span>,
we need to perform the extrapolation wrt inverse supercell size (that&rsquo;s why we have optimized polaron for multiple meshes!):</p>
<div class="arithmatex">\[\begin{equation}
\label{eq:makovpayne}
    E_\mathrm{pol}(N_p) =
    E^\infty_\mathrm{pol} + a N_p^{-1/3} + \mathcal{O}(N_p^{-1}),
\end{equation}\]</div>
<p>To fit the parameters of Eq. (\ref{eq:makovpayne}) to the optimized data, one can use any suitable software or library of choice.
In this tutorial, however &ndash; just as in other examples &ndash; we will rely on the capabilities of AbiPy as a Python module.</p>
<p>AbiPy provides a <code>Robot</code> class that can be used to analzye multiple NetCDF files produced in ABINIT calculations.
In particular, we will be interested in the <code>VpqRobot</code>.
The following Python script gives an example on how to use this class with the relevant methods:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">abipy.eph.vpq</span><span class="w"> </span><span class="kn">import</span> <span class="n">VpqRobot</span>

<span class="n">vpq_files</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;teph4vpq_4o_DS1_VPQ.nc&quot;</span><span class="p">,</span>
    <span class="s2">&quot;teph4vpq_4o_DS2_VPQ.nc&quot;</span><span class="p">,</span>
    <span class="s2">&quot;teph4vpq_4o_DS3_VPQ.nc&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">robot</span> <span class="o">=</span> <span class="n">VpqRobot</span><span class="o">.</span><span class="n">from_files</span><span class="p">(</span><span class="n">vpq_files</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">robot</span><span class="o">.</span><span class="n">get_final_results_df</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="n">robot</span><span class="o">.</span><span class="n">plot_kconv</span><span class="p">(</span><span class="n">nfit</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div>
<p>It imports the <code>VpqRobot</code> class from the module and initializes it with the list of VPQ files.
Then, a pandas dataframe with optimized data for each VPQ file is returned via the <code>get_final_results_df</code> method.
One can use this dataframe to perform further data analysis and create custom publication-ready figures.
We then use a <code>plot_kconv</code> method that peforms the fitting of Eq. (\ref{eq:makovpayne})
parameters to the data in the robot, and plots the following figure:</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For formal arguments of the methods and their meaning, user can invoke the Python <code>help()</code> funtion.
E.g. calling <code>help(VpqRobot.plot_kconv)</code> gives the method&rsquo;s docstring:</p>
<div class="highlight"><pre><span></span><code>...
Plot<span class="w"> </span>the<span class="w"> </span>convergence<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>results<span class="w"> </span>with<span class="w"> </span>respect<span class="w"> </span>to<span class="w"> </span>k-point<span class="w"> </span>sampling.

Args:
<span class="w">    </span>nfit<span class="w"> </span><span class="o">(</span>int,<span class="w"> </span>optional<span class="o">)</span>:<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>points<span class="w"> </span>used<span class="w"> </span><span class="k">in</span><span class="w"> </span>linear<span class="w"> </span>extrapolation.<span class="w"> </span>Defaults<span class="w"> </span>to<span class="w"> </span><span class="m">3</span>.
...
</code></pre></div>
</div>
<p><img alt="" src="../eph4vpq_assets/LiF_hole_extr0.png" /></p>
<p>The extrapolated values <span class="arithmatex">\(E_\mathrm{pol}\)</span> = -2.03 eV and <span class="arithmatex">\(\varepsilon_\mathrm{loc}\)</span> = 4.99 eV differ from a fully converged values of <span class="arithmatex">\(E_\mathrm{pol}\)</span> = -1.94 eV and <span class="arithmatex">\(\varepsilon_\mathrm{loc}\)</span> = 4.68 eV.
This is mainly due to the low <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> and sampling of <span class="arithmatex">\(\kk/\qq\)</span>-meshes used to produce the input parameters for the solver.
Also, one has to impose lower <a class="wikilink codevar-wikilink" href="/variables/eph#vpq_tolgrs">vpq_tolgrs</a> convergence threshold and use denser meshes for extrapolation.</p>
<p>Now, let&rsquo;s try to perform the same calculations as in <code>teph4vpq_4.abi</code> but without the long-range corrections for the matrix elements at <span class="arithmatex">\(\Gamma\)</span>.
The input is the same, but with the <a class="wikilink codevar-wikilink" href="/variables/eph#vpq_avg_g">vpq_avg_g</a> tag set to 0:</p>
<div class="text-center"><button id="uuid-0c4c8a0f-2d0f-4ce2-b245-1f483c5fd05d" class="md-button md-button--secondary"> View tests/tutorespfn/Input/teph4vpq_5.abi </button></div>
<div id="uuid-b2d8220d-8b07-4d95-a5d4-dfe019769626" class="my_dialog" title="tests/tutorespfn/Input/teph4vpq_5.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># LiF: computation of a small hole polaron on 3x3x3, 4x4x4, 5x5x5 k/q-grids</span>
<span class="c1"># without long-range Frohlich correction.</span>

<span class="c1"># NOTE that dataset mode is used only for the tutorial</span>
<span class="c1"># In production, it is advisable to compute polaron on each grid in a separate run</span>

<span class="w"> </span>ndtset<span class="w"> </span><span class="m">3</span>

<span class="w"> </span>optdriver<span class="w">  </span><span class="m">7</span><span class="w">   </span><span class="c1"># Electron-phonon driver</span>
<span class="w"> </span>eph_task<span class="w">   </span><span class="m">13</span><span class="w">  </span><span class="c1"># Activate the Variational Polaron Equations solver</span>

<span class="c1"># Variational Polaron Equations parameters</span>
<span class="w"> </span>vpq_pkind<span class="w">  </span><span class="s2">&quot;hole&quot;</span><span class="w">  </span><span class="c1"># Hole polaron</span>
<span class="w"> </span>vpq_tolgrs<span class="w">  </span>1e-5<span class="w">   </span><span class="c1"># Tolerance on the gradient norm</span>

<span class="w"> </span><span class="c1"># these parameters are default but given here explicitly for clarity</span>
<span class="w"> </span>vpq_aseed<span class="w">      </span><span class="s2">&quot;gau_energy&quot;</span><span class="w">  </span><span class="c1"># Initial charge localization is Guassian-like</span>
<span class="w"> </span>vpq_gpr_energy<span class="w">  </span><span class="m">0</span>.<span class="w"> </span><span class="m">1</span>.<span class="w">        </span><span class="c1"># Gaussian parameters for initial charge</span>
<span class="w"> </span>vpq_nstates<span class="w">     </span><span class="m">1</span><span class="w">            </span><span class="c1"># Number of polaronic states</span>
<span class="w"> </span>vpq_nstep<span class="w">       </span><span class="m">50</span><span class="w">           </span><span class="c1"># Maximum number of optimization steps</span>

<span class="c1"># Frohlich correction</span>
<span class="w"> </span>eph_frohl_ntheta<span class="w">  </span><span class="m">32</span><span class="w">   </span><span class="c1"># Number of divisions for the spherical integration of</span>
<span class="w">                        </span><span class="c1"># the long-range part of electron-phonon energy.</span>
<span class="w">                        </span><span class="c1"># Non-zero value activates the computation of Frohlich</span>
<span class="w">                        </span><span class="c1"># corrections.</span>
<span class="w">                        </span><span class="c1"># ntheta=32 gives the optimal number of divisions for the</span>
<span class="w">                        </span><span class="c1"># spherical integration.</span>

<span class="w"> </span>vpq_avg_g<span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="c1"># DO NOT apply Frohlich correction to e-ph coupling (default)</span>


<span class="c1"># Electron-phonon matrix elements</span>
<span class="w"> </span>getgstore_filepath1<span class="w"> </span><span class="s2">&quot;teph4vpq_3o_DS1_GSTORE.nc&quot;</span><span class="w"> </span><span class="c1"># 3x3x3 k/q-mesh</span>
<span class="w"> </span>getgstore_filepath2<span class="w"> </span><span class="s2">&quot;teph4vpq_3o_DS2_GSTORE.nc&quot;</span><span class="w"> </span><span class="c1"># 4x4x4 k/q-mesh</span>
<span class="w"> </span>getgstore_filepath3<span class="w"> </span><span class="s2">&quot;teph4vpq_3o_DS3_GSTORE.nc&quot;</span><span class="w"> </span><span class="c1"># 5x5x5 k/q-mesh</span>

<span class="c1"># Wavefunction</span>
<span class="c1"># Read the WFK file from the preparatory run</span>
<span class="w"> </span>getwfk_filepath1<span class="w"> </span><span class="s2">&quot;teph4vpq_2o_DS1_WFK&quot;</span><span class="w">  </span><span class="c1"># 3x3x3 k-mesh</span>
<span class="w"> </span>getwfk_filepath2<span class="w"> </span><span class="s2">&quot;teph4vpq_2o_DS2_WFK&quot;</span><span class="w">  </span><span class="c1"># 4x4x4 k-mesh</span>
<span class="w"> </span>getwfk_filepath3<span class="w"> </span><span class="s2">&quot;teph4vpq_2o_DS3_WFK&quot;</span><span class="w">  </span><span class="c1"># 5x5x5 k-mesh</span>

<span class="w"> </span>ngkpt1<span class="w">   </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w">  </span><span class="c1"># These parameters have to consistent with the WFK file</span>
<span class="w"> </span>ngkpt2<span class="w">   </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">4</span>
<span class="w"> </span>ngkpt3<span class="w">   </span><span class="m">5</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">5</span>

<span class="w"> </span>kptopt<span class="w">   </span><span class="m">1</span>
<span class="w"> </span>nshiftk<span class="w">  </span><span class="m">1</span>
<span class="w"> </span>shiftk<span class="w">   </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
<span class="w"> </span>nband<span class="w">    </span><span class="m">6</span>
<span class="w"> </span>ecut<span class="w">     </span><span class="m">30</span>

<span class="c1"># Phonons</span>
<span class="w"> </span>ddb_ngqpt<span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w">          </span><span class="c1"># This has to be consistent with the DDB file</span>
<span class="w"> </span>getddb_filepath
<span class="w"> </span><span class="s2">&quot;LiF_eph_varpeq/out_DDB&quot;</span><span class="w">  </span><span class="c1"># Read the precomputed DDB stored in git submodule</span>
<span class="w">                           </span><span class="c1"># NOTE: for the input parameters used to produce</span>
<span class="w">                           </span><span class="c1"># the DDB file, consult the LiF_eph_varpeq/dfpt.abi</span>

<span class="c1"># Pseudopotentials</span>
<span class="w"> </span>pp_dirpath<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">/Psdj_nc_sr_05_pbe_std_psp8&quot;</span>
<span class="w"> </span>pseudos<span class="w"> </span><span class="s2">&quot;Li.psp8, F.psp8&quot;</span>

<span class="c1"># Structure</span>
<span class="w"> </span>natom<span class="w">   </span><span class="m">2</span>
<span class="w"> </span>ntypat<span class="w">  </span><span class="m">2</span>
<span class="w"> </span>typat<span class="w">   </span><span class="m">1</span><span class="w"> </span><span class="m">2</span>
<span class="w"> </span>znucl<span class="w">   </span><span class="m">3</span><span class="w"> </span><span class="m">9</span>
<span class="w"> </span>xred<span class="w">    </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.0
<span class="w">         </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5

<span class="w"> </span>acell<span class="w"> </span><span class="m">3</span>*7.675
<span class="w"> </span>rprim<span class="w"> </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5
<span class="w">       </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.5
<span class="w">       </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% exclude_builders = eos_nvhpc_*</span>
<span class="c1">#%% test_chain = teph4vpq_1.abi, teph4vpq_2.abi, teph4vpq_3.abi,</span>
<span class="c1">#%%              teph4vpq_4.abi, teph4vpq_5.abi, teph4vpq_6.abi,</span>
<span class="c1">#%%              teph4vpq_7.abi, teph4vpq_8.abi, teph4vpq_9.abi,</span>
<span class="c1">#%%              teph4vpq_10.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% use_git_submodule = LiF_eph_varpeq</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   teph4vpq_5.abo, tolnlines = 110, tolabs = 1e-4, tolrel = 5e-2</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 10</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = V. Vasilchenko</span>
<span class="c1">#%% keywords = DFPT, EPH, POLARON</span>
<span class="c1">#%% description =</span>
<span class="c1">#%%   LiF, Fm-3m space group.</span>
<span class="c1">#%%   Computation of a small hole polaron on 3x3x3, 4x4x4, 5x5x5 k/q-grids</span>
<span class="c1">#%%   via Variational Polaron Equations without long-range Frohlich correction.</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-b2d8220d-8b07-4d95-a5d4-dfe019769626", "#uuid-0c4c8a0f-2d0f-4ce2-b245-1f483c5fd05d") }); </script>

<p>As usual, run this example with:</p>
<div class="highlight"><pre><span></span><code>abinit<span class="w"> </span>teph4vpq_5.abi<span class="w"> </span>&gt;<span class="w"> </span>teph4vpq_5.log<span class="w"> </span><span class="m">2</span>&gt;<span class="w"> </span>err<span class="w"> </span><span class="p">&amp;</span>
</code></pre></div>
<p>Upon completion, we can modify our Python script to include the new VPQ files in our robot.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">abipy.eph.vpq</span><span class="w"> </span><span class="kn">import</span> <span class="n">VpqRobot</span>

<span class="n">vpq_files</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># calculations with LR correction</span>
    <span class="s2">&quot;teph4vpq_4o_DS1_VPQ.nc&quot;</span><span class="p">,</span>
    <span class="s2">&quot;teph4vpq_4o_DS2_VPQ.nc&quot;</span><span class="p">,</span>
    <span class="s2">&quot;teph4vpq_4o_DS3_VPQ.nc&quot;</span><span class="p">,</span>
    <span class="c1"># calculations without LR correction</span>
    <span class="s2">&quot;teph4vpq_5o_DS1_VPQ.nc&quot;</span><span class="p">,</span>
    <span class="s2">&quot;teph4vpq_5o_DS2_VPQ.nc&quot;</span><span class="p">,</span>
    <span class="s2">&quot;teph4vpq_5o_DS3_VPQ.nc&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">robot</span> <span class="o">=</span> <span class="n">VpqRobot</span><span class="o">.</span><span class="n">from_files</span><span class="p">(</span><span class="n">vpq_files</span><span class="p">)</span>

<span class="n">robot</span><span class="o">.</span><span class="n">plot_kconv</span><span class="p">(</span><span class="n">nfit</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div>
<p>The robot is smart enough (but stupid nonetheless, so <strong>trust your own judgemenet</strong>) to detect 2 different kind
of calculations and peform separate extrapolation for each case.
It produces the following figure:</p>
<p><img alt="" src="../eph4vpq_assets/LiF_hole_extr1.png" /></p>
<p>In principle, extrapolated values for <span class="arithmatex">\(E_\mathrm{pol}\)</span> and <span class="arithmatex">\(\varepsilon_\mathrm{loc}\)</span> have to agree whether or not the LR correction is employed.
The discrepancy here is mainly due to the relatively high value of <a class="wikilink codevar-wikilink" href="/variables/eph#vpq_tolgrs">vpq_tolgrs</a>
and the coarse <span class="arithmatex">\(\kk/\qq\)</span>-meshes used for extrapolation.</p>
<details class="note">
<summary>Exercise</summary>
<p>Try changing the nfit argument in <code>plot_kconv</code> to 2 (i.e. throw away the 3x3x3 point)
from the extrapolation data and see if the extrapolated values agree better.</p>
</details>
<p>Note, however, how adding the LR correction brings the values of <span class="arithmatex">\(E_\mathrm{pol}\)</span> at fixed <span class="arithmatex">\(\kk/\qq\)</span>-meshes closer to the infinite-size value.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For delocalized polarons, i.e. there is no binding, adding LR correction will anyway give the negative value of <span class="arithmatex">\(E_\mathrm{pol}\)</span>,
solely due to the long-range correction that vanishes in the limit of <span class="arithmatex">\(N_p \to \infty\)</span>.
Without the LR correction, <span class="arithmatex">\(E_\mathrm{pol}\)</span> is zero for a delocalized particle.
As a result, one alway needs to check the extrapolation to the infinite-size limit and reach <span class="arithmatex">\(\kk/\qq\)</span>-meshes (supercells) large
enough to host a polaron.</p>
</div>
<h2 id="small-hole-polaron-multiple-states-and-visualiziation">Small hole polaron: multiple states and visualiziation<a class="headerlink" href="#small-hole-polaron-multiple-states-and-visualiziation" title="Permanent link">&para;</a></h2>
<p>For now, we have probed our system for a single polaronic state.
However, our method supports the search for multiple polaronic states:
once solutions with charge localization <span class="arithmatex">\(\boldsymbol{A}^i, i &lt; n\)</span> are found, we find the next one <span class="arithmatex">\(\boldsymbol{A}^{n}\)</span> by imposing
an orthogonality constraint wrt <span class="arithmatex">\(\boldsymbol{A}^i, i &lt; n\)</span>.</p>
<p>This is similar to the approach used to compute multiple electornic bands <a class="wikilink citation-wikilink" data-tippy-content="Iterative minimization techniques for ab initio total-energy calculations: Molecular dynamics and conjugate gradients" data-toggle="popover" href="/theory/bibliography#payne1992">[Payne1992]</a>.
In polaron problem, however, this procedure does not give an optimized solution for <span class="arithmatex">\(\boldsymbol{A}^n\)</span>,
as polaronic states are not necessarily orthogonal to each other.
Rather, it brings the next solution far away from all the previous ones.
After this is achieved, i.e. the solver is stuck at a constrained-induced stationary point,
the constraint can be removed, and a new solution is found.</p>
<p>Here we will utilize this approach to demonstrate that there exist multiple variational solutions for hole polaron in LiF.</p>
<p>Our input file is</p>
<div class="text-center"><button id="uuid-c4b477de-e472-4e89-956a-a7e65de4dd48" class="md-button md-button--secondary"> View tests/tutorespfn/Input/teph4vpq_6.abi </button></div>
<div id="uuid-0309a07c-fc0f-4118-b078-1205724a739b" class="my_dialog" title="tests/tutorespfn/Input/teph4vpq_6.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># LiF: computation of a small hole polaron on 3x3x3 k/q-grid with long-range</span>
<span class="c1"># Frohlich correction. Multiple polaronic states.</span>

<span class="w"> </span>optdriver<span class="w">  </span><span class="m">7</span><span class="w">   </span><span class="c1"># Electron-phonon driver</span>
<span class="w"> </span>eph_task<span class="w">   </span><span class="m">13</span><span class="w">  </span><span class="c1"># Activate the Variational Polaron Equations solver</span>

<span class="c1"># Variational Polaron Equations parameters</span>
<span class="w"> </span>vpq_pkind<span class="w">  </span><span class="s2">&quot;hole&quot;</span><span class="w">  </span><span class="c1"># Hole polaron</span>
<span class="w"> </span>vpq_tolgrs<span class="w">  </span>1e-5<span class="w">   </span><span class="c1"># Tolerance on the gradient norm</span>

<span class="w"> </span><span class="c1"># Optimization for multiple polaronic states</span>

<span class="w"> </span><span class="c1"># For state &gt; 1, the optimization is performed with orthogonalization constraint</span>
<span class="w"> </span><span class="c1"># wrt all previous polaronic states.</span>
<span class="w"> </span><span class="c1"># NOTE that after vpq_nstep_ort the constraint is lifted, as the final polaron</span>
<span class="w"> </span><span class="c1"># is not necessarily orthogonal to the previous ones.</span>
<span class="w"> </span><span class="c1"># The orthogonalization process helps brining the next solution far away from</span>
<span class="w"> </span><span class="c1"># all the previous one before its optimization.</span>

<span class="w"> </span>vpq_nstates<span class="w">     </span><span class="m">3</span><span class="w">     </span><span class="c1"># 3 states</span>
<span class="w"> </span>vpq_nstep<span class="w">       </span><span class="m">100</span><span class="w">   </span><span class="c1"># Maximum number of optimization steps</span>
<span class="w"> </span>vpq_nstep_ort<span class="w">   </span><span class="m">30</span><span class="w">    </span><span class="c1"># Maximum number of steps for which the orthogonalization</span>
<span class="w">                       </span><span class="c1"># constraint is applied</span>
<span class="w"> </span>vpq_translate<span class="w">   </span><span class="m">1</span><span class="w">     </span><span class="c1"># Take into account the translational invariance</span>

<span class="w"> </span><span class="c1"># these parameters are default but given here explicitly for clarity</span>
<span class="w"> </span>vpq_aseed<span class="w">      </span><span class="s2">&quot;gau_energy&quot;</span><span class="w">  </span><span class="c1"># Initial charge localization is Guassian-like</span>
<span class="w"> </span>vpq_gpr_energy<span class="w">  </span><span class="m">0</span>.<span class="w"> </span><span class="m">1</span>.<span class="w">        </span><span class="c1"># Gaussian parameters for initial charge</span>

<span class="c1"># Frohlich correction</span>
<span class="w"> </span>eph_frohl_ntheta<span class="w">  </span><span class="m">32</span><span class="w">   </span><span class="c1"># Number of divisions for the spherical integration of</span>
<span class="w">                        </span><span class="c1"># the long-range part of electron-phonon energy.</span>
<span class="w">                        </span><span class="c1"># Non-zero value activates the computation of Frohlich</span>
<span class="w">                        </span><span class="c1"># corrections.</span>
<span class="w">                        </span><span class="c1"># ntheta=32 gives the optimal number of divisions for the</span>
<span class="w">                        </span><span class="c1"># spherical integration.</span>

<span class="w"> </span>vpq_avg_g<span class="w">  </span><span class="m">1</span><span class="w">  </span><span class="c1"># Apply Frohlich correction to e-ph coupling</span>


<span class="c1"># Electron-phonon matrix elements</span>
<span class="w"> </span>getgstore_filepath<span class="w"> </span><span class="s2">&quot;teph4vpq_3o_DS1_GSTORE.nc&quot;</span><span class="w"> </span><span class="c1"># 3x3x3 k/q-mesh</span>

<span class="c1"># Wavefunction</span>
<span class="c1"># Read the WFK file from the preparatory run</span>
<span class="w"> </span>getwfk_filepath<span class="w"> </span><span class="s2">&quot;teph4vpq_2o_DS1_WFK&quot;</span><span class="w">  </span><span class="c1"># 3x3x3 k-mesh</span>

<span class="w"> </span>ngkpt<span class="w">    </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w">  </span><span class="c1"># These parameters have to be consistent with the WFK file</span>

<span class="w"> </span>kptopt<span class="w">   </span><span class="m">1</span>
<span class="w"> </span>nshiftk<span class="w">  </span><span class="m">1</span>
<span class="w"> </span>shiftk<span class="w">   </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
<span class="w"> </span>nband<span class="w">    </span><span class="m">6</span>
<span class="w"> </span>ecut<span class="w">     </span><span class="m">30</span>

<span class="c1"># Phonons</span>
<span class="w"> </span>ddb_ngqpt<span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w">          </span><span class="c1"># This has to be consistent with the DDB file</span>
<span class="w"> </span>getddb_filepath
<span class="w"> </span><span class="s2">&quot;LiF_eph_varpeq/out_DDB&quot;</span><span class="w">  </span><span class="c1"># Read the precomputed DDB stored in git submodule</span>
<span class="w">                           </span><span class="c1"># NOTE: for the input parameters used to produce</span>
<span class="w">                           </span><span class="c1"># the DDB file, consult the LiF_eph_varpeq/dfpt.abi</span>

<span class="c1"># Pseudopotentials</span>
<span class="w"> </span>pp_dirpath<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">/Psdj_nc_sr_05_pbe_std_psp8&quot;</span>
<span class="w"> </span>pseudos<span class="w"> </span><span class="s2">&quot;Li.psp8, F.psp8&quot;</span>

<span class="c1"># Structure</span>
<span class="w"> </span>natom<span class="w">   </span><span class="m">2</span>
<span class="w"> </span>ntypat<span class="w">  </span><span class="m">2</span>
<span class="w"> </span>typat<span class="w">   </span><span class="m">1</span><span class="w"> </span><span class="m">2</span>
<span class="w"> </span>znucl<span class="w">   </span><span class="m">3</span><span class="w"> </span><span class="m">9</span>
<span class="w"> </span>xred<span class="w">    </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.0
<span class="w">         </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5

<span class="w"> </span>acell<span class="w"> </span><span class="m">3</span>*7.675
<span class="w"> </span>rprim<span class="w"> </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5
<span class="w">       </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.5
<span class="w">       </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% exclude_builders = eos_nvhpc_*</span>
<span class="c1">#%% test_chain = teph4vpq_1.abi, teph4vpq_2.abi, teph4vpq_3.abi,</span>
<span class="c1">#%%              teph4vpq_4.abi, teph4vpq_5.abi, teph4vpq_6.abi,</span>
<span class="c1">#%%              teph4vpq_7.abi, teph4vpq_8.abi, teph4vpq_9.abi,</span>
<span class="c1">#%%              teph4vpq_10.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% use_git_submodule = LiF_eph_varpeq</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   teph4vpq_6.abo, tolnlines = 150, tolabs = 2.0e-4, tolrel = 2e-1</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 10</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = V. Vasilchenko</span>
<span class="c1">#%% keywords = DFPT, EPH, POLARON</span>
<span class="c1">#%% description =</span>
<span class="c1">#%%   LiF, Fm-3m space group.</span>
<span class="c1">#%%   Computation of a small hole polaron on 3x3x3 k/q-grid</span>
<span class="c1">#%%   via Variational Polaron Equations with long-range Frohlich correction.</span>
<span class="c1">#%%   Multiple polaronic states.</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-0309a07c-fc0f-4118-b078-1205724a739b", "#uuid-c4b477de-e472-4e89-956a-a7e65de4dd48") }); </script>

<p>As usual, run this example with:</p>
<div class="highlight"><pre><span></span><code>abinit<span class="w"> </span>teph4vpq_6.abi<span class="w"> </span>&gt;<span class="w"> </span>teph4vpq_6.log<span class="w"> </span><span class="m">2</span>&gt;<span class="w"> </span>err<span class="w"> </span><span class="p">&amp;</span>
</code></pre></div>
<p>Note that <a class="wikilink codevar-wikilink" href="/variables/eph#vpq_nstates">vpq_nstates</a> variable is now 3.
Also, two new <code>vpq_</code> variables are introduced, <a class="wikilink codevar-wikilink" href="/variables/eph#vpq_nstep_ort">vpq_nstep_ort</a> and <a class="wikilink codevar-wikilink" href="/variables/eph#vpq_translate">vpq_translate</a>.
The former defines how many orthogonalization steps are to be performed.
After <a class="wikilink codevar-wikilink" href="/variables/eph#vpq_nstep_ort">vpq_nstep_ort</a> steps, the orthogonality constraint is lifted, and the algorithm relaxes to a solution
from a starting point for <span class="arithmatex">\(\boldsymbol{A}\)</span> that is far away from the previous ones.
The <a class="wikilink codevar-wikilink" href="/variables/eph#vpq_translate">vpq_translate</a> tag turns on the translation of polaronic solutions, i.e. we peform <span class="arithmatex">\(n\)</span>-th orthogonalization
wrt computed <span class="arithmatex">\(\boldsymbol{A}^i, i &lt; n\)</span> and their translated images within the supercell.
This is rather important point, as polarons can localize at any equivalent atomic site within a supercell,
and we have to eliminate these trivial solutions.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>At large <span class="arithmatex">\(\kk/\qq\)</span> meshes the translation of polaronic solutions can be <strong>computationally prohibitive</strong>
due to the large supercell size.</p>
</div>
<p>Now let&rsquo;s examine the main output file</p>
<div class="text-center"><button id="uuid-c921d7e3-6e1b-4f26-89ff-03e3007b5fa8" class="md-button md-button--secondary"> View tests/tutorespfn/Refs/teph4vpq_6.abo </button></div>
<div id="uuid-b719da74-7cf5-4e64-b3f2-d74ccd9ac80d" class="my_dialog" title="tests/tutorespfn/Refs/teph4vpq_6.abo" hidden><div><pre class="small-text">

.Version 10.3.4.7 of ABINIT, released Dec 2025.
.(MPI version, prepared for a x86_64_linux_gnu13.2 computer) 

.Copyright (C) 1998-2025 ABINIT group . 
 ABINIT comes with ABSOLUTELY NO WARRANTY.
 It is free software, and you are welcome to redistribute it
 under certain conditions (GNU General Public License,
 see ~abinit/COPYING or http://www.gnu.org/copyleft/gpl.txt).

 ABINIT is a project of the Universite Catholique de Louvain,
 Corning Inc. and other collaborators, see ~abinit/doc/developers/contributors.txt .
 Please read https://docs.abinit.org/theory/acknowledgments for suggested
 acknowledgments of the ABINIT effort.
 For more information, see https://www.abinit.org .

.Starting date : Sun 23 Feb 2025.
- ( at 16h09 )

- input  file    -&gt; /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/vvasilchenko_varpeq_nosym/tests/TestBot_MPI1/tutorespfn_teph4vpq_1-teph4vpq_2-teph4vpq_3-teph4vpq_4-teph4vpq_5-teph4vpq_6-teph4vpq_7-teph4vpq_8-teph4vpq_9-teph4vpq_10/teph4vpq_6.abi
- output file    -&gt; teph4vpq_6.abo
- root for input  files -&gt; teph4vpq_6i
- root for output files -&gt; teph4vpq_6o

 Symmetries : space group Fm -3 m (#225); Bravais cF (face-center cubic)
================================================================================
 Values of the parameters that define the memory need of the present run
     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       5
     lnmax =       5     mgfft =      30  mpssoang =       3    mqgrid =    3001
     natom =       2  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      48    n1xccc =    2501    ntypat =       2
    occopt =       1   xclevel =       2
-    mband =           6        mffmem =           1         mkmem =           4
       mpw =         896          nfft =       27000          nkpt =           4
================================================================================
P This job should need less than                      10.118 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      0.330 Mbytes ; DEN or POT disk file :      0.208 Mbytes.
================================================================================

--------------------------------------------------------------------------------
------------- Echo of variables that govern the present computation ------------
--------------------------------------------------------------------------------
-
- outvars: echo of selected default values
-   iomode0 =  0 , fftalg0 =512 , wfoptalg0 =  0
-
- outvars: echo of global parameters not present in the input file
-  max_nthreads =    0
-
 -outvars: echo values of preprocessed input variables --------
            acell      7.6750000000E+00  7.6750000000E+00  7.6750000000E+00 Bohr
              amu      6.94100000E+00  1.89984032E+01
        ddb_ngqpt        3    3    3
             ecut      3.00000000E+01 Hartree
 eph_frohl_ntheta          32
         eph_task          13
-          fftalg         512
           istwfk        2    0    0    0
              ixc          11
              kpt      0.00000000E+00  0.00000000E+00  0.00000000E+00
                       3.33333333E-01  0.00000000E+00  0.00000000E+00
                       3.33333333E-01  3.33333333E-01  0.00000000E+00
                      -3.33333333E-01  3.33333333E-01  0.00000000E+00
         kptrlatt        3    0    0      0    3    0      0    0    3
          kptrlen      1.62811336E+01
P           mkmem           4
            natom           2
            nband           6
            ngfft          30      30      30
             nkpt           4
             nsym          48
           ntypat           2
              occ      2.000000  2.000000  2.000000  2.000000  2.000000  0.000000
        optdriver           7
            rprim      0.0000000000E+00  5.0000000000E-01  5.0000000000E-01
                       5.0000000000E-01  0.0000000000E+00  5.0000000000E-01
                       5.0000000000E-01  5.0000000000E-01  0.0000000000E+00
          spgroup         225
           symrel      1  0  0   0  1  0   0  0  1      -1  0  0   0 -1  0   0  0 -1
                       0 -1  1   0 -1  0   1 -1  0       0  1 -1   0  1  0  -1  1  0
                      -1  0  0  -1  0  1  -1  1  0       1  0  0   1  0 -1   1 -1  0
                       0  1 -1   1  0 -1   0  0 -1       0 -1  1  -1  0  1   0  0  1
                      -1  0  0  -1  1  0  -1  0  1       1  0  0   1 -1  0   1  0 -1
                       0 -1  1   1 -1  0   0 -1  0       0  1 -1  -1  1  0   0  1  0
                       1  0  0   0  0  1   0  1  0      -1  0  0   0  0 -1   0 -1  0
                       0  1 -1   0  0 -1   1  0 -1       0 -1  1   0  0  1  -1  0  1
                      -1  0  1  -1  1  0  -1  0  0       1  0 -1   1 -1  0   1  0  0
                       0 -1  0   1 -1  0   0 -1  1       0  1  0  -1  1  0   0  1 -1
                       1  0 -1   0  0 -1   0  1 -1      -1  0  1   0  0  1   0 -1  1
                       0  1  0   0  0  1   1  0  0       0 -1  0   0  0 -1  -1  0  0
                       1  0 -1   0  1 -1   0  0 -1      -1  0  1   0 -1  1   0  0  1
                       0 -1  0   0 -1  1   1 -1  0       0  1  0   0  1 -1  -1  1  0
                      -1  0  1  -1  0  0  -1  1  0       1  0 -1   1  0  0   1 -1  0
                       0  1  0   1  0  0   0  0  1       0 -1  0  -1  0  0   0  0 -1
                       0  0 -1   0  1 -1   1  0 -1       0  0  1   0 -1  1  -1  0  1
                       1 -1  0   0 -1  1   0 -1  0      -1  1  0   0  1 -1   0  1  0
                       0  0  1   1  0  0   0  1  0       0  0 -1  -1  0  0   0 -1  0
                      -1  1  0  -1  0  0  -1  0  1       1 -1  0   1  0  0   1  0 -1
                       0  0  1   0  1  0   1  0  0       0  0 -1   0 -1  0  -1  0  0
                       1 -1  0   0 -1  0   0 -1  1      -1  1  0   0  1  0   0  1 -1
                       0  0 -1   1  0 -1   0  1 -1       0  0  1  -1  0  1   0 -1  1
                      -1  1  0  -1  0  1  -1  0  0       1 -1  0   1  0 -1   1  0  0
            typat      1  2
        vpq_avg_g           1
    vpq_translate           1
      vpq_nstates           3
        vpq_nstep         100
    vpq_nstep_ort          30
       vpq_tolgrs      1.0000000000E-05
              wtk        0.03704    0.29630    0.22222    0.44444
           xangst      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.0307175380E+00  2.0307175380E+00  2.0307175380E+00
            xcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       3.8375000000E+00  3.8375000000E+00  3.8375000000E+00
             xred      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       5.0000000000E-01  5.0000000000E-01  5.0000000000E-01
            znucl        3.00000    9.00000

================================================================================

 chkinp: Checking input parameters for consistency.

================================================================================
== DATASET  1 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 1, }
dimensions: {natom: 2, nkpt: 4, mband: 6, nsppol: 1, nspinor: 1, nspden: 1, mpw: 896, }
cutoff_energies: {ecut:  30.0, pawecutdg:  -1.0, }
electrons: {nelect:   1.00000000E+01, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 7, eph_task: 13, }
...

 mkfilename: getwfk from: teph4vpq_2o_DS1_WFK

 mkfilename: getddb from: LiF_eph_varpeq/out_DDB

 mkfilename: getgstore from: teph4vpq_3o_DS1_GSTORE.nc

 Exchange-correlation functional for the present dataset will be:
  GGA: Perdew-Burke-Ernzerhof functional - ixc=11
 Citation for XC functional:
  J.P.Perdew, K.Burke, M.Ernzerhof, PRL 77, 3865 (1996)

- Reading GS states from WFK file: teph4vpq_2o_DS1_WFK
- Reading DDB from file: LiF_eph_varpeq/out_DDB




  ==== Info on the Cryst% object ====
 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  0.0000000  3.8375000  3.8375000  G(1)= -0.1302932  0.1302932  0.1302932
 R(2)=  3.8375000  0.0000000  3.8375000  G(2)=  0.1302932 -0.1302932  0.1302932
 R(3)=  3.8375000  3.8375000  0.0000000  G(3)=  0.1302932  0.1302932 -0.1302932
 Unit cell volume ucvol=  1.1302517E+02 bohr^3
 Angles (23,13,12)=  6.00000000E+01  6.00000000E+01  6.00000000E+01 degrees
 Time-reversal symmetry is present
 Reduced atomic positions [iatom, xred, symbol]:
    1)    0.0000000  0.0000000  0.0000000  Li
    2)    0.5000000  0.5000000  0.5000000   F

 DDB file with 4 blocks has been read.

================================================================================

 Dielectric Tensor and Effective Charges 


 anaddb : Zero the imaginary part of the Dynamical Matrix at Gamma,
   and impose the ASR on the effective charges 

 The violation of the charge neutrality conditions
 by the effective charges is as follows :
    atom        electric field
 displacement     direction
       1               1       -0.065315        0.000000
       1               2        0.000000        0.000000
       1               3        0.000000        0.000000
       2               1        0.000000        0.000000
       2               2       -0.065315        0.000000
       2               3       -0.000000        0.000000
       3               1       -0.000000        0.000000
       3               2       -0.000000        0.000000
       3               3       -0.065315        0.000000

 Effective charge tensors after 
 imposition of the charge neutrality (if requested by user),
 and eventual restriction to some part :
   atom    displacement
         1         1    1.092224E+00   -9.389407E-16   -9.386159E-16
         1         2   -5.076227E-17    1.092224E+00    9.392655E-16
         1         3    5.076227E-17    9.389407E-16    1.092224E+00
         2         1   -1.092224E+00    9.389407E-16    9.386159E-16
         2         2    5.076227E-17   -1.092224E+00   -9.392655E-16
         2         3   -5.076227E-17   -9.389407E-16   -1.092224E+00
 Now, the imaginary part of the dynamical matrix is zeroed
- Found dielectric tensor and Born effective charges in DDB file: LiF_eph_varpeq/out_DDB
- Cannot find quadrupole tensor in DDB file: LiF_eph_varpeq/out_DDB
 Values initialized with zeros.
       Homogeneous q point set in the B.Z.
 Grid q points  :       27
  1)   0.00000000E+00  0.00000000E+00  0.00000000E+00
  2)   3.33333333E-01  0.00000000E+00  0.00000000E+00
  3)  -3.33333333E-01  0.00000000E+00  0.00000000E+00
  4)   0.00000000E+00  3.33333333E-01  0.00000000E+00
  5)   3.33333333E-01  3.33333333E-01  0.00000000E+00
  6)  -3.33333333E-01  3.33333333E-01  0.00000000E+00
  7)   0.00000000E+00 -3.33333333E-01  0.00000000E+00
  8)   3.33333333E-01 -3.33333333E-01  0.00000000E+00
  9)  -3.33333333E-01 -3.33333333E-01  0.00000000E+00
 10)   0.00000000E+00  0.00000000E+00  3.33333333E-01
 11)   3.33333333E-01  0.00000000E+00  3.33333333E-01
 12)  -3.33333333E-01  0.00000000E+00  3.33333333E-01
 13)   0.00000000E+00  3.33333333E-01  3.33333333E-01
 14)   3.33333333E-01  3.33333333E-01  3.33333333E-01
 15)  -3.33333333E-01  3.33333333E-01  3.33333333E-01
 16)   0.00000000E+00 -3.33333333E-01  3.33333333E-01
 17)   3.33333333E-01 -3.33333333E-01  3.33333333E-01
 18)  -3.33333333E-01 -3.33333333E-01  3.33333333E-01
 19)   0.00000000E+00  0.00000000E+00 -3.33333333E-01
 20)   3.33333333E-01  0.00000000E+00 -3.33333333E-01
 21)  -3.33333333E-01  0.00000000E+00 -3.33333333E-01
 22)   0.00000000E+00  3.33333333E-01 -3.33333333E-01
 23)   3.33333333E-01  3.33333333E-01 -3.33333333E-01
 24)  -3.33333333E-01  3.33333333E-01 -3.33333333E-01
 25)   0.00000000E+00 -3.33333333E-01 -3.33333333E-01
 26)   3.33333333E-01 -3.33333333E-01 -3.33333333E-01
 27)  -3.33333333E-01 -3.33333333E-01 -3.33333333E-01

 The interatomic forces have been obtained
 Average speed of sound partial sums:     0.2234217387E-02 (at units)
-                                   =           4.8878 [km/s]

 Debye frequency from partial sums:     0.1801153402E-02 (Ha)
-                                 =     0.1185102008E+02 (THz)
-Debye temperature from partial sums:     0.5687585851E+03 (K)

 Average speed of sound partial sums:     0.2234217387E-02 (at units)
-                                   =           4.8878 [km/s]

 Debye frequency from partial sums:     0.1801153402E-02 (Ha)
-                                 =     0.1185102008E+02 (THz)
-Debye temperature from partial sums:     0.5687585851E+03 (K)

- Writing phonon DOS to netcdf file: teph4vpq_6o_PHDOS.nc

--- Pseudopotential description ------------------------------------------------
- pspini: atom type   1  psp file is /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/vvasilchenko_varpeq_nosym/tests/Pspdir/Psdj_nc_sr_05_pbe_std_psp8/Li.psp8
- pspatm: opening atomic psp file    /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/vvasilchenko_varpeq_nosym/tests/Pspdir/Psdj_nc_sr_05_pbe_std_psp8/Li.psp8
- Li    ONCVPSP-3.2.3.1  r_core=   1.40824   1.10935
-  3.00000   3.00000    170503                znucl, zion, pspdat
    8   11    1    4       400   0.00000      pspcod,pspxc,lmax,lloc,mmax,r2well
    3.99000000000000    0.00000000000000    0.00000000000000   rchrg,fchrg,qchrg
     nproj     2     2
     extension_switch     1
  pspatm : epsatm=    2.74345787
         --- l  ekb(1:nproj) --&gt;
             0   -4.951544   -1.544797
             1   -2.250662   -0.474685
 pspatm: atomic psp has been read  and splines computed

- pspini: atom type   2  psp file is /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/vvasilchenko_varpeq_nosym/tests/Pspdir/Psdj_nc_sr_05_pbe_std_psp8/F.psp8
- pspatm: opening atomic psp file    /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/vvasilchenko_varpeq_nosym/tests/Pspdir/Psdj_nc_sr_05_pbe_std_psp8/F.psp8
- F     ONCVPSP-3.2.3.1  r_core=   1.30942   1.45782   1.60379
-  9.00000   7.00000    170504                znucl, zion, pspdat
    8   11    2    4       600   0.00000      pspcod,pspxc,lmax,lloc,mmax,r2well
    5.99000000000000    2.50000000000000    0.00000000000000   rchrg,fchrg,qchrg
     nproj     2     2     1
     extension_switch     1
  pspatm : epsatm=    4.87626060
         --- l  ekb(1:nproj) --&gt;
             0    6.519403    1.070094
             1   -3.955629   -1.291931
             2   -2.441503
 pspatm: atomic psp has been read  and splines computed

   7.61971847E+01                                ecore*ucvol(ha*bohr**3)
--------------------------------------------------------------------------------

 Computing variational polaron equations from pre-existent GSTORE file: teph4vpq_3o_DS1_GSTORE.nc
 Initializing gstore object from: teph4vpq_3o_DS1_GSTORE.nc 

 === Gstore parameters ===
 kzone: bz
 kfilter: none
 nkibz: 4
 nkbz: 27
 glob_nk_spin: [27]
 qzone: bz
 nqibz: 4
 nqbz: 27
 glob_nq_spin: [27]
 kptopt: 1
 qptopt: 1
 with_vk: 1

 gqk_cplex: 2
 gqk_bstart: 3
 gqk_bstop: 5
 gqk_nb: 3
 gqk_my_npert: 6
 gqk_my_nk: -1
 gqk_my_nq: -1

  === MPI distribution ===
P Number of CPUs for parallelism over perturbations: 1
P Number of perturbations treated by this CPU: 6
P Number of CPUs for parallelism over q-points: 1
P Number of CPUs for parallelism over k-points: 1

  === Variational Polaron Equations ===

 Polaron:
   * Polaron kind: hole
   * BvK supercell: 3x3x3
   * Number of independent spin polarizations: 1
   * Number of polaronic states: 3
   * Filtering of electronic states: no

 Long-range corrections:
   * Frohlich correction: yes
   * Frohlich correction value: 9.265067E-01 eV
   * Frohlich correction included in matrix elements: yes

 Optimization parameters:
   * Initial seed: charge localization A_nk
   * Initial seed type: Gaussian, based on the electroic energies
   * Tolerance on the gradient norm: 1.00E-05
   * Maximum number of iterations per state: 100
 (for pstate &gt; 1)
   * Number of orthogonaliztion steps: 30
   * Translational invariance: yes

 Solving the variational polaron equations for each state...
   * spin 1/1, pstate 1/3...
   Done
   * spin 1/1, pstate 2/3...
   Done
   * spin 1/1, pstate 3/3...
   Done

 Printing the optimization logs
   --------------------------------------------------------------------------------------
   * spin 1/1, pstate 1/3
   * values in the optimization log are in (a.u.)
   --------------------------------------------------------------------------------------
   Step        E_pol         E_el         E_ph       E_elph      epsilon     ||grad||
      1  -3.0118E-03   4.1093E-02   4.4105E-02  -8.8210E-02   4.7117E-02   1.0900E-02
      2  -2.4528E-02   1.9417E-02   4.3945E-02  -8.7891E-02   6.8473E-02   2.2198E-03
      3  -3.9895E-02   3.0152E-03   4.2910E-02  -8.5819E-02   8.2804E-02   4.9899E-03
      4  -4.1219E-02   1.7941E-03   4.3013E-02  -8.6026E-02   8.4232E-02   3.2342E-03
      5  -4.3429E-02   5.7134E-04   4.4000E-02  -8.8000E-02   8.7429E-02   1.8175E-03
      6  -4.7596E-02   2.6635E-03   5.0259E-02  -1.0052E-01   9.7855E-02   4.6156E-03
      7  -5.2013E-02   5.3656E-03   5.7378E-02  -1.1476E-01   1.0939E-01   6.3385E-03
      8  -5.6357E-02   8.0023E-03   6.4359E-02  -1.2872E-01   1.2072E-01   6.1036E-03
      9  -6.1355E-02   1.0869E-02   7.2224E-02  -1.4445E-01   1.3358E-01   2.7019E-03
     10  -6.3183E-02   1.1570E-02   7.4753E-02  -1.4951E-01   1.3794E-01   4.1322E-03
     11  -6.9062E-02   1.5656E-02   8.4718E-02  -1.6944E-01   1.5378E-01   6.5822E-03
     12  -7.5398E-02   2.2493E-02   9.7891E-02  -1.9578E-01   1.7329E-01   3.7150E-03
     13  -7.6048E-02   2.4094E-02   1.0014E-01  -2.0028E-01   1.7619E-01   2.3120E-03
     14  -7.6484E-02   2.6017E-02   1.0250E-01  -2.0500E-01   1.7899E-01   3.8701E-04
     15  -7.6489E-02   2.6203E-02   1.0269E-01  -2.0538E-01   1.7918E-01   2.9740E-04
     16  -7.6495E-02   2.6384E-02   1.0288E-01  -2.0576E-01   1.7937E-01   5.8606E-05
     17  -7.6495E-02   2.6413E-02   1.0291E-01  -2.0582E-01   1.7940E-01   4.1058E-05
     18  -7.6496E-02   2.6449E-02   1.0294E-01  -2.0589E-01   1.7944E-01   4.5147E-05
     19  -7.6499E-02   2.6426E-02   1.0293E-01  -2.0585E-01   1.7942E-01   6.9912E-05
     20  -7.6504E-02   2.6408E-02   1.0291E-01  -2.0582E-01   1.7942E-01   1.6566E-04
     21  -7.6524E-02   2.6393E-02   1.0292E-01  -2.0583E-01   1.7944E-01   2.8983E-04
     22  -7.6587E-02   2.6434E-02   1.0302E-01  -2.0604E-01   1.7961E-01   3.2629E-04
     23  -7.6771E-02   2.6522E-02   1.0329E-01  -2.0658E-01   1.8006E-01   5.2636E-04
     24  -7.7070E-02   2.6540E-02   1.0361E-01  -2.0722E-01   1.8068E-01   6.7279E-04
     25  -7.7399E-02   2.6568E-02   1.0397E-01  -2.0793E-01   1.8137E-01   5.2129E-04
     26  -7.7402E-02   2.6586E-02   1.0399E-01  -2.0798E-01   1.8139E-01   3.8787E-04
     27  -7.7484E-02   2.6715E-02   1.0420E-01  -2.0840E-01   1.8168E-01   7.4010E-04
     28  -7.7588E-02   2.6682E-02   1.0427E-01  -2.0854E-01   1.8186E-01   2.9851E-04
     29  -7.7616E-02   2.6588E-02   1.0420E-01  -2.0841E-01   1.8182E-01   2.7462E-04
     30  -7.7633E-02   2.6618E-02   1.0425E-01  -2.0850E-01   1.8188E-01   1.2264E-04
     31  -7.7633E-02   2.6646E-02   1.0428E-01  -2.0856E-01   1.8191E-01   5.7879E-05
     32  -7.7635E-02   2.6712E-02   1.0435E-01  -2.0870E-01   1.8198E-01   9.2345E-05
     33  -7.7637E-02   2.6646E-02   1.0428E-01  -2.0857E-01   1.8192E-01   5.4803E-05
     34  -7.7637E-02   2.6617E-02   1.0425E-01  -2.0851E-01   1.8189E-01   4.7289E-05
     35  -7.7638E-02   2.6658E-02   1.0430E-01  -2.0859E-01   1.8193E-01   1.9472E-05
     36  -7.7638E-02   2.6661E-02   1.0430E-01  -2.0860E-01   1.8194E-01   1.8142E-05
     37  -7.7638E-02   2.6652E-02   1.0429E-01  -2.0858E-01   1.8193E-01   1.9508E-05
     38  -7.7638E-02   2.6654E-02   1.0429E-01  -2.0858E-01   1.8193E-01   7.8249E-06
   --------------------------------------------------------------------------------------
   Converged: ||grad||=7.8249E-06 &lt; vpq_tolgrs=1.0000E-05
   E_pol (eV):  -2.11263471E+00
     eps (eV):   4.95055799E+00
   --------------------------------------------------------------------------------------

   --------------------------------------------------------------------------------------
   * spin 1/1, pstate 2/3
   * values in the optimization log are in (a.u.)
   (o) - orthogonal all pstates &lt; 2
   --------------------------------------------------------------------------------------
   Step        E_pol         E_el         E_ph       E_elph      epsilon     ||grad||
      1  -9.2207E-04   4.4614E-02   4.5536E-02  -9.1071E-02   4.6458E-02   1.0902E-02  (o)
      2  -2.8019E-02   1.8675E-02   4.6694E-02  -9.3388E-02   7.4713E-02   5.0189E-03  (o)
      3  -4.0570E-02   7.1370E-03   4.7707E-02  -9.5414E-02   8.8277E-02   3.2276E-03  (o)
      4  -4.4896E-02   4.8516E-03   4.9748E-02  -9.9495E-02   9.4644E-02   4.2848E-03  (o)
      5  -5.1065E-02   5.2943E-03   5.6360E-02  -1.1272E-01   1.0743E-01   6.1301E-03  (o)
      6  -5.7579E-02   7.8276E-03   6.5407E-02  -1.3081E-01   1.2299E-01   5.4967E-03  (o)
      7  -6.1360E-02   1.0591E-02   7.1951E-02  -1.4390E-01   1.3331E-01   2.7017E-03  (o)
      8  -6.1925E-02   1.1456E-02   7.3381E-02  -1.4676E-01   1.3531E-01   3.4089E-03  (o)
      9  -6.3125E-02   1.3401E-02   7.6526E-02  -1.5305E-01   1.3965E-01   5.3225E-03  (o)
     10  -6.5651E-02   1.7337E-02   8.2989E-02  -1.6598E-01   1.4864E-01   7.5798E-03  (o)
     11  -6.8055E-02   2.2529E-02   9.0585E-02  -1.8117E-01   1.5864E-01   9.0116E-03  (o)
     12  -6.8691E-02   2.5701E-02   9.4392E-02  -1.8878E-01   1.6308E-01   9.6515E-03  (o)
     13  -6.8721E-02   2.6333E-02   9.5054E-02  -1.9011E-01   1.6377E-01   9.8229E-03  (o)
     14  -6.8721E-02   2.6327E-02   9.5048E-02  -1.9010E-01   1.6377E-01   9.8214E-03  (o)
     15  -6.8721E-02   2.6359E-02   9.5080E-02  -1.9016E-01   1.6380E-01   9.8301E-03  (o)
     16  -6.8721E-02   2.6348E-02   9.5070E-02  -1.9014E-01   1.6379E-01   9.8272E-03  (o)
     17  -6.8721E-02   2.6352E-02   9.5073E-02  -1.9015E-01   1.6379E-01   9.8282E-03  (o)
     18  -6.8721E-02   2.6351E-02   9.5072E-02  -1.9014E-01   1.6379E-01   9.8279E-03  (o)
     19  -6.8721E-02   2.6351E-02   9.5072E-02  -1.9014E-01   1.6379E-01   9.8280E-03  (o)
     20  -6.8721E-02   2.6351E-02   9.5072E-02  -1.9014E-01   1.6379E-01   9.8280E-03  (o)
     21  -6.8721E-02   2.6351E-02   9.5072E-02  -1.9014E-01   1.6379E-01   9.8280E-03  (o)
     22  -6.8721E-02   2.6351E-02   9.5072E-02  -1.9014E-01   1.6379E-01   9.8280E-03  (o)
     23  -6.8721E-02   2.6351E-02   9.5072E-02  -1.9014E-01   1.6379E-01   9.8280E-03  (o)
     24  -6.8721E-02   2.6351E-02   9.5072E-02  -1.9014E-01   1.6379E-01   9.8280E-03  (o)
     25  -6.8721E-02   2.6351E-02   9.5072E-02  -1.9014E-01   1.6379E-01   9.8280E-03  (o)
     26  -6.8721E-02   2.6351E-02   9.5072E-02  -1.9014E-01   1.6379E-01   9.8280E-03  (o)
     27  -6.8721E-02   2.6351E-02   9.5072E-02  -1.9014E-01   1.6379E-01   9.8280E-03  (o)
     28  -6.8721E-02   2.6351E-02   9.5072E-02  -1.9014E-01   1.6379E-01   9.8280E-03  (o)
     29  -6.8721E-02   2.6351E-02   9.5072E-02  -1.9014E-01   1.6379E-01   9.8280E-03  (o)
     30  -6.8721E-02   2.6351E-02   9.5072E-02  -1.9014E-01   1.6379E-01   9.8280E-03  (o)
     31  -6.8721E-02   2.6351E-02   9.5072E-02  -1.9014E-01   1.6379E-01   9.8280E-03
     32  -6.8841E-02   2.7693E-02   9.6534E-02  -1.9307E-01   1.6538E-01   1.0118E-02
     33  -7.6401E-02   2.7006E-02   1.0341E-01  -2.0681E-01   1.7981E-01   1.1017E-03
     34  -7.6461E-02   2.6598E-02   1.0306E-01  -2.0612E-01   1.7952E-01   2.8934E-04
     35  -7.6466E-02   2.6433E-02   1.0290E-01  -2.0580E-01   1.7937E-01   4.2613E-05
     36  -7.6466E-02   2.6420E-02   1.0289E-01  -2.0577E-01   1.7935E-01   1.1944E-05
     37  -7.6466E-02   2.6411E-02   1.0288E-01  -2.0575E-01   1.7934E-01   6.4048E-06
   --------------------------------------------------------------------------------------
   Converged: ||grad||=6.4048E-06 &lt; vpq_tolgrs=1.0000E-05
   E_pol (eV):  -2.08075736E+00
     eps (eV):   4.88019645E+00
   --------------------------------------------------------------------------------------

   --------------------------------------------------------------------------------------
   * spin 1/1, pstate 3/3
   * values in the optimization log are in (a.u.)
   (o) - orthogonal all pstates &lt; 3
   --------------------------------------------------------------------------------------
   Step        E_pol         E_el         E_ph       E_elph      epsilon     ||grad||
      1   5.1785E-03   5.0474E-02   4.5296E-02  -9.0591E-02   4.0117E-02   1.0432E-02  (o)
      2  -2.1764E-02   2.5176E-02   4.6939E-02  -9.3879E-02   6.8703E-02   5.5290E-03  (o)
      3  -4.4409E-02   5.0632E-03   4.9472E-02  -9.8945E-02   9.3882E-02   4.8509E-03  (o)
      4  -4.7885E-02   3.4293E-03   5.1314E-02  -1.0263E-01   9.9199E-02   3.9719E-03  (o)
      5  -5.3475E-02   5.1905E-03   5.8666E-02  -1.1733E-01   1.1214E-01   4.4340E-03  (o)
      6  -5.8648E-02   8.5958E-03   6.7244E-02  -1.3449E-01   1.2589E-01   4.4640E-03  (o)
      7  -6.0984E-02   1.0303E-02   7.1287E-02  -1.4257E-01   1.3227E-01   1.5067E-03  (o)
      8  -6.1012E-02   1.0082E-02   7.1094E-02  -1.4219E-01   1.3211E-01   1.4004E-03  (o)
      9  -6.1025E-02   1.0192E-02   7.1217E-02  -1.4243E-01   1.3224E-01   1.3434E-03  (o)
     10  -6.1038E-02   1.0201E-02   7.1239E-02  -1.4248E-01   1.3228E-01   1.2924E-03  (o)
     11  -6.1057E-02   1.0171E-02   7.1229E-02  -1.4246E-01   1.3229E-01   1.2752E-03  (o)
     12  -6.1092E-02   1.0217E-02   7.1309E-02  -1.4262E-01   1.3240E-01   1.3380E-03  (o)
     13  -6.1151E-02   1.0328E-02   7.1479E-02  -1.4296E-01   1.3263E-01   1.5451E-03  (o)
     14  -6.1253E-02   1.0531E-02   7.1784E-02  -1.4357E-01   1.3304E-01   1.9588E-03  (o)
     15  -6.1431E-02   1.0918E-02   7.2350E-02  -1.4470E-01   1.3378E-01   2.6388E-03  (o)
     16  -6.1755E-02   1.1663E-02   7.3419E-02  -1.4684E-01   1.3517E-01   3.6535E-03  (o)
     17  -6.2340E-02   1.3056E-02   7.5396E-02  -1.5079E-01   1.3774E-01   5.0562E-03  (o)
     18  -6.3276E-02   1.5431E-02   7.8707E-02  -1.5741E-01   1.4198E-01   6.7608E-03  (o)
     19  -6.4352E-02   1.8693E-02   8.3045E-02  -1.6609E-01   1.4740E-01   8.4073E-03  (o)
     20  -6.5019E-02   2.1737E-02   8.6756E-02  -1.7351E-01   1.5178E-01   9.5824E-03  (o)
     21  -6.5170E-02   2.3312E-02   8.8483E-02  -1.7697E-01   1.5365E-01   1.0140E-02  (o)
     22  -6.5181E-02   2.3747E-02   8.8929E-02  -1.7786E-01   1.5411E-01   1.0295E-02  (o)
     23  -6.5182E-02   2.3833E-02   8.9015E-02  -1.7803E-01   1.5420E-01   1.0325E-02  (o)
     24  -6.5182E-02   2.3842E-02   8.9024E-02  -1.7805E-01   1.5421E-01   1.0328E-02  (o)
     25  -6.5182E-02   2.3842E-02   8.9024E-02  -1.7805E-01   1.5421E-01   1.0328E-02  (o)
     26  -6.5182E-02   2.3842E-02   8.9024E-02  -1.7805E-01   1.5421E-01   1.0328E-02  (o)
     27  -6.5182E-02   2.3842E-02   8.9024E-02  -1.7805E-01   1.5421E-01   1.0328E-02  (o)
     28  -6.5182E-02   2.3842E-02   8.9024E-02  -1.7805E-01   1.5421E-01   1.0328E-02  (o)
     29  -6.5182E-02   2.3842E-02   8.9024E-02  -1.7805E-01   1.5421E-01   1.0328E-02  (o)
     30  -6.5182E-02   2.3842E-02   8.9024E-02  -1.7805E-01   1.5421E-01   1.0328E-02  (o)
     31  -6.5182E-02   2.3842E-02   8.9024E-02  -1.7805E-01   1.5421E-01   1.0328E-02
     32  -6.5665E-02   2.6759E-02   9.2424E-02  -1.8485E-01   1.5809E-01   1.1101E-02
     33  -7.6256E-02   2.7916E-02   1.0417E-01  -2.0834E-01   1.8043E-01   1.8871E-03
     34  -7.6425E-02   2.6661E-02   1.0309E-01  -2.0617E-01   1.7951E-01   7.0433E-04
     35  -7.6456E-02   2.6460E-02   1.0292E-01  -2.0583E-01   1.7937E-01   1.3895E-04
     36  -7.6457E-02   2.6426E-02   1.0288E-01  -2.0577E-01   1.7934E-01   4.3848E-05
     37  -7.6457E-02   2.6393E-02   1.0285E-01  -2.0570E-01   1.7931E-01   4.7376E-05
     38  -7.6462E-02   2.6407E-02   1.0287E-01  -2.0574E-01   1.7933E-01   8.8376E-05
     39  -7.6470E-02   2.6444E-02   1.0291E-01  -2.0583E-01   1.7938E-01   1.7091E-04
     40  -7.6504E-02   2.6467E-02   1.0297E-01  -2.0594E-01   1.7947E-01   3.0154E-04
     41  -7.6614E-02   2.6393E-02   1.0301E-01  -2.0601E-01   1.7962E-01   3.8575E-04
     42  -7.6882E-02   2.6399E-02   1.0328E-01  -2.0656E-01   1.8016E-01   5.2798E-04
     43  -7.7214E-02   2.6686E-02   1.0390E-01  -2.0780E-01   1.8111E-01   5.8143E-04
     44  -7.7441E-02   2.6631E-02   1.0407E-01  -2.0814E-01   1.8151E-01   3.9203E-04
     45  -7.7503E-02   2.6576E-02   1.0408E-01  -2.0816E-01   1.8158E-01   4.1233E-04
     46  -7.7548E-02   2.6606E-02   1.0415E-01  -2.0831E-01   1.8170E-01   3.0564E-04
     47  -7.7552E-02   2.6624E-02   1.0418E-01  -2.0835E-01   1.8173E-01   1.1406E-04
     48  -7.7559E-02   2.6673E-02   1.0423E-01  -2.0846E-01   1.8179E-01   1.7314E-04
     49  -7.7564E-02   2.6627E-02   1.0419E-01  -2.0838E-01   1.8175E-01   9.4107E-05
     50  -7.7566E-02   2.6627E-02   1.0419E-01  -2.0838E-01   1.8176E-01   8.0185E-05
     51  -7.7567E-02   2.6641E-02   1.0421E-01  -2.0841E-01   1.8177E-01   4.5980E-05
     52  -7.7567E-02   2.6637E-02   1.0420E-01  -2.0841E-01   1.8177E-01   2.6322E-05
     53  -7.7567E-02   2.6631E-02   1.0420E-01  -2.0840E-01   1.8177E-01   3.2463E-05
     54  -7.7567E-02   2.6636E-02   1.0420E-01  -2.0841E-01   1.8177E-01   1.6872E-05
     55  -7.7567E-02   2.6640E-02   1.0421E-01  -2.0841E-01   1.8177E-01   1.4787E-05
     56  -7.7567E-02   2.6637E-02   1.0420E-01  -2.0841E-01   1.8177E-01   1.0456E-05
     57  -7.7567E-02   2.6635E-02   1.0420E-01  -2.0841E-01   1.8177E-01   6.6123E-06
   --------------------------------------------------------------------------------------
   Converged: ||grad||=6.6123E-06 &lt; vpq_tolgrs=1.0000E-05
   E_pol (eV):  -2.11071576E+00
     eps (eV):   4.94621672E+00
   --------------------------------------------------------------------------------------

 Saving results to: teph4vpq_6o_VPQ.nc

== END DATASET(S) ==============================================================
================================================================================

 -outvars: echo values of variables after computation  --------
            acell      7.6750000000E+00  7.6750000000E+00  7.6750000000E+00 Bohr
              amu      6.94100000E+00  1.89984032E+01
        ddb_ngqpt        3    3    3
             ecut      3.00000000E+01 Hartree
 eph_frohl_ntheta          32
         eph_task          13
           etotal      0.0000000000E+00
            fcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
-          fftalg         512
              ixc          11
         kptrlatt        3    0    0      0    3    0      0    0    3
          kptrlen      1.62811336E+01
P           mkmem           4
            natom           2
            nband           6
            ngfft          30      30      30
             nkpt           4
             nsym          48
           ntypat           2
              occ      2.000000  2.000000  2.000000  2.000000  2.000000  0.000000
        optdriver           7
            rprim      0.0000000000E+00  5.0000000000E-01  5.0000000000E-01
                       5.0000000000E-01  0.0000000000E+00  5.0000000000E-01
                       5.0000000000E-01  5.0000000000E-01  0.0000000000E+00
          spgroup         225
           strten      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           symrel      1  0  0   0  1  0   0  0  1      -1  0  0   0 -1  0   0  0 -1
                       0 -1  1   0 -1  0   1 -1  0       0  1 -1   0  1  0  -1  1  0
                      -1  0  0  -1  0  1  -1  1  0       1  0  0   1  0 -1   1 -1  0
                       0  1 -1   1  0 -1   0  0 -1       0 -1  1  -1  0  1   0  0  1
                      -1  0  0  -1  1  0  -1  0  1       1  0  0   1 -1  0   1  0 -1
                       0 -1  1   1 -1  0   0 -1  0       0  1 -1  -1  1  0   0  1  0
                       1  0  0   0  0  1   0  1  0      -1  0  0   0  0 -1   0 -1  0
                       0  1 -1   0  0 -1   1  0 -1       0 -1  1   0  0  1  -1  0  1
                      -1  0  1  -1  1  0  -1  0  0       1  0 -1   1 -1  0   1  0  0
                       0 -1  0   1 -1  0   0 -1  1       0  1  0  -1  1  0   0  1 -1
                       1  0 -1   0  0 -1   0  1 -1      -1  0  1   0  0  1   0 -1  1
                       0  1  0   0  0  1   1  0  0       0 -1  0   0  0 -1  -1  0  0
                       1  0 -1   0  1 -1   0  0 -1      -1  0  1   0 -1  1   0  0  1
                       0 -1  0   0 -1  1   1 -1  0       0  1  0   0  1 -1  -1  1  0
                      -1  0  1  -1  0  0  -1  1  0       1  0 -1   1  0  0   1 -1  0
                       0  1  0   1  0  0   0  0  1       0 -1  0  -1  0  0   0  0 -1
                       0  0 -1   0  1 -1   1  0 -1       0  0  1   0 -1  1  -1  0  1
                       1 -1  0   0 -1  1   0 -1  0      -1  1  0   0  1 -1   0  1  0
                       0  0  1   1  0  0   0  1  0       0  0 -1  -1  0  0   0 -1  0
                      -1  1  0  -1  0  0  -1  0  1       1 -1  0   1  0  0   1  0 -1
                       0  0  1   0  1  0   1  0  0       0  0 -1   0 -1  0  -1  0  0
                       1 -1  0   0 -1  0   0 -1  1      -1  1  0   0  1  0   0  1 -1
                       0  0 -1   1  0 -1   0  1 -1       0  0  1  -1  0  1   0 -1  1
                      -1  1  0  -1  0  1  -1  0  0       1 -1  0   1  0 -1   1  0  0
            typat      1  2
        vpq_avg_g           1
    vpq_translate           1
      vpq_nstates           3
        vpq_nstep         100
    vpq_nstep_ort          30
       vpq_tolgrs      1.0000000000E-05
           xangst      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.0307175380E+00  2.0307175380E+00  2.0307175380E+00
            xcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       3.8375000000E+00  3.8375000000E+00  3.8375000000E+00
             xred      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       5.0000000000E-01  5.0000000000E-01  5.0000000000E-01
            znucl        3.00000    9.00000

================================================================================


- Timing analysis has been suppressed with timopt=0



================================================================================

 Suggested references for the acknowledgment of ABINIT usage.

 The users of ABINIT have little formal obligations with respect to the ABINIT group
 (those specified in the GNU General Public License, http://www.gnu.org/copyleft/gpl.txt).
 However, it is common practice in the scientific literature,
 to acknowledge the efforts of people that have made the research possible.
 In this spirit, please find below suggested citations of work written by ABINIT developers,
 corresponding to implementations inside of ABINIT that you have used in the present run.
 Note also that it will be of great value to readers of publications presenting these results,
 to read papers enabling them to understand the theoretical formalism and details
 of the ABINIT implementation.
 For information on why they are suggested, see also https://docs.abinit.org/theory/acknowledgments.
-
- [1] The Abinit project: Impact, environment and recent developments.
- Computer Phys. Comm. 248, 107042 (2020).
- X.Gonze, B. Amadon, G. Antonius, F.Arnardi, L.Baguet, J.-M.Beuken,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, N.Brouwer, F.Bruneval,
- G.Brunin, T.Cavignac, J.-B. Charraud, Wei Chen, M.Cote, S.Cottenier,
- J.Denier, G.Geneste, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, Xu He, N.Helbig, N.Holzwarth, Y.Jia, F.Jollet,
- W.Lafargue-Dit-Hauret, K.Lejaeghere, M.A.L.Marques, A.Martin, C.Martins,
- H.P.C. Miranda, F.Naccarato, K. Persson, G.Petretto, V.Planes, Y.Pouillon,
- S.Prokhorenko, F.Ricci, G.-M.Rignanese, A.H.Romero, M.M.Schmitt, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, G.Zerah and J.W.Zwanzig
- Comment: the fifth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT20.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2020
-
- [2] Optimized norm-conserving Vanderbilt pseudopotentials.
- D.R. Hamann, Phys. Rev. B 88, 085117 (2013).
- Comment: Some pseudopotential generated using the ONCVPSP code were used.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#hamann2013
-
- [3] ABINIT: Overview, and focus on selected capabilities
- J. Chem. Phys. 152, 124102 (2020).
- A. Romero, D.C. Allan, B. Amadon, G. Antonius, T. Applencourt, L.Baguet,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, F.Bruneval,
- G.Brunin, D.Caliste, M.Cote,
- J.Denier, C. Dreyer, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, F.Jollet, G. Jomard,
- A.Martin, 
- H.P.C. Miranda, F.Naccarato, G.Petretto, N.A. Pike, V.Planes,
- S.Prokhorenko, T. Rangel, F.Ricci, G.-M.Rignanese, M.Royo, M.Stengel, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, J.Wiktor, J.W.Zwanziger, and X.Gonze.
- Comment: a global overview of ABINIT, with focus on selected capabilities .
- Note that a version of this paper, that is not formatted for J. Chem. Phys 
- is available at https://www.abinit.org/sites/default/files/ABINIT20_JPC.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#romero2020
-
- [4] Recent developments in the ABINIT software package.
- Computer Phys. Comm. 205, 106 (2016).
- X.Gonze, F.Jollet, F.Abreu Araujo, D.Adams, B.Amadon, T.Applencourt,
- C.Audouze, J.-M.Beuken, J.Bieder, A.Bokhanchuk, E.Bousquet, F.Bruneval
- D.Caliste, M.Cote, F.Dahm, F.Da Pieve, M.Delaveau, M.Di Gennaro,
- B.Dorado, C.Espejo, G.Geneste, L.Genovese, A.Gerossier, M.Giantomassi,
- Y.Gillet, D.R.Hamann, L.He, G.Jomard, J.Laflamme Janssen, S.Le Roux,
- A.Levitt, A.Lherbier, F.Liu, I.Lukacevic, A.Martin, C.Martins,
- M.J.T.Oliveira, S.Ponce, Y.Pouillon, T.Rangel, G.-M.Rignanese,
- A.H.Romero, B.Rousseau, O.Rubel, A.A.Shukri, M.Stankovski, M.Torrent,
- M.J.Van Setten, B.Van Troeye, M.J.Verstraete, D.Waroquier, J.Wiktor,
- B.Xu, A.Zhou, J.W.Zwanziger.
- Comment: the fourth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT16.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2016
-
- And optionally:
-
- [5] ABINIT: First-principles approach of materials and nanosystem properties.
- Computer Phys. Comm. 180, 2582-2615 (2009).
- X. Gonze, B. Amadon, P.-M. Anglade, J.-M. Beuken, F. Bottin, P. Boulanger, F. Bruneval,
- D. Caliste, R. Caracas, M. Cote, T. Deutsch, L. Genovese, Ph. Ghosez, M. Giantomassi
- S. Goedecker, D.R. Hamann, P. Hermet, F. Jollet, G. Jomard, S. Leroux, M. Mancini, S. Mazevet,
- M.J.T. Oliveira, G. Onida, Y. Pouillon, T. Rangel, G.-M. Rignanese, D. Sangalli, R. Shaltaf,
- M. Torrent, M.J. Verstraete, G. Zerah, J.W. Zwanziger
- Comment: the third generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm. 
- is available at https://www.abinit.org/sites/default/files/ABINIT_CPC_v10.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2009
-
- Proc.   0 individual time (sec): cpu=         16.7  wall=         16.7

================================================================================

 Calculation completed.
.Delivered   0 WARNINGs and   4 COMMENTs to log file.
+Overall time at end (sec) : cpu=         16.7  wall=         16.7

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-b719da74-7cf5-4e64-b3f2-d74ccd9ac80d", "#uuid-c921d7e3-6e1b-4f26-89ff-03e3007b5fa8") }); </script>

<p>Note the difference in the initial prompt</p>
<div class="highlight"><pre><span></span><code>...
 Solving the variational polaron equations for each state...
<span class="w">   </span><span class="k">*</span><span class="w"> </span>spin 1/1, pstate 1/3...
   Done
<span class="w">   </span><span class="k">*</span><span class="w"> </span>spin 1/1, pstate 2/3...
   Done
<span class="w">   </span><span class="k">*</span><span class="w"> </span>spin 1/1, pstate 3/3...
</code></pre></div>
<p>Also, there are now three optimization logs for each state, which are a bit different when the orthogonalization is peformed.
For example, for state 2:</p>
<div class="highlight"><pre><span></span><code>   --------------------------------------------------------------------------------------
<span class="w">   </span><span class="k">*</span><span class="w"> </span>spin 1/1, pstate 2/3
<span class="w">   </span><span class="k">*</span><span class="w"> </span>values in the optimization log are in (a.u.)
   (o) - orthogonal all pstates &lt; 2
   --------------------------------------------------------------------------------------
   Step        E<span class="ge">_pol         E_</span>el         E<span class="ge">_ph       E_</span>elph      epsilon     ||grad||
      1  -9.2204E-04   4.4614E-02   4.5536E-02  -9.1071E-02   4.6458E-02   1.0902E-02  (o)
      2  -2.8019E-02   1.8675E-02   4.6694E-02  -9.3388E-02   7.4713E-02   5.0189E-03  (o)
      3  -4.0570E-02   7.1368E-03   4.7707E-02  -9.5414E-02   8.8277E-02   3.2275E-03  (o)
      4  -4.4896E-02   4.8512E-03   4.9747E-02  -9.9494E-02   9.4642E-02   4.2843E-03  (o)
      5  -5.1065E-02   5.2935E-03   5.6358E-02  -1.1272E-01   1.0742E-01   6.1297E-03  (o)
      6  -5.7578E-02   7.8267E-03   6.5405E-02  -1.3081E-01   1.2298E-01   5.4966E-03  (o)
      7  -6.1360E-02   1.0590E-02   7.1950E-02  -1.4390E-01   1.3331E-01   2.7006E-03  (o)
      8  -6.1924E-02   1.1454E-02   7.3377E-02  -1.4675E-01   1.3530E-01   3.4064E-03  (o)
      9  -6.3122E-02   1.3396E-02   7.6519E-02  -1.5304E-01   1.3964E-01   5.3188E-03  (o)
     10  -6.5647E-02   1.7329E-02   8.2976E-02  -1.6595E-01   1.4862E-01   7.5766E-03  (o)
     11  -6.8053E-02   2.2522E-02   9.0575E-02  -1.8115E-01   1.5863E-01   9.0101E-03  (o)
     12  -6.8691E-02   2.5699E-02   9.4390E-02  -1.8878E-01   1.6308E-01   9.6510E-03  (o)
     13  -6.8721E-02   2.6332E-02   9.5054E-02  -1.9011E-01   1.6378E-01   9.8228E-03  (o)
     14  -6.8721E-02   2.6327E-02   9.5049E-02  -1.9010E-01   1.6377E-01   9.8214E-03  (o)
     15  -6.8721E-02   2.6359E-02   9.5080E-02  -1.9016E-01   1.6380E-01   9.8300E-03  (o)
     16  -6.8721E-02   2.6349E-02   9.5070E-02  -1.9014E-01   1.6379E-01   9.8272E-03  (o)
     17  -6.8721E-02   2.6352E-02   9.5074E-02  -1.9015E-01   1.6380E-01   9.8282E-03  (o)
     18  -6.8721E-02   2.6351E-02   9.5072E-02  -1.9014E-01   1.6379E-01   9.8279E-03  (o)
     19  -6.8721E-02   2.6351E-02   9.5073E-02  -1.9015E-01   1.6379E-01   9.8280E-03  (o)
     20  -6.8721E-02   2.6351E-02   9.5073E-02  -1.9015E-01   1.6379E-01   9.8280E-03  (o)
     21  -6.8721E-02   2.6351E-02   9.5073E-02  -1.9015E-01   1.6379E-01   9.8280E-03  (o)
     22  -6.8721E-02   2.6351E-02   9.5073E-02  -1.9015E-01   1.6379E-01   9.8280E-03  (o)
     23  -6.8721E-02   2.6351E-02   9.5073E-02  -1.9015E-01   1.6379E-01   9.8280E-03  (o)
     24  -6.8721E-02   2.6351E-02   9.5073E-02  -1.9015E-01   1.6379E-01   9.8280E-03  (o)
     25  -6.8721E-02   2.6351E-02   9.5073E-02  -1.9015E-01   1.6379E-01   9.8280E-03  (o)
     26  -6.8721E-02   2.6351E-02   9.5073E-02  -1.9015E-01   1.6379E-01   9.8280E-03  (o)
     27  -6.8721E-02   2.6351E-02   9.5073E-02  -1.9015E-01   1.6379E-01   9.8280E-03  (o)
     28  -6.8721E-02   2.6351E-02   9.5073E-02  -1.9015E-01   1.6379E-01   9.8280E-03  (o)
     29  -6.8721E-02   2.6351E-02   9.5073E-02  -1.9015E-01   1.6379E-01   9.8280E-03  (o)
     30  -6.8721E-02   2.6351E-02   9.5073E-02  -1.9015E-01   1.6379E-01   9.8280E-03  (o)
     31  -6.8721E-02   2.6351E-02   9.5073E-02  -1.9015E-01   1.6379E-01   9.8280E-03
     32  -6.8842E-02   2.7693E-02   9.6535E-02  -1.9307E-01   1.6538E-01   1.0118E-02
     33  -7.6401E-02   2.7006E-02   1.0341E-01  -2.0681E-01   1.7981E-01   1.1018E-03
     34  -7.6461E-02   2.6598E-02   1.0306E-01  -2.0612E-01   1.7952E-01   2.8937E-04
     35  -7.6466E-02   2.6433E-02   1.0290E-01  -2.0580E-01   1.7937E-01   4.2615E-05
     36  -7.6466E-02   2.6420E-02   1.0289E-01  -2.0577E-01   1.7935E-01   1.1954E-05
     37  -7.6466E-02   2.6411E-02   1.0288E-01  -2.0575E-01   1.7934E-01   6.4220E-06
   --------------------------------------------------------------------------------------
   Converged: ||grad||=6.4220E-06 &lt; vpq_tolgrs=1.0000E-05
   E_pol (eV):  -2.08075740E+00
     eps (eV):   4.88019624E+00
</code></pre></div>
<p>Note the <code>(o)</code> tag for optimization step with the orthogonality constraint.
Also, check the gradient norm, which is indeed stuck at a constrained-induced stationary point
before the constraint is lifted.</p>
<p>All results are gathered in a single <em>VPQ</em> NetCDF file.
As before, we can visualize the convergence of our method using <a href="http://abinit.github.io/abipy/scripts/abiopen.html">abiopen.py</a>  with the <code>-e</code> option (<code>--expose</code>):</p>
<p><img alt="" src="../eph4vpq_assets/LiF_hole_pstate3.png" /></p>
<p>The <span class="arithmatex">\(E_\mathrm{pol}\)</span> values for each state differ slighly:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;E_pol (eV)&quot;</span><span class="w"> </span>teph4vpq_6.abo

<span class="w">   </span>E_pol<span class="w"> </span><span class="o">(</span>eV<span class="o">)</span>:<span class="w">  </span>-2.11263475E+00
<span class="w">   </span>E_pol<span class="w"> </span><span class="o">(</span>eV<span class="o">)</span>:<span class="w">  </span>-2.08075740E+00
<span class="w">   </span>E_pol<span class="w"> </span><span class="o">(</span>eV<span class="o">)</span>:<span class="w">  </span>-2.11071583E+00<span class="sb">`</span>
</code></pre></div>
<p>To visualize these states, one can compute the real-space charge distribution and displacements
via Eqs. (\ref{eq:polaron_phi}),(\ref{eq:polaron_tau}).</p>
<p>In this tutorial, this is done with the following input</p>
<div class="text-center"><button id="uuid-4f793814-a9e3-460c-a4cc-2342cbcc5765" class="md-button md-button--secondary"> View tests/tutorespfn/Input/teph4vpq_7.abi </button></div>
<div id="uuid-1ace51f7-f63b-46b0-8acc-39bede35dc31" class="my_dialog" title="tests/tutorespfn/Input/teph4vpq_7.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># LiF: visualization of a small hole polaron computed on a 3x3x3 k/q-grid.</span>
<span class="c1"># Multiple polaronic states.</span>

<span class="w"> </span>optdriver<span class="w">  </span><span class="m">7</span><span class="w">   </span><span class="c1"># Electron-phonon driver</span>
<span class="w"> </span>eph_task<span class="w">  </span>-13<span class="w">  </span><span class="c1"># Activate the Variational Polaron Equations visualization</span>

<span class="w"> </span>vpq_mesh_fact<span class="w"> </span><span class="m">2</span><span class="w">  </span><span class="c1"># &gt;1 decreases the resolution of the polaron wavefunction</span>
<span class="w">                  </span><span class="c1"># *xsf file and reduces memory requirements</span>
<span class="w">                  </span><span class="c1"># (default: 1)</span>

<span class="c1"># Variational Polaron Equations results from the previous run</span>
<span class="w"> </span>getvpq_filepath<span class="w"> </span><span class="s2">&quot;teph4vpq_6o_VPQ.nc&quot;</span>

<span class="c1"># Electron-phonon matrix elements</span>
<span class="w"> </span>getgstore_filepath<span class="w"> </span><span class="s2">&quot;teph4vpq_3o_DS1_GSTORE.nc&quot;</span><span class="w"> </span><span class="c1"># 3x3x3 k/q-mesh</span>

<span class="c1"># Wavefunction</span>
<span class="c1"># Read the WFK file from the preparatory run</span>
<span class="w"> </span>getwfk_filepath<span class="w"> </span><span class="s2">&quot;teph4vpq_2o_DS1_WFK&quot;</span><span class="w">  </span><span class="c1"># 3x3x3 k-mesh</span>

<span class="w"> </span>ngkpt<span class="w">    </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w">  </span><span class="c1"># These parameters have to be consistent with the WFK file</span>

<span class="w"> </span>kptopt<span class="w">   </span><span class="m">1</span>
<span class="w"> </span>nshiftk<span class="w">  </span><span class="m">1</span>
<span class="w"> </span>shiftk<span class="w">   </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
<span class="w"> </span>nband<span class="w">    </span><span class="m">6</span>
<span class="w"> </span>ecut<span class="w">     </span><span class="m">30</span>

<span class="c1"># Phonons</span>
<span class="w"> </span>ddb_ngqpt<span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w">          </span><span class="c1"># This has to be consistent with the DDB file</span>
<span class="w"> </span>getddb_filepath
<span class="w"> </span><span class="s2">&quot;LiF_eph_varpeq/out_DDB&quot;</span><span class="w">  </span><span class="c1"># Read the precomputed DDB stored in git submodule</span>
<span class="w">                           </span><span class="c1"># NOTE: for the input parameters used to producee</span>
<span class="w">                           </span><span class="c1"># the DDB file, consult the LiF_eph_varpeq/dfpt.abi</span>

<span class="c1"># Scattering potentials</span>
<span class="w"> </span>getdvdb_filepath
<span class="w"> </span><span class="s2">&quot;teph4vpq_1_DVDB&quot;</span><span class="w">  </span><span class="c1"># Read the DVDB file from the preparatory run</span>

<span class="c1"># Pseudopotentials</span>
<span class="w"> </span>pp_dirpath<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">/Psdj_nc_sr_05_pbe_std_psp8&quot;</span>
<span class="w"> </span>pseudos<span class="w"> </span><span class="s2">&quot;Li.psp8, F.psp8&quot;</span>

<span class="c1"># Structure</span>
<span class="w"> </span>natom<span class="w">   </span><span class="m">2</span>
<span class="w"> </span>ntypat<span class="w">  </span><span class="m">2</span>
<span class="w"> </span>typat<span class="w">   </span><span class="m">1</span><span class="w"> </span><span class="m">2</span>
<span class="w"> </span>znucl<span class="w">   </span><span class="m">3</span><span class="w"> </span><span class="m">9</span>
<span class="w"> </span>xred<span class="w">    </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.0
<span class="w">         </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5

<span class="w"> </span>acell<span class="w"> </span><span class="m">3</span>*7.675
<span class="w"> </span>rprim<span class="w"> </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5
<span class="w">       </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.5
<span class="w">       </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% exclude_builders = eos_nvhpc_*</span>
<span class="c1">#%% test_chain = teph4vpq_1.abi, teph4vpq_2.abi, teph4vpq_3.abi,</span>
<span class="c1">#%%              teph4vpq_4.abi, teph4vpq_5.abi, teph4vpq_6.abi,</span>
<span class="c1">#%%              teph4vpq_7.abi, teph4vpq_8.abi, teph4vpq_9.abi,</span>
<span class="c1">#%%              teph4vpq_10.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% use_git_submodule = LiF_eph_varpeq</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   teph4vpq_7.abo, tolnlines = 50, tolabs = 6e-4, tolrel = 1e-1</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 10</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = V. Vasilchenko</span>
<span class="c1">#%% keywords = DFPT, EPH, POLARON</span>
<span class="c1">#%% description =</span>
<span class="c1">#%%   LiF, Fm-3m space group.</span>
<span class="c1">#%%   Visualization of a small hole polaron computed on a 3x3x3 k/q-grid.</span>
<span class="c1">#%%   Multiple polaronic states.</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-1ace51f7-f63b-46b0-8acc-39bede35dc31", "#uuid-4f793814-a9e3-460c-a4cc-2342cbcc5765") }); </script>

<p>As usual, run this example with:</p>
<div class="highlight"><pre><span></span><code>abinit<span class="w"> </span>teph4vpq_7.abi<span class="w"> </span>&gt;<span class="w"> </span>teph4vpq_7.log<span class="w"> </span><span class="m">2</span>&gt;<span class="w"> </span>err<span class="w"> </span><span class="p">&amp;</span>
</code></pre></div>
<p>This calculations requires the <strong>VPQ</strong> NetCDF file produced in the previous calculations,
as well as the corresponding <strong>WFK</strong>, <strong>DDB</strong>, <strong>DVDB</strong> and <strong>GSTORE</strong> files.
Note the new <a class="wikilink codevar-wikilink" href="/variables/eph#getvpq_filepath">getvpq_filepath</a> variable.</p>
<p>The code responsible for producing <code>.xsf</code> files with visualiziation data is activated via the <a class="wikilink codevar-wikilink" href="/variables/eph#eph_task">eph_task</a> -13 variable.
The variable <a class="wikilink codevar-wikilink" href="/variables/eph#vpq_mesh_fact">vpq_mesh_fact</a> specifies the resolution downsampling of the charge distribution isosurface.
Increasing its value will reduce memory requirements by losing some fine feautres of the isosurface.
For small polarons <a class="wikilink codevar-wikilink" href="/variables/eph#vpq_mesh_fact">vpq_mesh_fact</a> 1 (no downsampling) is perfectly fine, but for the sake of tutorial we will use the downsampling anyaway.</p>
<p>This calculation has produced the following <code>.xsf</code> files:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>ls<span class="w"> </span>*xsf

teph4vpq_7o_pstate_1_POLARON.xsf<span class="w">               </span>teph4vpq_7o_pstate_2_POLARON.xsf<span class="w">               </span>teph4vpq_7o_pstate_3_POLARON.xsf
teph4vpq_7o_pstate_1_POLARON_DISPL.xsf<span class="w">         </span>teph4vpq_7o_pstate_2_POLARON_DISPL.xsf<span class="w">         </span>teph4vpq_7o_pstate_3_POLARON_DISPL.xsf
teph4vpq_7o_pstate_1_POLARON_DISPL_VECTORS.xsf<span class="w"> </span>teph4vpq_7o_pstate_2_POLARON_DISPL_VECTORS.xsf<span class="w"> </span>teph4vpq_7o_pstate_3_POLARON_DISPL_VECTORS.xsf
</code></pre></div>
<p>For each state, we have</p>
<ul>
<li>POLARON.xsf &rarr; polaron charge distribution in pristine geometry;</li>
<li>POLARON_DISPL.xsf &rarr; polaron charge distribution with distorted geometry;</li>
<li>POLARON_DISPL_VECTORS.xsf &rarr; pristine geometry with displacement vectors shown as forces.</li>
</ul>
<p>One can use software that can read <code>.xsf</code> file format (e.g. VESTA) to visualize these outputs.
The following figure shows the charge distribution of each polaronic state:</p>
<p><img alt="" src="../eph4vpq_assets/LiF_hole_polaron3.png" /></p>
<p>Note that state 1 and 3 are instances of a <strong>triply-degenerate hole polaron</strong>,
and oriented along two different directions of the &lt;100&gt; cubic family.
That&rsquo;s why they are close in binding energy (~ 0.1 % differnece), and the difference may decrease
if we ask for stricter convergence with <a class="wikilink codevar-wikilink" href="/variables/eph#vpq_tolgrs">vpq_tolgrs</a>.
These polarons have <span class="arithmatex">\(D_{4h}\)</span> point group symmetry.</p>
<p>However, state 2 possesses <strong>different symmetry</strong> (<span class="arithmatex">\(D_{2h}\)</span> point group) and is oriented along one of 6 direction of the &lt;110&gt; cubic family.</p>
<p>Having <strong>multiple</strong> and <strong>degenerate</strong> polaronic solutions for a single system is not surprising.
This happens due to the degeneracy of electronic states and can be seen already at the level of generalized Frohlich model <a class="wikilink citation-wikilink" data-tippy-content="Polarons in the cubic generalized Fr\&quot;ohlich model: Spontaneous symmetry breaking" data-toggle="popover" href="/theory/bibliography#vasilchenko2024">[Vasilchenko2024]</a>.
In <em>ab initio</em> calculations, this behaviour may be even more complex.</p>
<p>Also, note that these polarons localize on fluorine atoms and can occupy <strong>any fluorine site</strong> &ndash;
that&rsquo;s why we had to additionaly treat the translational invariance.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to manually translate the polarons at visualization step, use the <a class="wikilink codevar-wikilink" href="/variables/eph#vpq_trvec">vpq_trvec</a> variable.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Obtained solutions can be used as a starting point for calculations with other <span class="arithmatex">\(\kk/\qq\)</span>-meshes.
For this, one has to provide the <strong>VPQ</strong> file via <a class="wikilink codevar-wikilink" href="/variables/eph#getvpq_filepath">getvpq_filepath</a>, select a pstate via
<a class="wikilink codevar-wikilink" href="/variables/eph#vpq_select">vpq_select</a> and activate the interpolation using the <a class="wikilink codevar-wikilink" href="/variables/eph#vpq_interp">vpq_interp</a> tag.</p>
<p>This way, one can try to propagate a solution through a series of calculations on progressively increasing
meshes and achieve consistent localization of polaron.
However, as the potential energy surfaces of polarons possess multiple minima, it is still recommended
to check the consistency of the solutions between meshes.</p>
</div>
<p>Finally, let&rsquo;s look at the AbiPy capabilities to analyze individual contributions of the electronic bands
and phonon modes to the polaron formation.
This can be done with the <code>VpqFile</code> class which loads the <strong>VPQ</strong> NetCDF files and provides post-process tools.
With the following Python scripts</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">abipy.eph.vpq</span><span class="w"> </span><span class="kn">import</span> <span class="n">VpqFile</span>

<span class="n">ebands_file</span> <span class="o">=</span> <span class="s2">&quot;LiF_eph_varpeq/ebandso_GSR.nc&quot;</span>

<span class="n">vpq</span> <span class="o">=</span> <span class="n">VpqFile</span><span class="p">(</span><span class="s2">&quot;teph4vpq_6o_VPQ.nc&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">polaron</span> <span class="ow">in</span> <span class="n">vpq</span><span class="o">.</span><span class="n">polaron_spin</span><span class="p">:</span>
    <span class="n">polaron</span><span class="o">.</span><span class="n">plot_ank_with_ebands</span><span class="p">(</span><span class="n">ebands_file</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">abipy.eph.vpq</span><span class="w"> </span><span class="kn">import</span> <span class="n">VpqFile</span>

<span class="n">ddb_file</span> <span class="o">=</span> <span class="s2">&quot;LiF_eph_varpeq/out_DDB&quot;</span>

<span class="n">vpq</span> <span class="o">=</span> <span class="n">VpqFile</span><span class="p">(</span><span class="s2">&quot;teph4vpq_6o_VPQ.nc&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">polaron</span> <span class="ow">in</span> <span class="n">vpq</span><span class="o">.</span><span class="n">polaron_spin</span><span class="p">:</span>
    <span class="n">polaron</span><span class="o">.</span><span class="n">plot_bqnu_with_ddb</span><span class="p">(</span><span class="n">ddb_file</span><span class="p">)</span>
</code></pre></div>
<p>we can generate the following figures (it may take some time):</p>
<p><img alt="" src="../eph4vpq_assets/LiF_hole_coeffs.png" /></p>
<p>For each state, left and right figure show the contribution of the electronic bands and phonon modes to the polaron formation, respectively.
<span class="arithmatex">\(\boldsymbol{A}\)</span> and <span class="arithmatex">\(\boldsymbol{B}\)</span> coefficients are interpolated on <span class="arithmatex">\(\kk/\qq\)</span> paths &ndash; that&rsquo;s why
we see such dense sampling although our coefficients have been obtained on 3x3x3 <span class="arithmatex">\(\kk/\qq\)</span> meshes.
These results are unconverged mainly due to the coarse mesh of the calculation, but still provide qualitative insights.</p>
<p>Note the difference between the <span class="arithmatex">\(\boldsymbol{A}\)</span> contribution for each state.
Even for the degenerate states 1 and 3 it is different, which is mainly due to the fact that
we used high-symmetry paths of the <strong>pristine crystal</strong> to plot them.
With polarons, we have a <strong>symmetry-breaking</strong> effect, and one have to use <strong>special high-symmetry paths</strong> for each polaron.
For states 1 and 3, for example, one of the three <span class="arithmatex">\(\Gamma-X\)</span> direction becomes inequivalent with the two others.
For state 2, the same will hold for the set of <span class="arithmatex">\(\Gamma-K\)</span> directions.</p>
<p>This inequivalency can also be seen in the A-DOS, which have been computed with (red) and without symmetries (golden).
If <span class="arithmatex">\(\boldsymbol{A}\)</span> coefficients have possesed the same symmetry as the crystal, these DOS would have been identical.
However, the detailed symmetry analysis of polarons is beyond the scope of this tutorial.</p>
<h2 id="large-electron-polaron">Large electron polaron<a class="headerlink" href="#large-electron-polaron" title="Permanent link">&para;</a></h2>
<p>Conceptually, calculations of large polarons follow the same flow as for small polarons.
The main difference is in the size of <span class="arithmatex">\(\kk/\qq\)</span>-meshes we have to employ
as large polarons require large hosting supercells.
Here, we will obtain large electron polaron in LiF on 13x13x13 <span class="arithmatex">\(\kk/\qq\)</span>-mesh.</p>
<p>Again, we will need <strong>DDB</strong>, <strong>WFK</strong> and <strong>GSTORE</strong> files to launch the VarPEq optimization.
The first two files are already available:
<strong>DDB</strong> has been precomputed, and we also have obtained <strong>WFK</strong> on 13x13x13 <span class="arithmatex">\(\kk\)</span>-mesh at the NSCF step.</p>
<p>First, let&rsquo;s launch the gstore calculation with the input file</p>
<div class="text-center"><button id="uuid-593086b3-745f-4dd3-90d3-b747a006bf86" class="md-button md-button--secondary"> View tests/tutorespfn/Input/teph4vpq_8.abi </button></div>
<div id="uuid-06ccf232-d792-4c68-9136-6e6fff640bd8" class="my_dialog" title="tests/tutorespfn/Input/teph4vpq_8.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># LiF: computation of electron-phonon matrix elements for 13x13x13 k/q-grid.</span>
<span class="c1"># Energy filtering is activated.</span>
<span class="c1"># The results are stored in GSTORE.nc NetCDF file</span>
<span class="c1"># (preparatory run for VarPEq electron polaron calculations)</span>

<span class="w"> </span>optdriver<span class="w">  </span><span class="m">7</span><span class="w">   </span><span class="c1"># Electron-phonon driver</span>
<span class="w"> </span>eph_task<span class="w">   </span><span class="m">11</span><span class="w">  </span><span class="c1"># Activate the e-ph matrix elements computation via GSTORE</span>

<span class="c1"># Electron-phonon matrix elements parameters</span>
<span class="w"> </span>gstore_cplex<span class="w">  </span><span class="m">2</span><span class="w">     </span><span class="c1"># Complex e-ph matrix elements   (mandatory for VarPEq)</span>
<span class="w"> </span>gstore_kzone<span class="w">  </span><span class="s2">&quot;bz&quot;</span><span class="w">  </span><span class="c1"># Use full BZ for k and q meshed (mandatory for VarPEq)</span>
<span class="w"> </span>gstore_qzone<span class="w">  </span><span class="s2">&quot;bz&quot;</span>
<span class="w"> </span>gstore_erange<span class="w"> </span><span class="m">0</span>.<span class="w"> </span><span class="m">1</span>.0<span class="w"> </span>eV<span class="w">  </span><span class="c1"># Activate the energy filtering</span>
<span class="w">                          </span><span class="c1"># Here, only the electronic states in 1.0 eV window</span>
<span class="w">                          </span><span class="c1"># near the CBM are explicitly computed</span>

<span class="c1"># Wavefunction</span>
<span class="c1"># Read the WFK file from the preparatory run</span>
<span class="w"> </span>getwfk_filepath<span class="w">  </span><span class="s2">&quot;teph4vpq_2o_DS4_WFK&quot;</span><span class="w">  </span><span class="c1"># 13x13x13 k-mesh</span>

<span class="w"> </span>ngkpt<span class="w">    </span><span class="m">13</span><span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">13</span><span class="w">  </span><span class="c1"># These parameters have to consistent with the WFK file</span>

<span class="w"> </span>kptopt<span class="w">   </span><span class="m">1</span>
<span class="w"> </span>nshiftk<span class="w">  </span><span class="m">1</span>
<span class="w"> </span>shiftk<span class="w">   </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
<span class="w"> </span>nband<span class="w">    </span><span class="m">6</span>
<span class="w"> </span>ecut<span class="w">     </span><span class="m">30</span>

<span class="c1"># Phonons</span>
<span class="w"> </span>getddb_filepath
<span class="w"> </span><span class="s2">&quot;LiF_eph_varpeq/out_DDB&quot;</span><span class="w">  </span><span class="c1"># Read the precomputed DDB stored in git submodule</span>
<span class="w">                           </span><span class="c1"># NOTE: for the input parameters used to produce</span>
<span class="w">                           </span><span class="c1"># the DDB file, consult the LiF_eph_varpeq/dfpt.abi</span>

<span class="c1"># Scattering potentials</span>
<span class="w"> </span>getdvdb_filepath
<span class="w"> </span><span class="s2">&quot;teph4vpq_1_DVDB&quot;</span><span class="w">  </span><span class="c1"># Read the DVDB file from the preparatory run</span>

<span class="c1"># Phonons and scattering potentials interpolation</span>
<span class="w"> </span>ddb_ngqpt<span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w">       </span><span class="c1"># This has to be consistent with the DDB/DVDB files</span>
<span class="w"> </span>boxcutmin<span class="w">  </span><span class="m">1</span>.1<span class="w">         </span><span class="c1"># Optimal value that speeds up the interpolation</span>

<span class="w"> </span>eph_ngqpt_fine<span class="w">   </span><span class="m">13</span><span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">13</span><span class="w">  </span><span class="c1"># Interpolate to 13x13x13 q-grid</span>

<span class="c1"># Pseudopotentials</span>
<span class="w"> </span>pp_dirpath<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">/Psdj_nc_sr_05_pbe_std_psp8&quot;</span>
<span class="w"> </span>pseudos<span class="w"> </span><span class="s2">&quot;Li.psp8, F.psp8&quot;</span>

<span class="c1"># Structure</span>
<span class="w"> </span>natom<span class="w">   </span><span class="m">2</span>
<span class="w"> </span>ntypat<span class="w">  </span><span class="m">2</span>
<span class="w"> </span>typat<span class="w">   </span><span class="m">1</span><span class="w"> </span><span class="m">2</span>
<span class="w"> </span>znucl<span class="w">   </span><span class="m">3</span><span class="w"> </span><span class="m">9</span>
<span class="w"> </span>xred<span class="w">    </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.0
<span class="w">         </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5

<span class="w"> </span>acell<span class="w"> </span><span class="m">3</span>*7.675
<span class="w"> </span>rprim<span class="w"> </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5
<span class="w">       </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.5
<span class="w">       </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% exclude_builders = eos_nvhpc_*</span>
<span class="c1">#%% test_chain = teph4vpq_1.abi, teph4vpq_2.abi, teph4vpq_3.abi,</span>
<span class="c1">#%%              teph4vpq_4.abi, teph4vpq_5.abi, teph4vpq_6.abi,</span>
<span class="c1">#%%              teph4vpq_7.abi, teph4vpq_8.abi, teph4vpq_9.abi,</span>
<span class="c1">#%%              teph4vpq_10.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% use_git_submodule = LiF_eph_varpeq</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   teph4vpq_8.abo, tolnlines = 60, tolabs = 5e-6, tolrel = 1</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 10</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = V. Vasilchenko</span>
<span class="c1">#%% keywords = DFPT, EPH, POLARON</span>
<span class="c1">#%% description =</span>
<span class="c1">#%%   LiF, Fm-3m space group.</span>
<span class="c1">#%%   Preparatory run for VarPEq calculations (electron polaron).</span>
<span class="c1">#%%   Computation of electron-phonon matrix elements on 13x13x13, k/q-grid</span>
<span class="c1">#%%   using GSTORE with energy filtering.</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-06ccf232-d792-4c68-9136-6e6fff640bd8", "#uuid-593086b3-745f-4dd3-90d3-b747a006bf86") }); </script>

<p>As usual, run this example with:</p>
<div class="highlight"><pre><span></span><code>abinit<span class="w"> </span>teph4vpq_8.abi<span class="w"> </span>&gt;<span class="w"> </span>teph4vpq_8.log<span class="w"> </span><span class="m">2</span>&gt;<span class="w"> </span>err<span class="w"> </span><span class="p">&amp;</span>
</code></pre></div>
<p>While the calculation is running, let&rsquo;s examine the input file.
The main difference with our previous gstore runs, is the <a class="wikilink codevar-wikilink" href="/variables/eph#gstore_erange">gstore_erange</a> variable.
We use it to select the energy window near the CBM, so matrix elements <span class="arithmatex">\(g_{mn\nu}(\kk,\qq)\)</span>
will be computed <strong>ONLY</strong> for wavevectors <span class="arithmatex">\(\kk\)</span> and scattering <span class="arithmatex">\(\kk+\qq\)</span> inside this window.
Energy filtering may <strong>significantly</strong> reduce memory requirements and computational time.</p>
<p>Of course, we could have used <a class="wikilink codevar-wikilink" href="/variables/eph#gstore_brange">gstore_brange</a> to select the entire conduction band.
However, as large polarons are <strong>localized in reciprocal space</strong>, states contributing to the polaron formation,
are confined within an energy window near the band edge.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Of course, in production calculations, one has to perform convergence studies wrt <a class="wikilink codevar-wikilink" href="/variables/eph#gstore_erange">gstore_erange</a>.
This can be done at a fixed <span class="arithmatex">\(\kk/\qq\)</span>-mesh by increasing the energy window and monitoring the convergence
of the polaron energy terms.</p>
<p>In this example, 1 eV window is a bit too small for convergence.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>One can also use energy filtering at the step of computing the WFK files
to achieve extra-dense meshes.
See the corresponding section of the <a href="/tutorial/eph4mob">mobility tutorial</a>.</p>
</div>
<p>Once the <strong>GSTORE</strong> file has been computed, we can launch the variational optimization
(note that the <a class="wikilink codevar-wikilink" href="/variables/eph#vpq_pkind">vpq_pkind</a> is now &ldquo;electron&rdquo;, <strong>mandatory</strong>):</p>
<div class="text-center"><button id="uuid-f91c17f1-939f-4338-a55c-e21aa8fd3d73" class="md-button md-button--secondary"> View tests/tutorespfn/Input/teph4vpq_9.abi </button></div>
<div id="uuid-89d6c835-0270-4491-b9f4-26793024c726" class="my_dialog" title="tests/tutorespfn/Input/teph4vpq_9.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># LiF: computation of a large electron polaron on 13x13x13 k/q-grids</span>
<span class="c1"># with long-range Frohlich correction.</span>

<span class="w"> </span>optdriver<span class="w">  </span><span class="m">7</span><span class="w">   </span><span class="c1"># Electron-phonon driver</span>
<span class="w"> </span>eph_task<span class="w">   </span><span class="m">13</span><span class="w">  </span><span class="c1"># Activate the Variational Polaron Equations solver</span>

<span class="c1"># Variational Polaron Equations parameters</span>
<span class="w"> </span>vpq_pkind<span class="w">  </span><span class="s2">&quot;electron&quot;</span><span class="w">  </span><span class="c1"># Electron polaron</span>
<span class="w"> </span>vpq_tolgrs<span class="w">  </span>1e-7<span class="w">       </span><span class="c1"># Tolerance on the gradient norm</span>
<span class="w"> </span>vpq_nstep<span class="w">   </span><span class="m">100</span><span class="w">        </span><span class="c1"># Maximum number of optimization steps</span>

<span class="w"> </span><span class="c1"># these parameters are default but given here explicitly for clarity</span>
<span class="w"> </span>vpq_aseed<span class="w">      </span><span class="s2">&quot;gau_energy&quot;</span><span class="w">  </span><span class="c1"># Initial charge localization is Guassian-like</span>
<span class="w"> </span>vpq_gpr_energy<span class="w">  </span><span class="m">0</span>.<span class="w"> </span><span class="m">1</span>.<span class="w">        </span><span class="c1"># Gaussian parameters for initial charge</span>
<span class="w"> </span>vpq_nstates<span class="w">     </span><span class="m">1</span><span class="w">            </span><span class="c1"># Number of polaronic states</span>

<span class="c1"># Frohlich correction</span>
<span class="w"> </span>eph_frohl_ntheta<span class="w">  </span><span class="m">32</span><span class="w">   </span><span class="c1"># Number of divisions for the spherical integration of</span>
<span class="w">                        </span><span class="c1"># the long-range part of electron-phonon energy.</span>
<span class="w">                        </span><span class="c1"># Non-zero value activates the computation of Frohlich</span>
<span class="w">                        </span><span class="c1"># corrections.</span>
<span class="w">                        </span><span class="c1"># ntheta=32 gives the optimal number of divisions for the</span>
<span class="w">                        </span><span class="c1"># spherical integration.</span>

<span class="w"> </span>vpq_avg_g<span class="w">  </span><span class="m">1</span><span class="w">  </span><span class="c1"># Apply Frohlich correction to e-ph coupling</span>


<span class="c1"># Electron-phonon matrix elements (with energy filtering)</span>
<span class="w"> </span>getgstore_filepath<span class="w">  </span><span class="s2">&quot;teph4vpq_8o_GSTORE.nc&quot;</span><span class="w"> </span><span class="c1"># 13x13x13 k/q-mesh</span>

<span class="c1"># Wavefunction</span>
<span class="c1"># Read the WFK file from the preparatory run</span>
<span class="w"> </span>getwfk_filepath<span class="w">  </span><span class="s2">&quot;teph4vpq_2o_DS4_WFK&quot;</span><span class="w">  </span><span class="c1"># 13x13x13 k-mesh</span>

<span class="w"> </span>ngkpt<span class="w">    </span><span class="m">13</span><span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">13</span><span class="w">  </span><span class="c1"># These parameters have to consistent with the WFK file</span>

<span class="w"> </span>kptopt<span class="w">   </span><span class="m">1</span>
<span class="w"> </span>nshiftk<span class="w">  </span><span class="m">1</span>
<span class="w"> </span>shiftk<span class="w">   </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
<span class="w"> </span>nband<span class="w">    </span><span class="m">6</span>
<span class="w"> </span>ecut<span class="w">     </span><span class="m">30</span>

<span class="c1"># Phonons</span>
<span class="w"> </span>ddb_ngqpt<span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w">          </span><span class="c1"># This has to be consistent with the DDB file</span>
<span class="w"> </span>getddb_filepath
<span class="w"> </span><span class="s2">&quot;LiF_eph_varpeq/out_DDB&quot;</span><span class="w">  </span><span class="c1"># Read the precomputed DDB stored in git submodule</span>
<span class="w">                           </span><span class="c1"># NOTE: for the input parameters used to produce</span>
<span class="w">                           </span><span class="c1"># the DDB file, consult the LiF_eph_varpeq/dfpt.abi</span>

<span class="c1"># Pseudopotentials</span>
<span class="w"> </span>pp_dirpath<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">/Psdj_nc_sr_05_pbe_std_psp8&quot;</span>
<span class="w"> </span>pseudos<span class="w"> </span><span class="s2">&quot;Li.psp8, F.psp8&quot;</span>

<span class="c1"># Structure</span>
<span class="w"> </span>natom<span class="w">   </span><span class="m">2</span>
<span class="w"> </span>ntypat<span class="w">  </span><span class="m">2</span>
<span class="w"> </span>typat<span class="w">   </span><span class="m">1</span><span class="w"> </span><span class="m">2</span>
<span class="w"> </span>znucl<span class="w">   </span><span class="m">3</span><span class="w"> </span><span class="m">9</span>
<span class="w"> </span>xred<span class="w">    </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.0
<span class="w">         </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5

<span class="w"> </span>acell<span class="w"> </span><span class="m">3</span>*7.675
<span class="w"> </span>rprim<span class="w"> </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5
<span class="w">       </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.5
<span class="w">       </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% exclude_builders = eos_nvhpc_*</span>
<span class="c1">#%% test_chain = teph4vpq_1.abi, teph4vpq_2.abi, teph4vpq_3.abi,</span>
<span class="c1">#%%              teph4vpq_4.abi, teph4vpq_5.abi, teph4vpq_6.abi,</span>
<span class="c1">#%%              teph4vpq_7.abi, teph4vpq_8.abi, teph4vpq_9.abi,</span>
<span class="c1">#%%              teph4vpq_10.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% use_git_submodule = LiF_eph_varpeq</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   teph4vpq_9.abo, tolnlines = 60, tolabs = 1e-4, tolrel = 5e-2</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 10</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = V. Vasilchenko</span>
<span class="c1">#%% keywords = DFPT, EPH, POLARON</span>
<span class="c1">#%% description =</span>
<span class="c1">#%%   LiF, Fm-3m space group.</span>
<span class="c1">#%%   Computation of a large electron polaron on 13x13x13 k/q-grid</span>
<span class="c1">#%%   via Variational Polaron Equations with long-range Frohlich</span>
<span class="c1">#%%   correction and energy filtering.</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-89d6c835-0270-4491-b9f4-26793024c726", "#uuid-f91c17f1-939f-4338-a55c-e21aa8fd3d73") }); </script>

<div class="highlight"><pre><span></span><code>abinit<span class="w"> </span>teph4vpq_9.abi<span class="w"> </span>&gt;<span class="w"> </span>teph4vpq_9.log<span class="w"> </span><span class="m">2</span>&gt;<span class="w"> </span>err<span class="w"> </span><span class="p">&amp;</span>
</code></pre></div>
<details class="note">
<summary>Exercise</summary>
<p>Try using AbiPy to analyze to results stored in the teph4vpq_9o_VPQ.nc file
the same we have demonstrated for small polarons.
Do these results match your expectations?
Keep in mind that our calculations are underconverged.</p>
<p>Of course, skip the extrapolation part, as we have not computed large polarons on
progressively increasing meshes.
Or do these calculations yourself if you are intrested!</p>
</details>
<p>Finally, we can visualize the large polaron via the following input</p>
<div class="text-center"><button id="uuid-16050ebd-589d-4360-a63b-164b7528482c" class="md-button md-button--secondary"> View tests/tutorespfn/Input/teph4vpq_10.abi </button></div>
<div id="uuid-be7361e4-737c-405b-bd19-3c7b58bc733d" class="my_dialog" title="tests/tutorespfn/Input/teph4vpq_10.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># LiF: visualization of a large electron polaron computed on a 13x13x13 k/q-grid.</span>

<span class="w"> </span>optdriver<span class="w">  </span><span class="m">7</span><span class="w">   </span><span class="c1"># Electron-phonon driver</span>
<span class="w"> </span>eph_task<span class="w">  </span>-13<span class="w">  </span><span class="c1"># Activate the Variational Polaron Equations visualization</span>

<span class="w"> </span>vpq_trvec<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">6</span><span class="w">  </span><span class="c1"># Translate the polaronic solution for visualization</span>

<span class="w"> </span>vpq_mesh_fact<span class="w"> </span><span class="m">5</span><span class="w">  </span><span class="c1"># &gt;1 decreases the resolution of the polaron wavefunction</span>
<span class="w">                  </span><span class="c1"># *xsf file and reduces memory requirements</span>
<span class="w">                  </span><span class="c1"># (default: 1)</span>

<span class="c1"># Variational Polaron Equations results from the previous run</span>
<span class="w"> </span>getvpq_filepath<span class="w"> </span><span class="s2">&quot;teph4vpq_9o_VPQ.nc&quot;</span>

<span class="c1"># Electron-phonon matrix elements</span>
<span class="w"> </span>getgstore_filepath<span class="w"> </span><span class="s2">&quot;teph4vpq_8o_GSTORE.nc&quot;</span><span class="w"> </span><span class="c1"># 13x13x13 k/q-mesh</span>

<span class="c1"># Wavefunction</span>
<span class="c1"># Read the WFK file from the preparatory run</span>
<span class="w"> </span>getwfk_filepath<span class="w"> </span><span class="s2">&quot;teph4vpq_2o_DS4_WFK&quot;</span><span class="w">  </span><span class="c1"># 13x13x13 k-mesh</span>

<span class="w"> </span>ngkpt<span class="w">    </span><span class="m">13</span><span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">13</span><span class="w">  </span><span class="c1"># These parameters have to consistent with the WFK file</span>

<span class="w"> </span>kptopt<span class="w">   </span><span class="m">1</span>
<span class="w"> </span>nshiftk<span class="w">  </span><span class="m">1</span>
<span class="w"> </span>shiftk<span class="w">   </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
<span class="w"> </span>nband<span class="w">    </span><span class="m">6</span>
<span class="w"> </span>ecut<span class="w">     </span><span class="m">30</span>

<span class="c1"># Phonons</span>
<span class="w"> </span>ddb_ngqpt<span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w">          </span><span class="c1"># This has to be consistent with the DDB file</span>
<span class="w"> </span>getddb_filepath
<span class="w"> </span><span class="s2">&quot;LiF_eph_varpeq/out_DDB&quot;</span><span class="w">  </span><span class="c1"># Read the precomputed DDB stored in git submodule</span>
<span class="w">                           </span><span class="c1"># NOTE: for the input parameters used to produce</span>
<span class="w">                           </span><span class="c1"># the DDB file, consult the LiF_eph_varpeq/dfpt.abi</span>

<span class="c1"># Scattering potentials</span>
<span class="w"> </span>getdvdb_filepath
<span class="w"> </span><span class="s2">&quot;teph4vpq_1_DVDB&quot;</span><span class="w">  </span><span class="c1"># Read the DVDB file from the preparatory run</span>

<span class="c1"># Pseudopotentials</span>
<span class="w"> </span>pp_dirpath<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">/Psdj_nc_sr_05_pbe_std_psp8&quot;</span>
<span class="w"> </span>pseudos<span class="w"> </span><span class="s2">&quot;Li.psp8, F.psp8&quot;</span>

<span class="c1"># Structure</span>
<span class="w"> </span>natom<span class="w">   </span><span class="m">2</span>
<span class="w"> </span>ntypat<span class="w">  </span><span class="m">2</span>
<span class="w"> </span>typat<span class="w">   </span><span class="m">1</span><span class="w"> </span><span class="m">2</span>
<span class="w"> </span>znucl<span class="w">   </span><span class="m">3</span><span class="w"> </span><span class="m">9</span>
<span class="w"> </span>xred<span class="w">    </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.0
<span class="w">         </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5

<span class="w"> </span>acell<span class="w"> </span><span class="m">3</span>*7.675
<span class="w"> </span>rprim<span class="w"> </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5
<span class="w">       </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.5
<span class="w">       </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% exclude_builders = eos_nvhpc_*</span>
<span class="c1">#%% test_chain = teph4vpq_1.abi, teph4vpq_2.abi, teph4vpq_3.abi,</span>
<span class="c1">#%%              teph4vpq_4.abi, teph4vpq_5.abi, teph4vpq_6.abi,</span>
<span class="c1">#%%              teph4vpq_7.abi, teph4vpq_8.abi, teph4vpq_9.abi,</span>
<span class="c1">#%%              teph4vpq_10.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% use_git_submodule = LiF_eph_varpeq</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   teph4vpq_10.abo, tolnlines = 50, tolabs = 6e-4, tolrel = 1e-1</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 10</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = V. Vasilchenko</span>
<span class="c1">#%% keywords = DFPT, EPH, POLARON</span>
<span class="c1">#%% description =</span>
<span class="c1">#%%   LiF, Fm-3m space group.</span>
<span class="c1">#%%   Visualization of a large electron polaron computed on a 13x13x13 k/q-grid.</span>
<span class="c1">#%%   with energy filtering.</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-be7361e4-737c-405b-bd19-3c7b58bc733d", "#uuid-16050ebd-589d-4360-a63b-164b7528482c") }); </script>

<div class="highlight"><pre><span></span><code>abinit<span class="w"> </span>teph4vpq_10.abi<span class="w"> </span>&gt;<span class="w"> </span>teph4vpq_10.log<span class="w"> </span><span class="m">2</span>&gt;<span class="w"> </span>err<span class="w"> </span><span class="p">&amp;</span>
</code></pre></div>
<p>This produces usual <code>*xsf</code> files that can be used for viauslization.
If we open <code>teph4vpq_10o_pstate_1_POLARON.xsf</code> in VESTA, the following charge distribution can bee seen:</p>
<p><img alt="" src="../eph4vpq_assets/LiF_large.png" /></p>
<!--
-->







  
  






                

<!--
Add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
               <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
               <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
               <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li>
            <a href="https://gmatteo.github.io/abinit/about/release-notes/"
               data-toggle="popover" data-tippy-content="About">
               <i class="fa fa-info-circle"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/developers/git_and_gitlab/"
               data-toggle="popover" data-tippy-content="Developers">
               <i class="fa fa-terminal"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/theory/geometry/"
               data-toggle="popover" data-tippy-content="Theory">
               <i class="fa fa-book"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/faq/configuration_and_compilation/"
               data-toggle="popover" data-tippy-content="FAQ">
               <i class="fa fa-graduation-cap"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/tutorial/"
               data-toggle="popover" data-tippy-content="Tutorials">
               <i class="fa fa-file-text-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/variables/"
               data-toggle="popover" data-tippy-content="Variables">
               <i class="fa fa-question"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/topics/features/"
               data-toggle="popover" data-tippy-content="Topics">
               <i class="fa fa-user-circle-o"></i>
            </a>
          </li>
        
          <li>
            <a href=""
               data-toggle="popover" data-tippy-content="User Guides">
               <i class="fa "></i>
            </a>
          </li>
        
        </ul>
      </div>
    </div>
  </div>
</div>

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="footer.title">
      
        <a href="../eph4zpr/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              eph for zero-point renormalization
            </div>
          </div>
        </a>
      
      
        <a href="../eph_legacy/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              eph_legacy
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 10.4.7</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020-2024 The Abinit Group
            
            (VV)
            
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/abinit/abinit" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305m-317.51 213.508V175.185l142.739 81.205z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="http://www.facebook.com/abinit.org" target="_blank" rel="noopener" title="www.facebook.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256c0 120 82.7 220.8 194.2 248.5V334.2h-52.8V256h52.8v-33.7c0-87.1 39.4-127.5 125-127.5 16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287v175.9C413.8 494.8 512 386.9 512 256"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/hashtag/abinit" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
</div>
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "header.autohide"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": "10.4.7"}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
  </body>
</html>