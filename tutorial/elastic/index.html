
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Abinit documentation">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <link rel="canonical" href="https://gmatteo.github.io/abinit/tutorial/elastic/">
      
      
        <link rel="prev" href="../rttddft/">
      
      
        <link rel="next" href="../nlo/">
      
      
      <link rel="icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.43">
    
    
      
        <title>elastic - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
    
      
    

    <!--
    IMPORTANT: Don't use boostrap in particular boostrap.css since it comes into conflict with mkdocs-material theme.
    Prefer low-level tools based on Jquery or JS library such as Tippyjs to get the work done.
    -->

    <!-- Jquery from Google CDN -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>
    -->

    <!-- jQuery Modal -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />

    <!-- Tippyjs for popovers https://atomiks.github.io/tippyjs/ -->
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />

    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <!-- MathJax support
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    -->

    <!-- This version is compatible with plotly. -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script>

    <!-- Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "boldsymbol.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // Workaround for bm package. See https://github.com/mathjax/MathJax/issues/1219
                bm: ["{\\boldsymbol #1}",1],
                // Mathcal symbols
                mcL: "{\\mathcal{L}}",
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // Acronyms
                KS: "{\\text{KS}}",
                eph: "{\\text{e-ph}}",
                ee: "{\\text{e-e}}",
                phph: "{\\text{ph-ph}}",
                FM: "{\\text{FM}}",
                DW: "{\\text{DW}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // Symbols commonly used (k-points, eigenvalues ...)
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                bg: "{\\bf g}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kG: "{\\bf k + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                nk: "{n \\kk}",
                mk: "{, \\kk}",
                nks: "{n \\kk\\sigma}",
                mks: "{m \\kk\\sigma}",
                enk: "{\\varepsilon_\\nk}",
                emkq: "{\\varepsilon_{m\\kk+\\qq}}",
                qnu: "{\\qq \\nu}",
                wqnu: "{\\omega_{\\qnu}}",
                vnk: "{\\mathbf{v}_{n\\kk}}",
                vmkq: "{\\mathbf{v}_{m\\kk+\\qq}}",
                vnka: "{\\mathrm{v}_{n\\kk,\\alpha}}",
                vnkb: "{\\mathrm{v}_{n\\kk,\\beta}}",
                ef: "{\\varepsilon_F}",
                // EPH quantities
                gkkp: "{g_{mn\\nu}(\\kk,\\qq)}",
                gkq: "{g_{mn\\nu}(\\kk,\\qq)}",
                //\newcommand{\gkkpL}{g_{mn\nu}^\Lc(\kb,\qb)}
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                Gove: "{\\overline{G}}",
                Gund: "{\\underline{G}}",
                // Greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    

    

    <!-- Load fonts used for input variables -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tutorial-on-elastic-properties" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="abinit" class="md-header__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            abinit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              elastic
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../installation/" class="md-tabs__link">
          
  
  User Guides

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../topics/features/" class="md-tabs__link">
          
  
  Topics

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../variables/" class="md-tabs__link">
          
  
  Variables

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../faq/configuration_and_compilation/" class="md-tabs__link">
          
  
  FAQ

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../theory/geometry/" class="md-tabs__link">
          
  
  Theory

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../developers/git_and_gitlab/" class="md-tabs__link">
          
  
  Developers

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../about/release-notes/" class="md-tabs__link">
          
  
  About

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="abinit" class="md-nav__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    abinit
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    User Guides
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            User Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_1" >
        
          
          <label class="md-nav__link" for="__nav_1_1" id="__nav_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Installation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_1">
            <span class="md-nav__icon md-icon"></span>
            Installation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HowTo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_MacOS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MacOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_Ubuntu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ubuntu
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_CentOS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CentOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_EasyBuild/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EasyBuild
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_gpu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GPUs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NewUser
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abitk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abitk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/aim/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aim
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/anaddb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Anaddb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/atdep/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aTDEP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/cut3d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cut3d
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/fold2bloch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fold2Bloch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgddb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mrgddb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgscr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mrgscr
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/multibinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multibinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/optic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/respfn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Respfn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/spacegroup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spacegroup
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Topics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Topics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Topic List
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Abipy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abipy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/APPA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    APPA
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Artificial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Artificial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/aTDEP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aTDEP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomCentered/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AtomCentered
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomManipulator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AtomManipulator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomTypes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AtomTypes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Bader/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bader
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Band2eps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Band2eps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Berry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Berry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BandOcc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BandOcc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BSE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BSE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BoundingProcess/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BoundingProcess
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedDFT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ConstrainedDFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedPol/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ConstrainedPol
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Coulomb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coulomb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CrossingBarriers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CrossingBarriers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CalcUJ/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CalcUJ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/crystal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Crystal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFT%2BU/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFT+U
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DeltaSCF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DeltaSCF
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DensityPotential/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DensityPotential
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Dev/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dev
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFPT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DMFT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DMFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DynamicsMultibinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DynamicsMultibinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EffectiveMass/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EffectiveMass
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EFG/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EFG
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Elastic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Elastic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonInt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ElPhonInt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonTransport/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ElPhonTransport
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecDOS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ElecDOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecBandStructure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ElecBandStructure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ExtFPMD/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ExtFPMD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FileFormats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FileFormats
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FitProcess/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FitProcess
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ForcesStresses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForcesStresses
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FrequencyMeshMBPT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FrequencyMeshMBPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoConstraints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GeoConstraints
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoOpt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GeoOpt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Git/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GSintroduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GSintroduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GW/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWR/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GWR
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWls/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GWls
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Hybrids/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hybrids
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/k-points/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    K points
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeModel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LatticeModel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeWannier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LatticeWannier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LWFModel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LWFModel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LDAminushalf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LDAminushalf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LOTF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LOTF
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/longwave/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Longwave
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Macroave/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Macroave
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagField/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MagField
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagMom/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MagMom
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MolecularDynamics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MolecularDynamics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/multidtset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multidtset
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/NMR/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NMR
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/nonlinear/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nonlinear
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Optic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Output/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Output
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/parallelism/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallelism
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PAW/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PAW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PIMD/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PIMD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Planewaves/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Planewaves
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Phonons/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phonons
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononBands/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PhononBands
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononWidth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PhononWidth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Polaron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Polaron
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PortabilityNonRegression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PortabilityNonRegression
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/positron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Positron
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/printing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Printing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PseudosPAW/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PseudosPAW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/q-points/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Q points
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RandStopPow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RandStopPow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Recursion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Recursion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RPACorrEn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RPACorrEn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RTTDDFT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RTTDDFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFControl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SCFControl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFAlgorithms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SCFAlgorithms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SelfEnergy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SelfEnergy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SmartSymm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SmartSymm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/spinpolarisation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spinpolarisation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SpinDynamicsMultibinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SpinDynamicsMultibinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/STM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    STM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Susceptibility/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Susceptibility
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDDFT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TDDFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDepES/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TDepES
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Temperature/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Temperature
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TransPath/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TransPath
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TuningSpeedMem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TuningSpeedMem
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Unfolding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unfolding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/UnitCell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UnitCell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/vdw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vdw
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Verification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Verification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wannier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wannier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wavelets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wavelets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/xc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Xc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/external_resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    External Resources
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Variables
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Variables
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    All Variables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Abinit
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Abinit
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/basic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/bse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bethe-Salpeter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dev/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dmft/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DMFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/eph/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Electron-Phonon
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/ffield/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Varff
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File-handling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/geo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geometry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/gstate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ground-State
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/gw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/internal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Internal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/paral/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallelism
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/paw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PAW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dfpt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/rlx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Relaxation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/rttddft/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RTTDDFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/vdw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VdW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/w90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wannier90
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/anaddb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Anaddb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/atdep/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aTDEP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/multibinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multibinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/optic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/aim/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aim
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/external_parameters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    External Parameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/varset_stats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Statistics
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Basic tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Basic tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../base1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    basic1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../base2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    basic2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../base3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    basic3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../base4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    basic4
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../abinit_build/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ABINIT_build
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paw1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PAW1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../polarization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Polarization & finite field
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rf1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFPT1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rf2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFPT2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basepar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallelism
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_10" >
        
          
          <label class="md-nav__link" for="__nav_4_10" id="__nav_4_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ABINIT postprocessors
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_10">
            <span class="md-nav__icon md-icon"></span>
            ABINIT postprocessors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../atdep1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aTDEP1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cut3d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cut3D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fold2bloch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fold2bloch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../optic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    optic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wannier90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wannier90
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../z2pack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Z2pack
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_11" >
        
          
          <label class="md-nav__link" for="__nav_4_11" id="__nav_4_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DFT beyond basics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_11">
            <span class="md-nav__icon md-icon"></span>
            DFT beyond basics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nuc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    properties at the nucleus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dftu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFT+U
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ucalc_crpa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cRPA U(J)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lruj/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linear Response U(J)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paw2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PAW2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paw3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PAW3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../positron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    positron
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_12" >
        
          
          <label class="md-nav__link" for="__nav_4_12" id="__nav_4_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Many-Body Theory & excitations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_12">
            <span class="md-nav__icon md-icon"></span>
            Many-Body Theory & excitations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gw1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GW1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gw2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GW2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gwr_intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GWR_intro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gwr1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GWR1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bethe-Salpeter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dmft/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DMFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tddft/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TDDFT (Casida)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rttddft/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RT-TDDFT
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_13" checked>
        
          
          <label class="md-nav__link" for="__nav_4_13" id="__nav_4_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DFPT & electron-phonon
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_13_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_13">
            <span class="md-nav__icon md-icon"></span>
            DFPT & electron-phonon
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    elastic
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    elastic
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#elastic-and-piezoelectric-properties" class="md-nav__link">
    <span class="md-ellipsis">
      Elastic and piezoelectric properties.
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-the-ground-state-geometry-of-hypothetical-wurtzite-alp" class="md-nav__link">
    <span class="md-ellipsis">
      1 The ground-state geometry of (hypothetical) wurtzite AlP
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-response-function-calculations-of-several-second-derivatives-of-the-total-energy" class="md-nav__link">
    <span class="md-ellipsis">
      2 Response-function calculations of several second derivatives of the total energy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-anaddb-calculation-of-atom-relaxation-effects" class="md-nav__link">
    <span class="md-ellipsis">
      3 ANADDB calculation of atom-relaxation effects
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-finite-difference-calculation-of-elastic-and-piezoelectric-constants" class="md-nav__link">
    <span class="md-ellipsis">
      4 Finite-difference calculation of elastic and piezoelectric constants
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-alternative-dfpt-calculation-of-some-piezoelectric-constants" class="md-nav__link">
    <span class="md-ellipsis">
      5 Alternative DFPT calculation of some piezoelectric constants
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-response-function-calculation-of-the-elastic-constants-of-al-metal" class="md-nav__link">
    <span class="md-ellipsis">
      6 Response-function calculation of the elastic constants of Al metal
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6 Response-function calculation of the elastic constants of Al metal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#comment-on-symmetry" class="md-nav__link">
    <span class="md-ellipsis">
      Comment on symmetry
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nlo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nonlinear
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lattice_wannier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lattice_wannier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lw_quad/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    quadrupoles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eph_intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph_intro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eph4mob/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph for mobilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eph4zpr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph for zero-point renormalization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eph4vpq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph for variational polaron equations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eph_legacy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph_legacy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eph_tdep_legacy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph_tdep_legacy
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_14" >
        
          
          <label class="md-nav__link" for="__nav_4_14" id="__nav_4_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Multibinit
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_14">
            <span class="md-nav__icon md-icon"></span>
            Multibinit
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../multibinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    introduction to multibinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lattice_model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lattice_model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spin_model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spin_model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lwf_model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lwf_model
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_15" >
        
          
          <label class="md-nav__link" for="__nav_4_15" id="__nav_4_15_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Advanced parallelism
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_15">
            <span class="md-nav__icon md-icon"></span>
            Advanced parallelism
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paral_bandpw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_band_PW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paral_gswvl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_wavelets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paral_moldyn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_MD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paral_images/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_images
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paral_dfpt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_DFPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paral_mbt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_MBPT
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            FAQ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/configuration_and_compilation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration and compilation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/general_questions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General questions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/pre_and_post_processing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pre/Post processing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/ground_state/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ground state
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/dfpt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/Troubleshooting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Troubleshooting (old-dokuwiki)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/tuning_abinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tuning (old-dokuwiki)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Theory
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Theory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/geometry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geometry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/spherical_harmonics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spherical Harmonics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/wavefunctions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wavefunctions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/noncollinear/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Noncollinear
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/pseudopotentials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pseudopotentials
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/mbt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Many-Body Perturbation Theory
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bethe-Salpeter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/documents/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Documents
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acknowledgments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Acknowledgments
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bibliography/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bibliography
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acronyms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Acronyms
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Developers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Developers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/git_and_gitlab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git and Gitlab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/developers_howto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HowTo for developers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/abimkdocs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abimkdocs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/markdown/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Markdown
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_5" >
        
          
          <label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Test Suite
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_5">
            <span class="md-nav__icon md-icon"></span>
            Test Suite
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test list
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite_howto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Suite Howto
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/new_testsuite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YAML-based test suite Howto
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/yaml_tools_api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YAML-based test suite Python tools and API
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/XgType/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XgType
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_7" >
        
          
          <label class="md-nav__link" for="__nav_7_7" id="__nav_7_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pseudos
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_7">
            <span class="md-nav__icon md-icon"></span>
            Pseudos
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp1_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp3_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp45_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp45
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp5spinorbit_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp5
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp6_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp6
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp8_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp8
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/codestats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code stats
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/autoconf_examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Autoconf_examples
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testlink/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Page for linkcheck
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    About
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            About
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/release-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release Notes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/history/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    History
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#elastic-and-piezoelectric-properties" class="md-nav__link">
    <span class="md-ellipsis">
      Elastic and piezoelectric properties.
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-the-ground-state-geometry-of-hypothetical-wurtzite-alp" class="md-nav__link">
    <span class="md-ellipsis">
      1 The ground-state geometry of (hypothetical) wurtzite AlP
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-response-function-calculations-of-several-second-derivatives-of-the-total-energy" class="md-nav__link">
    <span class="md-ellipsis">
      2 Response-function calculations of several second derivatives of the total energy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-anaddb-calculation-of-atom-relaxation-effects" class="md-nav__link">
    <span class="md-ellipsis">
      3 ANADDB calculation of atom-relaxation effects
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-finite-difference-calculation-of-elastic-and-piezoelectric-constants" class="md-nav__link">
    <span class="md-ellipsis">
      4 Finite-difference calculation of elastic and piezoelectric constants
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-alternative-dfpt-calculation-of-some-piezoelectric-constants" class="md-nav__link">
    <span class="md-ellipsis">
      5 Alternative DFPT calculation of some piezoelectric constants
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-response-function-calculation-of-the-elastic-constants-of-al-metal" class="md-nav__link">
    <span class="md-ellipsis">
      6 Response-function calculation of the elastic constants of Al metal
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6 Response-function calculation of the elastic constants of Al metal">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#comment-on-symmetry" class="md-nav__link">
    <span class="md-ellipsis">
      Comment on symmetry
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                

                  

  
  


<h1 id="tutorial-on-elastic-properties">Tutorial on elastic properties<a class="headerlink" href="#tutorial-on-elastic-properties" title="Permanent link">&para;</a></h1>
<h2 id="elastic-and-piezoelectric-properties">Elastic and piezoelectric properties.<a class="headerlink" href="#elastic-and-piezoelectric-properties" title="Permanent link">&para;</a></h2>
<p>This tutorial shows how to calculate physical properties related to strain, for
an insulator and a metal:</p>
<ul>
<li>the rigid-atom elastic tensor</li>
<li>the rigid-atom piezoelectric tensor (insulators only)</li>
<li>the internal strain tensor</li>
<li>the atomic relaxation corrections to the elastic and piezoelectric tensor</li>
</ul>
<p>You should complete tutorials <a href="/tutorial/rf1">RF1</a> and <a href="/tutorial/rf2">RF2</a>
to introduce the density-functional perturbation theory (DFPT) features of
ABINIT before starting this tutorial. You will learn to use additional DFPT
features of ABINIT, and to use relevant parts of the associated codes Mrgddb and Anaddb.</p>
<p>Visualisation tools are NOT covered in this tutorial.
Powerful visualisation procedures have been developed in the Abipy context,
relying on matplotlib. See the README of <a href="https://github.com/abinit/abipy">Abipy</a>
and the <a href="https://github.com/abinit/abitutorials">Abipy tutorials</a>.</p>
<p>This tutorial should take about two hours.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Supposing you made your own installation of ABINIT, the input files to run the examples
are in the <em>~abinit/tests/</em> directory where <em>~abinit</em> is the <strong>absolute path</strong> of the abinit top-level directory.
If you have NOT made your own install, ask your system administrator where to find the package,
especially the executable and test files.</p>
<p>In case you work on your own PC or workstation, to make things easier, we suggest you define
some handy environment variables by executing the following lines in the terminal:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">ABI_HOME</span><span class="o">=</span>Replace_with_absolute_path_to_abinit_top_level_dir<span class="w"> </span><span class="c1"># Change this line</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/src/98_main/:<span class="nv">$PATH</span><span class="w">      </span><span class="c1"># Do not change this line: path to executable</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">ABI_TESTS</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/tests/<span class="w">             </span><span class="c1"># Do not change this line: path to tests dir</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">ABI_PSPDIR</span><span class="o">=</span><span class="nv">$ABI_TESTS</span>/Pspdir/<span class="w">  </span><span class="c1"># Do not change this line: path to pseudos dir</span>
</code></pre></div>
<p>Examples in this tutorial use these shell variables: copy and paste
the code snippets into the terminal (<strong>remember to set ABI_HOME first!</strong>) or, alternatively,
source the <code>set_abienv.sh</code> script located in the <em>~abinit</em> directory:</p>
<div class="highlight"><pre><span></span><code><span class="nb">source</span><span class="w"> </span>~abinit/set_abienv.sh
</code></pre></div>
<p>The &lsquo;export PATH&rsquo; line adds the directory containing the executables to your <a href="http://www.linfo.org/path_env_var.html">PATH</a>
so that you can invoke the code by simply typing <em>abinit</em> in the terminal instead of providing the absolute path.</p>
<p>To execute the tutorials, create a working directory (<code>Work*</code>) and
copy there the input files of the lesson.</p>
<p>Most of the tutorials do not rely on parallelism (except specific <a class="wikilink lesson-wikilink" href="/tutorial/basepar">tutorials on parallelism</a>).
However you can run most of the tutorial examples in parallel with MPI, see the <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a parallel calculation" data-toggle="popover" href="/topics/parallelism">topic on parallelism</a>.</p>
</div>
<h2 id="1-the-ground-state-geometry-of-hypothetical-wurtzite-alp">1 The ground-state geometry of (hypothetical) wurtzite AlP<a class="headerlink" href="#1-the-ground-state-geometry-of-hypothetical-wurtzite-alp" title="Permanent link">&para;</a></h2>
<p><em>Before beginning, you might consider working in a different subdirectory as for the other tutorials.
Why not create Work_elast in $ABI_TESTS/tutorespfn/Input?</em>
You should also copy the file <em>telast_1.abi</em> from <em>$ABI_TESTS/tutorespfn/Input</em> to <em>Work_elast</em>.</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span><span class="nv">$ABI_TESTS</span>/tutorespfn/Input
mkdir<span class="w"> </span>Work_elast
<span class="nb">cd</span><span class="w"> </span>Work_elast
cp<span class="w"> </span>../telast_1.abi<span class="w"> </span>.
</code></pre></div>
<p>You may wish to start the calculation (less than
one minute on a standard 3GHz machine) before you read the following.</p>
<div class="codehilite"><pre><span></span><code>abinit telast_1.abi &gt; telast_1.log &amp;
</code></pre></div>

<p>Then, you should open your input file <em>telast_1.abi</em> with an editor and examine it as you read this discussion.</p>
<div class="text-center"><button id="uuid-594ea24d-629a-40a3-b028-e5fd3f8b37b4" class="md-button md-button--secondary"> View tests/tutorespfn/Input/telast_1.abi </button></div>
<div id="uuid-54a09ec0-c051-4415-b888-8e35859b4577" class="my_dialog" title="tests/tutorespfn/Input/telast_1.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#AlAs in hypothetical wurzite (hexagonal) structure</span>
<span class="c1">#Structural optimization run</span>

<span class="w">   </span>ndtset<span class="w">   </span><span class="m">2</span><span class="w">       </span><span class="c1"># There are 2 datasets in this calculation</span>

<span class="c1"># Set 1 : Internal coordinate optimization</span>

<span class="w">  </span>geoopt1<span class="w">   </span><span class="s2">&quot;bfgs&quot;</span><span class="w">  </span><span class="c1"># Use BFGS algorithm for structural optimization</span>
<span class="w">   </span>ntime1<span class="w">   </span><span class="m">5</span><span class="w">       </span><span class="c1"># Maximum number of optimization steps</span>
<span class="w">  </span>tolmxf1<span class="w">   </span><span class="m">1</span>.0e-6<span class="w">  </span><span class="c1"># Optimization is converged when maximum force</span>
<span class="w">                    </span><span class="c1"># (Hartree/Bohr) is less than this maximum</span>
<span class="w">  </span>natfix1<span class="w">   </span><span class="m">2</span><span class="w">       </span><span class="c1"># Fix the position of two symmetry-equivalent atoms</span>
<span class="w">                    </span><span class="c1">#  in doing the structural optimization</span>
<span class="w">  </span>iatfix1<span class="w">   </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w">     </span><span class="c1"># Choose atoms 1 and 2 as the fixed atoms (see discussion)</span>

<span class="c1"># Set 2 : Lattice parameter relaxation (including re-optimization of</span>
<span class="c1">#         internal coordinates)</span>

<span class="w"> </span>dilatmx2<span class="w">   </span><span class="m">1</span>.05<span class="w">    </span><span class="c1"># Maximum scaling allowed for lattice parameters</span>
<span class="w"> </span>getxred2<span class="w">   </span>-1<span class="w">      </span><span class="c1"># Start with relaxed coordinates from dataset 1</span>
<span class="w">  </span>getwfk2<span class="w">   </span>-1<span class="w">      </span><span class="c1"># Start with wave functions from dataset 1</span>
<span class="w">  </span>geoopt2<span class="w">   </span><span class="s2">&quot;bfgs&quot;</span><span class="w">  </span><span class="c1"># Use BFGS algorithm</span>
<span class="w">   </span>ntime2<span class="w">   </span><span class="m">14</span><span class="w">      </span><span class="c1"># Maximum number of optimization steps</span>
<span class="w"> </span>optcell2<span class="w">   </span><span class="m">2</span><span class="w">       </span><span class="c1"># Fully optimize unit cell geometry, keeping symmetry</span>
<span class="w">  </span>tolmxf2<span class="w">   </span><span class="m">1</span>.0e-6<span class="w">  </span><span class="c1"># Convergence limit for forces as above</span>
<span class="w"> </span>strfact2<span class="w">   </span><span class="m">100</span><span class="w">     </span><span class="c1"># Test convergence of stresses (Hartree/bohr^3) by</span>
<span class="w">                    </span><span class="c1"># multiplying by this factor and applying force</span>
<span class="w">                    </span><span class="c1"># convergence test</span>
<span class="w">  </span>natfix2<span class="w">   </span><span class="m">2</span>
<span class="w">  </span>iatfix2<span class="w">   </span><span class="m">1</span><span class="w"> </span><span class="m">2</span>

<span class="c1">#Common input data</span>

<span class="c1">#Starting approximation for the unit cell</span>
<span class="w">  </span>acell<span class="w">   </span><span class="m">7</span>.5<span class="w">  </span><span class="m">7</span>.5<span class="w">  </span><span class="m">12</span>.263388<span class="w">           </span><span class="c1">#this is a guess, with the c/a</span>
<span class="w">                                        </span><span class="c1">#ratio based on ideal tetrahedral</span>
<span class="w">                                        </span><span class="c1">#bond angles</span>

<span class="w">  </span>rprim<span class="w">   </span><span class="m">0</span>.866025403784439<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0<span class="w">   </span><span class="c1">#hexagonal primitive vectors must be</span>
<span class="w">         </span>-0.866025403784439<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0<span class="w">   </span><span class="c1">#specified with high accuracy to be</span>
<span class="w">          </span><span class="m">0</span>.0<span class="w">                </span><span class="m">0</span>.0<span class="w">  </span><span class="m">1</span>.0<span class="w">   </span><span class="c1">#sure that the symmetry is recognized</span>
<span class="w">                                        </span><span class="c1">#and preserved in the optimization</span>
<span class="w">                                        </span><span class="c1">#process</span>

<span class="c1">#Definition of the atom types and atoms</span>
<span class="w"> </span>ntypat<span class="w">   </span><span class="m">2</span>
<span class="w">  </span>znucl<span class="w">   </span><span class="m">13</span><span class="w"> </span><span class="m">15</span>
<span class="w">  </span>natom<span class="w">   </span><span class="m">4</span>
<span class="w">  </span>typat<span class="w">   </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span>

<span class="c1">#Starting approximation for atomic positions in REDUCED coordinates</span>
<span class="c1">#based on ideal tetrahedral bond angles</span>
<span class="w">   </span>xred<span class="w">   </span><span class="m">1</span>/3<span class="w">  </span><span class="m">2</span>/3<span class="w">  </span><span class="m">0</span>.0
<span class="w">          </span><span class="m">2</span>/3<span class="w">  </span><span class="m">1</span>/3<span class="w">  </span><span class="m">0</span>.5
<span class="w">          </span><span class="m">1</span>/3<span class="w">  </span><span class="m">2</span>/3<span class="w">  </span><span class="m">0</span>.375
<span class="w">          </span><span class="m">2</span>/3<span class="w">  </span><span class="m">1</span>/3<span class="w">  </span><span class="m">0</span>.875

<span class="c1">#Gives the number of bands, explicitely (do not take the default)</span>
<span class="w">  </span>nband<span class="w">   </span><span class="m">8</span><span class="w">              </span><span class="c1"># For an insulator (if described correctly as an</span>
<span class="w">                         </span><span class="c1"># insulator by DFT), conduction bands should not</span>
<span class="w">                         </span><span class="c1"># be included in response-function calculations</span>

<span class="c1">#Definition of the plane wave basis set</span>
<span class="w">   </span>ecut<span class="w">   </span><span class="m">6</span>.0<span class="w">            </span><span class="c1"># Maximum kinetic energy cutoff (Hartree)</span>
<span class="w"> </span>ecutsm<span class="w">   </span><span class="m">0</span>.5<span class="w">            </span><span class="c1"># Smoothing energy needed for lattice parameter</span>
<span class="w">                         </span><span class="c1"># optimization.  This will be retained for</span>
<span class="w">                         </span><span class="c1"># consistency throughout.</span>

<span class="c1">#Definition of the k-point grid</span>
<span class="w">  </span>ngkpt<span class="w">   </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w">          </span><span class="c1"># 4x4x4 Monkhorst-Pack grid</span>
nshiftk<span class="w">   </span><span class="m">1</span><span class="w">              </span><span class="c1"># Use one copy of grid only (default)</span>
<span class="w"> </span>shiftk<span class="w">   </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.5<span class="w">    </span><span class="c1"># This choice of origin for the k point grid</span>
<span class="w">                         </span><span class="c1"># preserves the hexagonal symmetry of the grid,</span>
<span class="w">                         </span><span class="c1"># which would be broken by the default choice.</span>

<span class="c1">#Definition of the self-consistency procedure</span>
<span class="w"> </span>diemac<span class="w">   </span><span class="m">9</span>.0<span class="w">            </span><span class="c1"># Model dielectric preconditioner</span>
<span class="w">  </span>nstep<span class="w">   </span><span class="m">40</span><span class="w">             </span><span class="c1"># Maxiumum number of SCF iterations</span>
<span class="w"> </span>tolvrs<span class="w">   </span><span class="m">1</span>.0d-18<span class="w">        </span><span class="c1"># Strict tolerance on (squared) residual of the</span>
<span class="w">                         </span><span class="c1"># SCF potential needed for accurate forces and</span>
<span class="w">                         </span><span class="c1"># stresses in the structural optimization, and</span>
<span class="w">                         </span><span class="c1"># accurate wave functions in the RF calculations</span>
<span class="c1"># enforce calculation of forces at each SCF step</span>
<span class="w"> </span>optforces<span class="w"> </span><span class="m">1</span>


<span class="w"> </span>pp_dirpath<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
<span class="w"> </span>pseudos<span class="w"> </span><span class="s2">&quot;Psdj_nc_sr_04_pw_std_psp8/Al.psp8, Psdj_nc_sr_04_pw_std_psp8/P.psp8&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   telast_1.abo, tolnlines=  3, tolabs=  1.1e-7, tolrel=  2.0e-2, fld_options = -medium</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 2</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = D. Hamann</span>
<span class="c1">#%% keywords =</span>
<span class="c1">#%% description =</span>
<span class="c1">#%%   AlAs in hypothetical wurzite (hexagonal) structure</span>
<span class="c1">#%%   Structural optimization run</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-54a09ec0-c051-4415-b888-8e35859b4577", "#uuid-594ea24d-629a-40a3-b028-e5fd3f8b37b4") }); </script>

<p>The hypothetical wurtzite structure for AlP retains the tetrahedral
coordination of the atoms of the actual zincblende structure of AlP, but has a hexagonal lattice.
It was chosen for this tutorial because the atomic
positions are not completely determined by symmetry.
Both the atomic positions and the lattice constants should be optimized before beginning DFPT
calculations, especially those related to strain properties.
While GS structural optimization was treated in tutorials 1-3, we are introducing a few
new features here, and you should look at the following new input variables which will be discussed below:</p>
<ul>
<li><a class="wikilink codevar-wikilink" href="/variables/rlx#getxred">getxred</a></li>
<li><a class="wikilink codevar-wikilink" href="/variables/rlx#iatfix">iatfix</a></li>
<li><a class="wikilink codevar-wikilink" href="/variables/rlx#natfix">natfix</a></li>
<li><a class="wikilink codevar-wikilink" href="/variables/rlx#strfact">strfact</a></li>
</ul>
<p>There are two datasets specified in <em>telast_1.abi</em>. First, let us examine the
common input data. We specify a starting guess for <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a>, and give an
accurate decimal specification for <a class="wikilink codevar-wikilink" href="/variables/basic#rprim">rprim</a>. The definition of the atom
types and atoms follows <a href="/tutorial/rf1">tutorial DFPT1</a>. The reduced atomic
positions <a class="wikilink codevar-wikilink" href="/variables/basic#xred">xred</a> are a starting approximation, and will be replaced by our
converged results in the remaining input files, as will <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a>.</p>
<p>We will work with a fixed plane wave cutoff <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> (=6 Ha), but introduce
<a class="wikilink codevar-wikilink" href="/variables/rlx#ecutsm">ecutsm</a> (0.5 Ha) as in <a href="/tutorial/base3">tutorial 3</a> to smear the cutoff,
which produces smoothly varying stresses as the lattice parameters are
optimized. We will keep the same value of <a class="wikilink codevar-wikilink" href="/variables/rlx#ecutsm">ecutsm</a> for the DFPT calculations
as well, since changing it from the optimization run value could reintroduce
non-zero forces and stresses. For the k-point grid, we must explicitly specify
<a class="wikilink codevar-wikilink" href="/variables/basic#shiftk">shiftk</a> since the default value results in a grid shifted so as to break
hexagonal symmetry. The RF strain calculations check this, and will exit with
an error message if the grid does not have the proper symmetry.
The self-consistency procedures follow <a href="/tutorial/rf1">tutorial RF1</a>.</p>
<p>Dataset 1 optimizes the atomic positions keeping the lattice parameters fixed,
setting <a class="wikilink codevar-wikilink" href="/variables/rlx#geoopt">geoopt</a> &ldquo;bfgs&rdquo; as in <a href="/tutorial/base1">tutorial 1</a>. The optimization
steps proceed until the maximum force component on any atom is less than
<a class="wikilink codevar-wikilink" href="/variables/rlx#tolmxf">tolmxf</a>. It is always advised to relax the forces before beginning the
lattice parameter optimization. Dataset 2 optimizes the lattice parameters
with <a class="wikilink codevar-wikilink" href="/variables/rlx#optcell">optcell</a>=2 as in <a href="/tutorial/base3">tutorial 3</a>. However, tutorial 3
treats cubic Si, and the atom positions in reduced coordinates remained
fixed. In the present, more general case, the reduced atomic coordinates must
be reoptimized as the lattice parameters are optimized. Note that it is
necessary to include <a class="wikilink codevar-wikilink" href="/variables/rlx#getxred">getxred</a> = -1 so that the second dataset is
initialized with the relaxed coordinates. Coordinate and lattice parameter
optimizations actually take place simultaneously, with the computed stresses
at each step acting as forces on the lattice parameters. We have introduced
<a class="wikilink codevar-wikilink" href="/variables/rlx#strfact">strfact</a> which scales the stresses so that they may be compared with the
same <a class="wikilink codevar-wikilink" href="/variables/rlx#tolmxf">tolmxf</a> convergence test that is applied to the forces. The default
value of 100 is probably a good choice for many systems, but you should be
aware of what is happening.</p>
<p>From the hexagonal symmetry, we know that the positions of the atoms in the
a-b basal plane are fixed. However, a uniform translation along the c axis of
all the atoms leaves the structure invariant. Only the relative displacement
of the Al and As planes along the c axis is physically relevant. We will fix
the Al positions to be at reduced c-axis coordinates 0 and &frac12; (these are
related by symmetry) by introducing <a class="wikilink codevar-wikilink" href="/variables/rlx#natfix">natfix</a> and <a class="wikilink codevar-wikilink" href="/variables/rlx#iatfix">iatfix</a> to constrain the
structural optimization. This is really just for cosmetic purposes, since
letting them all slide an arbitrary amount (as they otherwise would) won&rsquo;t
change any results. However, you probably wouldn&rsquo;t want to publish the results
that way, so we may as well develop good habits.</p>
<p>Now we shall examine the results of the structural optimization run. As
always, we should first examine the log file to make sure the run has
terminated cleanly. There are a number of warnings, but none of them are
apparently serious. Next, let us edit the output file, <em>telast_1.abo</em>.</p>
<div class="text-center"><button id="uuid-e65e92de-ec97-475d-b339-a87c5e5f40ae" class="md-button md-button--secondary"> View tests/tutorespfn/Refs/telast_1.abo </button></div>
<div id="uuid-b49d0cb7-15b3-41a3-8d67-51b2c5cb6aa4" class="my_dialog" title="tests/tutorespfn/Refs/telast_1.abo" hidden><div><pre class="small-text">

.Version 10.1.4.5 of ABINIT, released Sep 2024.
.(MPI version, prepared for a x86_64_linux_gnu13.2 computer)

.Copyright (C) 1998-2025 ABINIT group .
 ABINIT comes with ABSOLUTELY NO WARRANTY.
 It is free software, and you are welcome to redistribute it
 under certain conditions (GNU General Public License,
 see ~abinit/COPYING or http://www.gnu.org/copyleft/gpl.txt).

 ABINIT is a project of the Universite Catholique de Louvain,
 Corning Inc. and other collaborators, see ~abinit/doc/developers/contributors.txt .
 Please read https://docs.abinit.org/theory/acknowledgments for suggested
 acknowledgments of the ABINIT effort.
 For more information, see https://www.abinit.org .

.Starting date : Fri 13 Sep 2024.
- ( at 19h03 )

- input  file    -&gt; /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/trunk_merge-10.0/tests/TestBot_MPI1/tutorespfn_telast_1/telast_1.abi
- output file    -&gt; telast_1.abo
- root for input  files -&gt; telast_1i
- root for output files -&gt; telast_1o

 DATASET    1 : space group P6_3 m c (#186); Bravais hP (primitive hexag.)
================================================================================
 Values of the parameters that define the memory need for DATASET  1.
     intxc =       0    ionmov =       2      iscf =       7    lmnmax =       6
     lnmax =       6     mgfft =      30  mpssoang =       3    mqgrid =    3001
     natom =       4  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      12    n1xccc =    2501    ntypat =       2
    occopt =       1   xclevel =       1
-    mband =           8        mffmem =           1         mkmem =           8
       mpw =         428          nfft =        9720          nkpt =           8
================================================================================
P This job should need less than                       4.777 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      0.420 Mbytes ; DEN or POT disk file :      0.076 Mbytes.
================================================================================

 DATASET    2 : space group P6_3 m c (#186); Bravais hP (primitive hexag.)
================================================================================
 Values of the parameters that define the memory need for DATASET  2.
     intxc =       0    ionmov =       2      iscf =       7    lmnmax =       6
     lnmax =       6     mgfft =      30  mpssoang =       3    mqgrid =    3001
     natom =       4  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      12    n1xccc =    2501    ntypat =       2
    occopt =       1   xclevel =       1
-    mband =           8        mffmem =           1         mkmem =           8
       mpw =         494          nfft =        9720          nkpt =           8
================================================================================
P This job should need less than                       4.867 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      0.484 Mbytes ; DEN or POT disk file :      0.076 Mbytes.
================================================================================

--------------------------------------------------------------------------------
------------- Echo of variables that govern the present computation ------------
--------------------------------------------------------------------------------
-
- outvars: echo of selected default values
-   iomode0 =  0 , fftalg0 =512 , wfoptalg0 =  0
-
- outvars: echo of global parameters not present in the input file
-  max_nthreads =    0
-
 -outvars: echo values of preprocessed input variables --------
            acell      7.5000000000E+00  7.5000000000E+00  1.2263388000E+01 Bohr
              amu      2.69815390E+01  3.09737620E+01
           diemac      9.00000000E+00
          dilatmx1     1.00000000E+00
          dilatmx2     1.05000000E+00
             ecut      6.00000000E+00 Hartree
           ecutsm      5.00000000E-01 Hartree
-          fftalg         512
           getwfk1          0
           getwfk2         -1
          getxred1          0
          getxred2         -1
           iatfix        1    2
           ionmov           2
              ixc       -1012
           jdtset        1    2
              kpt      0.00000000E+00  0.00000000E+00  1.25000000E-01
                       2.50000000E-01  0.00000000E+00  1.25000000E-01
                       5.00000000E-01  0.00000000E+00  1.25000000E-01
                       2.50000000E-01  2.50000000E-01  1.25000000E-01
                       0.00000000E+00  0.00000000E+00  3.75000000E-01
                       2.50000000E-01  0.00000000E+00  3.75000000E-01
                       5.00000000E-01  0.00000000E+00  3.75000000E-01
                       2.50000000E-01  2.50000000E-01  3.75000000E-01
         kptrlatt        4    0    0      0    4    0      0    0    4
P           mkmem           8
           natfix           2
            natom           4
            nband           8
           ndtset           2
            ngfft          18      18      30
             nkpt           8
            nstep          40
             nsym          12
            ntime1          5
            ntime2         14
           ntypat           2
              occ      2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000
          optcell1          0
          optcell2          2
        optforces           1
            rprim      8.6602540378E-01  5.0000000000E-01  0.0000000000E+00
                      -8.6602540378E-01  5.0000000000E-01  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  1.0000000000E+00
           shiftk      0.00000000E+00  0.00000000E+00  5.00000000E-01
          spgroup         186
           symrel      1  0  0   0  1  0   0  0  1       0  1  0   1  0  0   0  0  1
                       1  1  0  -1  0  0   0  0  1      -1  0  0   1  1  0   0  0  1
                       0  1  0  -1 -1  0   0  0  1      -1 -1  0   0  1  0   0  0  1
                      -1  0  0   0 -1  0   0  0  1       0 -1  0  -1  0  0   0  0  1
                      -1 -1  0   1  0  0   0  0  1       1  0  0  -1 -1  0   0  0  1
                       0 -1  0   1  1  0   0  0  1       1  1  0   0 -1  0   0  0  1
            tnons      0.0000000  0.0000000  0.0000000     0.0000000  0.0000000  0.5000000
                      -0.0000000  0.0000000  0.5000000     0.0000000  0.0000000  0.0000000
                       0.0000000 -0.0000000  0.0000000     0.0000000  0.0000000  0.5000000
                       0.0000000  0.0000000  0.5000000     0.0000000  0.0000000  0.0000000
                       0.0000000  0.0000000  0.0000000    -0.0000000  0.0000000  0.5000000
                       0.0000000  0.0000000  0.5000000     0.0000000 -0.0000000  0.0000000
           tolmxf      1.00000000E-06
           tolvrs      1.00000000E-18
            typat      1  1  2  2
              wtk        0.03125    0.18750    0.09375    0.18750    0.03125    0.18750
                         0.09375    0.18750
           xangst     -1.1457022644E+00  1.9844145322E+00  0.0000000000E+00
                       1.1457022644E+00  1.9844145322E+00  3.2447527148E+00
                      -1.1457022644E+00  1.9844145322E+00  2.4335645361E+00
                       1.1457022644E+00  1.9844145322E+00  5.6783172510E+00
            xcart     -2.1650635095E+00  3.7500000000E+00  0.0000000000E+00
                       2.1650635095E+00  3.7500000000E+00  6.1316940000E+00
                      -2.1650635095E+00  3.7500000000E+00  4.5987705000E+00
                       2.1650635095E+00  3.7500000000E+00  1.0730464500E+01
             xred      3.3333333333E-01  6.6666666667E-01  0.0000000000E+00
                       6.6666666667E-01  3.3333333333E-01  5.0000000000E-01
                       3.3333333333E-01  6.6666666667E-01  3.7500000000E-01
                       6.6666666667E-01  3.3333333333E-01  8.7500000000E-01
            znucl       13.00000   15.00000

================================================================================

 chkinp: Checking input parameters for consistency, jdtset=   1.

 chkinp: Checking input parameters for consistency, jdtset=   2.

================================================================================
== DATASET  1 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 1, }
dimensions: {natom: 4, nkpt: 8, mband: 8, nsppol: 1, nspinor: 1, nspden: 1, mpw: 428, }
cutoff_energies: {ecut:   6.0, pawecutdg:  -1.0, }
electrons: {nelect:   1.60000000E+01, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 0, ionmov: 2, optcell: 0, iscf: 7, paral_kgb: 0, }
...

 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  6.4951905  3.7500000  0.0000000  G(1)=  0.0769800  0.1333333  0.0000000
 R(2)= -6.4951905  3.7500000  0.0000000  G(2)= -0.0769800  0.1333333  0.0000000
 R(3)=  0.0000000  0.0000000 12.2633880  G(3)=  0.0000000  0.0000000  0.0815435
 Unit cell volume ucvol=  5.9739781E+02 bohr^3
 Angles (23,13,12)=  9.00000000E+01  9.00000000E+01  1.20000000E+02 degrees

 getcut: wavevector=  0.0000  0.0000  0.0000  ngfft=  18  18  30
         ecut(hartree)=      6.000   =&gt; boxcut(ratio)=   2.18103

--- Pseudopotential description ------------------------------------------------
- pspini: atom type   1  psp file is /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/trunk_merge-10.0/tests/Pspdir/Psdj_nc_sr_04_pw_std_psp8/Al.psp8
- pspatm: opening atomic psp file    /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/trunk_merge-10.0/tests/Pspdir/Psdj_nc_sr_04_pw_std_psp8/Al.psp8
- Al    ONCVPSP-3.3.0  r_core=   1.76802   1.76802   1.70587
- 13.00000   3.00000    171102                znucl, zion, pspdat
    8   -1012    2    4       600   0.00000   pspcod,pspxc,lmax,lloc,mmax,r2well
    5.99000000000000    5.00000000000000    0.00000000000000   rchrg,fchrg,qchrg
     nproj     2     2     2
     extension_switch     1
  pspatm : epsatm=    0.57439192
         --- l  ekb(1:nproj) --&gt;
             0    5.725870    0.726131
             1    6.190420    0.914022
             2   -4.229503   -0.925599
 pspatm: atomic psp has been read  and splines computed

- pspini: atom type   2  psp file is /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/trunk_merge-10.0/tests/Pspdir/Psdj_nc_sr_04_pw_std_psp8/P.psp8
- pspatm: opening atomic psp file    /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/trunk_merge-10.0/tests/Pspdir/Psdj_nc_sr_04_pw_std_psp8/P.psp8
- P     ONCVPSP-3.3.0  r_core=   1.46089   1.55067   1.70594
- 15.00000   5.00000    171102                znucl, zion, pspdat
    8   -1012    2    4       600   0.00000   pspcod,pspxc,lmax,lloc,mmax,r2well
    5.99000000000000    5.00000000000000    0.00000000000000   rchrg,fchrg,qchrg
     nproj     2     2     2
     extension_switch     1
  pspatm : epsatm=    7.03163490
         --- l  ekb(1:nproj) --&gt;
             0    6.795192    1.078292
             1    3.452929    0.907117
             2   -3.024864   -0.802189
 pspatm: atomic psp has been read  and splines computed

   2.43392858E+02                                ecore*ucvol(ha*bohr**3)
--------------------------------------------------------------------------------

_setup2: Arith. and geom. avg. npw (full set) are     419.906     419.872

================================================================================

=== [ionmov= 2] Broyden-Fletcher-Goldfarb-Shanno method (forces)
================================================================================

--- Iteration: (1/5) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

--- !BeginCycle
iteration_state: {dtset: 1, itime: 1, icycle: 1, }
solver: {iscf: 7, nstep: 40, nline: 4, wfoptalg: 0, }
tolerances: {tolvrs: 1.00E-18, }
...

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -18.594581260156    -1.859E+01 1.431E-02 1.007E+01 4.309E-04 4.309E-04
 ETOT  2  -18.616306831034    -2.173E-02 2.071E-05 9.822E-01 1.438E-03 1.007E-03
 ETOT  3  -18.618304430954    -1.998E-03 8.854E-06 1.012E-02 3.470E-04 6.603E-04
 ETOT  4  -18.618315298516    -1.087E-05 9.806E-08 2.689E-04 4.356E-05 6.168E-04
 ETOT  5  -18.618315444779    -1.463E-07 1.188E-09 5.811E-06 2.916E-05 6.459E-04
 ETOT  6  -18.618315448735    -3.956E-09 1.002E-10 1.391E-07 8.914E-06 6.370E-04
 ETOT  7  -18.618315448959    -2.231E-10 5.820E-12 3.455E-09 2.565E-06 6.396E-04
 ETOT  8  -18.618315448961    -2.935E-12 9.232E-14 5.078E-11 5.068E-08 6.395E-04
 ETOT  9  -18.618315448962    -8.882E-14 3.073E-15 4.872E-13 1.515E-08 6.395E-04
 ETOT 10  -18.618315448962    -4.263E-14 8.140E-17 1.084E-14 2.927E-09 6.395E-04
 ETOT 11  -18.618315448962     6.040E-14 5.114E-18 3.106E-16 2.301E-10 6.395E-04
 ETOT 12  -18.618315448961     1.776E-14 1.558E-19 7.577E-18 7.610E-11 6.395E-04
 ETOT 13  -18.618315448961     3.553E-15 9.065E-21 6.017E-20 2.984E-12 6.395E-04

 At SCF step   13       vres2   =  6.02E-20 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)=  2.26633726E-04  sigma(3 2)=  0.00000000E+00
  sigma(2 2)=  2.26633726E-04  sigma(3 1)=  0.00000000E+00
  sigma(3 3)=  2.54871353E-04  sigma(2 1)=  0.00000000E+00


--- !ResultsGS
iteration_state: {dtset: 1, itime: 1, icycle: 1, }
comment   : Summary of ground state results
lattice_vectors:
- [  6.4951905,   3.7500000,   0.0000000, ]
- [ -6.4951905,   3.7500000,   0.0000000, ]
- [  0.0000000,   0.0000000,  12.2633880, ]
lattice_lengths: [   7.50000,    7.50000,   12.26339, ]
lattice_angles: [ 90.000,  90.000, 120.000, ] # degrees, (23, 13, 12)
lattice_volume:   5.9739781E+02
convergence: {deltae:  3.553E-15, res2:  6.017E-20, residm:  9.065E-21, diffor:  2.984E-12, }
etotal    :  -1.86183154E+01
entropy   :   0.00000000E+00
fermie    :   1.24771042E-01
cartesian_stress_tensor: # hartree/bohr^3
- [  2.26633726E-04,   0.00000000E+00,   0.00000000E+00, ]
- [  0.00000000E+00,   2.26633726E-04,   0.00000000E+00, ]
- [  0.00000000E+00,   0.00000000E+00,   2.54871353E-04, ]
pressure_GPa:  -6.9447E+00
xred      :
- [  3.3333E-01,   6.6667E-01,   0.0000E+00, Al]
- [  6.6667E-01,   3.3333E-01,   5.0000E-01, Al]
- [  3.3333E-01,   6.6667E-01,   3.7500E-01,  P]
- [  6.6667E-01,   3.3333E-01,   8.7500E-01,  P]
cartesian_forces: # hartree/bohr
- [ -0.00000000E+00,  -0.00000000E+00,  -6.39505081E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,  -6.39505081E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,   6.39505081E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,   6.39505081E-04, ]
force_length_stats: {min:   6.39505081E-04, max:   6.39505081E-04, mean:   6.39505081E-04, }
...

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.91469459
    2        2.00000          0.91469459
    3        2.00000          2.78372227
    4        2.00000          2.78372227

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.16506350946110E+00  3.75000000000000E+00  0.00000000000000E+00
  2.16506350946110E+00  3.75000000000000E+00  6.13169400000000E+00
 -2.16506350946110E+00  3.75000000000000E+00  4.59877050000000E+00
  2.16506350946110E+00  3.75000000000000E+00  1.07304645000000E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.75000000000000E-01
  6.66666666666667E-01  3.33333333333333E-01  8.75000000000000E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 6.39505E-04 3.69218E-04 (free atoms)
 -0.00000000000000E+00 -0.00000000000000E+00 -6.39505081254510E-04
 -0.00000000000000E+00 -0.00000000000000E+00 -6.39505081254510E-04
 -0.00000000000000E+00 -0.00000000000000E+00  6.39505081254510E-04
 -0.00000000000000E+00 -0.00000000000000E+00  6.39505081254510E-04
 Gradient of E wrt nuclear positions in reduced coordinates (gred)
  0.00000000000000E+00 -0.00000000000000E+00  7.84249893939558E-03
  0.00000000000000E+00 -0.00000000000000E+00  7.84249893939558E-03
 -0.00000000000000E+00 -0.00000000000000E+00 -7.84249893939558E-03
 -0.00000000000000E+00 -0.00000000000000E+00 -7.84249893939558E-03
 Total energy (etotal) [Ha]= -1.86183154489615E+01

--- Iteration: (2/5) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

--- !BeginCycle
iteration_state: {dtset: 1, itime: 2, icycle: 1, }
solver: {iscf: 7, nstep: 40, nline: 4, wfoptalg: 0, }
tolerances: {tolvrs: 1.00E-18, }
...

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -18.618316191315    -1.862E+01 6.120E-12 1.409E-05 2.243E-05 6.171E-04
 ETOT  2  -18.618316213155    -2.184E-08 1.101E-12 5.216E-07 3.546E-05 5.816E-04
 ETOT  3  -18.618316214268    -1.114E-09 1.819E-11 2.072E-08 4.094E-06 5.857E-04
 ETOT  4  -18.618316214299    -3.067E-11 2.107E-13 9.478E-10 1.847E-07 5.855E-04
 ETOT  5  -18.618316214300    -1.155E-12 2.179E-14 2.909E-11 1.807E-07 5.853E-04
 ETOT  6  -18.618316214300    -7.105E-14 9.138E-17 4.616E-13 1.328E-08 5.854E-04
 ETOT  7  -18.618316214300    -9.948E-14 5.783E-18 7.527E-15 2.610E-09 5.854E-04
 ETOT  8  -18.618316214300     7.461E-14 1.465E-19 2.175E-16 4.350E-10 5.854E-04
 ETOT  9  -18.618316214300     4.619E-14 5.333E-21 8.940E-18 6.790E-11 5.854E-04
 ETOT 10  -18.618316214300    -4.974E-14 1.601E-22 1.322E-20 1.060E-11 5.854E-04

 At SCF step   10       vres2   =  1.32E-20 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)=  2.26502973E-04  sigma(3 2)=  0.00000000E+00
  sigma(2 2)=  2.26502973E-04  sigma(3 1)=  0.00000000E+00
  sigma(3 3)=  2.55131045E-04  sigma(2 1)=  0.00000000E+00


--- !ResultsGS
iteration_state: {dtset: 1, itime: 2, icycle: 1, }
comment   : Summary of ground state results
lattice_vectors:
- [  6.4951905,   3.7500000,   0.0000000, ]
- [ -6.4951905,   3.7500000,   0.0000000, ]
- [  0.0000000,   0.0000000,  12.2633880, ]
lattice_lengths: [   7.50000,    7.50000,   12.26339, ]
lattice_angles: [ 90.000,  90.000, 120.000, ] # degrees, (23, 13, 12)
lattice_volume:   5.9739781E+02
convergence: {deltae: -4.974E-14, res2:  1.322E-20, residm:  1.601E-22, diffor:  1.060E-11, }
etotal    :  -1.86183162E+01
entropy   :   0.00000000E+00
fermie    :   1.24753226E-01
cartesian_stress_tensor: # hartree/bohr^3
- [  2.26502973E-04,   0.00000000E+00,   0.00000000E+00, ]
- [  0.00000000E+00,   2.26502973E-04,   0.00000000E+00, ]
- [  0.00000000E+00,   0.00000000E+00,   2.55131045E-04, ]
pressure_GPa:  -6.9447E+00
xred      :
- [  3.3333E-01,   6.6667E-01,   0.0000E+00, Al]
- [  6.6667E-01,   3.3333E-01,   5.0000E-01, Al]
- [  3.3333E-01,   6.6667E-01,   3.7505E-01,  P]
- [  6.6667E-01,   3.3333E-01,   8.7505E-01,  P]
cartesian_forces: # hartree/bohr
- [ -0.00000000E+00,  -0.00000000E+00,  -5.85355855E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,  -5.85355855E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,   5.85355855E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,   5.85355855E-04, ]
force_length_stats: {min:   5.85355855E-04, max:   5.85355855E-04, mean:   5.85355855E-04, }
...

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.91470129
    2        2.00000          0.91470129
    3        2.00000          2.78373614
    4        2.00000          2.78373614

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.16506350946110E+00  3.75000000000000E+00  0.00000000000000E+00
  2.16506350946110E+00  3.75000000000000E+00  6.13169400000000E+00
 -2.16506350946110E+00  3.75000000000000E+00  4.59941000508125E+00
  2.16506350946110E+00  3.75000000000000E+00  1.07311040050813E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.75052147504528E-01
  6.66666666666667E-01  3.33333333333333E-01  8.75052147504528E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 5.85356E-04 3.37955E-04 (free atoms)
 -0.00000000000000E+00 -0.00000000000000E+00 -5.85355854829384E-04
 -0.00000000000000E+00 -0.00000000000000E+00 -5.85355854829384E-04
 -0.00000000000000E+00 -0.00000000000000E+00  5.85355854829384E-04
 -0.00000000000000E+00 -0.00000000000000E+00  5.85355854829384E-04
 Gradient of E wrt nuclear positions in reduced coordinates (gred)
  0.00000000000000E+00 -0.00000000000000E+00  7.17844596584441E-03
  0.00000000000000E+00 -0.00000000000000E+00  7.17844596584441E-03
 -0.00000000000000E+00 -0.00000000000000E+00 -7.17844596584441E-03
 -0.00000000000000E+00 -0.00000000000000E+00 -7.17844596584441E-03
 Total energy (etotal) [Ha]= -1.86183162143002E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)=-7.65339E-07
           Relative     =-4.11068E-08

--- Iteration: (3/5) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

--- !BeginCycle
iteration_state: {dtset: 1, itime: 3, icycle: 1, }
solver: {iscf: 7, nstep: 40, nline: 4, wfoptalg: 0, }
tolerances: {tolvrs: 1.00E-18, }
...

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -18.618317432284    -1.862E+01 7.169E-10 1.629E-03 2.407E-04 3.447E-04
 ETOT  2  -18.618319956592    -2.524E-06 1.297E-10 6.021E-05 3.808E-04 3.614E-05
 ETOT  3  -18.618320085226    -1.286E-07 2.113E-09 2.397E-06 4.405E-05 7.911E-06
 ETOT  4  -18.618320088764    -3.537E-09 2.450E-11 1.099E-07 1.984E-06 5.927E-06
 ETOT  5  -18.618320088910    -1.467E-10 2.519E-12 3.368E-09 1.948E-06 3.980E-06
 ETOT  6  -18.618320088914    -3.286E-12 1.054E-14 5.349E-11 1.417E-07 4.121E-06
 ETOT  7  -18.618320088914    -1.776E-14 6.762E-16 8.680E-13 2.826E-08 4.150E-06
 ETOT  8  -18.618320088914     5.329E-14 1.720E-17 2.490E-14 4.736E-09 4.145E-06
 ETOT  9  -18.618320088914    -1.030E-13 6.282E-19 1.007E-15 7.473E-10 4.146E-06
 ETOT 10  -18.618320088914    -7.105E-15 1.893E-20 1.489E-18 1.174E-10 4.145E-06
 ETOT 11  -18.618320088914     9.237E-14 1.023E-22 2.119E-20 1.379E-11 4.145E-06

 At SCF step   11       vres2   =  2.12E-20 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)=  2.25086118E-04  sigma(3 2)=  0.00000000E+00
  sigma(2 2)=  2.25086118E-04  sigma(3 1)=  0.00000000E+00
  sigma(3 3)=  2.57903440E-04  sigma(2 1)=  0.00000000E+00


--- !ResultsGS
iteration_state: {dtset: 1, itime: 3, icycle: 1, }
comment   : Summary of ground state results
lattice_vectors:
- [  6.4951905,   3.7500000,   0.0000000, ]
- [ -6.4951905,   3.7500000,   0.0000000, ]
- [  0.0000000,   0.0000000,  12.2633880, ]
lattice_lengths: [   7.50000,    7.50000,   12.26339, ]
lattice_angles: [ 90.000,  90.000, 120.000, ] # degrees, (23, 13, 12)
lattice_volume:   5.9739781E+02
convergence: {deltae:  9.237E-14, res2:  2.119E-20, residm:  1.023E-22, diffor:  1.379E-11, }
etotal    :  -1.86183201E+01
entropy   :   0.00000000E+00
fermie    :   1.24560433E-01
cartesian_stress_tensor: # hartree/bohr^3
- [  2.25086118E-04,   0.00000000E+00,   0.00000000E+00, ]
- [  0.00000000E+00,   2.25086118E-04,   0.00000000E+00, ]
- [  0.00000000E+00,   0.00000000E+00,   2.57903440E-04, ]
pressure_GPa:  -6.9441E+00
xred      :
- [  3.3333E-01,   6.6667E-01,   0.0000E+00, Al]
- [  6.6667E-01,   3.3333E-01,   5.0000E-01, Al]
- [  3.3333E-01,   6.6667E-01,   3.7562E-01,  P]
- [  6.6667E-01,   3.3333E-01,   8.7562E-01,  P]
cartesian_forces: # hartree/bohr
- [ -0.00000000E+00,  -0.00000000E+00,  -4.14540716E-06, ]
- [ -0.00000000E+00,  -0.00000000E+00,  -4.14540716E-06, ]
- [ -0.00000000E+00,  -0.00000000E+00,   4.14540716E-06, ]
- [ -0.00000000E+00,  -0.00000000E+00,   4.14540716E-06, ]
force_length_stats: {min:   4.14540716E-06, max:   4.14540716E-06, mean:   4.14540716E-06, }
...

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.91477622
    2        2.00000          0.91477622
    3        2.00000          2.78385331
    4        2.00000          2.78385331

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.16506350946110E+00  3.75000000000000E+00  0.00000000000000E+00
  2.16506350946110E+00  3.75000000000000E+00  6.13169400000000E+00
 -2.16506350946110E+00  3.75000000000000E+00  4.60632308709957E+00
  2.16506350946110E+00  3.75000000000000E+00  1.07380170870996E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.75615864645200E-01
  6.66666666666667E-01  3.33333333333333E-01  8.75615864645200E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 4.14541E-06 2.39335E-06 (free atoms)
 -0.00000000000000E+00 -0.00000000000000E+00 -4.14540715535821E-06
 -0.00000000000000E+00 -0.00000000000000E+00 -4.14540715535821E-06
 -0.00000000000000E+00 -0.00000000000000E+00  4.14540715535820E-06
 -0.00000000000000E+00 -0.00000000000000E+00  4.14540715535820E-06
 Gradient of E wrt nuclear positions in reduced coordinates (gred)
  0.00000000000000E+00 -0.00000000000000E+00  5.08367363641340E-05
  0.00000000000000E+00 -0.00000000000000E+00  5.08367363641340E-05
 -0.00000000000000E+00 -0.00000000000000E+00 -5.08367363641339E-05
 -0.00000000000000E+00 -0.00000000000000E+00 -5.08367363641339E-05
 Total energy (etotal) [Ha]= -1.86183200889136E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)=-3.87461E-06
           Relative     =-2.08108E-07

--- Iteration: (4/5) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

--- !BeginCycle
iteration_state: {dtset: 1, itime: 4, icycle: 1, }
solver: {iscf: 7, nstep: 40, nline: 4, wfoptalg: 0, }
tolerances: {tolvrs: 1.00E-18, }
...

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -18.618320087590    -1.862E+01 3.658E-14 8.350E-08 1.682E-06 2.463E-06
 ETOT  2  -18.618320087720    -1.294E-10 6.602E-15 3.099E-09 2.723E-06 2.605E-07
 ETOT  3  -18.618320087726    -6.647E-12 1.080E-13 1.232E-10 3.146E-07 5.418E-08
 ETOT  4  -18.618320087726    -2.487E-13 1.253E-15 5.623E-12 1.423E-08 3.995E-08
 ETOT  5  -18.618320087726     1.670E-13 1.295E-16 1.723E-13 1.387E-08 2.608E-08
 ETOT  6  -18.618320087726    -4.619E-14 5.378E-19 2.757E-15 1.006E-09 2.709E-08
 ETOT  7  -18.618320087726    -5.329E-14 3.481E-20 4.515E-17 2.042E-10 2.729E-08
 ETOT  8  -18.618320087726     4.263E-14 8.955E-22 1.297E-18 3.408E-11 2.726E-08
 ETOT  9  -18.618320087726     1.066E-14 3.257E-23 5.339E-20 5.317E-12 2.726E-08

 At SCF step    9       vres2   =  5.34E-20 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)=  2.25075990E-04  sigma(3 2)=  0.00000000E+00
  sigma(2 2)=  2.25075990E-04  sigma(3 1)=  0.00000000E+00
  sigma(3 3)=  2.57922984E-04  sigma(2 1)=  0.00000000E+00


--- !ResultsGS
iteration_state: {dtset: 1, itime: 4, icycle: 1, }
comment   : Summary of ground state results
lattice_vectors:
- [  6.4951905,   3.7500000,   0.0000000, ]
- [ -6.4951905,   3.7500000,   0.0000000, ]
- [  0.0000000,   0.0000000,  12.2633880, ]
lattice_lengths: [   7.50000,    7.50000,   12.26339, ]
lattice_angles: [ 90.000,  90.000, 120.000, ] # degrees, (23, 13, 12)
lattice_volume:   5.9739781E+02
convergence: {deltae:  1.066E-14, res2:  5.339E-20, residm:  3.257E-23, diffor:  5.317E-12, }
etotal    :  -1.86183201E+01
entropy   :   0.00000000E+00
fermie    :   1.24559057E-01
cartesian_stress_tensor: # hartree/bohr^3
- [  2.25075990E-04,   0.00000000E+00,   0.00000000E+00, ]
- [  0.00000000E+00,   2.25075990E-04,   0.00000000E+00, ]
- [  0.00000000E+00,   0.00000000E+00,   2.57922984E-04, ]
pressure_GPa:  -6.9441E+00
xred      :
- [  3.3333E-01,   6.6667E-01,   0.0000E+00, Al]
- [  6.6667E-01,   3.3333E-01,   5.0000E-01, Al]
- [  3.3333E-01,   6.6667E-01,   3.7562E-01,  P]
- [  6.6667E-01,   3.3333E-01,   8.7562E-01,  P]
cartesian_forces: # hartree/bohr
- [ -0.00000000E+00,  -0.00000000E+00,  -2.72640146E-08, ]
- [ -0.00000000E+00,  -0.00000000E+00,  -2.72640146E-08, ]
- [ -0.00000000E+00,  -0.00000000E+00,   2.72640146E-08, ]
- [ -0.00000000E+00,  -0.00000000E+00,   2.72640146E-08, ]
force_length_stats: {min:   2.72640146E-08, max:   2.72640146E-08, mean:   2.72640146E-08, }
...

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.91477677
    2        2.00000          0.91477677
    3        2.00000          2.78385393
    4        2.00000          2.78385393

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.16506350946110E+00  3.75000000000000E+00  0.00000000000000E+00
  2.16506350946110E+00  3.75000000000000E+00  6.13169400000000E+00
 -2.16506350946110E+00  3.75000000000000E+00  4.60637239374879E+00
  2.16506350946110E+00  3.75000000000000E+00  1.07380663937488E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.75619885283642E-01
  6.66666666666667E-01  3.33333333333333E-01  8.75619885283642E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 2.72640E-08 1.57409E-08 (free atoms)
 -0.00000000000000E+00 -0.00000000000000E+00 -2.72640146068820E-08
 -0.00000000000000E+00 -0.00000000000000E+00 -2.72640146068786E-08
 -0.00000000000000E+00 -0.00000000000000E+00  2.72640146068786E-08
 -0.00000000000000E+00 -0.00000000000000E+00  2.72640146068786E-08
 Gradient of E wrt nuclear positions in reduced coordinates (gred)
  0.00000000000000E+00 -0.00000000000000E+00  3.34349189561862E-07
  0.00000000000000E+00 -0.00000000000000E+00  3.34349189561820E-07
 -0.00000000000000E+00 -0.00000000000000E+00 -3.34349189561820E-07
 -0.00000000000000E+00 -0.00000000000000E+00 -3.34349189561820E-07
 Total energy (etotal) [Ha]= -1.86183200877263E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)= 1.18731E-09
           Relative     = 6.37709E-11

 At Broyd/MD step   4, gradients are converged :
  max grad (force/stress) = 2.7264E-08 &lt; tolmxf= 1.0000E-06 ha/bohr (free atoms)

================================================================================

 ----iterations are completed or convergence reached----

 Mean square residual over all n,k,spin=   13.267E-24; max=  32.570E-24
 reduced coordinates (array xred) for    4 atoms
       0.333333333333      0.666666666667      0.000000000000
       0.666666666667      0.333333333333      0.500000000000
       0.333333333333      0.666666666667      0.375619885284
       0.666666666667      0.333333333333      0.875619885284
 rms dE/dt=  9.7572E-05; max dE/dt=  1.6933E-04; dE/dt below (all hartree)
    1       0.000000000000      0.000000000000      0.000169332887
    2       0.000000000000      0.000000000000      0.000169332887
    3       0.000000000000      0.000000000000      0.000168664189
    4       0.000000000000      0.000000000000      0.000168664189

 cartesian coordinates (angstrom) at end:
    1     -1.14570226435669     1.98441453221250     0.00000000000000
    2      1.14570226435669     1.98441453221250     3.24475271484805
    3     -1.14570226435669     1.98441453221250     2.43758728505002
    4      1.14570226435669     1.98441453221250     5.68233999989807

 cartesian forces (hartree/bohr) at end:
    1     -0.00000000000000    -0.00000000000000    -0.00000002726401
    2     -0.00000000000000    -0.00000000000000    -0.00000002726401
    3     -0.00000000000000    -0.00000000000000     0.00000002726401
    4     -0.00000000000000    -0.00000000000000     0.00000002726401
 frms,max,avg= 1.5740886E-08 2.7264015E-08   0.000E+00  0.000E+00 -1.378E-05 h/b

 cartesian forces (eV/Angstrom) at end:
    1     -0.00000000000000    -0.00000000000000    -0.00000140197188
    2     -0.00000000000000    -0.00000000000000    -0.00000140197188
    3     -0.00000000000000    -0.00000000000000     0.00000140197188
    4     -0.00000000000000    -0.00000000000000     0.00000140197188
 frms,max,avg= 8.0942884E-07 1.4019719E-06   0.000E+00  0.000E+00 -7.086E-04 e/A
 length scales=  7.500000000000  7.500000000000 12.263388000000 bohr
              =  3.968829064425  3.968829064425  6.489505429696 angstroms
 prteigrs : about to open file telast_1o_DS1_EIG
 Fermi (or HOMO) energy (hartree) =   0.12456   Average Vxc (hartree)=  -0.32881
 Eigenvalues (hartree) for nkpt=   8  k points:
 kpt#   1, nband=  8, wtk=  0.03125, kpt=  0.0000  0.0000  0.1250 (reduced coord)
  -0.26794   -0.21601   -0.06043    0.09528    0.09528    0.11087    0.12456    0.12456
 prteigrs : prtvol=0 or 1, do not print more k-points.


--- !EnergyTerms
iteration_state     : {dtset: 1, itime: 4, icycle: 1, }
comment             : Components of total free energy in Hartree
kinetic             :  6.53203912684844E+00
hartree             :  1.94073921495652E+00
xc                  : -6.24980318264765E+00
Ewald energy        : -1.69354477572291E+01
psp_core            :  4.07421743822202E-01
local_psp           : -7.27634843585520E+00
non_local_psp       :  2.96307920237848E+00
total_energy        : -1.86183200877263E+01
total_energy_eV     : -5.06630254735469E+02
band_energy         : -4.55057639711309E-01
...

 rms coord change=  2.5307E-04   atom, delta coord (reduced):
     1        0.000000000000      0.000000000000      0.000000000000
     2        0.000000000000      0.000000000000      0.000000000000
     3        0.000000000000      0.000000000000      0.000619885284
     4        0.000000000000      0.000000000000      0.000619885284

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)=  2.25075990E-04  sigma(3 2)=  0.00000000E+00
  sigma(2 2)=  2.25075990E-04  sigma(3 1)=  0.00000000E+00
  sigma(3 3)=  2.57922984E-04  sigma(2 1)=  0.00000000E+00

-Cartesian components of stress tensor (GPa)         [Pressure= -6.9441E+00 GPa]
- sigma(1 1)=  6.62196314E+00  sigma(3 2)=  0.00000000E+00
- sigma(2 2)=  6.62196314E+00  sigma(3 1)=  0.00000000E+00
- sigma(3 3)=  7.58835491E+00  sigma(2 1)=  0.00000000E+00

================================================================================
== DATASET  2 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 2, }
dimensions: {natom: 4, nkpt: 8, mband: 8, nsppol: 1, nspinor: 1, nspden: 1, mpw: 494, }
cutoff_energies: {ecut:   6.0, pawecutdg:  -1.0, }
electrons: {nelect:   1.60000000E+01, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 0, ionmov: 2, optcell: 2, iscf: 7, paral_kgb: 0, }
...

 mkfilename : getwfk/=0, take file _WFK from output of DATASET   1.

 find_getdtset : getxred/=0, take data from output of dataset with index  1.

 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  6.4951905  3.7500000  0.0000000  G(1)=  0.0769800  0.1333333  0.0000000
 R(2)= -6.4951905  3.7500000  0.0000000  G(2)= -0.0769800  0.1333333  0.0000000
 R(3)=  0.0000000  0.0000000 12.2633880  G(3)=  0.0000000  0.0000000  0.0815435
 Unit cell volume ucvol=  5.9739781E+02 bohr^3
 Angles (23,13,12)=  9.00000000E+01  9.00000000E+01  1.20000000E+02 degrees

 getcut: wavevector=  0.0000  0.0000  0.0000  ngfft=  18  18  30
         ecut(hartree)=      6.615   =&gt; boxcut(ratio)=   2.07717

--- Pseudopotential description ------------------------------------------------
- pspini: atom type   1  psp file is /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/trunk_merge-10.0/tests/Pspdir/Psdj_nc_sr_04_pw_std_psp8/Al.psp8
- pspatm: opening atomic psp file    /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/trunk_merge-10.0/tests/Pspdir/Psdj_nc_sr_04_pw_std_psp8/Al.psp8
- Al    ONCVPSP-3.3.0  r_core=   1.76802   1.76802   1.70587
- 13.00000   3.00000    171102                znucl, zion, pspdat
    8   -1012    2    4       600   0.00000   pspcod,pspxc,lmax,lloc,mmax,r2well
    5.99000000000000    5.00000000000000    0.00000000000000   rchrg,fchrg,qchrg
     nproj     2     2     2
     extension_switch     1
  pspatm : epsatm=    0.57439192
         --- l  ekb(1:nproj) --&gt;
             0    5.725870    0.726131
             1    6.190420    0.914022
             2   -4.229503   -0.925599
 pspatm: atomic psp has been read  and splines computed

- pspini: atom type   2  psp file is /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/trunk_merge-10.0/tests/Pspdir/Psdj_nc_sr_04_pw_std_psp8/P.psp8
- pspatm: opening atomic psp file    /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/trunk_merge-10.0/tests/Pspdir/Psdj_nc_sr_04_pw_std_psp8/P.psp8
- P     ONCVPSP-3.3.0  r_core=   1.46089   1.55067   1.70594
- 15.00000   5.00000    171102                znucl, zion, pspdat
    8   -1012    2    4       600   0.00000   pspcod,pspxc,lmax,lloc,mmax,r2well
    5.99000000000000    5.00000000000000    0.00000000000000   rchrg,fchrg,qchrg
     nproj     2     2     2
     extension_switch     1
  pspatm : epsatm=    7.03163490
         --- l  ekb(1:nproj) --&gt;
             0    6.795192    1.078292
             1    3.452929    0.907117
             2   -3.024864   -0.802189
 pspatm: atomic psp has been read  and splines computed

--------------------------------------------------------------------------------

-inwffil : will read wavefunctions from disk file telast_1o_DS1_WFK
_setup2: Arith. and geom. avg. npw (full set) are     485.938     485.925

================================================================================

=== [ionmov= 2] Broyden-Fletcher-Goldfarb-Shanno method (forces)
================================================================================

--- Iteration: ( 1/14) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

--- !BeginCycle
iteration_state: {dtset: 2, itime: 1, icycle: 1, }
solver: {iscf: 7, nstep: 40, nline: 4, wfoptalg: 0, }
tolerances: {tolvrs: 1.00E-18, }
...

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -18.618320087726    -1.862E+01 1.385E-26 5.031E-20 2.726E-08 2.726E-08

 At SCF step    1       vres2   =  5.03E-20 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)=  2.25075990E-04  sigma(3 2)=  0.00000000E+00
  sigma(2 2)=  2.25075990E-04  sigma(3 1)=  0.00000000E+00
  sigma(3 3)=  2.57922984E-04  sigma(2 1)=  0.00000000E+00


--- !ResultsGS
iteration_state: {dtset: 2, itime: 1, icycle: 1, }
comment   : Summary of ground state results
lattice_vectors:
- [  6.4951905,   3.7500000,   0.0000000, ]
- [ -6.4951905,   3.7500000,   0.0000000, ]
- [  0.0000000,   0.0000000,  12.2633880, ]
lattice_lengths: [   7.50000,    7.50000,   12.26339, ]
lattice_angles: [ 90.000,  90.000, 120.000, ] # degrees, (23, 13, 12)
lattice_volume:   5.9739781E+02
convergence: {deltae: -1.862E+01, res2:  5.031E-20, residm:  1.385E-26, diffor:  2.726E-08, }
etotal    :  -1.86183201E+01
entropy   :   0.00000000E+00
fermie    :   1.24559057E-01
cartesian_stress_tensor: # hartree/bohr^3
- [  2.25075990E-04,   0.00000000E+00,   0.00000000E+00, ]
- [  0.00000000E+00,   2.25075990E-04,   0.00000000E+00, ]
- [  0.00000000E+00,   0.00000000E+00,   2.57922984E-04, ]
pressure_GPa:  -6.9441E+00
xred      :
- [  3.3333E-01,   6.6667E-01,   0.0000E+00, Al]
- [  6.6667E-01,   3.3333E-01,   5.0000E-01, Al]
- [  3.3333E-01,   6.6667E-01,   3.7562E-01,  P]
- [  6.6667E-01,   3.3333E-01,   8.7562E-01,  P]
cartesian_forces: # hartree/bohr
- [ -0.00000000E+00,  -0.00000000E+00,  -2.72621559E-08, ]
- [ -0.00000000E+00,  -0.00000000E+00,  -2.72621559E-08, ]
- [ -0.00000000E+00,  -0.00000000E+00,   2.72621559E-08, ]
- [ -0.00000000E+00,  -0.00000000E+00,   2.72621559E-08, ]
force_length_stats: {min:   2.72621559E-08, max:   2.72621559E-08, mean:   2.72621559E-08, }
...

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.91477677
    2        2.00000          0.91477677
    3        2.00000          2.78385393
    4        2.00000          2.78385393

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.16506350946110E+00  3.75000000000000E+00  0.00000000000000E+00
  2.16506350946110E+00  3.75000000000000E+00  6.13169400000000E+00
 -2.16506350946110E+00  3.75000000000000E+00  4.60637239374879E+00
  2.16506350946110E+00  3.75000000000000E+00  1.07380663937488E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.75619885283642E-01
  6.66666666666667E-01  3.33333333333333E-01  8.75619885283642E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 2.72622E-08 1.57398E-08 (free atoms)
 -0.00000000000000E+00 -0.00000000000000E+00 -2.72621558761308E-08
 -0.00000000000000E+00 -0.00000000000000E+00 -2.72621558761291E-08
 -0.00000000000000E+00 -0.00000000000000E+00  2.72621558761274E-08
 -0.00000000000000E+00 -0.00000000000000E+00  2.72621558761274E-08
 Gradient of E wrt nuclear positions in reduced coordinates (gred)
  0.00000000000000E+00 -0.00000000000000E+00  3.34326395225472E-07
  0.00000000000000E+00 -0.00000000000000E+00  3.34326395225452E-07
 -0.00000000000000E+00 -0.00000000000000E+00 -3.34326395225431E-07
 -0.00000000000000E+00 -0.00000000000000E+00 -3.34326395225431E-07
 Scale of Primitive Cell (acell) [bohr]
  7.50000000000000E+00  7.50000000000000E+00  1.22633880000000E+01
 Real space primitive translations (rprimd) [bohr]
  6.49519052838329E+00  3.75000000000000E+00  0.00000000000000E+00
 -6.49519052838329E+00  3.75000000000000E+00  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  1.22633880000000E+01
 Unitary Cell Volume (ucvol) [Bohr^3]=  5.97397811876170E+02
 Angles (23,13,12)= [degrees]
  9.00000000000000E+01  9.00000000000000E+01  1.20000000000000E+02
 Lengths [Bohr]
  7.50000000000000E+00  7.50000000000000E+00  1.22633880000000E+01
 Stress tensor in cartesian coordinates (strten) [Ha/bohr^3]
  2.25075990118991E-04  0.00000000000000E+00  0.00000000000000E+00
  0.00000000000000E+00  2.25075990118992E-04  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  2.57922984317097E-04
 Total energy (etotal) [Ha]= -1.86183200877264E+01

--- Iteration: ( 2/14) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

--- !BeginCycle
iteration_state: {dtset: 2, itime: 2, icycle: 1, }
solver: {iscf: 7, nstep: 40, nline: 4, wfoptalg: 0, }
tolerances: {tolvrs: 1.00E-18, }
...

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -18.620612382219    -1.862E+01 1.503E-06 2.580E-01 1.091E-05 1.089E-05
 ETOT  2  -18.620986307379    -3.739E-04 5.199E-09 2.345E-02 1.441E-04 1.332E-04
 ETOT  3  -18.621026902969    -4.060E-05 1.907E-07 1.458E-03 2.721E-05 1.060E-04
 ETOT  4  -18.621028206943    -1.304E-06 3.995E-09 1.431E-05 3.751E-06 1.098E-04
 ETOT  5  -18.621028214121    -7.178E-09 2.107E-11 1.086E-07 8.898E-07 1.106E-04
 ETOT  6  -18.621028214204    -8.239E-11 2.905E-13 9.383E-10 1.313E-07 1.108E-04
 ETOT  7  -18.621028214205    -8.278E-13 7.804E-15 1.537E-11 6.631E-08 1.108E-04
 ETOT  8  -18.621028214205    -3.553E-14 5.876E-16 3.994E-13 2.346E-08 1.108E-04
 ETOT  9  -18.621028214205    -5.329E-14 1.131E-17 7.415E-15 1.884E-09 1.108E-04
 ETOT 10  -18.621028214205    -6.040E-14 1.155E-19 2.010E-16 3.338E-10 1.108E-04
 ETOT 11  -18.621028214205     8.527E-14 2.621E-21 6.036E-18 2.033E-12 1.108E-04
 ETOT 12  -18.621028214205    -1.421E-14 3.721E-23 1.575E-20 6.644E-13 1.108E-04

 At SCF step   12       vres2   =  1.57E-20 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)=  1.88454442E-04  sigma(3 2)=  0.00000000E+00
  sigma(2 2)=  1.88454442E-04  sigma(3 1)=  0.00000000E+00
  sigma(3 3)=  2.00031817E-04  sigma(2 1)=  0.00000000E+00


--- !ResultsGS
iteration_state: {dtset: 2, itime: 2, icycle: 1, }
comment   : Summary of ground state results
lattice_vectors:
- [  6.4513332,   3.7246790,   0.0000000, ]
- [ -6.4513332,   3.7246790,   0.0000000, ]
- [  0.0000000,   0.0000000,  12.1684977, ]
lattice_lengths: [   7.44936,    7.44936,   12.16850, ]
lattice_angles: [ 90.000,  90.000, 120.000, ] # degrees, (23, 13, 12)
lattice_volume:   5.8479719E+02
convergence: {deltae: -1.421E-14, res2:  1.575E-20, residm:  3.721E-23, diffor:  6.644E-13, }
etotal    :  -1.86210282E+01
entropy   :   0.00000000E+00
fermie    :   1.31053378E-01
cartesian_stress_tensor: # hartree/bohr^3
- [  1.88454442E-04,   0.00000000E+00,   0.00000000E+00, ]
- [  0.00000000E+00,   1.88454442E-04,   0.00000000E+00, ]
- [  0.00000000E+00,   0.00000000E+00,   2.00031817E-04, ]
pressure_GPa:  -5.6581E+00
xred      :
- [  3.3333E-01,   6.6667E-01,   0.0000E+00, Al]
- [  6.6667E-01,   3.3333E-01,   5.0000E-01, Al]
- [  3.3333E-01,   6.6667E-01,   3.7562E-01,  P]
- [  6.6667E-01,   3.3333E-01,   8.7562E-01,  P]
cartesian_forces: # hartree/bohr
- [ -0.00000000E+00,  -0.00000000E+00,  -1.10819316E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,  -1.10819316E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,   1.10819316E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,   1.10819316E-04, ]
force_length_stats: {min:   1.10819316E-04, max:   1.10819316E-04, mean:   1.10819316E-04, }
...

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.90591679
    2        2.00000          0.90591679
    3        2.00000          2.82130215
    4        2.00000          2.82130215

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.15044439506922E+00  3.72467895111161E+00  0.00000000000000E+00
  2.15044439506922E+00  3.72467895111161E+00  6.08424885553802E+00
 -2.15044439506922E+00  3.72467895111161E+00  4.57072974135985E+00
  2.15044439506922E+00  3.72467895111161E+00  1.06549785968979E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.75619887506694E-01
  6.66666666666667E-01  3.33333333333333E-01  8.75619887506694E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 1.10819E-04 6.39816E-05 (free atoms)
 -0.00000000000000E+00 -0.00000000000000E+00 -1.10819316074079E-04
 -0.00000000000000E+00 -0.00000000000000E+00 -1.10819316074079E-04
 -0.00000000000000E+00 -0.00000000000000E+00  1.10819316074079E-04
 -0.00000000000000E+00 -0.00000000000000E+00  1.10819316074079E-04
 Gradient of E wrt nuclear positions in reduced coordinates (gred)
  0.00000000000000E+00 -0.00000000000000E+00  1.34850459399044E-03
  0.00000000000000E+00 -0.00000000000000E+00  1.34850459399044E-03
 -0.00000000000000E+00 -0.00000000000000E+00 -1.34850459399044E-03
 -0.00000000000000E+00 -0.00000000000000E+00 -1.34850459399044E-03
 Scale of Primitive Cell (acell) [bohr]
  7.44935790222323E+00  7.44935790222323E+00  1.21684977110760E+01
 Real space primitive translations (rprimd) [bohr]
  6.45133318520767E+00  3.72467895111161E+00  0.00000000000000E+00
 -6.45133318520767E+00  3.72467895111161E+00  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  1.21684977110760E+01
 Unitary Cell Volume (ucvol) [Bohr^3]=  5.84797189954013E+02
 Angles (23,13,12)= [degrees]
  9.00000000000000E+01  9.00000000000000E+01  1.20000000000000E+02
 Lengths [Bohr]
  7.44935790222323E+00  7.44935790222323E+00  1.21684977110760E+01
 Stress tensor in cartesian coordinates (strten) [Ha/bohr^3]
  1.88454441934327E-04  0.00000000000000E+00  0.00000000000000E+00
  0.00000000000000E+00  1.88454441934328E-04  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  2.00031817288747E-04
 Total energy (etotal) [Ha]= -1.86210282142047E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)=-2.70813E-03
           Relative     =-1.45444E-04

--- Iteration: ( 3/14) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

--- !BeginCycle
iteration_state: {dtset: 2, itime: 3, icycle: 1, }
solver: {iscf: 7, nstep: 40, nline: 4, wfoptalg: 0, }
tolerances: {tolvrs: 1.00E-18, }
...

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -18.620395113105    -1.862E+01 9.908E-03 3.593E+00 1.450E-04 2.558E-04
 ETOT  2  -18.625373181703    -4.978E-03 4.200E-08 2.675E-01 2.159E-04 4.717E-04
 ETOT  3  -18.625795988679    -4.228E-04 1.903E-06 1.631E-02 6.805E-05 4.037E-04
 ETOT  4  -18.625809982700    -1.399E-05 5.181E-08 1.403E-04 2.163E-05 4.253E-04
 ETOT  5  -18.625810049870    -6.717E-08 2.439E-10 8.583E-07 1.551E-06 4.237E-04
 ETOT  6  -18.625810050436    -5.665E-10 1.651E-12 9.881E-09 2.189E-06 4.259E-04
 ETOT  7  -18.625810050446    -9.187E-12 2.327E-13 2.881E-10 6.753E-07 4.252E-04
 ETOT  8  -18.625810050446    -4.903E-13 1.487E-14 3.011E-12 1.672E-07 4.254E-04
 ETOT  9  -18.625810050446    -5.329E-14 2.343E-17 4.330E-14 1.508E-09 4.254E-04
 ETOT 10  -18.625810050446    -6.395E-14 2.017E-19 1.066E-15 5.942E-10 4.254E-04
 ETOT 11  -18.625810050446     4.974E-14 8.078E-21 3.085E-17 4.785E-11 4.254E-04
 ETOT 12  -18.625810050446     7.461E-14 3.354E-22 1.214E-18 9.307E-12 4.254E-04
 ETOT 13  -18.625810050446    -1.243E-13 6.935E-24 3.688E-21 1.101E-12 4.254E-04

 At SCF step   13       vres2   =  3.69E-21 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)= -1.39970905E-05  sigma(3 2)=  0.00000000E+00
  sigma(2 2)= -1.39970905E-05  sigma(3 1)=  0.00000000E+00
  sigma(3 3)= -4.19456506E-05  sigma(2 1)=  0.00000000E+00


--- !ResultsGS
iteration_state: {dtset: 2, itime: 3, icycle: 1, }
comment   : Summary of ground state results
lattice_vectors:
- [  6.2744758,   3.6225703,   0.0000000, ]
- [ -6.2744758,   3.6225703,   0.0000000, ]
- [  0.0000000,   0.0000000,  11.8139166, ]
lattice_lengths: [   7.24514,    7.24514,   11.81392, ]
lattice_angles: [ 90.000,  90.000, 120.000, ] # degrees, (23, 13, 12)
lattice_volume:   5.3705426E+02
convergence: {deltae: -1.243E-13, res2:  3.688E-21, residm:  6.935E-24, diffor:  1.101E-12, }
etotal    :  -1.86258101E+01
entropy   :   0.00000000E+00
fermie    :   1.58359077E-01
cartesian_stress_tensor: # hartree/bohr^3
- [ -1.39970905E-05,   0.00000000E+00,   0.00000000E+00, ]
- [  0.00000000E+00,  -1.39970905E-05,   0.00000000E+00, ]
- [  0.00000000E+00,   0.00000000E+00,  -4.19456506E-05, ]
pressure_GPa:   6.8590E-01
xred      :
- [  3.3333E-01,   6.6667E-01,   0.0000E+00, Al]
- [  6.6667E-01,   3.3333E-01,   5.0000E-01, Al]
- [  3.3333E-01,   6.6667E-01,   3.7566E-01,  P]
- [  6.6667E-01,   3.3333E-01,   8.7566E-01,  P]
cartesian_forces: # hartree/bohr
- [ -0.00000000E+00,  -0.00000000E+00,  -4.25409742E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,  -4.25409742E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,   4.25409742E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,   4.25409742E-04, ]
force_length_stats: {min:   4.25409742E-04, max:   4.25409742E-04, mean:   4.25409742E-04, }
...

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.91832880
    2        2.00000          0.91832880
    3        2.00000          2.85654582
    4        2.00000          2.85654582

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.09149193396900E+00  3.62257029325479E+00  0.00000000000000E+00
  2.09149193396900E+00  3.62257029325479E+00  5.90695830178881E+00
 -2.09149193396900E+00  3.62257029325479E+00  4.43806047508582E+00
  2.09149193396900E+00  3.62257029325479E+00  1.03450187768746E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.75663772143256E-01
  6.66666666666667E-01  3.33333333333333E-01  8.75663772143256E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 4.25410E-04 2.45610E-04 (free atoms)
 -0.00000000000000E+00 -0.00000000000000E+00 -4.25409742377248E-04
 -0.00000000000000E+00 -0.00000000000000E+00 -4.25409742377248E-04
 -0.00000000000000E+00 -0.00000000000000E+00  4.25409742377248E-04
 -0.00000000000000E+00 -0.00000000000000E+00  4.25409742377248E-04
 Gradient of E wrt nuclear positions in reduced coordinates (gred)
  0.00000000000000E+00 -0.00000000000000E+00  5.02575521879426E-03
  0.00000000000000E+00 -0.00000000000000E+00  5.02575521879426E-03
 -0.00000000000000E+00 -0.00000000000000E+00 -5.02575521879426E-03
 -0.00000000000000E+00 -0.00000000000000E+00 -5.02575521879426E-03
 Scale of Primitive Cell (acell) [bohr]
  7.24514058650959E+00  7.24514058650959E+00  1.18139166035776E+01
 Real space primitive translations (rprimd) [bohr]
  6.27447580190699E+00  3.62257029325479E+00  0.00000000000000E+00
 -6.27447580190699E+00  3.62257029325479E+00  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  1.18139166035776E+01
 Unitary Cell Volume (ucvol) [Bohr^3]=  5.37054260913142E+02
 Angles (23,13,12)= [degrees]
  9.00000000000000E+01  9.00000000000000E+01  1.20000000000000E+02
 Lengths [Bohr]
  7.24514058650959E+00  7.24514058650959E+00  1.18139166035776E+01
 Stress tensor in cartesian coordinates (strten) [Ha/bohr^3]
 -1.39970905483387E-05  0.00000000000000E+00  0.00000000000000E+00
  0.00000000000000E+00 -1.39970905483376E-05  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00 -4.19456506275877E-05
 Total energy (etotal) [Ha]= -1.86258100504462E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)=-4.78184E-03
           Relative     =-2.56765E-04

--- Iteration: ( 4/14) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

--- !BeginCycle
iteration_state: {dtset: 2, itime: 4, icycle: 1, }
solver: {iscf: 7, nstep: 40, nline: 4, wfoptalg: 0, }
tolerances: {tolvrs: 1.00E-18, }
...

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -18.625793678800    -1.863E+01 1.787E-09 3.885E-02 4.284E-05 3.826E-04
 ETOT  2  -18.625847789618    -5.411E-05 4.726E-10 2.903E-03 2.013E-04 1.812E-04
 ETOT  3  -18.625852418689    -4.629E-06 2.096E-08 1.804E-04 2.769E-05 2.089E-04
 ETOT  4  -18.625852575632    -1.569E-07 5.685E-10 1.756E-06 8.536E-07 2.081E-04
 ETOT  5  -18.625852576495    -8.628E-10 2.977E-12 1.315E-08 1.737E-06 2.063E-04
 ETOT  6  -18.625852576505    -1.053E-11 2.497E-13 3.932E-10 5.589E-07 2.069E-04
 ETOT  7  -18.625852576506    -5.862E-13 1.436E-14 6.494E-12 1.664E-07 2.067E-04
 ETOT  8  -18.625852576506     8.171E-14 1.192E-16 2.415E-14 9.161E-09 2.067E-04
 ETOT  9  -18.625852576506    -2.132E-14 6.782E-19 3.275E-16 8.788E-10 2.067E-04
 ETOT 10  -18.625852576506    -1.208E-13 4.568E-21 1.091E-17 3.665E-11 2.067E-04
 ETOT 11  -18.625852576506     8.527E-14 2.016E-22 2.553E-19 3.321E-12 2.067E-04

 At SCF step   11       vres2   =  2.55E-19 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)=  1.55753314E-05  sigma(3 2)=  0.00000000E+00
  sigma(2 2)=  1.55753314E-05  sigma(3 1)=  0.00000000E+00
  sigma(3 3)= -7.65222386E-06  sigma(2 1)=  0.00000000E+00


--- !ResultsGS
iteration_state: {dtset: 2, itime: 4, icycle: 1, }
comment   : Summary of ground state results
lattice_vectors:
- [  6.2908835,   3.6320433,   0.0000000, ]
- [ -6.2908835,   3.6320433,   0.0000000, ]
- [  0.0000000,   0.0000000,  11.8548195, ]
lattice_lengths: [   7.26409,    7.26409,   11.85482, ]
lattice_angles: [ 90.000,  90.000, 120.000, ] # degrees, (23, 13, 12)
lattice_volume:   5.4173589E+02
convergence: {deltae:  8.527E-14, res2:  2.553E-19, residm:  2.016E-22, diffor:  3.321E-12, }
etotal    :  -1.86258526E+01
entropy   :   0.00000000E+00
fermie    :   1.55492149E-01
cartesian_stress_tensor: # hartree/bohr^3
- [  1.55753314E-05,   0.00000000E+00,   0.00000000E+00, ]
- [  0.00000000E+00,   1.55753314E-05,   0.00000000E+00, ]
- [  0.00000000E+00,   0.00000000E+00,  -7.65222386E-06, ]
pressure_GPa:  -2.3045E-01
xred      :
- [  3.3333E-01,   6.6667E-01,   0.0000E+00, Al]
- [  6.6667E-01,   3.3333E-01,   5.0000E-01, Al]
- [  3.3333E-01,   6.6667E-01,   3.7569E-01,  P]
- [  6.6667E-01,   3.3333E-01,   8.7569E-01,  P]
cartesian_forces: # hartree/bohr
- [ -0.00000000E+00,  -0.00000000E+00,  -2.06742072E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,  -2.06742072E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,   2.06742072E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,   2.06742072E-04, ]
force_length_stats: {min:   2.06742072E-04, max:   2.06742072E-04, mean:   2.06742072E-04, }
...

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.90107151
    2        2.00000          0.90107151
    3        2.00000          2.86882662
    4        2.00000          2.86882662

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.09696118265684E+00  3.63204330986136E+00  0.00000000000000E+00
  2.09696118265684E+00  3.63204330986136E+00  5.92740976257752E+00
 -2.09696118265684E+00  3.63204330986136E+00  4.45373962567437E+00
  2.09696118265684E+00  3.63204330986136E+00  1.03811493882519E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.75690209051591E-01
  6.66666666666667E-01  3.33333333333333E-01  8.75690209051590E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 2.06742E-04 1.19363E-04 (free atoms)
 -0.00000000000000E+00 -0.00000000000000E+00 -2.06742071558979E-04
 -0.00000000000000E+00 -0.00000000000000E+00 -2.06742071558979E-04
 -0.00000000000000E+00 -0.00000000000000E+00  2.06742071558979E-04
 -0.00000000000000E+00 -0.00000000000000E+00  2.06742071558979E-04
 Gradient of E wrt nuclear positions in reduced coordinates (gred)
  0.00000000000000E+00 -0.00000000000000E+00  2.45088994658838E-03
  0.00000000000000E+00 -0.00000000000000E+00  2.45088994658838E-03
 -0.00000000000000E+00 -0.00000000000000E+00 -2.45088994658838E-03
 -0.00000000000000E+00 -0.00000000000000E+00 -2.45088994658838E-03
 Scale of Primitive Cell (acell) [bohr]
  7.26408661972273E+00  7.26408661972273E+00  1.18548195251550E+01
 Real space primitive translations (rprimd) [bohr]
  6.29088354797052E+00  3.63204330986136E+00  0.00000000000000E+00
 -6.29088354797052E+00  3.63204330986136E+00  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  1.18548195251550E+01
 Unitary Cell Volume (ucvol) [Bohr^3]=  5.41735887995156E+02
 Angles (23,13,12)= [degrees]
  9.00000000000000E+01  9.00000000000000E+01  1.20000000000000E+02
 Lengths [Bohr]
  7.26408661972273E+00  7.26408661972273E+00  1.18548195251550E+01
 Stress tensor in cartesian coordinates (strten) [Ha/bohr^3]
  1.55753314158374E-05  0.00000000000000E+00  0.00000000000000E+00
  0.00000000000000E+00  1.55753314158380E-05  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00 -7.65222385635644E-06
 Total energy (etotal) [Ha]= -1.86258525765057E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)=-4.25261E-05
           Relative     =-2.28318E-06

--- Iteration: ( 5/14) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

--- !BeginCycle
iteration_state: {dtset: 2, itime: 5, icycle: 1, }
solver: {iscf: 7, nstep: 40, nline: 4, wfoptalg: 0, }
tolerances: {tolvrs: 1.00E-18, }
...

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -18.625858508358    -1.863E+01 3.351E-06 1.926E-03 1.309E-05 1.937E-04
 ETOT  2  -18.625861201462    -2.693E-06 2.743E-11 1.278E-04 1.348E-04 5.882E-05
 ETOT  3  -18.625861409881    -2.084E-07 1.018E-09 7.594E-06 1.405E-05 7.287E-05
 ETOT  4  -18.625861417021    -7.140E-09 2.493E-11 1.069E-07 1.342E-06 7.421E-05
 ETOT  5  -18.625861417078    -5.657E-11 9.874E-13 2.229E-09 1.234E-06 7.298E-05
 ETOT  6  -18.625861417080    -2.480E-12 7.654E-14 8.329E-11 4.062E-07 7.338E-05
 ETOT  7  -18.625861417080    -5.684E-14 1.038E-15 8.088E-13 3.643E-08 7.335E-05
 ETOT  8  -18.625861417080    -6.040E-14 3.164E-18 5.824E-15 2.806E-09 7.335E-05
 ETOT  9  -18.625861417080     1.457E-13 7.402E-20 1.385E-16 3.466E-10 7.335E-05
 ETOT 10  -18.625861417080    -1.315E-13 1.353E-21 2.789E-18 1.838E-11 7.335E-05
 ETOT 11  -18.625861417080     8.882E-14 1.915E-23 2.685E-20 1.934E-12 7.335E-05

 At SCF step   11       vres2   =  2.69E-20 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)=  7.78752386E-06  sigma(3 2)=  0.00000000E+00
  sigma(2 2)=  7.78752386E-06  sigma(3 1)=  0.00000000E+00
  sigma(3 3)= -1.10361440E-05  sigma(2 1)=  0.00000000E+00


--- !ResultsGS
iteration_state: {dtset: 2, itime: 5, icycle: 1, }
comment   : Summary of ground state results
lattice_vectors:
- [  6.2859119,   3.6291729,   0.0000000, ]
- [ -6.2859119,   3.6291729,   0.0000000, ]
- [  0.0000000,   0.0000000,  11.8519295, ]
lattice_lengths: [   7.25835,    7.25835,   11.85193, ]
lattice_angles: [ 90.000,  90.000, 120.000, ] # degrees, (23, 13, 12)
lattice_volume:   5.4074811E+02
convergence: {deltae:  8.882E-14, res2:  2.685E-20, residm:  1.915E-23, diffor:  1.934E-12, }
etotal    :  -1.86258614E+01
entropy   :   0.00000000E+00
fermie    :   1.56114476E-01
cartesian_stress_tensor: # hartree/bohr^3
- [  7.78752386E-06,   0.00000000E+00,   0.00000000E+00, ]
- [  0.00000000E+00,   7.78752386E-06,   0.00000000E+00, ]
- [  0.00000000E+00,   0.00000000E+00,  -1.10361440E-05, ]
pressure_GPa:  -4.4513E-02
xred      :
- [  3.3333E-01,   6.6667E-01,   0.0000E+00, Al]
- [  6.6667E-01,   3.3333E-01,   5.0000E-01, Al]
- [  3.3333E-01,   6.6667E-01,   3.7571E-01,  P]
- [  6.6667E-01,   3.3333E-01,   8.7571E-01,  P]
cartesian_forces: # hartree/bohr
- [ -0.00000000E+00,  -0.00000000E+00,  -7.33456414E-05, ]
- [ -0.00000000E+00,  -0.00000000E+00,  -7.33456414E-05, ]
- [ -0.00000000E+00,  -0.00000000E+00,   7.33456414E-05, ]
- [ -0.00000000E+00,  -0.00000000E+00,   7.33456414E-05, ]
force_length_stats: {min:   7.33456414E-05, max:   7.33456414E-05, mean:   7.33456414E-05, }
...

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.90039806
    2        2.00000          0.90039806
    3        2.00000          2.86620564
    4        2.00000          2.86620564

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.09530396796376E+00  3.62917292981390E+00  0.00000000000000E+00
  2.09530396796376E+00  3.62917292981390E+00  5.92596474011772E+00
 -2.09530396796376E+00  3.62917292981390E+00  4.45284585239999E+00
  2.09530396796376E+00  3.62917292981390E+00  1.03788105925177E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.75706407958777E-01
  6.66666666666667E-01  3.33333333333333E-01  8.75706407958777E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 7.33456E-05 4.23461E-05 (free atoms)
 -0.00000000000000E+00 -0.00000000000000E+00 -7.33456413678862E-05
 -0.00000000000000E+00 -0.00000000000000E+00 -7.33456413678862E-05
 -0.00000000000000E+00 -0.00000000000000E+00  7.33456413678862E-05
 -0.00000000000000E+00 -0.00000000000000E+00  7.33456413678862E-05
 Gradient of E wrt nuclear positions in reduced coordinates (gred)
  0.00000000000000E+00 -0.00000000000000E+00  8.69287369174826E-04
  0.00000000000000E+00 -0.00000000000000E+00  8.69287369174826E-04
 -0.00000000000000E+00 -0.00000000000000E+00 -8.69287369174826E-04
 -0.00000000000000E+00 -0.00000000000000E+00 -8.69287369174826E-04
 Scale of Primitive Cell (acell) [bohr]
  7.25834585962779E+00  7.25834585962779E+00  1.18519294802354E+01
 Real space primitive translations (rprimd) [bohr]
  6.28591190389127E+00  3.62917292981390E+00  0.00000000000000E+00
 -6.28591190389127E+00  3.62917292981390E+00  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  1.18519294802354E+01
 Unitary Cell Volume (ucvol) [Bohr^3]=  5.40748106461164E+02
 Angles (23,13,12)= [degrees]
  9.00000000000000E+01  9.00000000000000E+01  1.20000000000000E+02
 Lengths [Bohr]
  7.25834585962779E+00  7.25834585962779E+00  1.18519294802354E+01
 Stress tensor in cartesian coordinates (strten) [Ha/bohr^3]
  7.78752386425469E-06  0.00000000000000E+00  0.00000000000000E+00
  0.00000000000000E+00  7.78752386425567E-06  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00 -1.10361439805695E-05
 Total energy (etotal) [Ha]= -1.86258614170802E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)=-8.84057E-06
           Relative     =-4.74640E-07

--- Iteration: ( 6/14) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

--- !BeginCycle
iteration_state: {dtset: 2, itime: 6, icycle: 1, }
solver: {iscf: 7, nstep: 40, nline: 4, wfoptalg: 0, }
tolerances: {tolvrs: 1.00E-18, }
...

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -18.625865269519    -1.863E+01 2.076E-07 1.463E-03 2.606E-05 4.729E-05
 ETOT  2  -18.625867220594    -1.951E-06 1.624E-11 4.966E-05 2.703E-04 2.230E-04
 ETOT  3  -18.625867298256    -7.766E-08 8.062E-10 3.920E-06 3.316E-05 1.898E-04
 ETOT  4  -18.625867303221    -4.965E-09 3.475E-11 8.712E-08 2.277E-06 1.921E-04
 ETOT  5  -18.625867303291    -7.034E-11 1.347E-12 3.094E-09 1.496E-06 1.936E-04
 ETOT  6  -18.625867303295    -4.206E-12 7.305E-14 5.638E-11 4.125E-07 1.932E-04
 ETOT  7  -18.625867303295     3.908E-14 2.085E-16 1.484E-12 1.263E-08 1.932E-04
 ETOT  8  -18.625867303295     9.592E-14 2.504E-17 2.307E-14 7.324E-09 1.932E-04
 ETOT  9  -18.625867303295    -2.096E-13 8.807E-19 7.499E-16 1.296E-09 1.932E-04
 ETOT 10  -18.625867303295     5.329E-14 1.270E-20 2.022E-18 1.223E-10 1.932E-04
 ETOT 11  -18.625867303295     3.908E-14 4.608E-23 4.713E-20 9.957E-12 1.932E-04

 At SCF step   11       vres2   =  4.71E-20 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)=  1.16252444E-06  sigma(3 2)=  0.00000000E+00
  sigma(2 2)=  1.16252444E-06  sigma(3 1)=  0.00000000E+00
  sigma(3 3)= -8.76785702E-06  sigma(2 1)=  0.00000000E+00


--- !ResultsGS
iteration_state: {dtset: 2, itime: 6, icycle: 1, }
comment   : Summary of ground state results
lattice_vectors:
- [  6.2814410,   3.6265917,   0.0000000, ]
- [ -6.2814410,   3.6265917,   0.0000000, ]
- [  0.0000000,   0.0000000,  11.8573760, ]
lattice_lengths: [   7.25318,    7.25318,   11.85738, ]
lattice_angles: [ 90.000,  90.000, 120.000, ] # degrees, (23, 13, 12)
lattice_volume:   5.4022731E+02
convergence: {deltae:  3.908E-14, res2:  4.713E-20, residm:  4.608E-23, diffor:  9.957E-12, }
etotal    :  -1.86258673E+01
entropy   :   0.00000000E+00
fermie    :   1.56475498E-01
cartesian_stress_tensor: # hartree/bohr^3
- [  1.16252444E-06,   0.00000000E+00,   0.00000000E+00, ]
- [  0.00000000E+00,   1.16252444E-06,   0.00000000E+00, ]
- [  0.00000000E+00,   0.00000000E+00,  -8.76785702E-06, ]
pressure_GPa:   6.3185E-02
xred      :
- [  3.3333E-01,   6.6667E-01,   0.0000E+00, Al]
- [  6.6667E-01,   3.3333E-01,   5.0000E-01, Al]
- [  3.3333E-01,   6.6667E-01,   3.7573E-01,  P]
- [  6.6667E-01,   3.3333E-01,   8.7573E-01,  P]
cartesian_forces: # hartree/bohr
- [ -0.00000000E+00,  -0.00000000E+00,   1.93163980E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,   1.93163980E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,  -1.93163980E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,  -1.93163980E-04, ]
force_length_stats: {min:   1.93163980E-04, max:   1.93163980E-04, mean:   1.93163980E-04, }
...

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.90005809
    2        2.00000          0.90005809
    3        2.00000          2.86477951
    4        2.00000          2.86477951

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.09381367444273E+00  3.62659166571729E+00  0.00000000000000E+00
  2.09381367444273E+00  3.62659166571729E+00  5.92868798591793E+00
 -2.09381367444273E+00  3.62659166571729E+00  4.45511343042603E+00
  2.09381367444273E+00  3.62659166571729E+00  1.03838014163440E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.75725071129397E-01
  6.66666666666667E-01  3.33333333333333E-01  8.75725071129396E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 1.93164E-04 1.11523E-04 (free atoms)
 -0.00000000000000E+00 -0.00000000000000E+00  1.93163979895613E-04
 -0.00000000000000E+00 -0.00000000000000E+00  1.93163979895613E-04
 -0.00000000000000E+00 -0.00000000000000E+00 -1.93163979895613E-04
 -0.00000000000000E+00 -0.00000000000000E+00 -1.93163979895613E-04
 Gradient of E wrt nuclear positions in reduced coordinates (gred)
 -0.00000000000000E+00 -0.00000000000000E+00 -2.29041793383842E-03
 -0.00000000000000E+00 -0.00000000000000E+00 -2.29041793383842E-03
  0.00000000000000E+00 -0.00000000000000E+00  2.29041793383842E-03
  0.00000000000000E+00 -0.00000000000000E+00  2.29041793383842E-03
 Scale of Primitive Cell (acell) [bohr]
  7.25318333143459E+00  7.25318333143459E+00  1.18573759718359E+01
 Real space primitive translations (rprimd) [bohr]
  6.28144102332820E+00  3.62659166571729E+00  0.00000000000000E+00
 -6.28144102332820E+00  3.62659166571729E+00  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  1.18573759718359E+01
 Unitary Cell Volume (ucvol) [Bohr^3]=  5.40227305981169E+02
 Angles (23,13,12)= [degrees]
  9.00000000000000E+01  9.00000000000000E+01  1.20000000000000E+02
 Lengths [Bohr]
  7.25318333143459E+00  7.25318333143459E+00  1.18573759718359E+01
 Stress tensor in cartesian coordinates (strten) [Ha/bohr^3]
  1.16252444225967E-06  0.00000000000000E+00  0.00000000000000E+00
  0.00000000000000E+00  1.16252444226032E-06  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00 -8.76785701522736E-06
 Total energy (etotal) [Ha]= -1.86258673032953E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)=-5.88622E-06
           Relative     =-3.16024E-07

--- Iteration: ( 7/14) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

--- !BeginCycle
iteration_state: {dtset: 2, itime: 7, icycle: 1, }
solver: {iscf: 7, nstep: 40, nline: 4, wfoptalg: 0, }
tolerances: {tolvrs: 1.00E-18, }
...

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -18.625868953262    -1.863E+01 4.856E-09 7.431E-04 1.192E-05 2.051E-04
 ETOT  2  -18.625869887932    -9.347E-07 6.894E-12 1.516E-05 2.144E-04 4.195E-04
 ETOT  3  -18.625869906582    -1.865E-08 4.124E-10 1.148E-06 2.922E-05 3.903E-04
 ETOT  4  -18.625869907858    -1.276E-09 3.123E-11 3.935E-08 5.923E-06 3.962E-04
 ETOT  5  -18.625869907892    -3.401E-11 1.777E-13 1.087E-09 1.881E-07 3.960E-04
 ETOT  6  -18.625869907893    -1.510E-12 1.115E-14 2.611E-11 1.495E-07 3.959E-04
 ETOT  7  -18.625869907893     3.553E-15 1.072E-16 4.209E-13 3.281E-09 3.959E-04
 ETOT  8  -18.625869907893    -2.487E-14 3.280E-18 6.774E-15 2.733E-09 3.959E-04
 ETOT  9  -18.625869907893     1.776E-14 2.099E-19 9.837E-17 6.040E-10 3.959E-04
 ETOT 10  -18.625869907893    -6.040E-14 5.427E-21 4.191E-19 8.930E-11 3.959E-04

 At SCF step   10       vres2   =  4.19E-19 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)= -8.75599287E-07  sigma(3 2)=  0.00000000E+00
  sigma(2 2)= -8.75599287E-07  sigma(3 1)=  0.00000000E+00
  sigma(3 3)= -3.55285664E-06  sigma(2 1)=  0.00000000E+00


--- !ResultsGS
iteration_state: {dtset: 2, itime: 7, icycle: 1, }
comment   : Summary of ground state results
lattice_vectors:
- [  6.2795828,   3.6255188,   0.0000000, ]
- [ -6.2795828,   3.6255188,   0.0000000, ]
- [  0.0000000,   0.0000000,  11.8662846, ]
lattice_lengths: [   7.25104,    7.25104,   11.86628, ]
lattice_angles: [ 90.000,  90.000, 120.000, ] # degrees, (23, 13, 12)
lattice_volume:   5.4031336E+02
convergence: {deltae: -6.040E-14, res2:  4.191E-19, residm:  5.427E-21, diffor:  8.930E-11, }
etotal    :  -1.86258699E+01
entropy   :   0.00000000E+00
fermie    :   1.56468117E-01
cartesian_stress_tensor: # hartree/bohr^3
- [ -8.75599287E-07,   0.00000000E+00,   0.00000000E+00, ]
- [  0.00000000E+00,  -8.75599287E-07,   0.00000000E+00, ]
- [  0.00000000E+00,   0.00000000E+00,  -3.55285664E-06, ]
pressure_GPa:   5.2017E-02
xred      :
- [  3.3333E-01,   6.6667E-01,   0.0000E+00, Al]
- [  6.6667E-01,   3.3333E-01,   5.0000E-01, Al]
- [  3.3333E-01,   6.6667E-01,   3.7572E-01,  P]
- [  6.6667E-01,   3.3333E-01,   8.7572E-01,  P]
cartesian_forces: # hartree/bohr
- [ -0.00000000E+00,  -0.00000000E+00,   3.95857718E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,   3.95857718E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,  -3.95857718E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,  -3.95857718E-04, ]
force_length_stats: {min:   3.95857718E-04, max:   3.95857718E-04, mean:   3.95857718E-04, }
...

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.90013554
    2        2.00000          0.90013554
    3        2.00000          2.86496203
    4        2.00000          2.86496203

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.09319425891119E+00  3.62551880654566E+00  0.00000000000000E+00
  2.09319425891119E+00  3.62551880654566E+00  5.93314228584360E+00
 -2.09319425891119E+00  3.62551880654566E+00  4.45834460026049E+00
  2.09319425891119E+00  3.62551880654566E+00  1.03914868861041E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.75715294313609E-01
  6.66666666666667E-01  3.33333333333333E-01  8.75715294313609E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 3.95858E-04 2.28549E-04 (free atoms)
 -0.00000000000000E+00 -0.00000000000000E+00  3.95857717623423E-04
 -0.00000000000000E+00 -0.00000000000000E+00  3.95857717623423E-04
 -0.00000000000000E+00 -0.00000000000000E+00 -3.95857717623423E-04
 -0.00000000000000E+00 -0.00000000000000E+00 -3.95857717623423E-04
 Gradient of E wrt nuclear positions in reduced coordinates (gred)
 -0.00000000000000E+00 -0.00000000000000E+00 -4.69736032721813E-03
 -0.00000000000000E+00 -0.00000000000000E+00 -4.69736032721813E-03
  0.00000000000000E+00 -0.00000000000000E+00  4.69736032721813E-03
  0.00000000000000E+00 -0.00000000000000E+00  4.69736032721813E-03
 Scale of Primitive Cell (acell) [bohr]
  7.25103761309133E+00  7.25103761309133E+00  1.18662845716872E+01
 Real space primitive translations (rprimd) [bohr]
  6.27958277673357E+00  3.62551880654566E+00  0.00000000000000E+00
 -6.27958277673357E+00  3.62551880654566E+00  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  1.18662845716872E+01
 Unitary Cell Volume (ucvol) [Bohr^3]=  5.40313360663965E+02
 Angles (23,13,12)= [degrees]
  9.00000000000000E+01  9.00000000000000E+01  1.20000000000000E+02
 Lengths [Bohr]
  7.25103761309133E+00  7.25103761309133E+00  1.18662845716872E+01
 Stress tensor in cartesian coordinates (strten) [Ha/bohr^3]
 -8.75599287274110E-07  0.00000000000000E+00  0.00000000000000E+00
  0.00000000000000E+00 -8.75599287273243E-07  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00 -3.55285663999091E-06
 Total energy (etotal) [Ha]= -1.86258699078934E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)=-2.60460E-06
           Relative     =-1.39838E-07

--- Iteration: ( 8/14) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

--- !BeginCycle
iteration_state: {dtset: 2, itime: 8, icycle: 1, }
solver: {iscf: 7, nstep: 40, nline: 4, wfoptalg: 0, }
tolerances: {tolvrs: 1.00E-18, }
...

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -18.625870500468    -1.863E+01 5.961E-10 2.372E-04 1.039E-05 3.855E-04
 ETOT  2  -18.625870792938    -2.925E-07 5.265E-12 8.796E-06 7.087E-05 4.563E-04
 ETOT  3  -18.625870803317    -1.038E-08 7.753E-11 9.245E-07 8.286E-06 4.481E-04
 ETOT  4  -18.625870804441    -1.124E-09 5.697E-12 2.550E-08 1.022E-06 4.491E-04
 ETOT  5  -18.625870804458    -1.721E-11 1.126E-13 3.482E-10 3.143E-07 4.494E-04
 ETOT  6  -18.625870804459    -4.015E-13 1.043E-14 9.577E-12 1.310E-07 4.493E-04
 ETOT  7  -18.625870804459     7.105E-14 1.044E-16 1.308E-13 1.698E-08 4.493E-04
 ETOT  8  -18.625870804459    -1.670E-13 5.207E-19 1.388E-15 1.234E-09 4.493E-04
 ETOT  9  -18.625870804459     6.040E-14 2.421E-20 3.472E-17 2.160E-10 4.493E-04
 ETOT 10  -18.625870804459    -3.553E-14 2.296E-22 4.314E-19 1.616E-11 4.493E-04

 At SCF step   10       vres2   =  4.31E-19 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)= -4.88693819E-07  sigma(3 2)=  0.00000000E+00
  sigma(2 2)= -4.88693819E-07  sigma(3 1)=  0.00000000E+00
  sigma(3 3)= -8.98637303E-08  sigma(2 1)=  0.00000000E+00


--- !ResultsGS
iteration_state: {dtset: 2, itime: 8, icycle: 1, }
comment   : Summary of ground state results
lattice_vectors:
- [  6.2793463,   3.6253823,   0.0000000, ]
- [ -6.2793463,   3.6253823,   0.0000000, ]
- [  0.0000000,   0.0000000,  11.8721234, ]
lattice_lengths: [   7.25076,    7.25076,   11.87212, ]
lattice_angles: [ 90.000,  90.000, 120.000, ] # degrees, (23, 13, 12)
lattice_volume:   5.4053850E+02
convergence: {deltae: -3.553E-14, res2:  4.314E-19, residm:  2.296E-22, diffor:  1.616E-11, }
etotal    :  -1.86258708E+01
entropy   :   0.00000000E+00
fermie    :   1.56365747E-01
cartesian_stress_tensor: # hartree/bohr^3
- [ -4.88693819E-07,   0.00000000E+00,   0.00000000E+00, ]
- [  0.00000000E+00,  -4.88693819E-07,   0.00000000E+00, ]
- [  0.00000000E+00,   0.00000000E+00,  -8.98637303E-08, ]
pressure_GPa:   1.0467E-02
xred      :
- [  3.3333E-01,   6.6667E-01,   0.0000E+00, Al]
- [  6.6667E-01,   3.3333E-01,   5.0000E-01, Al]
- [  3.3333E-01,   6.6667E-01,   3.7567E-01,  P]
- [  6.6667E-01,   3.3333E-01,   8.7567E-01,  P]
cartesian_forces: # hartree/bohr
- [ -0.00000000E+00,  -0.00000000E+00,   4.49281900E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,   4.49281900E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,  -4.49281900E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,  -4.49281900E-04, ]
force_length_stats: {min:   4.49281900E-04, max:   4.49281900E-04, mean:   4.49281900E-04, }
...

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.90030008
    2        2.00000          0.90030008
    3        2.00000          2.86554358
    4        2.00000          2.86554358

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.09311541811792E+00  3.62538225028602E+00  0.00000000000000E+00
  2.09311541811793E+00  3.62538225028602E+00  5.93606171717127E+00
 -2.09311541811792E+00  3.62538225028602E+00  4.46003090104898E+00
  2.09311541811793E+00  3.62538225028602E+00  1.03960926182202E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.75672551394423E-01
  6.66666666666667E-01  3.33333333333333E-01  8.75672551394423E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 4.49282E-04 2.59393E-04 (free atoms)
 -0.00000000000000E+00 -0.00000000000000E+00  4.49281899510563E-04
 -0.00000000000000E+00 -0.00000000000000E+00  4.49281899510563E-04
 -0.00000000000000E+00 -0.00000000000000E+00 -4.49281899510563E-04
 -0.00000000000000E+00 -0.00000000000000E+00 -4.49281899510563E-04
 Gradient of E wrt nuclear positions in reduced coordinates (gred)
 -0.00000000000000E+00 -0.00000000000000E+00 -5.33393016780528E-03
 -0.00000000000000E+00 -0.00000000000000E+00 -5.33393016780528E-03
  0.00000000000000E+00 -0.00000000000000E+00  5.33393016780528E-03
  0.00000000000000E+00 -0.00000000000000E+00  5.33393016780528E-03
 Scale of Primitive Cell (acell) [bohr]
  7.25076450057204E+00  7.25076450057204E+00  1.18721234343425E+01
 Real space primitive translations (rprimd) [bohr]
  6.27934625435378E+00  3.62538225028602E+00  0.00000000000000E+00
 -6.27934625435378E+00  3.62538225028602E+00  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  1.18721234343425E+01
 Unitary Cell Volume (ucvol) [Bohr^3]=  5.40538503071347E+02
 Angles (23,13,12)= [degrees]
  9.00000000000000E+01  9.00000000000000E+01  1.20000000000000E+02
 Lengths [Bohr]
  7.25076450057204E+00  7.25076450057204E+00  1.18721234343425E+01
 Stress tensor in cartesian coordinates (strten) [Ha/bohr^3]
 -4.88693818601949E-07  0.00000000000000E+00  0.00000000000000E+00
  0.00000000000000E+00 -4.88693818601299E-07  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00 -8.98637302955028E-08
 Total energy (etotal) [Ha]= -1.86258708044586E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)=-8.96565E-07
           Relative     =-4.81355E-08

--- Iteration: ( 9/14) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

--- !BeginCycle
iteration_state: {dtset: 2, itime: 9, icycle: 1, }
solver: {iscf: 7, nstep: 40, nline: 4, wfoptalg: 0, }
tolerances: {tolvrs: 1.00E-18, }
...

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -18.625871338867    -1.863E+01 6.247E-10 8.504E-05 2.591E-05 4.234E-04
 ETOT  2  -18.625871439927    -1.011E-07 1.758E-12 3.036E-06 6.112E-06 4.173E-04
 ETOT  3  -18.625871442909    -2.982E-09 2.556E-11 3.405E-07 2.884E-06 4.201E-04
 ETOT  4  -18.625871443321    -4.124E-10 1.723E-12 1.020E-08 5.202E-07 4.196E-04
 ETOT  5  -18.625871443328    -6.903E-12 3.270E-14 1.057E-10 2.415E-07 4.194E-04
 ETOT  6  -18.625871443328    -1.705E-13 2.592E-15 3.973E-12 8.221E-08 4.195E-04
 ETOT  7  -18.625871443328    -3.553E-14 9.992E-17 4.914E-14 8.987E-09 4.195E-04
 ETOT  8  -18.625871443328     8.527E-14 2.311E-19 4.573E-16 8.677E-11 4.195E-04
 ETOT  9  -18.625871443328    -4.974E-14 2.025E-21 1.135E-17 6.167E-11 4.195E-04
 ETOT 10  -18.625871443328     5.684E-14 8.368E-23 1.278E-19 6.523E-12 4.195E-04

 At SCF step   10       vres2   =  1.28E-19 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)=  1.47343993E-07  sigma(3 2)=  0.00000000E+00
  sigma(2 2)=  1.47343993E-07  sigma(3 1)=  0.00000000E+00
  sigma(3 3)=  1.74934048E-06  sigma(2 1)=  0.00000000E+00


--- !ResultsGS
iteration_state: {dtset: 2, itime: 9, icycle: 1, }
comment   : Summary of ground state results
lattice_vectors:
- [  6.2793062,   3.6253591,   0.0000000, ]
- [ -6.2793062,   3.6253591,   0.0000000, ]
- [  0.0000000,   0.0000000,  11.8757706, ]
lattice_lengths: [   7.25072,    7.25072,   11.87577, ]
lattice_angles: [ 90.000,  90.000, 120.000, ] # degrees, (23, 13, 12)
lattice_volume:   5.4069767E+02
convergence: {deltae:  5.684E-14, res2:  1.278E-19, residm:  8.368E-23, diffor:  6.523E-12, }
etotal    :  -1.86258714E+01
entropy   :   0.00000000E+00
fermie    :   1.56306183E-01
cartesian_stress_tensor: # hartree/bohr^3
- [  1.47343993E-07,   0.00000000E+00,   0.00000000E+00, ]
- [  0.00000000E+00,   1.47343993E-07,   0.00000000E+00, ]
- [  0.00000000E+00,   0.00000000E+00,   1.74934048E-06, ]
pressure_GPa:  -2.0046E-02
xred      :
- [  3.3333E-01,   6.6667E-01,   0.0000E+00, Al]
- [  6.6667E-01,   3.3333E-01,   5.0000E-01, Al]
- [  3.3333E-01,   6.6667E-01,   3.7560E-01,  P]
- [  6.6667E-01,   3.3333E-01,   8.7560E-01,  P]
cartesian_forces: # hartree/bohr
- [ -0.00000000E+00,  -0.00000000E+00,   4.19454717E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,   4.19454717E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,  -4.19454717E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,  -4.19454717E-04, ]
force_length_stats: {min:   4.19454717E-04, max:   4.19454717E-04, mean:   4.19454717E-04, }
...

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.90041513
    2        2.00000          0.90041513
    3        2.00000          2.86597062
    4        2.00000          2.86597062

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.09310207508744E+00  3.62535913947930E+00  0.00000000000000E+00
  2.09310207508744E+00  3.62535913947930E+00  5.93788529961910E+00
 -2.09310207508744E+00  3.62535913947930E+00  4.46052398245148E+00
  2.09310207508744E+00  3.62535913947930E+00  1.03984092820706E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.75598698642563E-01
  6.66666666666667E-01  3.33333333333333E-01  8.75598698642563E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 4.19455E-04 2.42172E-04 (free atoms)
 -0.00000000000000E+00 -0.00000000000000E+00  4.19454716917441E-04
 -0.00000000000000E+00 -0.00000000000000E+00  4.19454716917441E-04
 -0.00000000000000E+00 -0.00000000000000E+00 -4.19454716917441E-04
 -0.00000000000000E+00 -0.00000000000000E+00 -4.19454716917441E-04
 Gradient of E wrt nuclear positions in reduced coordinates (gred)
 -0.00000000000000E+00 -0.00000000000000E+00 -4.98134799487993E-03
 -0.00000000000000E+00 -0.00000000000000E+00 -4.98134799487993E-03
  0.00000000000000E+00 -0.00000000000000E+00  4.98134799487993E-03
  0.00000000000000E+00 -0.00000000000000E+00  4.98134799487993E-03
 Scale of Primitive Cell (acell) [bohr]
  7.25071827895859E+00  7.25071827895859E+00  1.18757705992382E+01
 Real space primitive translations (rprimd) [bohr]
  6.27930622526233E+00  3.62535913947930E+00  0.00000000000000E+00
 -6.27930622526233E+00  3.62535913947930E+00  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  1.18757705992382E+01
 Unitary Cell Volume (ucvol) [Bohr^3]=  5.40697665049853E+02
 Angles (23,13,12)= [degrees]
  9.00000000000000E+01  9.00000000000000E+01  1.20000000000000E+02
 Lengths [Bohr]
  7.25071827895859E+00  7.25071827895859E+00  1.18757705992382E+01
 Stress tensor in cartesian coordinates (strten) [Ha/bohr^3]
  1.47343992644195E-07  0.00000000000000E+00  0.00000000000000E+00
  0.00000000000000E+00  1.47343992644845E-07  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  1.74934047707080E-06
 Total energy (etotal) [Ha]= -1.86258714433280E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)=-6.38869E-07
           Relative     =-3.43001E-08

--- Iteration: (10/14) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

--- !BeginCycle
iteration_state: {dtset: 2, itime: 10, icycle: 1, }
solver: {iscf: 7, nstep: 40, nline: 4, wfoptalg: 0, }
tolerances: {tolvrs: 1.00E-18, }
...

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -18.625872246019    -1.863E+01 1.285E-09 1.868E-04 6.657E-05 3.529E-04
 ETOT  2  -18.625872484283    -2.383E-07 3.331E-12 5.091E-06 8.470E-05 2.682E-04
 ETOT  3  -18.625872489906    -5.623E-09 2.284E-10 4.526E-07 1.737E-05 2.856E-04
 ETOT  4  -18.625872490381    -4.747E-10 8.335E-12 1.224E-08 4.172E-06 2.814E-04
 ETOT  5  -18.625872490389    -7.571E-12 6.702E-14 9.347E-11 3.197E-08 2.814E-04
 ETOT  6  -18.625872490389    -7.105E-15 4.449E-16 5.718E-12 3.241E-08 2.814E-04
 ETOT  7  -18.625872490389    -1.492E-13 3.468E-17 1.129E-13 1.780E-09 2.814E-04
 ETOT  8  -18.625872490389     1.776E-14 3.323E-19 1.853E-15 9.658E-10 2.814E-04
 ETOT  9  -18.625872490389     1.030E-13 2.634E-20 1.207E-17 1.517E-10 2.814E-04
 ETOT 10  -18.625872490389    -1.066E-14 6.747E-23 6.223E-20 1.369E-11 2.814E-04

 At SCF step   10       vres2   =  6.22E-20 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)=  8.90543311E-07  sigma(3 2)=  0.00000000E+00
  sigma(2 2)=  8.90543311E-07  sigma(3 1)=  0.00000000E+00
  sigma(3 3)=  3.17624743E-06  sigma(2 1)=  0.00000000E+00


--- !ResultsGS
iteration_state: {dtset: 2, itime: 10, icycle: 1, }
comment   : Summary of ground state results
lattice_vectors:
- [  6.2789845,   3.6251734,   0.0000000, ]
- [ -6.2789845,   3.6251734,   0.0000000, ]
- [  0.0000000,   0.0000000,  11.8802568, ]
lattice_lengths: [   7.25035,    7.25035,   11.88026, ]
lattice_angles: [ 90.000,  90.000, 120.000, ] # degrees, (23, 13, 12)
lattice_volume:   5.4084649E+02
convergence: {deltae: -1.066E-14, res2:  6.223E-20, residm:  6.747E-23, diffor:  1.369E-11, }
etotal    :  -1.86258725E+01
entropy   :   0.00000000E+00
fermie    :   1.56294192E-01
cartesian_stress_tensor: # hartree/bohr^3
- [  8.90543311E-07,   0.00000000E+00,   0.00000000E+00, ]
- [  0.00000000E+00,   8.90543311E-07,   0.00000000E+00, ]
- [  0.00000000E+00,   0.00000000E+00,   3.17624743E-06, ]
pressure_GPa:  -4.8617E-02
xred      :
- [  3.3333E-01,   6.6667E-01,   0.0000E+00, Al]
- [  6.6667E-01,   3.3333E-01,   5.0000E-01, Al]
- [  3.3333E-01,   6.6667E-01,   3.7542E-01,  P]
- [  6.6667E-01,   3.3333E-01,   8.7542E-01,  P]
cartesian_forces: # hartree/bohr
- [ -0.00000000E+00,  -0.00000000E+00,   2.81449460E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,   2.81449460E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,  -2.81449460E-04, ]
- [ -0.00000000E+00,  -0.00000000E+00,  -2.81449460E-04, ]
force_length_stats: {min:   2.81449460E-04, max:   2.81449460E-04, mean:   2.81449460E-04, }
...

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.90052447
    2        2.00000          0.90052447
    3        2.00000          2.84791683
    4        2.00000          2.84791683

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.09299482495851E+00  3.62517337680687E+00  0.00000000000000E+00
  2.09299482495851E+00  3.62517337680687E+00  5.94012838276317E+00
 -2.09299482495851E+00  3.62517337680687E+00  4.46009070485727E+00
  2.09299482495851E+00  3.62517337680687E+00  1.04002190876204E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.75420396451311E-01
  6.66666666666667E-01  3.33333333333333E-01  8.75420396451311E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 2.81449E-04 1.62495E-04 (free atoms)
 -0.00000000000000E+00 -0.00000000000000E+00  2.81449460177440E-04
 -0.00000000000000E+00 -0.00000000000000E+00  2.81449460177440E-04
 -0.00000000000000E+00 -0.00000000000000E+00 -2.81449460177440E-04
 -0.00000000000000E+00 -0.00000000000000E+00 -2.81449460177440E-04
 Gradient of E wrt nuclear positions in reduced coordinates (gred)
 -0.00000000000000E+00 -0.00000000000000E+00 -3.34369185342676E-03
 -0.00000000000000E+00 -0.00000000000000E+00 -3.34369185342676E-03
  0.00000000000000E+00 -0.00000000000000E+00  3.34369185342676E-03
  0.00000000000000E+00 -0.00000000000000E+00  3.34369185342676E-03
 Scale of Primitive Cell (acell) [bohr]
  7.25034675361375E+00  7.25034675361375E+00  1.18802567655263E+01
 Real space primitive translations (rprimd) [bohr]
  6.27898447487554E+00  3.62517337680687E+00  0.00000000000000E+00
 -6.27898447487554E+00  3.62517337680687E+00  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  1.18802567655263E+01
 Unitary Cell Volume (ucvol) [Bohr^3]=  5.40846487879460E+02
 Angles (23,13,12)= [degrees]
  9.00000000000000E+01  9.00000000000000E+01  1.20000000000000E+02
 Lengths [Bohr]
  7.25034675361375E+00  7.25034675361375E+00  1.18802567655263E+01
 Stress tensor in cartesian coordinates (strten) [Ha/bohr^3]
  8.90543311326728E-07  0.00000000000000E+00  0.00000000000000E+00
  0.00000000000000E+00  8.90543311327379E-07  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  3.17624743297973E-06
 Total energy (etotal) [Ha]= -1.86258724903887E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)=-1.04706E-06
           Relative     =-5.62154E-08

--- Iteration: (11/14) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

--- !BeginCycle
iteration_state: {dtset: 2, itime: 11, icycle: 1, }
solver: {iscf: 7, nstep: 40, nline: 4, wfoptalg: 0, }
tolerances: {tolvrs: 1.00E-18, }
...

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -18.625872951183    -1.863E+01 5.981E-06 1.905E-04 7.036E-05 2.111E-04
 ETOT  2  -18.625873237286    -2.861E-07 4.670E-12 8.390E-06 1.314E-04 7.974E-05
 ETOT  3  -18.625873252406    -1.512E-08 3.127E-10 3.113E-07 2.053E-05 1.003E-04
 ETOT  4  -18.625873252770    -3.637E-10 2.319E-12 9.630E-09 1.072E-06 9.920E-05
 ETOT  5  -18.625873252782    -1.181E-11 1.630E-13 3.168E-10 7.347E-07 9.846E-05
 ETOT  6  -18.625873252782    -4.263E-13 3.294E-15 3.837E-12 5.764E-08 9.852E-05
 ETOT  7  -18.625873252782     1.776E-14 8.935E-17 3.670E-14 1.398E-08 9.854E-05
 ETOT  8  -18.625873252782    -3.197E-14 1.350E-18 1.118E-15 1.753E-09 9.853E-05
 ETOT  9  -18.625873252782     7.105E-14 2.866E-20 2.263E-17 1.917E-10 9.853E-05
 ETOT 10  -18.625873252782     2.132E-14 5.920E-22 3.772E-19 1.993E-11 9.853E-05

 At SCF step   10       vres2   =  3.77E-19 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)=  9.20576151E-07  sigma(3 2)=  0.00000000E+00
  sigma(2 2)=  9.20576151E-07  sigma(3 1)=  0.00000000E+00
  sigma(3 3)=  2.41599926E-06  sigma(2 1)=  0.00000000E+00


--- !ResultsGS
iteration_state: {dtset: 2, itime: 11, icycle: 1, }
comment   : Summary of ground state results
lattice_vectors:
- [  6.2783632,   3.6248147,   0.0000000, ]
- [ -6.2783632,   3.6248147,   0.0000000, ]
- [  0.0000000,   0.0000000,  11.8817594, ]
lattice_lengths: [   7.24963,    7.24963,   11.88176, ]
lattice_angles: [ 90.000,  90.000, 120.000, ] # degrees, (23, 13, 12)
lattice_volume:   5.4080786E+02
convergence: {deltae:  2.132E-14, res2:  3.772E-19, residm:  5.920E-22, diffor:  1.993E-11, }
etotal    :  -1.86258733E+01
entropy   :   0.00000000E+00
fermie    :   1.56390404E-01
cartesian_stress_tensor: # hartree/bohr^3
- [  9.20576151E-07,   0.00000000E+00,   0.00000000E+00, ]
- [  0.00000000E+00,   9.20576151E-07,   0.00000000E+00, ]
- [  0.00000000E+00,   0.00000000E+00,   2.41599926E-06, ]
pressure_GPa:  -4.1750E-02
xred      :
- [  3.3333E-01,   6.6667E-01,   0.0000E+00, Al]
- [  6.6667E-01,   3.3333E-01,   5.0000E-01, Al]
- [  3.3333E-01,   6.6667E-01,   3.7524E-01,  P]
- [  6.6667E-01,   3.3333E-01,   8.7524E-01,  P]
cartesian_forces: # hartree/bohr
- [ -0.00000000E+00,  -0.00000000E+00,   9.85344626E-05, ]
- [ -0.00000000E+00,  -0.00000000E+00,   9.85344626E-05, ]
- [ -0.00000000E+00,  -0.00000000E+00,  -9.85344626E-05, ]
- [ -0.00000000E+00,  -0.00000000E+00,  -9.85344626E-05, ]
force_length_stats: {min:   9.85344626E-05, max:   9.85344626E-05, mean:   9.85344626E-05, }
...

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.90050107
    2        2.00000          0.90050107
    3        2.00000          2.84790611
    4        2.00000          2.84790611

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.09278773038793E+00  3.62481467848865E+00  0.00000000000000E+00
  2.09278773038793E+00  3.62481467848865E+00  5.94087969967761E+00
 -2.09278773038793E+00  3.62481467848865E+00  4.45850007113508E+00
  2.09278773038793E+00  3.62481467848865E+00  1.03993797708127E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.75239046784353E-01
  6.66666666666667E-01  3.33333333333333E-01  8.75239046784353E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 9.85345E-05 5.68889E-05 (free atoms)
 -0.00000000000000E+00 -0.00000000000000E+00  9.85344625874036E-05
 -0.00000000000000E+00 -0.00000000000000E+00  9.85344625874036E-05
 -0.00000000000000E+00 -0.00000000000000E+00 -9.85344625874036E-05
 -0.00000000000000E+00 -0.00000000000000E+00 -9.85344625874036E-05
 Gradient of E wrt nuclear positions in reduced coordinates (gred)
 -0.00000000000000E+00 -0.00000000000000E+00 -1.17076277700830E-03
 -0.00000000000000E+00 -0.00000000000000E+00 -1.17076277700830E-03
  0.00000000000000E+00 -0.00000000000000E+00  1.17076277700830E-03
  0.00000000000000E+00 -0.00000000000000E+00  1.17076277700830E-03
 Scale of Primitive Cell (acell) [bohr]
  7.24962935697730E+00  7.24962935697730E+00  1.18817593993552E+01
 Real space primitive translations (rprimd) [bohr]
  6.27836319116379E+00  3.62481467848865E+00  0.00000000000000E+00
 -6.27836319116379E+00  3.62481467848865E+00  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  1.18817593993552E+01
 Unitary Cell Volume (ucvol) [Bohr^3]=  5.40807857000502E+02
 Angles (23,13,12)= [degrees]
  9.00000000000000E+01  9.00000000000000E+01  1.20000000000000E+02
 Lengths [Bohr]
  7.24962935697730E+00  7.24962935697730E+00  1.18817593993552E+01
 Stress tensor in cartesian coordinates (strten) [Ha/bohr^3]
  9.20576150503240E-07  0.00000000000000E+00  0.00000000000000E+00
  0.00000000000000E+00  9.20576150504216E-07  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  2.41599925544626E-06
 Total energy (etotal) [Ha]= -1.86258732527819E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)=-7.62393E-07
           Relative     =-4.09319E-08

--- Iteration: (12/14) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

--- !BeginCycle
iteration_state: {dtset: 2, itime: 12, icycle: 1, }
solver: {iscf: 7, nstep: 40, nline: 4, wfoptalg: 0, }
tolerances: {tolvrs: 1.00E-18, }
...

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -18.625873343685    -1.863E+01 2.188E-09 9.528E-05 3.019E-05 6.835E-05
 ETOT  2  -18.625873487943    -1.443E-07 1.819E-12 6.251E-06 7.779E-05 9.442E-06
 ETOT  3  -18.625873499105    -1.116E-08 9.413E-11 2.039E-07 1.082E-05 1.374E-06
 ETOT  4  -18.625873499288    -1.827E-10 6.508E-13 4.793E-09 1.814E-07 1.556E-06
 ETOT  5  -18.625873499293    -4.608E-12 1.230E-13 2.099E-10 5.248E-07 1.031E-06
 ETOT  6  -18.625873499293    -1.279E-13 2.277E-15 3.160E-12 5.509E-08 1.086E-06
 ETOT  7  -18.625873499293     7.105E-15 4.258E-17 3.386E-14 9.209E-09 1.095E-06
 ETOT  8  -18.625873499293    -9.237E-14 1.007E-18 6.616E-16 1.507E-09 1.094E-06
 ETOT  9  -18.625873499293     1.457E-13 6.819E-21 7.112E-18 9.945E-11 1.094E-06
 ETOT 10  -18.625873499293    -1.030E-13 4.840E-23 1.582E-19 8.524E-12 1.094E-06

 At SCF step   10       vres2   =  1.58E-19 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)=  3.32725870E-07  sigma(3 2)=  0.00000000E+00
  sigma(2 2)=  3.32725870E-07  sigma(3 1)=  0.00000000E+00
  sigma(3 3)=  6.80818543E-07  sigma(2 1)=  0.00000000E+00


--- !ResultsGS
iteration_state: {dtset: 2, itime: 12, icycle: 1, }
comment   : Summary of ground state results
lattice_vectors:
- [  6.2778480,   3.6245172,   0.0000000, ]
- [ -6.2778480,   3.6245172,   0.0000000, ]
- [  0.0000000,   0.0000000,  11.8805162, ]
lattice_lengths: [   7.24903,    7.24903,   11.88052, ]
lattice_angles: [ 90.000,  90.000, 120.000, ] # degrees, (23, 13, 12)
lattice_volume:   5.4066253E+02
convergence: {deltae: -1.030E-13, res2:  1.582E-19, residm:  4.840E-23, diffor:  8.524E-12, }
etotal    :  -1.86258735E+01
entropy   :   0.00000000E+00
fermie    :   1.56504593E-01
cartesian_stress_tensor: # hartree/bohr^3
- [  3.32725870E-07,   0.00000000E+00,   0.00000000E+00, ]
- [  0.00000000E+00,   3.32725870E-07,   0.00000000E+00, ]
- [  0.00000000E+00,   0.00000000E+00,   6.80818543E-07, ]
pressure_GPa:  -1.3203E-02
xred      :
- [  3.3333E-01,   6.6667E-01,   0.0000E+00, Al]
- [  6.6667E-01,   3.3333E-01,   5.0000E-01, Al]
- [  3.3333E-01,   6.6667E-01,   3.7517E-01,  P]
- [  6.6667E-01,   3.3333E-01,   8.7517E-01,  P]
cartesian_forces: # hartree/bohr
- [ -0.00000000E+00,  -0.00000000E+00,   1.09397187E-06, ]
- [ -0.00000000E+00,  -0.00000000E+00,   1.09397187E-06, ]
- [ -0.00000000E+00,  -0.00000000E+00,  -1.09397187E-06, ]
- [ -0.00000000E+00,  -0.00000000E+00,  -1.09397187E-06, ]
force_length_stats: {min:   1.09397187E-06, max:   1.09397187E-06, mean:   1.09397187E-06, }
...

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.90040038
    2        2.00000          0.90040038
    3        2.00000          2.84756157
    4        2.00000          2.84756157

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.09261600311221E+00  3.62451723812206E+00  0.00000000000000E+00
  2.09261600311221E+00  3.62451723812206E+00  5.94025810109684E+00
 -2.09261600311221E+00  3.62451723812206E+00  4.45715697078182E+00
  2.09261600311221E+00  3.62451723812206E+00  1.03974150718787E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.75165261755110E-01
  6.66666666666667E-01  3.33333333333333E-01  8.75165261755110E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 1.09397E-06 6.31605E-07 (free atoms)
 -0.00000000000000E+00 -0.00000000000000E+00  1.09397186567912E-06
 -0.00000000000000E+00 -0.00000000000000E+00  1.09397186567912E-06
 -0.00000000000000E+00 -0.00000000000000E+00 -1.09397186567912E-06
 -0.00000000000000E+00 -0.00000000000000E+00 -1.09397186567912E-06
 Gradient of E wrt nuclear positions in reduced coordinates (gred)
 -0.00000000000000E+00 -0.00000000000000E+00 -1.29969504749448E-05
 -0.00000000000000E+00 -0.00000000000000E+00 -1.29969504749448E-05
  0.00000000000000E+00 -0.00000000000000E+00  1.29969504749448E-05
  0.00000000000000E+00 -0.00000000000000E+00  1.29969504749448E-05
 Scale of Primitive Cell (acell) [bohr]
  7.24903447624411E+00  7.24903447624411E+00  1.18805162021937E+01
 Real space primitive translations (rprimd) [bohr]
  6.27784800933663E+00  3.62451723812206E+00  0.00000000000000E+00
 -6.27784800933663E+00  3.62451723812206E+00  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  1.18805162021937E+01
 Unitary Cell Volume (ucvol) [Bohr^3]=  5.40662530980077E+02
 Angles (23,13,12)= [degrees]
  9.00000000000000E+01  9.00000000000000E+01  1.20000000000000E+02
 Lengths [Bohr]
  7.24903447624411E+00  7.24903447624411E+00  1.18805162021937E+01
 Stress tensor in cartesian coordinates (strten) [Ha/bohr^3]
  3.32725869583972E-07  0.00000000000000E+00  0.00000000000000E+00
  0.00000000000000E+00  3.32725869584623E-07  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  6.80818542777911E-07
 Total energy (etotal) [Ha]= -1.86258734992927E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)=-2.46511E-07
           Relative     =-1.32349E-08

--- Iteration: (13/14) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

--- !BeginCycle
iteration_state: {dtset: 2, itime: 13, icycle: 1, }
solver: {iscf: 7, nstep: 40, nline: 4, wfoptalg: 0, }
tolerances: {tolvrs: 1.00E-18, }
...

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -18.625873504927    -1.863E+01 4.039E-10 8.199E-06 9.968E-07 2.091E-06
 ETOT  2  -18.625873516121    -1.119E-08 1.510E-13 5.561E-07 7.191E-06 5.101E-06
 ETOT  3  -18.625873516976    -8.551E-10 4.100E-12 3.830E-08 8.346E-07 4.266E-06
 ETOT  4  -18.625873517013    -3.667E-11 1.282E-13 5.411E-10 7.923E-09 4.258E-06
 ETOT  5  -18.625873517013    -2.274E-13 1.483E-15 5.464E-12 4.573E-08 4.304E-06
 ETOT  6  -18.625873517013     1.101E-13 1.627E-16 1.919E-13 1.513E-08 4.289E-06
 ETOT  7  -18.625873517013    -1.670E-13 5.083E-18 2.157E-15 3.340E-09 4.292E-06
 ETOT  8  -18.625873517013     5.329E-14 2.004E-20 1.083E-17 8.083E-13 4.292E-06
 ETOT  9  -18.625873517013    -3.908E-14 2.267E-22 1.431E-19 2.288E-11 4.292E-06

 At SCF step    9       vres2   =  1.43E-19 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)=  4.45380131E-08  sigma(3 2)=  0.00000000E+00
  sigma(2 2)=  4.45380131E-08  sigma(3 1)=  0.00000000E+00
  sigma(3 3)=  5.98179683E-08  sigma(2 1)=  0.00000000E+00


--- !ResultsGS
iteration_state: {dtset: 2, itime: 13, icycle: 1, }
comment   : Summary of ground state results
lattice_vectors:
- [  6.2777318,   3.6244501,   0.0000000, ]
- [ -6.2777318,   3.6244501,   0.0000000, ]
- [  0.0000000,   0.0000000,  11.8796466, ]
lattice_lengths: [   7.24890,    7.24890,   11.87965, ]
lattice_angles: [ 90.000,  90.000, 120.000, ] # degrees, (23, 13, 12)
lattice_volume:   5.4060294E+02
convergence: {deltae: -3.908E-14, res2:  1.431E-19, residm:  2.267E-22, diffor:  2.288E-11, }
etotal    :  -1.86258735E+01
entropy   :   0.00000000E+00
fermie    :   1.56537478E-01
cartesian_stress_tensor: # hartree/bohr^3
- [  4.45380131E-08,   0.00000000E+00,   0.00000000E+00, ]
- [  0.00000000E+00,   4.45380131E-08,   0.00000000E+00, ]
- [  0.00000000E+00,   0.00000000E+00,   5.98179683E-08, ]
pressure_GPa:  -1.4602E-03
xred      :
- [  3.3333E-01,   6.6667E-01,   0.0000E+00, Al]
- [  6.6667E-01,   3.3333E-01,   5.0000E-01, Al]
- [  3.3333E-01,   6.6667E-01,   3.7517E-01,  P]
- [  6.6667E-01,   3.3333E-01,   8.7517E-01,  P]
cartesian_forces: # hartree/bohr
- [ -0.00000000E+00,  -0.00000000E+00,  -4.29203355E-06, ]
- [ -0.00000000E+00,  -0.00000000E+00,  -4.29203355E-06, ]
- [ -0.00000000E+00,  -0.00000000E+00,   4.29203355E-06, ]
- [ -0.00000000E+00,  -0.00000000E+00,   4.29203355E-06, ]
force_length_stats: {min:   4.29203355E-06, max:   4.29203355E-06, mean:   4.29203355E-06, }
...

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.90035840
    2        2.00000          0.90035840
    3        2.00000          2.84740379
    4        2.00000          2.84740379

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.09257726862986E+00  3.62445014803062E+00  0.00000000000000E+00
  2.09257726862986E+00  3.62445014803062E+00  5.93982328391834E+00
 -2.09257726862986E+00  3.62445014803062E+00  4.45688283117674E+00
  2.09257726862986E+00  3.62445014803062E+00  1.03967061150951E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.75169648838160E-01
  6.66666666666667E-01  3.33333333333333E-01  8.75169648838160E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 4.29203E-06 2.47801E-06 (free atoms)
 -0.00000000000000E+00 -0.00000000000000E+00 -4.29203355468990E-06
 -0.00000000000000E+00 -0.00000000000000E+00 -4.29203355468990E-06
 -0.00000000000000E+00 -0.00000000000000E+00  4.29203355468991E-06
 -0.00000000000000E+00 -0.00000000000000E+00  4.29203355468991E-06
 Gradient of E wrt nuclear positions in reduced coordinates (gred)
  0.00000000000000E+00 -0.00000000000000E+00  5.09878416870118E-05
  0.00000000000000E+00 -0.00000000000000E+00  5.09878416870118E-05
 -0.00000000000000E+00 -0.00000000000000E+00 -5.09878416870118E-05
 -0.00000000000000E+00 -0.00000000000000E+00 -5.09878416870118E-05
 Scale of Primitive Cell (acell) [bohr]
  7.24890029606125E+00  7.24890029606125E+00  1.18796465678367E+01
 Real space primitive translations (rprimd) [bohr]
  6.27773180588958E+00  3.62445014803062E+00  0.00000000000000E+00
 -6.27773180588958E+00  3.62445014803062E+00  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  1.18796465678367E+01
 Unitary Cell Volume (ucvol) [Bohr^3]=  5.40602941607674E+02
 Angles (23,13,12)= [degrees]
  9.00000000000000E+01  9.00000000000000E+01  1.20000000000000E+02
 Lengths [Bohr]
  7.24890029606125E+00  7.24890029606125E+00  1.18796465678367E+01
 Stress tensor in cartesian coordinates (strten) [Ha/bohr^3]
  4.45380131275808E-08  0.00000000000000E+00  0.00000000000000E+00
  0.00000000000000E+00  4.45380131285566E-08  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  5.98179682848553E-08
 Total energy (etotal) [Ha]= -1.86258735170132E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)=-1.77205E-08
           Relative     =-9.51391E-10

--- Iteration: (14/14) Internal Cycle: (1/1)
--------------------------------------------------------------------------------

---SELF-CONSISTENT-FIELD CONVERGENCE--------------------------------------------

--- !BeginCycle
iteration_state: {dtset: 2, itime: 14, icycle: 1, }
solver: {iscf: 7, nstep: 40, nline: 4, wfoptalg: 0, }
tolerances: {tolvrs: 1.00E-18, }
...

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -18.625873516050    -1.863E+01 1.339E-11 2.459E-07 1.655E-06 2.637E-06
 ETOT  2  -18.625873516408    -3.573E-10 7.426E-15 1.626E-08 2.415E-06 2.220E-07
 ETOT  3  -18.625873516435    -2.709E-11 1.811E-13 8.689E-10 3.276E-07 5.495E-07
 ETOT  4  -18.625873516435    -7.212E-13 2.810E-15 1.869E-11 9.921E-09 5.594E-07
 ETOT  5  -18.625873516436    -9.237E-14 2.990E-16 5.727E-13 2.580E-08 5.336E-07
 ETOT  6  -18.625873516435     1.421E-13 1.465E-17 6.674E-15 5.837E-09 5.395E-07
 ETOT  7  -18.625873516436    -9.592E-14 2.102E-20 6.158E-17 2.360E-10 5.397E-07
 ETOT  8  -18.625873516436    -3.553E-15 7.474E-22 6.610E-19 2.597E-11 5.397E-07

 At SCF step    8       vres2   =  6.61E-19 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)=  1.12504488E-09  sigma(3 2)=  0.00000000E+00
  sigma(2 2)=  1.12504488E-09  sigma(3 1)=  0.00000000E+00
  sigma(3 3)= -2.49308893E-09  sigma(2 1)=  0.00000000E+00


--- !ResultsGS
iteration_state: {dtset: 2, itime: 14, icycle: 1, }
comment   : Summary of ground state results
lattice_vectors:
- [  6.2777276,   3.6244477,   0.0000000, ]
- [ -6.2777276,   3.6244477,   0.0000000, ]
- [  0.0000000,   0.0000000,  11.8794999, ]
lattice_lengths: [   7.24890,    7.24890,   11.87950, ]
lattice_angles: [ 90.000,  90.000, 120.000, ] # degrees, (23, 13, 12)
lattice_volume:   5.4059554E+02
convergence: {deltae: -3.553E-15, res2:  6.610E-19, residm:  7.474E-22, diffor:  2.597E-11, }
etotal    :  -1.86258735E+01
entropy   :   0.00000000E+00
fermie    :   1.56539873E-01
cartesian_stress_tensor: # hartree/bohr^3
- [  1.12504488E-09,   0.00000000E+00,   0.00000000E+00, ]
- [  0.00000000E+00,   1.12504488E-09,   0.00000000E+00, ]
- [  0.00000000E+00,   0.00000000E+00,  -2.49308893E-09, ]
pressure_GPa:   2.3831E-06
xred      :
- [  3.3333E-01,   6.6667E-01,   0.0000E+00, Al]
- [  6.6667E-01,   3.3333E-01,   5.0000E-01, Al]
- [  3.3333E-01,   6.6667E-01,   3.7517E-01,  P]
- [  6.6667E-01,   3.3333E-01,   8.7517E-01,  P]
cartesian_forces: # hartree/bohr
- [ -0.00000000E+00,  -0.00000000E+00,  -5.39690966E-07, ]
- [ -0.00000000E+00,  -0.00000000E+00,  -5.39690966E-07, ]
- [ -0.00000000E+00,  -0.00000000E+00,   5.39690966E-07, ]
- [ -0.00000000E+00,  -0.00000000E+00,   5.39690966E-07, ]
force_length_stats: {min:   5.39690966E-07, max:   5.39690966E-07, mean:   5.39690966E-07, }
...

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.90035311
    2        2.00000          0.90035311
    3        2.00000          2.84738216
    4        2.00000          2.84738216

---OUTPUT-----------------------------------------------------------------------

 Cartesian coordinates (xcart) [bohr]
 -2.09257586237126E+00  3.62444771231929E+00  0.00000000000000E+00
  2.09257586237126E+00  3.62444771231929E+00  5.93974993521829E+00
 -2.09257586237126E+00  3.62444771231929E+00  4.45688504559261E+00
  2.09257586237126E+00  3.62444771231929E+00  1.03966349808109E+01
 Reduced coordinates (xred)
  3.33333333333333E-01  6.66666666666667E-01  0.00000000000000E+00
  6.66666666666667E-01  3.33333333333333E-01  5.00000000000000E-01
  3.33333333333333E-01  6.66666666666667E-01  3.75174468134307E-01
  6.66666666666667E-01  3.33333333333333E-01  8.75174468134307E-01
 Cartesian forces (fcart) [Ha/bohr]; max,rms= 5.39691E-07 3.11591E-07 (free atoms)
 -0.00000000000000E+00 -0.00000000000000E+00 -5.39690966197158E-07
 -0.00000000000000E+00 -0.00000000000000E+00 -5.39690966197158E-07
 -0.00000000000000E+00 -0.00000000000000E+00  5.39690966197159E-07
 -0.00000000000000E+00 -0.00000000000000E+00  5.39690966197159E-07
 Gradient of E wrt nuclear positions in reduced coordinates (gred)
  0.00000000000000E+00 -0.00000000000000E+00  6.41125876301492E-06
  0.00000000000000E+00 -0.00000000000000E+00  6.41125876301492E-06
 -0.00000000000000E+00 -0.00000000000000E+00 -6.41125876301494E-06
 -0.00000000000000E+00 -0.00000000000000E+00 -6.41125876301494E-06
 Scale of Primitive Cell (acell) [bohr]
  7.24889542463858E+00  7.24889542463858E+00  1.18794998704366E+01
 Real space primitive translations (rprimd) [bohr]
  6.27772758711379E+00  3.62444771231929E+00  0.00000000000000E+00
 -6.27772758711379E+00  3.62444771231929E+00  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00  1.18794998704366E+01
 Unitary Cell Volume (ucvol) [Bohr^3]=  5.40595539314894E+02
 Angles (23,13,12)= [degrees]
  9.00000000000000E+01  9.00000000000000E+01  1.20000000000000E+02
 Lengths [Bohr]
  7.24889542463858E+00  7.24889542463858E+00  1.18794998704366E+01
 Stress tensor in cartesian coordinates (strten) [Ha/bohr^3]
  1.12504488190834E-09  0.00000000000000E+00  0.00000000000000E+00
  0.00000000000000E+00  1.12504488223360E-09  0.00000000000000E+00
  0.00000000000000E+00  0.00000000000000E+00 -2.49308893050370E-09
 Total energy (etotal) [Ha]= -1.86258735164355E+01

 Difference of energy with previous step (new-old):
           Absolute (Ha)= 5.77717E-10
           Relative     = 3.10169E-11

 At Broyd/MD step  14, gradients are converged :
  max grad (force/stress) = 5.3969E-07 &lt; tolmxf= 1.0000E-06 ha/bohr (free atoms)

================================================================================

 ----iterations are completed or convergence reached----

 Mean square residual over all n,k,spin=   29.288E-23; max=  74.743E-23
 reduced coordinates (array xred) for    4 atoms
       0.333333333333      0.666666666667      0.000000000000
       0.666666666667      0.333333333333      0.500000000000
       0.333333333333      0.666666666667      0.375174468134
       0.666666666667      0.333333333333      0.875174468134
 rms dE/dt=  6.2548E-05; max dE/dt=  1.1456E-04; dE/dt below (all hartree)
    1       0.000000000000      0.000000000000      0.000114558357
    2       0.000000000000      0.000000000000      0.000114558357
    3       0.000000000000      0.000000000000      0.000101735839
    4       0.000000000000      0.000000000000      0.000101735839

 cartesian coordinates (angstrom) at end:
    1     -1.10734345361244     1.91797512308553     0.00000000000000
    2      1.10734345361244     1.91797512308553     3.14318029044145
    3     -1.10734345361244     1.91797512308553     2.35848198743321
    4      1.10734345361244     1.91797512308553     5.50166227787466

 cartesian forces (hartree/bohr) at end:
    1     -0.00000000000000    -0.00000000000000    -0.00000053969097
    2     -0.00000000000000    -0.00000000000000    -0.00000053969097
    3     -0.00000000000000    -0.00000000000000     0.00000053969097
    4     -0.00000000000000    -0.00000000000000     0.00000053969097
 frms,max,avg= 3.1159072E-07 5.3969097E-07   0.000E+00  0.000E+00 -9.104E-06 h/b

 cartesian forces (eV/Angstrom) at end:
    1     -0.00000000000000    -0.00000000000000    -0.00002775202297
    2     -0.00000000000000    -0.00000000000000    -0.00002775202297
    3     -0.00000000000000    -0.00000000000000     0.00002775202297
    4     -0.00000000000000    -0.00000000000000     0.00002775202297
 frms,max,avg= 1.6022638E-05 2.7752023E-05   0.000E+00  0.000E+00 -4.681E-04 e/A
 length scales=  7.248895424639  7.248895424639 11.879499870437 bohr
              =  3.835950246171  3.835950246171  6.286360580883 angstroms
 prteigrs : about to open file telast_1o_DS2_EIG
 Fermi (or HOMO) energy (hartree) =   0.15654   Average Vxc (hartree)=  -0.34190
 Eigenvalues (hartree) for nkpt=   8  k points:
 kpt#   1, nband=  8, wtk=  0.03125, kpt=  0.0000  0.0000  0.1250 (reduced coord)
  -0.25845   -0.19638   -0.04431    0.12449    0.12449    0.14168    0.15654    0.15654
 prteigrs : prtvol=0 or 1, do not print more k-points.


--- !EnergyTerms
iteration_state     : {dtset: 2, itime: 14, icycle: 1, }
comment             : Components of total free energy in Hartree
kinetic             :  6.75559841341052E+00
hartree             :  1.80771548183082E+00
xc                  : -6.35342590781107E+00
Ewald energy        : -1.75094233803271E+01
psp_core            :  4.50230977818671E-01
local_psp           : -6.81179811436585E+00
non_local_psp       :  3.03522901300853E+00
total_energy        : -1.86258735164355E+01
total_energy_eV     : -5.06835793983535E+02
band_energy         : -9.08042690476543E-02
...

 rms coord change=  1.8184E-04   atom, delta coord (reduced):
     1        0.000000000000      0.000000000000      0.000000000000
     2        0.000000000000      0.000000000000      0.000000000000
     3        0.000000000000      0.000000000000     -0.000445417149
     4        0.000000000000      0.000000000000     -0.000445417149

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)=  1.12504488E-09  sigma(3 2)=  0.00000000E+00
  sigma(2 2)=  1.12504488E-09  sigma(3 1)=  0.00000000E+00
  sigma(3 3)= -2.49308893E-09  sigma(2 1)=  0.00000000E+00

-Cartesian components of stress tensor (GPa)         [Pressure=  2.3831E-06 GPa]
- sigma(1 1)=  3.30999576E-05  sigma(3 2)=  0.00000000E+00
- sigma(2 2)=  3.30999576E-05  sigma(3 1)=  0.00000000E+00
- sigma(3 3)= -7.33491964E-05  sigma(2 1)=  0.00000000E+00

== END DATASET(S) ==============================================================
================================================================================

 -outvars: echo values of variables after computation  --------
            acell1     7.5000000000E+00  7.5000000000E+00  1.2263388000E+01 Bohr
            acell2     7.2488954246E+00  7.2488954246E+00  1.1879499870E+01 Bohr
              amu      2.69815390E+01  3.09737620E+01
           diemac      9.00000000E+00
          dilatmx1     1.00000000E+00
          dilatmx2     1.05000000E+00
             ecut      6.00000000E+00 Hartree
           ecutsm      5.00000000E-01 Hartree
           etotal1    -1.8618320088E+01
           etotal2    -1.8625873516E+01
            fcart1    -0.0000000000E+00 -0.0000000000E+00 -2.7264014607E-08
                      -0.0000000000E+00 -0.0000000000E+00 -2.7264014607E-08
                      -0.0000000000E+00 -0.0000000000E+00  2.7264014607E-08
                      -0.0000000000E+00 -0.0000000000E+00  2.7264014607E-08
            fcart2    -0.0000000000E+00 -0.0000000000E+00 -5.3969096620E-07
                      -0.0000000000E+00 -0.0000000000E+00 -5.3969096620E-07
                      -0.0000000000E+00 -0.0000000000E+00  5.3969096620E-07
                      -0.0000000000E+00 -0.0000000000E+00  5.3969096620E-07
-          fftalg         512
           getwfk1          0
           getwfk2         -1
          getxred1          0
          getxred2         -1
           iatfix        1    2
           ionmov           2
              ixc       -1012
           jdtset        1    2
              kpt      0.00000000E+00  0.00000000E+00  1.25000000E-01
                       2.50000000E-01  0.00000000E+00  1.25000000E-01
                       5.00000000E-01  0.00000000E+00  1.25000000E-01
                       2.50000000E-01  2.50000000E-01  1.25000000E-01
                       0.00000000E+00  0.00000000E+00  3.75000000E-01
                       2.50000000E-01  0.00000000E+00  3.75000000E-01
                       5.00000000E-01  0.00000000E+00  3.75000000E-01
                       2.50000000E-01  2.50000000E-01  3.75000000E-01
         kptrlatt        4    0    0      0    4    0      0    0    4
P           mkmem           8
           natfix           2
            natom           4
            nband           8
           ndtset           2
            ngfft          18      18      30
             nkpt           8
            nstep          40
             nsym          12
            ntime1          5
            ntime2         14
           ntypat           2
              occ      2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000
          optcell1          0
          optcell2          2
        optforces           1
            rprim      8.6602540378E-01  5.0000000000E-01  0.0000000000E+00
                      -8.6602540378E-01  5.0000000000E-01  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  1.0000000000E+00
           shiftk      0.00000000E+00  0.00000000E+00  5.00000000E-01
          spgroup         186
           strten1     2.2507599014E-04  2.2507599014E-04  2.5792298437E-04
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           strten2     1.1250448819E-09  1.1250448822E-09 -2.4930889305E-09
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           symrel      1  0  0   0  1  0   0  0  1       0  1  0   1  0  0   0  0  1
                       1  1  0  -1  0  0   0  0  1      -1  0  0   1  1  0   0  0  1
                       0  1  0  -1 -1  0   0  0  1      -1 -1  0   0  1  0   0  0  1
                      -1  0  0   0 -1  0   0  0  1       0 -1  0  -1  0  0   0  0  1
                      -1 -1  0   1  0  0   0  0  1       1  0  0  -1 -1  0   0  0  1
                       0 -1  0   1  1  0   0  0  1       1  1  0   0 -1  0   0  0  1
            tnons      0.0000000  0.0000000  0.0000000     0.0000000  0.0000000  0.5000000
                      -0.0000000  0.0000000  0.5000000     0.0000000  0.0000000  0.0000000
                       0.0000000 -0.0000000  0.0000000     0.0000000  0.0000000  0.5000000
                       0.0000000  0.0000000  0.5000000     0.0000000  0.0000000  0.0000000
                       0.0000000  0.0000000  0.0000000    -0.0000000  0.0000000  0.5000000
                       0.0000000  0.0000000  0.5000000     0.0000000 -0.0000000  0.0000000
           tolmxf      1.00000000E-06
           tolvrs      1.00000000E-18
            typat      1  1  2  2
              wtk        0.03125    0.18750    0.09375    0.18750    0.03125    0.18750
                         0.09375    0.18750
           xangst1    -1.1457022644E+00  1.9844145322E+00  0.0000000000E+00
                       1.1457022644E+00  1.9844145322E+00  3.2447527148E+00
                      -1.1457022644E+00  1.9844145322E+00  2.4375872851E+00
                       1.1457022644E+00  1.9844145322E+00  5.6823399999E+00
           xangst2    -1.1073434536E+00  1.9179751231E+00  0.0000000000E+00
                       1.1073434536E+00  1.9179751231E+00  3.1431802904E+00
                      -1.1073434536E+00  1.9179751231E+00  2.3584819874E+00
                       1.1073434536E+00  1.9179751231E+00  5.5016622779E+00
            xcart1    -2.1650635095E+00  3.7500000000E+00  0.0000000000E+00
                       2.1650635095E+00  3.7500000000E+00  6.1316940000E+00
                      -2.1650635095E+00  3.7500000000E+00  4.6063723937E+00
                       2.1650635095E+00  3.7500000000E+00  1.0738066394E+01
            xcart2    -2.0925758624E+00  3.6244477123E+00  0.0000000000E+00
                       2.0925758624E+00  3.6244477123E+00  5.9397499352E+00
                      -2.0925758624E+00  3.6244477123E+00  4.4568850456E+00
                       2.0925758624E+00  3.6244477123E+00  1.0396634981E+01
             xred1     3.3333333333E-01  6.6666666667E-01  0.0000000000E+00
                       6.6666666667E-01  3.3333333333E-01  5.0000000000E-01
                       3.3333333333E-01  6.6666666667E-01  3.7561988528E-01
                       6.6666666667E-01  3.3333333333E-01  8.7561988528E-01
             xred2     3.3333333333E-01  6.6666666667E-01  0.0000000000E+00
                       6.6666666667E-01  3.3333333333E-01  5.0000000000E-01
                       3.3333333333E-01  6.6666666667E-01  3.7517446813E-01
                       6.6666666667E-01  3.3333333333E-01  8.7517446813E-01
            znucl       13.00000   15.00000

================================================================================


- Timing analysis has been suppressed with timopt=0



================================================================================

 Suggested references for the acknowledgment of ABINIT usage.

 The users of ABINIT have little formal obligations with respect to the ABINIT group
 (those specified in the GNU General Public License, http://www.gnu.org/copyleft/gpl.txt).
 However, it is common practice in the scientific literature,
 to acknowledge the efforts of people that have made the research possible.
 In this spirit, please find below suggested citations of work written by ABINIT developers,
 corresponding to implementations inside of ABINIT that you have used in the present run.
 Note also that it will be of great value to readers of publications presenting these results,
 to read papers enabling them to understand the theoretical formalism and details
 of the ABINIT implementation.
 For information on why they are suggested, see also https://docs.abinit.org/theory/acknowledgments.
-
- [1] Libxc: A library of exchange and correlation functionals for density functional theory.
- M.A.L. Marques, M.J.T. Oliveira, T. Burnus, Computer Physics Communications 183, 2227 (2012).
- Comment: to be cited when LibXC is used (negative value of ixc)
- Strong suggestion to cite this paper.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#marques2012
-
- [2] The Abinit project: Impact, environment and recent developments.
- Computer Phys. Comm. 248, 107042 (2020).
- X.Gonze, B. Amadon, G. Antonius, F.Arnardi, L.Baguet, J.-M.Beuken,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, N.Brouwer, F.Bruneval,
- G.Brunin, T.Cavignac, J.-B. Charraud, Wei Chen, M.Cote, S.Cottenier,
- J.Denier, G.Geneste, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, Xu He, N.Helbig, N.Holzwarth, Y.Jia, F.Jollet,
- W.Lafargue-Dit-Hauret, K.Lejaeghere, M.A.L.Marques, A.Martin, C.Martins,
- H.P.C. Miranda, F.Naccarato, K. Persson, G.Petretto, V.Planes, Y.Pouillon,
- S.Prokhorenko, F.Ricci, G.-M.Rignanese, A.H.Romero, M.M.Schmitt, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, G.Zerah and J.W.Zwanzig
- Comment: the fifth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm.
- is available at https://www.abinit.org/sites/default/files/ABINIT20.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2020
-
- [3] Optimized norm-conserving Vanderbilt pseudopotentials.
- D.R. Hamann, Phys. Rev. B 88, 085117 (2013).
- Comment: Some pseudopotential generated using the ONCVPSP code were used.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#hamann2013
-
- [4] ABINIT: Overview, and focus on selected capabilities
- J. Chem. Phys. 152, 124102 (2020).
- A. Romero, D.C. Allan, B. Amadon, G. Antonius, T. Applencourt, L.Baguet,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, F.Bruneval,
- G.Brunin, D.Caliste, M.Cote,
- J.Denier, C. Dreyer, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, F.Jollet, G. Jomard,
- A.Martin,
- H.P.C. Miranda, F.Naccarato, G.Petretto, N.A. Pike, V.Planes,
- S.Prokhorenko, T. Rangel, F.Ricci, G.-M.Rignanese, M.Royo, M.Stengel, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, J.Wiktor, J.W.Zwanziger, and X.Gonze.
- Comment: a global overview of ABINIT, with focus on selected capabilities .
- Note that a version of this paper, that is not formatted for J. Chem. Phys
- is available at https://www.abinit.org/sites/default/files/ABINIT20_JPC.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#romero2020
-
- [5] Recent developments in the ABINIT software package.
- Computer Phys. Comm. 205, 106 (2016).
- X.Gonze, F.Jollet, F.Abreu Araujo, D.Adams, B.Amadon, T.Applencourt,
- C.Audouze, J.-M.Beuken, J.Bieder, A.Bokhanchuk, E.Bousquet, F.Bruneval
- D.Caliste, M.Cote, F.Dahm, F.Da Pieve, M.Delaveau, M.Di Gennaro,
- B.Dorado, C.Espejo, G.Geneste, L.Genovese, A.Gerossier, M.Giantomassi,
- Y.Gillet, D.R.Hamann, L.He, G.Jomard, J.Laflamme Janssen, S.Le Roux,
- A.Levitt, A.Lherbier, F.Liu, I.Lukacevic, A.Martin, C.Martins,
- M.J.T.Oliveira, S.Ponce, Y.Pouillon, T.Rangel, G.-M.Rignanese,
- A.H.Romero, B.Rousseau, O.Rubel, A.A.Shukri, M.Stankovski, M.Torrent,
- M.J.Van Setten, B.Van Troeye, M.J.Verstraete, D.Waroquier, J.Wiktor,
- B.Xu, A.Zhou, J.W.Zwanziger.
- Comment: the fourth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm.
- is available at https://www.abinit.org/sites/default/files/ABINIT16.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2016
-
- Proc.   0 individual time (sec): cpu=         24.6  wall=         26.2

================================================================================

 Calculation completed.
.Delivered 181 WARNINGs and  16 COMMENTs to log file.
+Overall time at end (sec) : cpu=         24.6  wall=         26.2

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-b49d0cb7-15b3-41a3-8d67-51b2c5cb6aa4", "#uuid-e65e92de-ec97-475d-b339-a87c5e5f40ae") }); </script>

<p>The first thing to look for is to see whether Abinit recognized the symmetry of the
system. In setting up a new data file, it&rsquo;s easy to make mistakes, so this is a valuable check.
We see</p>
<div class="codehilite"><pre><span></span><code>DATASET    1 : space group P6_3 m c (#186); Bravais hP (primitive hexag.)
</code></pre></div>

<p>which is correct. Next, we confirm that the structural optimization converged.
The following lines tell us that things are OK.
From dataset 1 :</p>
<div class="codehilite"><pre><span></span><code>At Broyd/MD step   4, gradients are converged :
max grad (force/stress) = 2.7264E-08 &lt; tolmxf= 1.0000E-06 ha/bohr (free atoms)
</code></pre></div>

<p>and from dataset 2 :</p>
<div class="codehilite"><pre><span></span><code>At Broyd/MD step  14, gradients are converged :
max grad (force/stress) = 5.3969E-07 &lt; tolmxf= 1.0000E-06 ha/bohr (free atoms)
</code></pre></div>

<p>We can also confirm that the stresses are relaxed:</p>
<div class="codehilite"><pre><span></span><code>Cartesian components of stress tensor (hartree/bohr^3)
 sigma(1 1)=  1.12504637E-09  sigma(3 2)=  0.00000000E+00
 sigma(2 2)=  1.12504637E-09  sigma(3 1)=  0.00000000E+00
 sigma(3 3)= -2.49308610E-09  sigma(2 1)=  0.00000000E+00
</code></pre></div>

<p>Now would be a good time to copy <em>telast_2.abi</em> into your
working directory, since we will use the present output to start the next run.
Locate the optimized lattice parameters and reduced atomic coordinates near
the end of <em>telast_1.abo</em>:</p>
<div class="codehilite"><pre><span></span><code> acell2    7.2488954246E+00  7.2488954246E+00  1.1879499870E+01 Bohr

 xred2     3.3333333333E-01  6.6666666667E-01  0.0000000000E+00
           6.6666666667E-01  3.3333333333E-01  5.0000000000E-01
           3.3333333333E-01  6.6666666667E-01  3.7517446813E-01
           6.6666666667E-01  3.3333333333E-01  8.7517446813E-01
</code></pre></div>

<p>With your editor, copy and paste these into <em>telast_2.abi</em> at the indicated
places in the &ldquo;Common input data&rdquo; area. Be sure to change acell2 and xred2 to
acell and xred since these common values will apply to all datasets in the next set of calculations.</p>
<h2 id="2-response-function-calculations-of-several-second-derivatives-of-the-total-energy">2 Response-function calculations of several second derivatives of the total energy<a class="headerlink" href="#2-response-function-calculations-of-several-second-derivatives-of-the-total-energy" title="Permanent link">&para;</a></h2>
<p>We will now compute second derivatives of the total energy (2DTE&rsquo;s) with
respect to all the perturbations we need to compute elastic and piezoelectric
properties. You may want to review the first paragraphs of the <a class="wikilink user-guide-wikilink" href="/guide/respfn">respfn help file</a>
which you studied in <a href="/tutorial/rf1">tutorial RF1</a>.
We will introduce only one new input variable for the strain perturbation,</p>
<ul>
<li><a class="wikilink codevar-wikilink" href="/variables/dfpt#rfstrs">rfstrs</a></li>
</ul>
<p>The treatment of strain as a perturbation has some subtle aspects. It would be
a good idea to read  Metric tensor formulation of strain in density-functional
perturbation theory, by D. R. Hamann, Xifan Wu, Karin M. Rabe, and David Vanderbilt <a class="wikilink citation-wikilink" data-tippy-content="Metric tensor formulation of strain in density-functional perturbation theory" data-toggle="popover" href="/theory/bibliography#hamann2005">[Hamann2005]</a>
especially Sec. II and Sec. IV. We will do all the RF calculations you learned in <a href="/tutorial/rf1">tutorial RF1</a> together
with strain, so you should review the variables</p>
<ul>
<li><a class="wikilink codevar-wikilink" href="/variables/dfpt#rfphon">rfphon</a></li>
<li><a class="wikilink codevar-wikilink" href="/variables/dfpt#rfatpol">rfatpol</a></li>
<li><a class="wikilink codevar-wikilink" href="/variables/dfpt#rfdir">rfdir</a></li>
<li><a class="wikilink codevar-wikilink" href="/variables/dfpt#rfelfd">rfelfd</a></li>
</ul>
<p>If not yet done (see end of previous section), copy <em>telast_2.abi</em> into <em>Work_elast</em> and start the
calculation while you read (less than 2 minutes on a standard 3GHz machine). We now
assume that you know which command to use to launch ABINIT.
Look at <em>telast_2.abi</em> in your editor to follow the discussion.</p>
<div class="text-center"><button id="uuid-c6e788d0-8038-4358-b9b1-4210ce8d5459" class="md-button md-button--secondary"> View tests/tutorespfn/Input/telast_2.abi </button></div>
<div id="uuid-a59c4dac-b221-4ed5-bf7b-6b12aa41f04d" class="my_dialog" title="tests/tutorespfn/Input/telast_2.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#AlP in hypothetical wurzite (hexagonal) structure</span>
<span class="c1">#Response function calculation for:</span>
<span class="c1">#    * rigid-atom elastic tensor</span>
<span class="c1">#    * rigid-atom piezoelectric tensor</span>
<span class="c1">#    * interatomic force constants at gamma</span>
<span class="c1">#    * Born effective charges</span>

<span class="w">   </span>ndtset<span class="w">   </span><span class="m">3</span>

<span class="c1"># Set 1 : Initial self-consistent run</span>

<span class="w">  </span>kptopt1<span class="w">   </span><span class="m">1</span>
<span class="w">  </span>tolvrs1<span class="w">   </span><span class="m">1</span>.0d-18<span class="w">  </span><span class="c1">#need excellent convergence of GS quantities for RF runs</span>


<span class="c1"># Set 2 : Calculate the ddk wf&#39;s - needed for piezoelectric tensor and</span>
<span class="c1">#         Born effective charges in dataset 3</span>

<span class="w">  </span>getwfk2<span class="w">  </span>-1
<span class="w">    </span>iscf2<span class="w">  </span>-3<span class="w">        </span><span class="c1">#this option is needed for ddk</span>
<span class="w">  </span>kptopt2<span class="w">   </span><span class="m">2</span><span class="w">        </span><span class="c1">#use time-reversal symmetry only for k points</span>
<span class="w">    </span>nqpt2<span class="w">   </span><span class="m">1</span><span class="w">        </span><span class="c1">#one wave vector will be specified</span>
<span class="w">     </span>qpt2<span class="w">   </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w">    </span><span class="c1">#need to specify gamma point</span>
<span class="w">  </span>rfelfd2<span class="w">   </span><span class="m">2</span><span class="w">        </span><span class="c1">#set for ddk wf&#39;s only</span>
<span class="w">  </span>tolwfr2<span class="w">   </span><span class="m">1</span>.0d-20<span class="w">  </span><span class="c1">#only wf convergence can be monitored here</span>

<span class="c1"># Set 3 : response-function calculations for all needed perturbations</span>

<span class="w">  </span>getddk3<span class="w">  </span>-1
<span class="w">  </span>getwfk3<span class="w">  </span>-2
<span class="w">  </span>kptopt3<span class="w">   </span><span class="m">2</span><span class="w">        </span><span class="c1">#use time-reversal symmetry only for k points</span>
<span class="w">    </span>nqpt3<span class="w">   </span><span class="m">1</span>
<span class="w">     </span>qpt3<span class="w">   </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
<span class="w">  </span>rfphon3<span class="w">   </span><span class="m">1</span><span class="w">        </span><span class="c1">#do atomic displacement perturbation</span>
<span class="w">  </span>rfstrs3<span class="w">   </span><span class="m">3</span><span class="w">        </span><span class="c1">#do strain perturbation</span>
<span class="w">  </span>tolvrs3<span class="w">   </span><span class="m">1</span>.0d-10<span class="w">  </span><span class="c1">#need reasonable convergence of 1st-order quantities</span>


<span class="c1">#Common input data</span>

<span class="c1"># acell  COPY RELAXED RESULT FROM PREVIOUS CALCULATION</span>
<span class="c1"># Here is a default value, for automatic testing : suppress it and fill with values from the previous run</span>
<span class="w">  </span>acell<span class="w">  </span><span class="m">7</span>.2488954246E+00<span class="w">  </span><span class="m">7</span>.2488954246E+00<span class="w">  </span><span class="m">1</span>.1879499870E+01<span class="w"> </span>Bohr

<span class="w">  </span>rprim<span class="w">   </span>sqrt<span class="o">(</span><span class="m">0</span>.75<span class="o">)</span><span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0<span class="w">   </span><span class="c1">#Better to specify hexagonal primitive vectors</span>
<span class="w">         </span>-sqrt<span class="o">(</span><span class="m">0</span>.75<span class="o">)</span><span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0<span class="w">   </span><span class="c1">#with high accuracy to be</span>
<span class="w">          </span><span class="m">0</span>.0<span class="w">         </span><span class="m">0</span>.0<span class="w">  </span><span class="m">1</span>.0<span class="w">   </span><span class="c1">#sure that the symmetry is recognized</span>
<span class="w">                                 </span><span class="c1">#and preserved in the optimization process</span>

<span class="c1">#Definition of the atom types and atoms</span>
<span class="w"> </span>ntypat<span class="w">   </span><span class="m">2</span>
<span class="w">  </span>znucl<span class="w">   </span><span class="m">13</span><span class="w"> </span><span class="m">15</span>
<span class="w">  </span>natom<span class="w">   </span><span class="m">4</span>
<span class="w">  </span>typat<span class="w">   </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span>

<span class="c1"># xred  COPY RELAXED RESULT FROM PREVIOUS CALCULATION</span>
<span class="c1"># Here is a set of default values, for automatic testing : suppress it and fill with values from the previous run</span>
<span class="w">  </span>xred<span class="w">   </span><span class="m">1</span>/3<span class="w">  </span><span class="m">2</span>/3<span class="w">  </span><span class="m">0</span>
<span class="w">         </span><span class="m">2</span>/3<span class="w">  </span><span class="m">1</span>/3<span class="w">  </span><span class="m">1</span>/2
<span class="w">         </span><span class="m">1</span>/3<span class="w">  </span><span class="m">2</span>/3<span class="w">  </span><span class="m">3</span>.7517446813E-01
<span class="w">         </span><span class="m">2</span>/3<span class="w">  </span><span class="m">1</span>/3<span class="w">  </span><span class="m">8</span>.7517446813E-01

<span class="c1">#Gives the number of bands, explicitely (do not take the default)</span>
<span class="w">  </span>nband<span class="w">   </span><span class="m">8</span><span class="w">              </span><span class="c1"># For an insulator (if described correctly as an</span>
<span class="w">                         </span><span class="c1"># insulator by DFT), conduction bands should not</span>
<span class="w">                         </span><span class="c1"># be included in response-function calculations</span>

<span class="c1">#Definition of the plane wave basis set</span>
<span class="w">   </span>ecut<span class="w">   </span><span class="m">6</span>.0<span class="w">            </span><span class="c1"># Maximum kinetic energy cutoff (Hartree)</span>
<span class="w"> </span>ecutsm<span class="w">   </span><span class="m">0</span>.5<span class="w">            </span><span class="c1"># Smoothing energy needed for lattice paramete</span>
<span class="w">                         </span><span class="c1"># optimization.  This will be retained for</span>
<span class="w">                         </span><span class="c1"># consistency throughout.</span>

<span class="c1">#Definition of the k-point grid</span>
<span class="w"> </span>kptopt<span class="w">   </span><span class="m">1</span><span class="w">              </span><span class="c1"># Use symmetry and treat only inequivalent points</span>
<span class="w">  </span>ngkpt<span class="w">   </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w">          </span><span class="c1"># 4x4x4 Monkhorst-Pack grid</span>
nshiftk<span class="w">   </span><span class="m">1</span><span class="w">              </span><span class="c1"># Use one copy of grid only (default)</span>
<span class="w"> </span>shiftk<span class="w">   </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.5<span class="w">    </span><span class="c1"># This choice of origin for the k point grid</span>
<span class="w">                         </span><span class="c1"># preserves the hexagonal symmetry of the grid,</span>
<span class="w">                         </span><span class="c1"># which would be broken by the default choice.</span>

<span class="c1">#Definition of the self-consistency procedure</span>
<span class="w"> </span>diemac<span class="w">   </span><span class="m">9</span>.0<span class="w">            </span><span class="c1"># Model dielectric preconditioner</span>
<span class="w">  </span>nstep<span class="w">   </span><span class="m">40</span><span class="w">             </span><span class="c1"># Maxiumum number of SCF iterations</span>
<span class="c1"># enforce calculation of forces at each SCF step</span>
<span class="w"> </span>optforces<span class="w"> </span><span class="m">1</span>


<span class="w"> </span>pp_dirpath<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
<span class="w"> </span>pseudos<span class="w"> </span><span class="s2">&quot;Psdj_nc_sr_04_pw_std_psp8/Al.psp8, Psdj_nc_sr_04_pw_std_psp8/P.psp8&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = telast_2.abi, telast_3.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   telast_2.abo, tolnlines=  3, tolabs=  1.1e-3 , tolrel=  7.0e-4 , fld_options = -easy</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 2</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = D. Hamann</span>
<span class="c1">#%% keywords = NC, DFPT</span>
<span class="c1">#%% description =</span>
<span class="c1">#%%   AlP in hypothetical wurzite (hexagonal) structure</span>
<span class="c1">#%%   Response function calculation for:</span>
<span class="c1">#%%       * rigid-atom elastic tensor</span>
<span class="c1">#%%       * rigid-atom piezoelectric tensor</span>
<span class="c1">#%%       * interatomic force constants at gamma</span>
<span class="c1">#%%       * Born effective charges</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-a59c4dac-b221-4ed5-bf7b-6b12aa41f04d", "#uuid-c6e788d0-8038-4358-b9b1-4210ce8d5459") }); </script>

<p>This has been set up as a self-contained calculation with three datasets. The
first is simply a GS run to obtain the GS wave functions we will need for the
DFPT calculations. We have removed the convergence test from the common input
data to remind ourselves that different tests are needed for different
datasets. We set a tight limit on the convergence of the self-consistent
potential with <a class="wikilink codevar-wikilink" href="/variables/basic#tolvrs">tolvrs</a>. Since we have specified <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>=8, all the bands
are occupied and the potential test also assures us that all the wave
functions are well converged. This issue will come up again in the section on
metals. We could have used the output wave functions <em>telast_1o_DS2_WFK</em> as
input for our RF calculations and skipped dataset 1, but redoing the GS
calculation takes relatively little time for this simple system.</p>
<p>Dataset 2 involves the calculation of the derivatives of the wave functions
with respect to the Brillouin-zone wave vector, the so-called ddk wave
functions. Recall that these are auxiliary quantities needed to compute the
response to the <a class="wikilink lesson-wikilink" href="/tutorial/rf1#5">electric field perturbation</a> and
introduced in <a href="/tutorial/rf1">tutorial RF1</a>. It would be a good idea to review the relevant
parts of <a class="wikilink user-guide-wikilink" href="/guide/respfn#1">section 1</a> of the respfn_help file.</p>
<p>Examining this section of <em>telast_2.abi</em>, note that electric
field as well as strain are uniform perturbations, so that they are defined only for
<a class="wikilink codevar-wikilink" href="/variables/gstate#qpt">qpt</a> = 0 0 0. <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfelfd">rfelfd</a> = 2 specifies that we want the ddk calculation to be
performed, which requires <a class="wikilink codevar-wikilink" href="/variables/basic#iscf">iscf</a> = -3. The ddk wave functions will be used to
calculate both the piezoelectric tensor and the Born effective charges, and in
general we need them for <strong>k</strong> derivatives in all three (reduced) directions,
<a class="wikilink codevar-wikilink" href="/variables/dfpt#rfdir">rfdir</a> = 1 1 1 (that is the default). Since there is no potential self-consistency in the ddk
calculations, we must specify convergence in terms of the wave function
residuals using <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a>.</p>
<p>Finally, dataset 3 performs the actual calculations of the needed 2DTE&rsquo;s for
the elastic and piezoelectric tensors. Setting <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfphon">rfphon</a> = 1 turns on the
atomic displacement perturbation, which we need for all atoms (see <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfatpol">rfatpol</a>)
and all directions (see <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfdir">rfdir</a>). Abinit will calculate first-order
wave functions for each atom and direction in turn, and use those to calculate
2DTE&rsquo;s with respect to all pairs of atomic displacements and with respect to
one atomic displacement and one component of electric field. These quantities,
the interatomic force constants (at <span class="arithmatex">\(\Gamma\)</span>) and the Born effective charges will
be used later to compute the atomic relaxation contribution to the elastic and
piezoelectric tensor.</p>
<p>First-order wave functions for the strain perturbation are computed next.
Setting <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfstrs">rfstrs</a> = 3 specifies that we want both uniaxial and shear strains
to be treated, and <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfdir">rfdir</a> = 1 1 1 cycles through strains xx, yy, and zz for
uniaxial and yz, xz, and xy for shear. We note that while other perturbations
in Abinit are treated in reduced coordinates, strain is better dealt with in
Cartesian coordinates for reasons discussed in the reference cited above.
These wave functions are used to compute three types of 2DTE&rsquo;s. Derivatives
with respect to two strain components give us the so-called rigid-ion elastic
tensor. Derivatives with respect to one strain and one electric field
component give us the rigid-ion piezoelectric tensor. Finally, derivatives
with respect to one strain and one atomic displacement yield the internal-strain
force-response tensor, an intermediate quantity that will be necessary
to compute the atomic relaxation corrections to the rigid-ion quantities. As
in <a href="/tutorial/rf1">tutorial DFPT1</a>, we specify convergence in terms of the residual of the
potential (here the first-order potential) using <a class="wikilink codevar-wikilink" href="/variables/basic#tolvrs">tolvrs</a>.</p>
<p>Your run should have completed by now. Abinit should have created quite a few files,
among which:</p>
<ul>
<li>telast_2.abo (main output file)</li>
<li>telast_2o_DS1_DDB (first derivatives of the energy from GS calculation)</li>
<li>telast_2o_DS3_DDB (second derivatives from the RF calculation)</li>
<li>telast_2o_DS1_WFK (GS wave functions)</li>
<li>telast_2o_DS2_1WF* (ddk wave functions)</li>
<li>telast_2o_DS3_1WF* (RF first-order wave functions from various perturbations)</li>
</ul>
<p>The derivative database DDB files are ascii and
readable, but primarily for subsequent analysis by anaddb which we will
undertake in the next section. Finally, the various wave function binary files
are primarily of use for subsequent calculations, where they could cut the
number of needed iterations in, for example, convergence testing.
File names have been generated according to the following convention.
After the &ldquo;root&rdquo; name (which is by default taken from the name of the .abi file),
follows the number of the dataset producing the file.
Finally, the first-order wave function 1WF files have a final &ldquo;pertcase&rdquo;
number described in <a class="wikilink user-guide-wikilink" href="/guide/respfn#1">section 1</a> of the <a class="wikilink user-guide-wikilink" href="/guide/respfn">respfn_help file</a>.
While <em>telast_2.abi</em> specifies all atomic displacements, only the
symmetry-inequivalent perturbations are treated, so the &ldquo;pertcase&rdquo; list is incomplete.
All cases specified in the input data are treated for the strain perturbation.</p>
<p>First, take a look at the end of the *log file to make sure the run
has completed without error. You might wish to take a look at the WARNING&rsquo;s,
but they all appear to be harmless. Next, edit your <em>telast_2.abo</em> file.
Searching backwards for ETOT you will find</p>
<div class="codehilite"><pre><span></span><code>     iter   2DEtotal(Ha)        deltaE(Ha) residm    vres2
-ETOT  1   2.6864034257676     -1.394E+01 7.628E+01 3.415E+02
 ETOT  2   1.5949143903393     -1.091E+00 3.669E-02 4.465E+00
 ETOT  3   1.5767914745018     -1.812E-02 5.026E-05 3.449E-01
 ETOT  4   1.5758067303228     -9.847E-04 9.600E-07 6.237E-03
 ETOT  5   1.5757929703648     -1.376E-05 6.251E-08 3.303E-05
 ETOT  6   1.5757928924185     -7.795E-08 1.128E-09 3.010E-07
 ETOT  7   1.5757928914135     -1.005E-09 9.367E-11 6.841E-09
 ETOT  8   1.5757928913731     -4.046E-11 1.281E-12 1.312E-10
 ETOT  9   1.5757928913723     -7.105E-13 1.065E-13 8.070E-12

 At SCF step    9       vres2   =  8.07E-12 &lt; tolvrs=  1.00E-10 =&gt;converged.
</code></pre></div>

<p>Abinit is solving a set of Schroedinger-like equations for the first-order
wave functions, and these functions minimize a variational expression for the
2DTE (technically, they are called self-consistent Sternheimer equations).
The  energy  convergence looks similar to that of GS calculations.  The fact
that <em>vres2</em>, the residual of the self-consistent first-order potential, has
reached <a class="wikilink codevar-wikilink" href="/variables/basic#tolvrs">tolvrs</a> well within <a class="wikilink codevar-wikilink" href="/variables/basic#nstep">nstep</a> (40) iterations indicates that the
2DTE calculation for this perturbation (xy strain) has converged. It would
pay to examine a few more cases for different perturbations (unless you have
looked through all the warnings in the log).</p>
<p>Another convergence item to examine in your .abo file is</p>
<div class="codehilite"><pre><span></span><code><span class="w"> </span><span class="n">Seventeen</span><span class="w"> </span><span class="n">components</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="mi">2</span><span class="n">nd</span><span class="o">-</span><span class="n">order</span><span class="w"> </span><span class="n">total</span><span class="w"> </span><span class="n">energy</span><span class="w"> </span><span class="p">(</span><span class="n">hartree</span><span class="p">)</span><span class="w"> </span><span class="n">are</span>
<span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="n">th</span><span class="o">-</span><span class="n">order</span><span class="w"> </span><span class="n">hamiltonian</span><span class="w"> </span><span class="n">combined</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="mi">1</span><span class="n">st</span><span class="o">-</span><span class="n">order</span><span class="w"> </span><span class="n">wavefunctions</span>
<span class="w">     </span><span class="n">kin0</span><span class="o">=</span><span class="w">   </span><span class="mf">1.67341861E+01</span><span class="w"> </span><span class="n">eigvalue</span><span class="o">=</span><span class="w">  </span><span class="o">-</span><span class="mf">4.11015159E-01</span><span class="w">  </span><span class="n">local</span><span class="o">=</span><span class="w">  </span><span class="o">-</span><span class="mf">3.22857213E+00</span>
<span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="n">st</span><span class="o">-</span><span class="n">order</span><span class="w"> </span><span class="n">hamiltonian</span><span class="w"> </span><span class="n">combined</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="mi">1</span><span class="n">st</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="mi">0</span><span class="n">th</span><span class="o">-</span><span class="n">order</span><span class="w"> </span><span class="n">wfs</span>
<span class="w"> </span><span class="n">loc</span><span class="w"> </span><span class="n">psp</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="o">-</span><span class="mf">9.55499839E+00</span><span class="w">  </span><span class="n">Hartree</span><span class="o">=</span><span class="w">   </span><span class="mf">4.67777679E+00</span><span class="w">     </span><span class="n">xc</span><span class="o">=</span><span class="w">  </span><span class="o">-</span><span class="mf">7.47227780E-01</span>
<span class="w">     </span><span class="n">kin1</span><span class="o">=</span><span class="w">  </span><span class="o">-</span><span class="mf">2.31525775E+01</span>
<span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">:</span><span class="w"> </span><span class="n">eventually</span><span class="p">,</span><span class="w"> </span><span class="n">occupation</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">non</span><span class="o">-</span><span class="n">local</span><span class="w"> </span><span class="n">contributions</span>
<span class="w">    </span><span class="n">edocc</span><span class="o">=</span><span class="w">   </span><span class="mf">0.00000000E+00</span><span class="w">     </span><span class="n">enl0</span><span class="o">=</span><span class="w">   </span><span class="mf">6.39144174E-01</span><span class="w">   </span><span class="n">enl1</span><span class="o">=</span><span class="w">  </span><span class="o">-</span><span class="mf">6.46481544E-03</span>
<span class="w"> </span><span class="mi">1</span><span class="o">-</span><span class="mi">10</span><span class="w"> </span><span class="n">gives</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">relaxation</span><span class="w"> </span><span class="n">energy</span><span class="w"> </span><span class="p">(</span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">shifted</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">some</span><span class="w"> </span><span class="n">occ</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="o">/=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="w">   </span><span class="n">erelax</span><span class="o">=</span><span class="w">  </span><span class="o">-</span><span class="mf">1.50497487E+01</span>
<span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="w"> </span><span class="n">Non</span><span class="o">-</span><span class="n">relaxation</span><span class="w">  </span><span class="n">contributions</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">frozen</span><span class="o">-</span><span class="n">wavefunctions</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">Ewald</span>
<span class="w">  </span><span class="n">fr</span><span class="o">.</span><span class="n">hart</span><span class="o">=</span><span class="w">  </span><span class="o">-</span><span class="mf">1.37404595E-01</span><span class="w">   </span><span class="n">fr</span><span class="o">.</span><span class="n">kin</span><span class="o">=</span><span class="w">   </span><span class="mf">1.27503317E+01</span><span class="w"> </span><span class="n">fr</span><span class="o">.</span><span class="n">loc</span><span class="o">=</span><span class="w">   </span><span class="mf">4.84873306E-01</span>
<span class="w"> </span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="w"> </span><span class="n">Non</span><span class="o">-</span><span class="n">relaxation</span><span class="w">  </span><span class="n">contributions</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">frozen</span><span class="o">-</span><span class="n">wavefunctions</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">Ewald</span>
<span class="w">  </span><span class="n">fr</span><span class="o">.</span><span class="n">nonl</span><span class="o">=</span><span class="w">   </span><span class="mf">4.27603780E-01</span><span class="w">    </span><span class="n">fr</span><span class="o">.</span><span class="n">xc</span><span class="o">=</span><span class="w">  </span><span class="o">-</span><span class="mf">3.16560587E-02</span><span class="w">  </span><span class="n">Ewald</span><span class="o">=</span><span class="w">   </span><span class="mf">3.13179353E+00</span>
<span class="w"> </span><span class="mi">17</span><span class="w"> </span><span class="n">Non</span><span class="o">-</span><span class="n">relaxation</span><span class="w">  </span><span class="n">contributions</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">pseudopotential</span><span class="w"> </span><span class="n">core</span><span class="w"> </span><span class="n">energy</span>
<span class="w">  </span><span class="n">pspcore</span><span class="o">=</span><span class="w">   </span><span class="mf">0.00000000E+00</span>
<span class="w"> </span><span class="n">Resulting</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">:</span>
<span class="w"> </span><span class="mi">2</span><span class="n">DEtotal</span><span class="o">=</span><span class="w">    </span><span class="mf">0.1575792891E+01</span><span class="w"> </span><span class="n">Ha</span><span class="o">.</span><span class="w"> </span><span class="n">Also</span><span class="w"> </span><span class="mi">2</span><span class="n">DEtotal</span><span class="o">=</span><span class="w">    </span><span class="mf">0.428795052510E+02</span><span class="w"> </span><span class="n">eV</span>
<span class="w">    </span><span class="p">(</span><span class="mi">2</span><span class="n">DErelax</span><span class="o">=</span><span class="w">   </span><span class="o">-</span><span class="mf">1.5049748718E+01</span><span class="w"> </span><span class="n">Ha</span><span class="o">.</span><span class="w"> </span><span class="mi">2</span><span class="n">DEnonrelax</span><span class="o">=</span><span class="w">    </span><span class="mf">1.6625541610E+01</span><span class="w"> </span><span class="n">Ha</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="w">  </span><span class="n">non</span><span class="o">-</span><span class="k">var</span><span class="o">.</span><span class="w"> </span><span class="mi">2</span><span class="n">DEtotal</span><span class="w"> </span><span class="p">:</span><span class="w">    </span><span class="mf">1.5757929293E+00</span><span class="w"> </span><span class="n">Ha</span><span class="p">)</span>
</code></pre></div>

<p>This detailed breakdown of the contributions to 2DTE is probably of limited
interest, but you should compare &ldquo;2DEtotal&rdquo; and &ldquo;non-var. 2DEtotal&rdquo; from the
last three lines. While the first-order wave function for the present
perturbation minimizes a variational expression for the second derivative
with respect to this perturbation as we just saw, the various 2DTE given as
elastic tensors, etc. in the output and in the DDB file are all computed using
non-variational expressions. Using the non-variational expressions, mixed
second derivatives with respect to the present perturbation and all other
perturbations of interest can be computed directly from the present
first-order wave functions. The disadvantage is that the non-variational result
has errors which are linearly proportional to convergence errors in the GS and
first-order wave functions. Since errors in the variational 2DEtotal are
second-order in wave-function convergence errors, comparing this to the non-variational
result for the diagonal second derivative will give an idea of the
accuracy of the latter and perhaps indicate the need for tighter convergence
tolerances for both the GS and RF wave functions.
This is discussed in X. Gonze and C. Lee, Phys. Rev. B 55, 10355 (1997) <a class="wikilink citation-wikilink" data-tippy-content="Dynamical matrices, Born effective charges, dielectric permittivity tensors, and interatomic force constants from density-functional perturbation theory" data-toggle="popover" href="/theory/bibliography#gonze1997a">[Gonze1997a]</a>, Sec. II.
For an atomic-displacement perturbation, the corresponding breakdown of the 2DTE is headed
&ldquo;Thirteen components.&rdquo;</p>
<p>Now let us take a look at the results we want, the various 2DTE&rsquo;s. They begin by</p>
<div class="codehilite"><pre><span></span><code><span class="w"> </span><span class="o">==&gt;</span><span class="w"> </span><span class="nv">Compute</span><span class="w"> </span><span class="nv">Derivative</span><span class="w"> </span><span class="nv">Database</span><span class="w"> </span><span class="o">&lt;==</span>

<span class="w">  </span><span class="mi">2</span><span class="nv">nd</span><span class="o">-</span><span class="nv">order</span><span class="w"> </span><span class="nv">matrix</span><span class="w"> </span><span class="ss">(</span><span class="nv">non</span><span class="o">-</span><span class="nv">cartesian</span><span class="w"> </span><span class="nv">coordinates</span>,<span class="w"> </span><span class="nv">masses</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">included</span>,
<span class="w">   </span><span class="nv">asr</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">included</span><span class="w"> </span><span class="ss">)</span>
<span class="w">  </span><span class="nv">cartesian</span><span class="w"> </span><span class="nv">coordinates</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">strain</span><span class="w"> </span><span class="nv">terms</span><span class="w"> </span><span class="ss">(</span><span class="mi">1</span><span class="o">/</span><span class="nv">ucvol</span><span class="w"> </span><span class="nv">factor</span>
<span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="nv">elastic</span><span class="w"> </span><span class="nv">tensor</span><span class="w"> </span><span class="nv">components</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">included</span><span class="ss">)</span>
<span class="w">     </span><span class="nv">j1</span><span class="w">       </span><span class="nv">j2</span><span class="w">             </span><span class="nv">matrix</span><span class="w"> </span><span class="nv">element</span>
<span class="w">  </span><span class="nv">dir</span><span class="w"> </span><span class="nv">pert</span><span class="w"> </span><span class="nv">dir</span><span class="w"> </span><span class="nv">pert</span><span class="w">     </span><span class="nv">real</span><span class="w"> </span><span class="nv">part</span><span class="w">     </span><span class="nv">imaginary</span><span class="w"> </span><span class="nv">part</span>

<span class="w">   </span><span class="mi">1</span><span class="w">    </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">    </span><span class="mi">1</span><span class="w">         </span><span class="mi">5</span>.<span class="mi">7740048299</span><span class="w">         </span><span class="mi">0</span>.<span class="mi">0000000000</span>
<span class="w">   </span><span class="mi">1</span><span class="w">    </span><span class="mi">1</span><span class="w">   </span><span class="mi">2</span><span class="w">    </span><span class="mi">1</span><span class="w">        </span><span class="o">-</span><span class="mi">2</span>.<span class="mi">8870024150</span><span class="w">         </span><span class="mi">0</span>.<span class="mi">0000000000</span>
<span class="w">   </span><span class="mi">1</span><span class="w">    </span><span class="mi">1</span><span class="w">   </span><span class="mi">3</span><span class="w">    </span><span class="mi">1</span><span class="w">         </span><span class="mi">0</span>.<span class="mi">0000000000</span><span class="w">         </span><span class="mi">0</span>.<span class="mi">0000000000</span>
<span class="w">            </span>.....
</code></pre></div>

<p>These are the &ldquo;raw&rdquo; 2DTE&rsquo;s, in reduced coordinates for atom-displacement and
electric-field perturbations, but cartesian coordinates for strain
perturbations. The same results with the same organization appear in the file
<em>telast_2_DS3_DDB</em> which will be used later as input for automated analysis and
converted to more useful notation and units by anaddb. A breakout of various
types of 2DTE&rsquo;s follows (all converted to Cartesian coordinates and in atomic units):</p>
<div class="codehilite"><pre><span></span><code><span class="w">  </span><span class="nv">Dynamical</span><span class="w"> </span><span class="nv">matrix</span>,<span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">cartesian</span><span class="w"> </span><span class="nv">coordinates</span>,
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="nv">specified</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">inputs</span>,<span class="w"> </span><span class="nv">asr</span><span class="w"> </span><span class="nv">has</span><span class="w"> </span><span class="nv">been</span><span class="w"> </span><span class="nv">imposed</span>
<span class="w">     </span><span class="nv">j1</span><span class="w">       </span><span class="nv">j2</span><span class="w">             </span><span class="nv">matrix</span><span class="w"> </span><span class="nv">element</span>
<span class="w">  </span><span class="nv">dir</span><span class="w"> </span><span class="nv">pert</span><span class="w"> </span><span class="nv">dir</span><span class="w"> </span><span class="nv">pert</span><span class="w">     </span><span class="nv">real</span><span class="w"> </span><span class="nv">part</span><span class="w">    </span><span class="nv">imaginary</span><span class="w"> </span><span class="nv">part</span>

<span class="w">   </span><span class="mi">1</span><span class="w">    </span><span class="mi">1</span><span class="w">   </span><span class="mi">1</span><span class="w">    </span><span class="mi">1</span><span class="w">         </span><span class="mi">0</span>.<span class="mi">1098826675</span><span class="w">         </span><span class="mi">0</span>.<span class="mi">0000000000</span>
<span class="w">   </span><span class="mi">1</span><span class="w">    </span><span class="mi">1</span><span class="w">   </span><span class="mi">2</span><span class="w">    </span><span class="mi">1</span><span class="w">         </span><span class="mi">0</span>.<span class="mi">0000000000</span><span class="w">         </span><span class="mi">0</span>.<span class="mi">0000000000</span>
<span class="w">   </span><span class="mi">1</span><span class="w">    </span><span class="mi">1</span><span class="w">   </span><span class="mi">3</span><span class="w">    </span><span class="mi">1</span><span class="w">         </span><span class="mi">0</span>.<span class="mi">0000000000</span><span class="w">         </span><span class="mi">0</span>.<span class="mi">0000000000</span>
<span class="w">            </span>.....
</code></pre></div>

<p>This contains the interatomic force constant data that will be used later to
include atomic relaxation effects. &ldquo;asr&rdquo; refers to the acoustic sum rule,
which basically is a way of making sure that forces sum to zero when an atom is displaced.</p>
<div class="codehilite"><pre><span></span><code><span class="w">  </span><span class="nv">Effective</span><span class="w"> </span><span class="nv">charges</span>,<span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">cartesian</span><span class="w"> </span><span class="nv">coordinates</span>,
<span class="w">  </span><span class="ss">(</span><span class="nv">from</span><span class="w"> </span><span class="nv">phonon</span><span class="w"> </span><span class="nv">response</span><span class="ss">)</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="nv">specified</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">inputs</span>,<span class="w"> </span><span class="nv">charge</span><span class="w"> </span><span class="nv">neutrality</span><span class="w"> </span><span class="nv">has</span><span class="w"> </span><span class="nv">been</span><span class="w"> </span><span class="nv">imposed</span>
<span class="w">     </span><span class="nv">j1</span><span class="w">       </span><span class="nv">j2</span><span class="w">             </span><span class="nv">matrix</span><span class="w"> </span><span class="nv">element</span>
<span class="w">  </span><span class="nv">dir</span><span class="w"> </span><span class="nv">pert</span><span class="w"> </span><span class="nv">dir</span><span class="w"> </span><span class="nv">pert</span><span class="w">     </span><span class="nv">real</span><span class="w"> </span><span class="nv">part</span><span class="w">    </span><span class="nv">imaginary</span><span class="w"> </span><span class="nv">part</span>

<span class="w">   </span><span class="mi">1</span><span class="w">    </span><span class="mi">6</span><span class="w">   </span><span class="mi">1</span><span class="w">    </span><span class="mi">1</span><span class="w">         </span><span class="mi">2</span>.<span class="mi">0670263917</span><span class="w">         </span><span class="mi">0</span>.<span class="mi">0000000000</span>
<span class="w">   </span><span class="mi">2</span><span class="w">    </span><span class="mi">6</span><span class="w">   </span><span class="mi">1</span><span class="w">    </span><span class="mi">1</span><span class="w">         </span><span class="mi">0</span>.<span class="mi">0000000000</span><span class="w">         </span><span class="mi">0</span>.<span class="mi">0000000000</span>
<span class="w">   </span><span class="mi">3</span><span class="w">    </span><span class="mi">6</span><span class="w">   </span><span class="mi">1</span><span class="w">    </span><span class="mi">1</span><span class="w">         </span><span class="mi">0</span>.<span class="mi">0000000000</span><span class="w">         </span><span class="mi">0</span>.<span class="mi">0000000000</span>
<span class="w">            </span>.....
</code></pre></div>

<p>The Born effective charges will be used to find the atomic relaxation
contributions of the piezoelectric tensor.</p>
<div class="codehilite"><pre><span></span><code>  Rigid-atom elastic tensor , in cartesian coordinates,
     j1       j2             matrix element
  dir pert dir pert     real part    imaginary part

   1    7   1    7         0.0078004875         0.0000000000
   1    7   2    7         0.0019706468         0.0000000000
   1    7   3    7         0.0011850679         0.0000000000
            .....
</code></pre></div>

<p>The rigid-atom elastic tensor is the 2DTE with respect to a pair of strains.
We recall that &ldquo;pert&rdquo; = natom+3 and natom+4 for unaxial and shear strains, respectively.</p>
<div class="codehilite"><pre><span></span><code>  Internal strain coupling parameters, in cartesian coordinates,
   zero average net force deriv. has been imposed
     j1       j2             matrix element
  dir pert dir pert     real part    imaginary part

   1    1   1    7         0.1464077350         0.0000000000
   1    1   2    7        -0.1464077350         0.0000000000
   1    1   3    7         0.0000000000         0.0000000000
            .....
</code></pre></div>

<p>These 2DTE&rsquo;s with respect to one strain and one atomic displacement are needed
for atomic relaxation corrections to both the elastic tensor and piezoelectric
tensor. While this set of parameters is of limited direct interest, it should
be examined in cases when you think that high symmetry may eliminate the need
for these corrections. You are probably wrong, and any non-zero term indicates a correction.</p>
<div class="codehilite"><pre><span></span><code>  Rigid-atom proper piezoelectric tensor, in cartesian coordinates,
  (from strain response)
     j1       j2             matrix element
  dir pert dir pert     real part    imaginary part

   1    6   1    7         0.0000000000         0.0000000000
   1    6   2    7         0.0000000000         0.0000000000
   1    6   3    7        -0.0000000000         0.0000000000
   1    6   1    8         0.0000000000         0.0000000000
   1    6   2    8         0.0070195611         0.0000000000
   1    6   3    8         0.0000000000         0.0000000000
</code></pre></div>

<p>Finally, we have the piezoelectric tensor, the 2DTE with respect to one strain
and one uniform electric field component. (Yes, there are non-zero elements.)</p>
<h2 id="3-anaddb-calculation-of-atom-relaxation-effects">3 ANADDB calculation of atom-relaxation effects<a class="headerlink" href="#3-anaddb-calculation-of-atom-relaxation-effects" title="Permanent link">&para;</a></h2>
<p>In this section, we will run the program anaddb, which analyzes DDB files
generated in prior RF calculations. You should copy <em>telast_3.abi</em>
in your <em>Work_elast</em> directory. You should now go to the <a class="wikilink user-guide-wikilink" href="/guide/anaddb">anaddb help file</a>
introduction. The bulk of the material in this help file is contained in the
description of the variables. You should read the descriptions of</p>
<ul>
<li><a class="wikilink codevar-wikilink" href="/variables/anaddb#elaflag">elaflag</a>,</li>
<li><a class="wikilink codevar-wikilink" href="/variables/anaddb#piezoflag">piezoflag</a>,</li>
<li><a class="wikilink codevar-wikilink" href="/variables/anaddb#instrflag">instrflag</a>,</li>
<li><a class="wikilink codevar-wikilink" href="/variables/anaddb#chneut">chneut</a>.</li>
</ul>
<p>For the theory underlying the incorporation of atom-relaxation corrections, it
is recommended you see  X. Wu, D. Vanderbilt, and D. R. Hamann <a class="wikilink citation-wikilink" data-tippy-content="Systematic treatment of displacements, strains, and electric fields in density-functional perturbation theory" data-toggle="popover" href="/theory/bibliography#wu2005">[Wu2005]</a>.</p>
<p>Anaddb can do lots of other things, such as calculate the frequency-dependent
dielectric tensor, interpolate the phonon spectrum to make nice phonon
dispersion plots, calculate Raman spectra, etc., but we are focusing on the
minimum needed for the elastic and piezoelectric constants at zero electric field.</p>
<p>We also mention that <a class="wikilink user-guide-wikilink" href="/guide/mrgddb">mrgddb</a>
is another utility program that can be used to combine DDB files generated in
several different datasets or in different runs into a single DDB file that
can be analyzed by anaddb. One particular usage would be to combine the DDB
file produced by the GS run, which contains first-derivative information such
as stresses and forces with the RF DDB. It is anticipated that anaddb in a
future release will implement the finite-stress corrections to the elastic
tensor discussed in <a href="/theory/documents/elasticity-oganov.pdf">notes by A. R. Oganov</a> .</p>
<p>Now would be a good time to edit <em>telast_3.abi</em> and observe that it is very
simple, consisting of nothing more than the four variables listed above set to
appropriate values.</p>
<div class="text-center"><button id="uuid-5c6a837a-be06-4fca-992e-98bf44a68f30" class="md-button md-button--secondary"> View tests/tutorespfn/Input/telast_3.abi </button></div>
<div id="uuid-fbc037d1-9027-4128-ab4b-1d1b60ac4886" class="my_dialog" title="tests/tutorespfn/Input/telast_3.abi" hidden><div><div class="codehilite small-text"><pre><span></span>!the<span class="w"> </span>input<span class="w"> </span>file<span class="w"> </span><span class="k">for</span><span class="w"> </span>the<span class="w"> </span>anaddb<span class="w"> </span>code

<span class="w">  </span>elaflag<span class="w">  </span><span class="m">3</span><span class="w">  </span>!the<span class="w"> </span>flag<span class="w"> </span><span class="k">for</span><span class="w"> </span>the<span class="w"> </span>elastic<span class="w"> </span>constant
piezoflag<span class="w">  </span><span class="m">3</span><span class="w">  </span>!the<span class="w"> </span>flag<span class="w"> </span><span class="k">for</span><span class="w"> </span>the<span class="w"> </span>piezoelectric<span class="w"> </span>constant
instrflag<span class="w">  </span><span class="m">1</span><span class="w">  </span>!the<span class="w"> </span>flag<span class="w"> </span><span class="k">for</span><span class="w"> </span>the<span class="w"> </span>internal<span class="w"> </span>strain<span class="w"> </span>tensor

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = anaddb</span>
<span class="c1">#%% test_chain = telast_2.abi, telast_3.abi</span>
<span class="c1">#%% input_ddb = telast_2o_DS3_DDB</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   telast_3.abo, tolnlines=  2, tolabs=  2.0e-4, tolrel=  1.1, fld_options = -easy</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 4</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = D. Hamann</span>
<span class="c1">#%% keywords =  NC, DFPT</span>
<span class="c1">#%% description =  The input file for the anaddb code</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-fbc037d1-9027-4128-ab4b-1d1b60ac4886", "#uuid-5c6a837a-be06-4fca-992e-98bf44a68f30") }); </script>

<p>A <em>telast_3.files</em> file is also needed for anaddb. Copy it from the tests/tutorespfn/Input directory.</p>
<div class="text-center"><button id="uuid-58bb78d9-f5ce-4bf2-9527-6af7c85c2f7c" class="md-button md-button--secondary"> View tests/tutorespfn/Input/telast_3.files </button></div>
<div id="uuid-37e6fc3e-52e2-442b-8c31-ebc08206e6d7" class="my_dialog" title="tests/tutorespfn/Input/telast_3.files" hidden><div><pre class="small-text">
telast_3.abi
telast_3.abo
telast_2o_DS3_DDB
dummy_moldyn
dummy_GKK
dummy_epout
dummy_ddk

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-37e6fc3e-52e2-442b-8c31-ebc08206e6d7", "#uuid-58bb78d9-f5ce-4bf2-9527-6af7c85c2f7c") }); </script>

<p>The first two lines specify the .abi and .abo files, the third line specifies the DDB file, and the
last lines are dummy names which would be used in connection with other
capabilities of anaddb. Now you should run the calculation:</p>
<div class="codehilite"><pre><span></span><code>anaddb &lt;telast_3.files &gt;&amp; telast_3.log
</code></pre></div>

<p>This calculation should only take a few seconds. You should edit the log file,
go to the end, and make sure the calculation terminated without error. Next,
examine <em>telast_3.abo</em>. After some header information, we come to tables giving
the &ldquo;force-response&rdquo; and &ldquo;displacement-response&rdquo; internal strain tensors.
These represent, respectively, the force on each atom and the displacement of
each atom in response to a unit strain of the specified type. These numbers
are of limited interest to us, but represent important intermediate quantities
in the treatment of atomic relaxation (see the X. Wu <a class="wikilink citation-wikilink" data-tippy-content="Systematic treatment of displacements, strains, and electric fields in density-functional perturbation theory" data-toggle="popover" href="/theory/bibliography#wu2005">[Wu2005]</a> paper cited above).</p>
<p>Next, we come to the elastic tensor output:</p>
<div class="codehilite"><pre><span></span><code> Elastic Tensor (clamped ion) (unit:10^2GP):

   2.2949823   0.5797842   0.3486590  -0.0000000  -0.0000000   0.0000001
   0.5797842   2.2949822   0.3486590  -0.0000000   0.0000000   0.0000001
   0.3486589   0.3486589   2.4696020  -0.0000000   0.0000000   0.0000001
   0.0000000   0.0000000   0.0000000   0.5821756   0.0000000   0.0000000
  -0.0000000   0.0000000   0.0000000   0.0000000   0.5821756   0.0000000
   0.0000000   0.0000000   0.0000000   0.0000000   0.0000000   0.8575990

 Elastic Tensor (relaxed ion) (unit:10^2GP):
  (at fixed electric field boundary condition)

   1.8986339   0.7520966   0.5652395  -0.0000000  -0.0000000   0.0000001
   0.7520966   1.8986339   0.5652395  -0.0000000   0.0000000   0.0000001
   0.5652395   0.5652395   2.0508555  -0.0000000   0.0000000   0.0000001
   0.0000000   0.0000000   0.0000000   0.4487908   0.0000000   0.0000000
   0.0000000  -0.0000000  -0.0000000   0.0000000   0.4487909  -0.0000000
   0.0000000  -0.0000000   0.0000000   0.0000000  -0.0000000   0.5732684
</code></pre></div>

<p>While not labeled, the rows and columns 1-6 here represent xx, yy, zz, yz, xz,
xy strains and stresses in the conventional Voigt notation.
The clamped-ion results were calculated in the telast_2 RF run, and are simply
converted to standard GPa units by anaddb (the terms &ldquo;clamped ion,&rdquo; &ldquo;clamped
atom,&rdquo; and &ldquo;rigid atom&rdquo; used in various places are interchangeable, similarly for &ldquo;relaxed.&rdquo;)
The relaxed-ion result was calculated by anaddb by combining 2DTE&rsquo;s for
internal strain and interatomic force constants which are stored in the input
DDB file. Comparing the clamped and relaxed results, we see that all the
diagonal elastic constants have decreased in value.
This is plausible, since allowing the internal degrees of freedom to relax
should make a material less stiff. These tensors should be symmetric, and
certain tensor elements should be zero or identical by symmetry.
It&rsquo;s a good idea to check these properties against a standard text such as  J.
F. Nye, Physical Properties of Crystals (Oxford U. P., Oxford 1985) <a class="wikilink citation-wikilink" data-tippy-content="Physical Properties of Crystals" data-toggle="popover" href="/theory/bibliography#nye1985">[Nye1985]</a>.
Departures from expected symmetries (there are a few in the last decimal place
here) are due to either convergence errors or, if large, incorrectly specified
geometry (however, see the final comments on symmetry  below).</p>
<p>Later, we will obtain the (3,3) component of the Elastic Tensor (clamped ion)
from finite differences. Its value is 246.96020 GPa (note the unit:10^2GP indication above).</p>
<p>Next in *telast_3.abo we find the piezoelectric tensor results:</p>
<div class="codehilite"><pre><span></span><code><span class="w"> </span><span class="n">Proper</span><span class="w"> </span><span class="n">piezoelectric</span><span class="w"> </span><span class="n">constants</span><span class="w"> </span><span class="p">(</span><span class="n">clamped</span><span class="w"> </span><span class="n">ion</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">unit</span><span class="p">:</span><span class="n">c</span><span class="o">/</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>

<span class="w">      </span><span class="mf">0.00000000</span><span class="w">      </span><span class="mf">0.00000000</span><span class="w">      </span><span class="mf">0.36031593</span>
<span class="w">      </span><span class="mf">0.00000000</span><span class="w">      </span><span class="mf">0.00000000</span><span class="w">      </span><span class="mf">0.36031593</span>
<span class="w">     </span><span class="o">-</span><span class="mf">0.00000000</span><span class="w">     </span><span class="o">-</span><span class="mf">0.00000000</span><span class="w">     </span><span class="o">-</span><span class="mf">0.69614902</span>
<span class="w">      </span><span class="mf">0.00000000</span><span class="w">      </span><span class="mf">0.40162256</span><span class="w">      </span><span class="mf">0.00000000</span>
<span class="w">      </span><span class="mf">0.40162251</span><span class="w">      </span><span class="mf">0.00000000</span><span class="w">      </span><span class="mf">0.00000000</span>
<span class="w">      </span><span class="mf">0.00000000</span><span class="w">      </span><span class="mf">0.00000000</span><span class="w">     </span><span class="o">-</span><span class="mf">0.00000001</span>

<span class="w"> </span><span class="n">ddb_piezo</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">WARNING</span><span class="w"> </span><span class="o">-</span>
<span class="w">  </span><span class="n">Acoustic</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="n">rule</span><span class="w"> </span><span class="n">violation</span><span class="w"> </span><span class="n">met</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">eigenvalues</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">accoustic</span><span class="w"> </span><span class="n">mode</span>
<span class="w">  </span><span class="n">are</span><span class="w"> </span><span class="n">too</span><span class="w"> </span><span class="n">large</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">Gamma</span><span class="w"> </span><span class="n">point</span>
<span class="w">  </span><span class="n">Increase</span><span class="w"> </span><span class="n">cutoff</span><span class="w"> </span><span class="n">energy</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">k</span><span class="o">-</span><span class="n">points</span><span class="w"> </span><span class="n">sampling</span><span class="o">.</span>
<span class="w">  </span><span class="n">The</span><span class="w"> </span><span class="n">three</span><span class="w"> </span><span class="n">eigenvalues</span><span class="w"> </span><span class="n">are</span><span class="p">:</span><span class="w">   </span><span class="o">-</span><span class="mf">1.016026E-04</span><span class="w">   </span><span class="o">-</span><span class="mf">1.389885E-05</span><span class="w">   </span><span class="o">-</span><span class="mf">2.054240E-05</span>

<span class="w"> </span><span class="n">Proper</span><span class="w"> </span><span class="n">piezoelectric</span><span class="w"> </span><span class="n">constants</span><span class="w"> </span><span class="p">(</span><span class="n">relaxed</span><span class="w"> </span><span class="n">ion</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">unit</span><span class="p">:</span><span class="n">c</span><span class="o">/</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>

<span class="w">      </span><span class="mf">0.00000000</span><span class="w">     </span><span class="o">-</span><span class="mf">0.00000000</span><span class="w">     </span><span class="o">-</span><span class="mf">0.12745531</span>
<span class="w">     </span><span class="o">-</span><span class="mf">0.00000000</span><span class="w">      </span><span class="mf">0.00000000</span><span class="w">     </span><span class="o">-</span><span class="mf">0.12745533</span>
<span class="w">      </span><span class="mf">0.00000000</span><span class="w">      </span><span class="mf">0.00000000</span><span class="w">      </span><span class="mf">0.24692958</span>
<span class="w">      </span><span class="mf">0.00000000</span><span class="w">     </span><span class="o">-</span><span class="mf">0.15011587</span><span class="w">      </span><span class="mf">0.00000000</span>
<span class="w">     </span><span class="o">-</span><span class="mf">0.15011568</span><span class="w">      </span><span class="mf">0.00000000</span><span class="w">      </span><span class="mf">0.00000000</span>
<span class="w">     </span><span class="o">-</span><span class="mf">0.00000000</span><span class="w">      </span><span class="mf">0.00000000</span><span class="w">     </span><span class="o">-</span><span class="mf">0.00000002</span>
</code></pre></div>

<p>The 3 columns here represent x, y, and z electric polarization, and the 6 rows
the Voigt strains. The clamped-ion result was calculated in the telast_2 RF
run, and is simply scaled to conventional units by anaddb. The ion relaxation
contributions are based on 2DTE&rsquo;s for internal strain, interatomic force
constants, and Born effective charges, and typically constitute much larger
corrections to the piezoelectric tensor than to the elastic tensor. Once
again, symmetries should be checked (The slight discrepancies seen here can
be removed by setting tolvrs3 = 1.0d-18 in <em>telast_2.abi</em>). One should be aware
that the piezoelectric tensor is identically zero in any material which has a center of symmetry.</p>
<p>There is also a WARNING message. For the purpose of a tutorial, the <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a>
has not been selected large enough. Changing <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> from 6 Ha to 15 Ha will eliminate this problem.</p>
<p>Since we are dealing with a hypothetical material, there is no experimental
data with which to compare our results. In the next section, we will calculate
a few of these numbers by a finite-difference method to gain confidence in the RF approach.</p>
<h2 id="4-finite-difference-calculation-of-elastic-and-piezoelectric-constants">4 Finite-difference calculation of elastic and piezoelectric constants<a class="headerlink" href="#4-finite-difference-calculation-of-elastic-and-piezoelectric-constants" title="Permanent link">&para;</a></h2>
<p>You should copy <em>telast_4.abi</em> into your <em>Work_elast</em> directory.</p>
<div class="text-center"><button id="uuid-cb8c7d90-61c4-4e45-b5c2-c5c14b3a334a" class="md-button md-button--secondary"> View tests/tutorespfn/Input/telast_4.abi </button></div>
<div id="uuid-70141ac0-c3cc-4759-87ca-77fbc2e7e926" class="my_dialog" title="tests/tutorespfn/Input/telast_4.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#AlP in hypothetical wurzite (hexagonal) structure</span>
<span class="c1">#Finite-difference calculation for c-axis strain increment +/- 0.0001</span>

<span class="w">   </span>ndtset<span class="w">   </span><span class="m">4</span>

<span class="c1"># Set 1 : Self-consistent run for stress</span>

<span class="w">  </span>kptopt1<span class="w">   </span><span class="m">1</span>
<span class="w">   </span>rprim1<span class="w">   </span><span class="m">0</span>.866025403784439<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0
<span class="w">           </span>-0.866025403784439<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0
<span class="w">            </span><span class="m">0</span>.0<span class="w">                </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.9999<span class="w">  </span><span class="c1">#strained value</span>

<span class="c1"># Set 2 : Run for electric polarization</span>

berryopt2<span class="w">  </span>-1<span class="w">  </span><span class="c1">#preferred method to calulate electric polarization</span>
<span class="w">  </span>getwfk2<span class="w">  </span>-1<span class="w">  </span><span class="c1">#previous wf&#39;s will be transformed to full k set as needed</span>
<span class="w">  </span>kptopt2<span class="w">   </span><span class="m">3</span><span class="w">  </span><span class="c1">#berry phase calculation requires full k set</span>

<span class="w">   </span>rprim2<span class="w">   </span><span class="m">0</span>.866025403784439<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0
<span class="w">           </span>-0.866025403784439<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0
<span class="w">            </span><span class="m">0</span>.0<span class="w">                </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.9999

<span class="c1"># Set 3 : Self-consistent run for stress</span>

<span class="w">  </span>getwfk3<span class="w">  </span>-1<span class="w">  </span><span class="c1">#wave function shouldn&#39;t change much</span>
<span class="w">  </span>kptopt3<span class="w">   </span><span class="m">1</span>
<span class="w">   </span>rprim3<span class="w">   </span><span class="m">0</span>.866025403784439<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0
<span class="w">           </span>-0.866025403784439<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0
<span class="w">            </span><span class="m">0</span>.0<span class="w">                </span><span class="m">0</span>.0<span class="w">  </span><span class="m">1</span>.0001<span class="w">  </span><span class="c1">#strained value</span>

<span class="c1"># Set 4 : Run for electric polarization</span>

berryopt4<span class="w">  </span>-1
<span class="w">  </span>getwfk4<span class="w">  </span>-1
<span class="w">  </span>kptopt4<span class="w">   </span><span class="m">3</span>
<span class="w">   </span>rprim4<span class="w">   </span><span class="m">0</span>.866025403784439<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0
<span class="w">           </span>-0.866025403784439<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0
<span class="w">            </span><span class="m">0</span>.0<span class="w">                </span><span class="m">0</span>.0<span class="w">  </span><span class="m">1</span>.0001

<span class="c1">#Common input data</span>

<span class="c1">#Starting approximation for the unit cell</span>

<span class="c1"># relaxed lattice constants</span>
<span class="c1"># acell  COPY RELAXED RESULT FROM PREVIOUS CALCULATION</span>
<span class="c1"># Here is a default value, for automatic testing : suppress it and fill with values from the previous run</span>
<span class="w">     </span>acell<span class="w">  </span><span class="m">7</span>.2488954246E+00<span class="w">  </span><span class="m">7</span>.2488954246E+00<span class="w">  </span><span class="m">1</span>.1879499870E+01<span class="w"> </span>Bohr

<span class="c1">#Definition of the atom types and atoms</span>
<span class="w"> </span>ntypat<span class="w">   </span><span class="m">2</span>
<span class="w">  </span>znucl<span class="w">   </span><span class="m">13</span><span class="w"> </span><span class="m">15</span>
<span class="w">  </span>natom<span class="w">   </span><span class="m">4</span>
<span class="w">  </span>typat<span class="w">   </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span>

<span class="c1">#Starting approximation for atomic positions in REDUCED coordinates</span>
<span class="c1">#based on ideal tetrahedral bond angles</span>

<span class="c1"># xred  COPY RELAXED RESULT FROM PREVIOUS CALCULATION</span>
<span class="c1"># Here is a set of default values, for automatic testing : suppress it and fill with values from the previous run</span>
<span class="w">  </span>xred<span class="w">   </span><span class="m">1</span>/3<span class="w">  </span><span class="m">2</span>/3<span class="w">  </span><span class="m">0</span>
<span class="w">         </span><span class="m">2</span>/3<span class="w">  </span><span class="m">1</span>/3<span class="w">  </span><span class="m">1</span>/2
<span class="w">         </span><span class="m">1</span>/3<span class="w">  </span><span class="m">2</span>/3<span class="w">  </span><span class="m">3</span>.7517446813E-01
<span class="w">         </span><span class="m">2</span>/3<span class="w">  </span><span class="m">1</span>/3<span class="w">  </span><span class="m">8</span>.7517446813E-01

<span class="c1">#Gives the number of bands, explicitely (do not take the default)</span>
<span class="w">  </span>nband<span class="w">   </span><span class="m">8</span><span class="w">              </span><span class="c1"># For an insulator (if described correctly as an</span>
<span class="w">                         </span><span class="c1"># insulator by DFT), conduction bands should not</span>
<span class="w">                         </span><span class="c1"># be included in response-function calculations</span>

<span class="c1">#Definition of the plane wave basis set</span>
<span class="w">   </span>ecut<span class="w">   </span><span class="m">6</span>.0<span class="w">            </span><span class="c1"># Maximum kinetic energy cutoff (Hartree)</span>
<span class="w"> </span>ecutsm<span class="w">   </span><span class="m">0</span>.5<span class="w">            </span><span class="c1"># Smoothing energy needed for lattice paramete</span>
<span class="w">                         </span><span class="c1"># optimization.  This will be retained for</span>
<span class="w">                         </span><span class="c1"># consistency throughout.</span>

<span class="c1">#Definition of the k-point grid</span>
<span class="w"> </span>kptopt<span class="w">   </span><span class="m">1</span><span class="w">              </span><span class="c1"># Use symmetry and treat only inequivalent points</span>
<span class="w">  </span>ngkpt<span class="w">   </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w">          </span><span class="c1"># 4x4x4 Monkhorst-Pack grid</span>
nshiftk<span class="w">   </span><span class="m">1</span><span class="w">              </span><span class="c1"># Use one copy of grid only (default)</span>
<span class="w"> </span>shiftk<span class="w">   </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.5<span class="w">    </span><span class="c1"># This choice of origin for the k point grid</span>
<span class="w">                         </span><span class="c1"># preserves the hexagonal symmetry of the grid,</span>
<span class="w">                         </span><span class="c1"># which would be broken by the default choice.</span>

<span class="c1">#Definition of the self-consistency procedure</span>
<span class="w"> </span>diemac<span class="w">   </span><span class="m">9</span>.0<span class="w">            </span><span class="c1"># Model dielectric preconditioner</span>
<span class="w">  </span>nstep<span class="w">   </span><span class="m">40</span><span class="w">             </span><span class="c1"># Maxiumum number of SCF iterations</span>
<span class="w"> </span>tolvrs<span class="w">   </span><span class="m">1</span>.0d-18<span class="w">        </span><span class="c1"># Needed for good stress and polarization convergence</span>
<span class="c1"># enforce calculation of forces at each SCF step</span>
<span class="w"> </span>optforces<span class="w"> </span><span class="m">1</span>


<span class="w"> </span>pp_dirpath<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
<span class="w"> </span>pseudos<span class="w"> </span><span class="s2">&quot;Psdj_nc_sr_04_pw_std_psp8/Al.psp8, Psdj_nc_sr_04_pw_std_psp8/P.psp8&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   telast_4.abo, tolnlines=  0, tolabs=  0.000e+00, tolrel=  0.000e+00</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 2</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = D. Hamann</span>
<span class="c1">#%% keywords = NC, DFPT</span>
<span class="c1">#%% description =</span>
<span class="c1">#%%    AlP in hypothetical wurzite (hexagonal) structure</span>
<span class="c1">#%%    Finite-difference calculation for c-axis strain increment +/- 0.0001</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-70141ac0-c3cc-4759-87ca-77fbc2e7e926", "#uuid-cb8c7d90-61c4-4e45-b5c2-c5c14b3a334a") }); </script>

<p>Editing <em>telast_4.abi</em>, you will see that it has four datasets, the first two
with the c-axis contracted 0.01% and the second two with it expanded 0.01%,
which we specified by changing the third row of <a class="wikilink codevar-wikilink" href="/variables/basic#rprim">rprim</a>. The common data is
essentially the same as telast_2.abi, and the relaxed <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a> values and
<a class="wikilink codevar-wikilink" href="/variables/basic#xred">xred</a> from telast_1.abo have already been included. Datasets 1 and 3 do the
self-consistent convergence of the GS wave functions for the strained lattices
and compute the stress. Datasets 2 and 4 introduce a new variable.</p>
<ul>
<li><a class="wikilink codevar-wikilink" href="/variables/ffield#berryopt">berryopt</a></li>
</ul>
<p>Electric polarization in solids is a subtle topic which has been
rigorously resolved thirty years ago. It is now understood to be a bulk property, and to be
quantitatively described by a Berry phase formulation introduced by R. D.
King-Smith and D. Vanderbilt, Phys. Ref. B 47, 1651(1993) <a class="wikilink citation-wikilink" data-tippy-content="Theory of polarization of crystalline solids" data-toggle="popover" href="/theory/bibliography#kingsmith1993">[Kingsmith1993]</a>. It can be
calculated in a GS calculation by integrating the gradient with respect to
<strong>k</strong> of the GS wave functions over the Brillouin zone. In GS calculations,
the gradients are approximated by finite-difference expressions constructed
from neighboring points in the <strong>k</strong> mesh. These are closely related to the
ddk wave functions used in RF calculations in section 2 and introduced in
<a class="wikilink lesson-wikilink" href="/tutorial/rf1#5">tutorial DFPT1, section 5</a>. We will use <a class="wikilink codevar-wikilink" href="/variables/ffield#berryopt">berryopt</a> = -1,
which utilizes an improved coding of the calculation.
With the default <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfdir">rfdir</a> = 1 1 1 all the cartesian components of the polarization are computed.</p>
<p>Now, run the <em>telast_4.abi</em> calculation, which should only take a minute or two, and
edit <em>telast_4.abo</em>. To calculate the elastic constants, we need to find the
stresses  sigma(1 1) and sigma(3 3). We see that each of the four datasets
have stress results, but that there are slight differences between those from,
for example dataset 1 and dataset 2, which should be identical. Despite our
tight limit, this is still a convergence issue. Look at the following convergence results,</p>
<div class="codehilite"><pre><span></span><code>Dataset 1:
 At SCF step   13       vres2   =  6.68E-21 &lt; tolvrs=  1.00E-18 =&gt;converged.

Dataset 2:
 At SCF step    1       vres2   =  5.31E-22 &lt; tolvrs=  1.00E-18 =&gt;converged.
</code></pre></div>

<p>Since dataset 2 has better convergence, we will use it.  Coherently,
we will use also the dataset 4 results, choosing those in GPa units,</p>
<div class="codehilite"><pre><span></span><code>-Cartesian components of stress tensor (GPa)         [Pressure=  9.1716E-03 GPa]
- sigma(1 1)= -1.39848817E-03  sigma(3 2)=  0.00000000E+00
- sigma(2 2)= -1.39848817E-03  sigma(3 1)=  0.00000000E+00
- sigma(3 3)= -2.47179326E-02  sigma(2 1)=  0.00000000E+00

-Cartesian components of stress tensor (GPa)         [Pressure= -1.1941E-02 GPa]
- sigma(1 1)=  5.57418718E-03  sigma(3 2)=  0.00000000E+00
- sigma(2 2)=  5.57418718E-03  sigma(3 1)=  0.00000000E+00
- sigma(3 3)=  2.46737283E-02  sigma(2 1)=  0.00000000E+00
</code></pre></div>

<p>Let us now compute the numerical derivative of sigma(3 3) and compare to our
RF result. Recalling that our dimensionless strains were 0.0001, we find
246.9583 GPa. This compares very well with the value 246.9602 GPa, the 3,3
element of the Rigid-ion elastic tensor we found from our anaddb calculation
in section 3. (Recall that our strains and stresses were both 3,3 or z,z or Voigt
3.) Similarly, the numerical derivative of  sigma(3 1) is 34.8634 GPa
compared to 34.8658 GPa, the 3,1 elastic-tensor element computed above.</p>
<p>The good agreement we found from this simple numerical differentiation
required that we had accurately relaxed the lattice so that the stress of the
unstrained structure was very small. Similar numerical-derivative comparisons
for systems with finite stress are more complicated, as discussed in
<a href="/theory/documents/elasticity-oganov.pdf">notes by A. R. Oganov</a>.
Numerical-derivative comparisons for the relaxed-ion results are extremely challenging
since they require relaxing atomic forces to exceedingly small limits.</p>
<p>Now let us examine the electric polarizations found in datasets 2 and 4,
focusing on the C/m^2 results,</p>
<div class="codehilite"><pre><span></span><code>       Polarization    -3.695942387E-15 C/m^2
       Polarization    -8.071946282E-16 C/m^2
       Polarization    -3.244653656E-01 C/m^2

       Polarization     5.396151684E-16 C/m^2
       Polarization     9.218443808E-18 C/m^2
       Polarization    -3.246052331E-01 C/m^2
</code></pre></div>

<p>While not labeled as such, these are the Cartesian x, y, and z components,
respectively, and the x and y components are zero within numerical accuracy as
they must be from symmetry. Numerical differentiation of the z component
yields -0.699337 C/m<span class="arithmatex">\(^2\)</span>. This is to be compared with the z,3 element of our
rigid-ion piezoelectric tensor from section 3, -0.696149 C/m<span class="arithmatex">\(^2\)</span>, and the two
results do not compare as well as we might wish.</p>
<p>What is wrong? There are two possibilities. The first is that the RF
calculation produces the proper piezoelectric tensor, while numerical
differentiation of the polarization produces the improper piezoelectric
tensor. This is a subtle point, for which you are referred to  D. Vanderbilt,
J. Phys. Chem. Solids 61, 147 (2000) <a class="wikilink citation-wikilink" data-tippy-content="Berry-phase theory of proper piezoelectric response" data-toggle="popover" href="/theory/bibliography#vanderbilt2000">[Vanderbilt2000]</a>. The improper-to-proper transformation
only effects certain tensor elements, however, and for our particular
combination of crystal symmetry and choice of strain there is no correction.
The second possibility is the subject of the next section.</p>
<h2 id="5-alternative-dfpt-calculation-of-some-piezoelectric-constants">5 Alternative DFPT calculation of some piezoelectric constants<a class="headerlink" href="#5-alternative-dfpt-calculation-of-some-piezoelectric-constants" title="Permanent link">&para;</a></h2>
<p>Our GS calculation of the polarization in section 4 used, in effect, a finite-
difference approximation to ddk wave functions, while our RF calculations in
section 2 used analytic results based on the RF approach. Since the <strong>k</strong> grid
determined by <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> = 4 4 4 and <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> = 1 is rather coarse, this is
a probable source of discrepancy. Since this issue was noted previously in
connection with the calculation of Born effective charges by  Na Sai, K. M.
Rabe, and D. Vanderbilt, Phys. Rev. B 66, 104108 (2002) <a class="wikilink citation-wikilink" data-tippy-content="Theory of structural response to macroscopic electric fields in ferroelectric systems" data-toggle="popover" href="/theory/bibliography#sai2002">[Sai2002]</a>, Abinit has
incorporated the ability to use finite-difference ddk wave functions from GS
calculations in RF calculations of electric-field-related 2DTE&rsquo;s.</p>
<p>Copy
<em>telast_5.abi</em> into <em>Work_elast</em>, and edit <em>telast_5.abi</em>.</p>
<div class="text-center"><button id="uuid-ffc42629-b83e-47a0-a53d-7eb52e770ce9" class="md-button md-button--secondary"> View tests/tutorespfn/Input/telast_5.abi </button></div>
<div id="uuid-e22d10c7-d9d1-4738-b30c-d2542f641472" class="my_dialog" title="tests/tutorespfn/Input/telast_5.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#AlP in hypothetical wurzite (hexagonal) structure</span>

<span class="c1">#Alternative response function calculation for some rigid-atom</span>
<span class="c1">#piezoelectric tensor elements.</span>

<span class="w">   </span>ndtset<span class="w">   </span><span class="m">3</span>

<span class="c1"># Set 1 : Initial self-consistent run</span>

<span class="w">  </span>kptopt1<span class="w">   </span><span class="m">1</span>
<span class="w">  </span>prtden1<span class="w">   </span><span class="m">1</span><span class="w">        </span><span class="c1">#second dataset need density</span>
<span class="w">  </span>tolvrs1<span class="w">   </span><span class="m">1</span>.0d-18<span class="w">  </span><span class="c1">#need excellent convergence of GS quantities for RF runs</span>


<span class="c1">#Second dataset : finite-difference d/dk ground-state calculation</span>
<span class="c1">#                uses bdberry_new</span>

berryopt2<span class="w">   </span>-2<span class="w">       </span><span class="c1">#specifies ddk wave functions wanted</span>
<span class="w">  </span>getden2<span class="w">   </span>-1<span class="w">       </span><span class="c1">#use density from previous dataset</span>
<span class="w">  </span>getwfk2<span class="w">   </span>-1<span class="w">       </span><span class="c1">#use wave function from profious dataset</span>
<span class="w">  </span>kptopt2<span class="w">   </span><span class="m">3</span><span class="w">        </span><span class="c1">#need full set of k points herre</span>
<span class="w">    </span>iscf2<span class="w">   </span>-2<span class="w">       </span><span class="c1">#non-self-consistent</span>
<span class="w">   </span>rfdir2<span class="w">   </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w">    </span><span class="c1">#we are only checking a c-axis quantity</span>
<span class="w">  </span>tolwfr2<span class="w">   </span><span class="m">1</span>.0d-20<span class="w">  </span><span class="c1"># only wave function convergence can be used with</span>
<span class="w">                     </span><span class="c1"># non-self-consistent calculation</span>

<span class="c1"># Set 3 : response-function calculations for all needed perturbations</span>

<span class="w">  </span>getddk3<span class="w">  </span>-1
<span class="w">  </span>getwfk3<span class="w">  </span>-1
<span class="w">  </span>kptopt3<span class="w">   </span><span class="m">2</span><span class="w">        </span><span class="c1">#use time-reversal symmetry only for k points</span>
<span class="w">    </span>nqpt3<span class="w">   </span><span class="m">1</span>
<span class="w">     </span>qpt3<span class="w">   </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
<span class="w">  </span>rfstrs3<span class="w">   </span><span class="m">1</span><span class="w">        </span><span class="c1">#do strain perturbation</span>
<span class="w">   </span>rfdir3<span class="w">   </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w">    </span><span class="c1">#the full set of directions is needed</span>
<span class="w">  </span>tolvrs3<span class="w">   </span><span class="m">1</span>.0d-10<span class="w">  </span><span class="c1">#need reasonable convergence of 1st-order quantities</span>

<span class="c1">#Common input data</span>

<span class="c1"># acell  COPY RELAXED RESULT FROM PREVIOUS CALCULATION</span>
<span class="c1"># Here is a default value, for automatic testing : suppress it and fill with values from the previous run</span>
<span class="w">  </span>acell<span class="w">  </span><span class="m">7</span>.2488954246E+00<span class="w">  </span><span class="m">7</span>.2488954246E+00<span class="w">  </span><span class="m">1</span>.1879499870E+01<span class="w"> </span>Bohr

<span class="w">  </span>rprim<span class="w">   </span><span class="m">0</span>.866025403784439<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0<span class="w">   </span><span class="c1">#hexagonal primitive vectors must be</span>
<span class="w">         </span>-0.866025403784439<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0<span class="w">   </span><span class="c1">#specified with high accuracy to be</span>
<span class="w">          </span><span class="m">0</span>.0<span class="w">                </span><span class="m">0</span>.0<span class="w">  </span><span class="m">1</span>.0<span class="w">   </span><span class="c1">#sure that the symmetry is recognized</span>
<span class="w">                                        </span><span class="c1">#and preserved in the optimization</span>
<span class="w">                                        </span><span class="c1">#process</span>

<span class="c1">#Definition of the atom types and atoms</span>
<span class="w"> </span>ntypat<span class="w">   </span><span class="m">2</span>
<span class="w">  </span>znucl<span class="w">   </span><span class="m">13</span><span class="w"> </span><span class="m">15</span>
<span class="w">  </span>natom<span class="w">   </span><span class="m">4</span>
<span class="w">  </span>typat<span class="w">   </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span>


<span class="c1"># xred  COPY RELAXED RESULT FROM PREVIOUS CALCULATION</span>
<span class="c1"># Here is a set of default values, for automatic testing : suppress it and fill with values from the previous run</span>
<span class="w">  </span>xred<span class="w">   </span><span class="m">1</span>/3<span class="w">  </span><span class="m">2</span>/3<span class="w">  </span><span class="m">0</span>
<span class="w">         </span><span class="m">2</span>/3<span class="w">  </span><span class="m">1</span>/3<span class="w">  </span><span class="m">1</span>/2
<span class="w">         </span><span class="m">1</span>/3<span class="w">  </span><span class="m">2</span>/3<span class="w">  </span><span class="m">3</span>.7517446813E-01
<span class="w">         </span><span class="m">2</span>/3<span class="w">  </span><span class="m">1</span>/3<span class="w">  </span><span class="m">8</span>.7517446813E-01

<span class="c1">#Gives the number of bands, explicitely (do not take the default)</span>
<span class="w">  </span>nband<span class="w">   </span><span class="m">8</span><span class="w">              </span><span class="c1"># For an insulator (if described correctly as an</span>
<span class="w">                         </span><span class="c1"># insulator by DFT), conduction bands should not</span>
<span class="w">                         </span><span class="c1"># be included in response-function calculations</span>

<span class="c1">#Definition of the plane wave basis set</span>
<span class="w">   </span>ecut<span class="w">   </span><span class="m">6</span>.0<span class="w">            </span><span class="c1"># Maximum kinetic energy cutoff (Hartree)</span>
<span class="w"> </span>ecutsm<span class="w">   </span><span class="m">0</span>.5<span class="w">            </span><span class="c1"># Smoothing energy needed for lattice paramete</span>
<span class="w">                         </span><span class="c1"># optimization.  This will be retained for</span>
<span class="w">                         </span><span class="c1"># consistency throughout.</span>

<span class="c1">#Definition of the k-point grid</span>
<span class="w"> </span>kptopt<span class="w">   </span><span class="m">1</span><span class="w">              </span><span class="c1"># Use symmetry and treat only inequivalent points</span>
<span class="w">  </span>ngkpt<span class="w">   </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w">          </span><span class="c1"># 4x4x4 Monkhorst-Pack grid</span>
nshiftk<span class="w">   </span><span class="m">1</span><span class="w">              </span><span class="c1"># Use one copy of grid only (default)</span>
<span class="w"> </span>shiftk<span class="w">   </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.5<span class="w">    </span><span class="c1"># This choice of origin for the k point grid</span>
<span class="w">                         </span><span class="c1"># preserves the hexagonal symmetry of the grid,</span>
<span class="w">                         </span><span class="c1"># which would be broken by the default choice.</span>

<span class="c1">#Definition of the self-consistency procedure</span>
<span class="w"> </span>diemac<span class="w">   </span><span class="m">9</span>.0<span class="w">            </span><span class="c1"># Model dielectric preconditioner</span>
<span class="w">  </span>nstep<span class="w">   </span><span class="m">40</span><span class="w">             </span><span class="c1"># Maxiumum number of SCF iterations</span>
<span class="c1"># enforce calculation of forces at each SCF step</span>
<span class="w"> </span>optforces<span class="w"> </span><span class="m">1</span>


<span class="w"> </span>pp_dirpath<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
<span class="w"> </span>pseudos<span class="w"> </span><span class="s2">&quot;Psdj_nc_sr_04_pw_std_psp8/Al.psp8, Psdj_nc_sr_04_pw_std_psp8/P.psp8&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test = </span>
<span class="c1">#%%   telast_5.abo, tolnlines=  5, tolabs=  1.100e-08, tolrel= 0.0004</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 2</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = D. Hamann</span>
<span class="c1">#%% keywords = NC, DFPT</span>
<span class="c1">#%% description =</span>
<span class="c1">#%%   AlP in hypothetical wurzite (hexagonal) structure</span>
<span class="c1">#%%   Alternative response function calculation for some rigid-atom</span>
<span class="c1">#%%   piezoelectric tensor elements.</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-e22d10c7-d9d1-4738-b30c-d2542f641472", "#uuid-ffc42629-b83e-47a0-a53d-7eb52e770ce9") }); </script>

<p>You should compare this with our previous RF data, <em>telast_2.abi</em>, and note that
dataset1 and the Common data (after entering relaxed structural results) are
essentially identical. Dataset 2 has been replaced by a non-self-consistent GS
calculation with <a class="wikilink codevar-wikilink" href="/variables/ffield#berryopt">berryopt</a> = -2 specified to perform the finite-difference
ddk wave function calculation. (The finite-difference first-order wave
functions are implicit but not actually calculated in the GS polarization
calculation.) We have restricted <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfdir">rfdir</a> to 0 0 1 since we are only
interested in the 3,3 piezoelectric constant. Now compare dataset 3 with that
in <em>telast_2.abi</em>. Can you figure out what we have dropped and why? Run the
<em>telast_5.abi</em> calculation, which will only take about a minute with our simplifications.</p>
<p>Now edit <em>telast_5.abo</em>, looking for the piezoelectric tensor,</p>
<div class="codehilite"><pre><span></span><code>  Rigid-atom proper piezoelectric tensor, in cartesian coordinates,
  (from strain response)
     j1       j2             matrix element
  dir pert dir pert     real part    imaginary part

   3    6   3    7        -0.0122230317         0.0000000000
</code></pre></div>

<div class="text-center"><button id="uuid-7b8feb7c-7cba-4ee3-99f4-ad6e4975f8fe" class="md-button md-button--secondary"> View tests/tutorespfn/Refs/telast_5.abo </button></div>
<div id="uuid-a3d040a5-0142-4fbf-a0b0-86c1039552de" class="my_dialog" title="tests/tutorespfn/Refs/telast_5.abo" hidden><div><pre class="small-text">

.Version 10.1.4.5 of ABINIT, released Sep 2024.
.(MPI version, prepared for a x86_64_linux_gnu13.2 computer)

.Copyright (C) 1998-2025 ABINIT group .
 ABINIT comes with ABSOLUTELY NO WARRANTY.
 It is free software, and you are welcome to redistribute it
 under certain conditions (GNU General Public License,
 see ~abinit/COPYING or http://www.gnu.org/copyleft/gpl.txt).

 ABINIT is a project of the Universite Catholique de Louvain,
 Corning Inc. and other collaborators, see ~abinit/doc/developers/contributors.txt .
 Please read https://docs.abinit.org/theory/acknowledgments for suggested
 acknowledgments of the ABINIT effort.
 For more information, see https://www.abinit.org .

.Starting date : Fri 13 Sep 2024.
- ( at 19h03 )

- input  file    -&gt; /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/trunk_merge-10.0/tests/TestBot_MPI1/tutorespfn_telast_5/telast_5.abi
- output file    -&gt; telast_5.abo
- root for input  files -&gt; telast_5i
- root for output files -&gt; telast_5o

 DATASET    1 : space group P6_3 m c (#186); Bravais hP (primitive hexag.)
================================================================================
 Values of the parameters that define the memory need for DATASET  1.
     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       6
     lnmax =       6     mgfft =      30  mpssoang =       3    mqgrid =    3001
     natom =       4  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      12    n1xccc =    2501    ntypat =       2
    occopt =       1   xclevel =       1
-    mband =           8        mffmem =           1         mkmem =           8
       mpw =         386          nfft =        7680          nkpt =           8
================================================================================
P This job should need less than                       4.092 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      0.379 Mbytes ; DEN or POT disk file :      0.061 Mbytes.
================================================================================

 DATASET    2 : space group P6_3 m c (#186); Bravais hP (primitive hexag.)
================================================================================
 Values of the parameters that define the memory need for DATASET  2.
     intxc =       0    ionmov =       0      iscf =      -2    lmnmax =       6
     lnmax =       6     mgfft =      30  mpssoang =       3    mqgrid =    3001
     natom =       4  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      12    n1xccc =    2501    ntypat =       2
    occopt =       1   xclevel =       1
-    mband =           8        mffmem =           1         mkmem =          64
       mpw =         386          nfft =        7680          nkpt =          64
================================================================================
P This job should need less than                       6.130 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      3.018 Mbytes ; DEN or POT disk file :      0.061 Mbytes.
================================================================================

 DATASET    3 : space group P6_3 m c (#186); Bravais hP (primitive hexag.)
================================================================================
 Values of the parameters that define the memory need for DATASET  3 (RF).
     intxc =       0      iscf =       7    lmnmax =       6     lnmax =       6
     mgfft =      30  mpssoang =       3    mqgrid =    3001     natom =       4
  nloc_mem =       1    nspden =       1   nspinor =       1    nsppol =       1
      nsym =      12    n1xccc =    2501    ntypat =       2    occopt =       1
   xclevel =       1
-    mband =           8        mffmem =           1         mkmem =          32
-   mkqmem =          32        mk1mem =          32           mpw =         386
      nfft =        7680          nkpt =          32
================================================================================
P This job should need less than                       7.845 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      1.510 Mbytes ; DEN or POT disk file :      0.061 Mbytes.
================================================================================

--------------------------------------------------------------------------------
------------- Echo of variables that govern the present computation ------------
--------------------------------------------------------------------------------
-
- outvars: echo of selected default values
-   iomode0 =  0 , fftalg0 =512 , wfoptalg0 =  0
-
- outvars: echo of global parameters not present in the input file
-  max_nthreads =    0
-
 -outvars: echo values of preprocessed input variables --------
            acell      7.2488954246E+00  7.2488954246E+00  1.1879499870E+01 Bohr
              amu      2.69815390E+01  3.09737620E+01
         berryopt1          0
         berryopt2         -2
         berryopt3          0
           diemac      9.00000000E+00
             ecut      6.00000000E+00 Hartree
           ecutsm      5.00000000E-01 Hartree
-          fftalg         512
           getddk1          0
           getddk2          0
           getddk3         -1
           getden1          0
           getden2         -1
           getden3          0
           getwfk1          0
           getwfk2         -1
           getwfk3         -1
             iscf1          7
             iscf2         -2
             iscf3          7
              ixc       -1012
           jdtset        1    2    3
              kpt1     0.00000000E+00  0.00000000E+00  1.25000000E-01
                       2.50000000E-01  0.00000000E+00  1.25000000E-01
                       5.00000000E-01  0.00000000E+00  1.25000000E-01
                       2.50000000E-01  2.50000000E-01  1.25000000E-01
                       0.00000000E+00  0.00000000E+00  3.75000000E-01
                       2.50000000E-01  0.00000000E+00  3.75000000E-01
                       5.00000000E-01  0.00000000E+00  3.75000000E-01
                       2.50000000E-01  2.50000000E-01  3.75000000E-01
              kpt2     0.00000000E+00  0.00000000E+00  1.25000000E-01
                       2.50000000E-01  0.00000000E+00  1.25000000E-01
                       5.00000000E-01  0.00000000E+00  1.25000000E-01
                      -2.50000000E-01  0.00000000E+00  1.25000000E-01
                       0.00000000E+00  2.50000000E-01  1.25000000E-01
                       2.50000000E-01  2.50000000E-01  1.25000000E-01
                       5.00000000E-01  2.50000000E-01  1.25000000E-01
                      -2.50000000E-01  2.50000000E-01  1.25000000E-01
                       0.00000000E+00  5.00000000E-01  1.25000000E-01
                       2.50000000E-01  5.00000000E-01  1.25000000E-01
                       5.00000000E-01  5.00000000E-01  1.25000000E-01
                      -2.50000000E-01  5.00000000E-01  1.25000000E-01
                       0.00000000E+00 -2.50000000E-01  1.25000000E-01
                       2.50000000E-01 -2.50000000E-01  1.25000000E-01
                       5.00000000E-01 -2.50000000E-01  1.25000000E-01
                      -2.50000000E-01 -2.50000000E-01  1.25000000E-01
                       0.00000000E+00  0.00000000E+00  3.75000000E-01
                       2.50000000E-01  0.00000000E+00  3.75000000E-01
                       5.00000000E-01  0.00000000E+00  3.75000000E-01
                      -2.50000000E-01  0.00000000E+00  3.75000000E-01
                       0.00000000E+00  2.50000000E-01  3.75000000E-01
                       2.50000000E-01  2.50000000E-01  3.75000000E-01
                       5.00000000E-01  2.50000000E-01  3.75000000E-01
                      -2.50000000E-01  2.50000000E-01  3.75000000E-01
                       0.00000000E+00  5.00000000E-01  3.75000000E-01
                       2.50000000E-01  5.00000000E-01  3.75000000E-01
                       5.00000000E-01  5.00000000E-01  3.75000000E-01
                      -2.50000000E-01  5.00000000E-01  3.75000000E-01
                       0.00000000E+00 -2.50000000E-01  3.75000000E-01
                       2.50000000E-01 -2.50000000E-01  3.75000000E-01
                       5.00000000E-01 -2.50000000E-01  3.75000000E-01
                      -2.50000000E-01 -2.50000000E-01  3.75000000E-01
                       0.00000000E+00  0.00000000E+00 -3.75000000E-01
                       2.50000000E-01  0.00000000E+00 -3.75000000E-01
                       5.00000000E-01  0.00000000E+00 -3.75000000E-01
                      -2.50000000E-01  0.00000000E+00 -3.75000000E-01
                       0.00000000E+00  2.50000000E-01 -3.75000000E-01
                       2.50000000E-01  2.50000000E-01 -3.75000000E-01
                       5.00000000E-01  2.50000000E-01 -3.75000000E-01
                      -2.50000000E-01  2.50000000E-01 -3.75000000E-01
                       0.00000000E+00  5.00000000E-01 -3.75000000E-01
                       2.50000000E-01  5.00000000E-01 -3.75000000E-01
                       5.00000000E-01  5.00000000E-01 -3.75000000E-01
                      -2.50000000E-01  5.00000000E-01 -3.75000000E-01
                       0.00000000E+00 -2.50000000E-01 -3.75000000E-01
                       2.50000000E-01 -2.50000000E-01 -3.75000000E-01
                       5.00000000E-01 -2.50000000E-01 -3.75000000E-01
                      -2.50000000E-01 -2.50000000E-01 -3.75000000E-01
                       0.00000000E+00  0.00000000E+00 -1.25000000E-01
                       2.50000000E-01  0.00000000E+00 -1.25000000E-01
              kpt3     0.00000000E+00  0.00000000E+00  1.25000000E-01
                       2.50000000E-01  0.00000000E+00  1.25000000E-01
                       5.00000000E-01  0.00000000E+00  1.25000000E-01
                      -2.50000000E-01  0.00000000E+00  1.25000000E-01
                       0.00000000E+00  2.50000000E-01  1.25000000E-01
                       2.50000000E-01  2.50000000E-01  1.25000000E-01
                       5.00000000E-01  2.50000000E-01  1.25000000E-01
                      -2.50000000E-01  2.50000000E-01  1.25000000E-01
                       0.00000000E+00  5.00000000E-01  1.25000000E-01
                       2.50000000E-01  5.00000000E-01  1.25000000E-01
                       5.00000000E-01  5.00000000E-01  1.25000000E-01
                      -2.50000000E-01  5.00000000E-01  1.25000000E-01
                       0.00000000E+00 -2.50000000E-01  1.25000000E-01
                       2.50000000E-01 -2.50000000E-01  1.25000000E-01
                       5.00000000E-01 -2.50000000E-01  1.25000000E-01
                      -2.50000000E-01 -2.50000000E-01  1.25000000E-01
                       0.00000000E+00  0.00000000E+00  3.75000000E-01
                       2.50000000E-01  0.00000000E+00  3.75000000E-01
                       5.00000000E-01  0.00000000E+00  3.75000000E-01
                      -2.50000000E-01  0.00000000E+00  3.75000000E-01
                       0.00000000E+00  2.50000000E-01  3.75000000E-01
                       2.50000000E-01  2.50000000E-01  3.75000000E-01
                       5.00000000E-01  2.50000000E-01  3.75000000E-01
                      -2.50000000E-01  2.50000000E-01  3.75000000E-01
                       0.00000000E+00  5.00000000E-01  3.75000000E-01
                       2.50000000E-01  5.00000000E-01  3.75000000E-01
                       5.00000000E-01  5.00000000E-01  3.75000000E-01
                      -2.50000000E-01  5.00000000E-01  3.75000000E-01
                       0.00000000E+00 -2.50000000E-01  3.75000000E-01
                       2.50000000E-01 -2.50000000E-01  3.75000000E-01
                       5.00000000E-01 -2.50000000E-01  3.75000000E-01
                      -2.50000000E-01 -2.50000000E-01  3.75000000E-01
                       outvar_i_n : Printing only first  50 k-points.
           kptopt1          1
           kptopt2          3
           kptopt3          2
         kptrlatt        4    0    0      0    4    0      0    0    4
          kptrlen      2.89955817E+01
P           mkmem1          8
P           mkmem2         64
P           mkmem3         32
P          mkqmem1          8
P          mkqmem2         64
P          mkqmem3         32
P          mk1mem1          8
P          mk1mem2         64
P          mk1mem3         32
            natom           4
            nband1          8
            nband2          8
            nband3          8
           nbdbuf1          0
           nbdbuf2          2
           nbdbuf3          0
           ndtset           3
            ngfft          16      16      30
             nkpt1          8
             nkpt2         64
             nkpt3         32
             nqpt1          0
             nqpt2          0
             nqpt3          1
            nstep          40
             nsym          12
           ntypat           2
              occ1     2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000
              occ3     2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000
        optdriver1          0
        optdriver2          0
        optdriver3          1
        optforces           1
           prtpot1          0
           prtpot2          0
           prtpot3          1
            rfdir1          1       1       1
            rfdir2          0       0       1
            rfdir3          0       0       1
           rfstrs1          0
           rfstrs2          0
           rfstrs3          1
            rprim      8.6602540378E-01  5.0000000000E-01  0.0000000000E+00
                      -8.6602540378E-01  5.0000000000E-01  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  1.0000000000E+00
           shiftk      0.00000000E+00  0.00000000E+00  5.00000000E-01
          spgroup         186
           symrel      1  0  0   0  1  0   0  0  1       0  1  0   1  0  0   0  0  1
                       1  1  0  -1  0  0   0  0  1      -1  0  0   1  1  0   0  0  1
                       0  1  0  -1 -1  0   0  0  1      -1 -1  0   0  1  0   0  0  1
                      -1  0  0   0 -1  0   0  0  1       0 -1  0  -1  0  0   0  0  1
                      -1 -1  0   1  0  0   0  0  1       1  0  0  -1 -1  0   0  0  1
                       0 -1  0   1  1  0   0  0  1       1  1  0   0 -1  0   0  0  1
            tnons      0.0000000  0.0000000  0.0000000     0.0000000  0.0000000  0.5000000
                      -0.0000000  0.0000000  0.5000000    -0.0000000  0.0000000  0.0000000
                      -0.0000000 -0.0000000  0.0000000    -0.0000000 -0.0000000  0.5000000
                      -0.0000000 -0.0000000  0.5000000    -0.0000000 -0.0000000  0.0000000
                      -0.0000000 -0.0000000  0.0000000    -0.0000000 -0.0000000  0.5000000
                       0.0000000 -0.0000000  0.5000000     0.0000000 -0.0000000  0.0000000
           tolvrs1     1.00000000E-18
           tolvrs2     0.00000000E+00
           tolvrs3     1.00000000E-10
           tolwfr1     0.00000000E+00
           tolwfr2     1.00000000E-20
           tolwfr3     0.00000000E+00
            typat      1  1  2  2
              wtk1       0.03125    0.18750    0.09375    0.18750    0.03125    0.18750
                         0.09375    0.18750
              wtk2       0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563
              wtk3       0.03125    0.03125    0.03125    0.03125    0.03125    0.03125
                         0.03125    0.03125    0.03125    0.03125    0.03125    0.03125
                         0.03125    0.03125    0.03125    0.03125    0.03125    0.03125
                         0.03125    0.03125    0.03125    0.03125    0.03125    0.03125
                         0.03125    0.03125    0.03125    0.03125    0.03125    0.03125
                         0.03125    0.03125
                       outvars : Printing only first  50 k-points.
           xangst     -1.1073434536E+00  1.9179751231E+00  0.0000000000E+00
                       1.1073434536E+00  1.9179751231E+00  3.1431802903E+00
                      -1.1073434536E+00  1.9179751231E+00  2.3584819873E+00
                       1.1073434536E+00  1.9179751231E+00  5.5016622776E+00
            xcart     -2.0925758624E+00  3.6244477123E+00  0.0000000000E+00
                       2.0925758624E+00  3.6244477123E+00  5.9397499350E+00
                      -2.0925758624E+00  3.6244477123E+00  4.4568850454E+00
                       2.0925758624E+00  3.6244477123E+00  1.0396634980E+01
             xred      3.3333333333E-01  6.6666666667E-01  0.0000000000E+00
                       6.6666666667E-01  3.3333333333E-01  5.0000000000E-01
                       3.3333333333E-01  6.6666666667E-01  3.7517446813E-01
                       6.6666666667E-01  3.3333333333E-01  8.7517446813E-01
            znucl       13.00000   15.00000

================================================================================

 chkinp: Checking input parameters for consistency, jdtset=   1.

 chkinp: Checking input parameters for consistency, jdtset=   2.

 chkinp: Checking input parameters for consistency, jdtset=   3.

================================================================================
== DATASET  1 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 1, }
dimensions: {natom: 4, nkpt: 8, mband: 8, nsppol: 1, nspinor: 1, nspden: 1, mpw: 386, }
cutoff_energies: {ecut:   6.0, pawecutdg:  -1.0, }
electrons: {nelect:   1.60000000E+01, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 0, ionmov: 0, optcell: 0, iscf: 7, paral_kgb: 0, }
...

 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  6.2777276  3.6244477  0.0000000  G(1)=  0.0796467  0.1379521  0.0000000
 R(2)= -6.2777276  3.6244477  0.0000000  G(2)= -0.0796467  0.1379521  0.0000000
 R(3)=  0.0000000  0.0000000 11.8794999  G(3)=  0.0000000  0.0000000  0.0841786
 Unit cell volume ucvol=  5.4059554E+02 bohr^3
 Angles (23,13,12)=  9.00000000E+01  9.00000000E+01  1.20000000E+02 degrees

 getcut: wavevector=  0.0000  0.0000  0.0000  ngfft=  16  16  30
         ecut(hartree)=      6.000   =&gt; boxcut(ratio)=   2.00174

--- Pseudopotential description ------------------------------------------------
- pspini: atom type   1  psp file is /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/trunk_merge-10.0/tests/Pspdir/Psdj_nc_sr_04_pw_std_psp8/Al.psp8
- pspatm: opening atomic psp file    /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/trunk_merge-10.0/tests/Pspdir/Psdj_nc_sr_04_pw_std_psp8/Al.psp8
- Al    ONCVPSP-3.3.0  r_core=   1.76802   1.76802   1.70587
- 13.00000   3.00000    171102                znucl, zion, pspdat
    8   -1012    2    4       600   0.00000   pspcod,pspxc,lmax,lloc,mmax,r2well
    5.99000000000000    5.00000000000000    0.00000000000000   rchrg,fchrg,qchrg
     nproj     2     2     2
     extension_switch     1
  pspatm : epsatm=    0.57439192
         --- l  ekb(1:nproj) --&gt;
             0    5.725870    0.726131
             1    6.190420    0.914022
             2   -4.229503   -0.925599
 pspatm: atomic psp has been read  and splines computed

- pspini: atom type   2  psp file is /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/trunk_merge-10.0/tests/Pspdir/Psdj_nc_sr_04_pw_std_psp8/P.psp8
- pspatm: opening atomic psp file    /home/buildbot/ABINIT3/eos_gnu_13.2_mpich/trunk_merge-10.0/tests/Pspdir/Psdj_nc_sr_04_pw_std_psp8/P.psp8
- P     ONCVPSP-3.3.0  r_core=   1.46089   1.55067   1.70594
- 15.00000   5.00000    171102                znucl, zion, pspdat
    8   -1012    2    4       600   0.00000   pspcod,pspxc,lmax,lloc,mmax,r2well
    5.99000000000000    5.00000000000000    0.00000000000000   rchrg,fchrg,qchrg
     nproj     2     2     2
     extension_switch     1
  pspatm : epsatm=    7.03163490
         --- l  ekb(1:nproj) --&gt;
             0    6.795192    1.078292
             1    3.452929    0.907117
             2   -3.024864   -0.802189
 pspatm: atomic psp has been read  and splines computed

   2.43392858E+02                                ecore*ucvol(ha*bohr**3)
--------------------------------------------------------------------------------

_setup2: Arith. and geom. avg. npw (full set) are     378.625     378.563

================================================================================

--- !BeginCycle
iteration_state: {dtset: 1, }
solver: {iscf: 7, nstep: 40, nline: 4, wfoptalg: 0, }
tolerances: {tolvrs: 1.00E-18, }
...

     iter   Etot(hartree)      deltaE(h)  residm     vres2    diffor    maxfor
 ETOT  1  -18.599703283671    -1.860E+01 1.931E-02 8.151E+00 7.427E-04 7.427E-04
 ETOT  2  -18.624626114969    -2.492E-02 1.886E-05 5.299E-01 1.010E-03 2.676E-04
 ETOT  3  -18.625858656082    -1.233E-03 5.527E-06 1.006E-02 2.120E-04 5.558E-05
 ETOT  4  -18.625871345454    -1.269E-05 4.449E-08 1.849E-04 6.553E-05 9.950E-06
 ETOT  5  -18.625871468687    -1.232E-07 1.414E-09 2.559E-06 1.659E-05 6.641E-06
 ETOT  6  -18.625871471468    -2.780E-09 5.884E-11 7.997E-08 9.154E-06 2.513E-06
 ETOT  7  -18.625871471614    -1.468E-10 3.224E-12 1.521E-09 2.170E-06 3.428E-07
 ETOT  8  -18.625871471616    -1.862E-12 6.518E-14 2.159E-11 7.564E-08 4.184E-07
 ETOT  9  -18.625871471616    -1.030E-13 1.363E-15 1.501E-13 1.013E-08 4.083E-07
 ETOT 10  -18.625871471617    -1.492E-13 5.549E-17 3.933E-15 1.037E-09 4.093E-07
 ETOT 11  -18.625871471617     1.776E-14 1.533E-18 1.593E-16 6.282E-10 4.087E-07
 ETOT 12  -18.625871471616     6.750E-14 6.635E-20 1.983E-18 5.659E-11 4.088E-07
 ETOT 13  -18.625871471616     4.263E-14 1.929E-21 6.699E-21 2.404E-12 4.088E-07

 At SCF step   13       vres2   =  6.70E-21 &lt; tolvrs=  1.00E-18 =&gt;converged.

 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)=  7.06357945E-08  sigma(3 2)=  0.00000000E+00
  sigma(2 2)=  7.06357945E-08  sigma(3 1)=  0.00000000E+00
  sigma(3 3)= -2.80154672E-09  sigma(2 1)=  0.00000000E+00


--- !ResultsGS
iteration_state: {dtset: 1, }
comment   : Summary of ground state results
lattice_vectors:
- [  6.2777276,   3.6244477,   0.0000000, ]
- [ -6.2777276,   3.6244477,   0.0000000, ]
- [  0.0000000,   0.0000000,  11.8794999, ]
lattice_lengths: [   7.24890,    7.24890,   11.87950, ]
lattice_angles: [ 90.000,  90.000, 120.000, ] # degrees, (23, 13, 12)
lattice_volume:   5.4059554E+02
convergence: {deltae:  4.263E-14, res2:  6.699E-21, residm:  1.929E-21, diffor:  2.404E-12, }
etotal    :  -1.86258715E+01
entropy   :   0.00000000E+00
fermie    :   1.56540507E-01
cartesian_stress_tensor: # hartree/bohr^3
- [  7.06357945E-08,   0.00000000E+00,   0.00000000E+00, ]
- [  0.00000000E+00,   7.06357945E-08,   0.00000000E+00, ]
- [  0.00000000E+00,   0.00000000E+00,  -2.80154672E-09, ]
pressure_GPa:  -1.3580E-03
xred      :
- [  3.3333E-01,   6.6667E-01,   0.0000E+00, Al]
- [  6.6667E-01,   3.3333E-01,   5.0000E-01, Al]
- [  3.3333E-01,   6.6667E-01,   3.7517E-01,  P]
- [  6.6667E-01,   3.3333E-01,   8.7517E-01,  P]
cartesian_forces: # hartree/bohr
- [ -0.00000000E+00,  -0.00000000E+00,  -4.08750973E-07, ]
- [ -0.00000000E+00,  -0.00000000E+00,  -4.08750973E-07, ]
- [ -0.00000000E+00,  -0.00000000E+00,   4.08750973E-07, ]
- [ -0.00000000E+00,  -0.00000000E+00,   4.08750973E-07, ]
force_length_stats: {min:   4.08750973E-07, max:   4.08750973E-07, mean:   4.08750973E-07, }
...

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.95513472
    2        2.00000          0.95513472
    3        2.00000          2.81414310
    4        2.00000          2.81414310
================================================================================

 ----iterations are completed or convergence reached----

 Mean square residual over all n,k,spin=   71.434E-24; max=  19.290E-22
 reduced coordinates (array xred) for    4 atoms
       0.333333333333      0.666666666667      0.000000000000
       0.666666666667      0.333333333333      0.500000000000
       0.333333333333      0.666666666667      0.375174468130
       0.666666666667      0.333333333333      0.875174468130
 rms dE/dt=  6.1705E-05; max dE/dt=  1.1162E-04; dE/dt below (all hartree)
    1       0.000000000000      0.000000000000      0.000111622038
    2       0.000000000000      0.000000000000      0.000111622038
    3       0.000000000000      0.000000000000      0.000101910524
    4       0.000000000000      0.000000000000      0.000101910524

 cartesian coordinates (angstrom) at end:
    1     -1.10734345360655     1.91797512307532     0.00000000000000
    2      1.10734345360654     1.91797512307532     3.14318029032593
    3     -1.10734345360655     1.91797512307532     2.35848198731946
    4      1.10734345360654     1.91797512307532     5.50166227764540

 cartesian forces (hartree/bohr) at end:
    1     -0.00000000000000    -0.00000000000000    -0.00000040875097
    2     -0.00000000000000    -0.00000000000000    -0.00000040875097
    3     -0.00000000000000    -0.00000000000000     0.00000040875097
    4     -0.00000000000000    -0.00000000000000     0.00000040875097
 frms,max,avg= 2.3599248E-07 4.0875097E-07   0.000E+00  0.000E+00 -8.987E-06 h/b

 cartesian forces (eV/Angstrom) at end:
    1     -0.00000000000000    -0.00000000000000    -0.00002101881834
    2     -0.00000000000000    -0.00000000000000    -0.00002101881834
    3     -0.00000000000000    -0.00000000000000     0.00002101881834
    4     -0.00000000000000    -0.00000000000000     0.00002101881834
 frms,max,avg= 1.2135220E-05 2.1018818E-05   0.000E+00  0.000E+00 -4.622E-04 e/A
 length scales=  7.248895424600  7.248895424600 11.879499870000 bohr
              =  3.835950246151  3.835950246151  6.286360580652 angstroms
 prteigrs : about to open file telast_5o_DS1_EIG
 Fermi (or HOMO) energy (hartree) =   0.15654   Average Vxc (hartree)=  -0.34190
 Eigenvalues (hartree) for nkpt=   8  k points:
 kpt#   1, nband=  8, wtk=  0.03125, kpt=  0.0000  0.0000  0.1250 (reduced coord)
  -0.25845   -0.19638   -0.04431    0.12449    0.12449    0.14168    0.15654    0.15654
 prteigrs : prtvol=0 or 1, do not print more k-points.


--- !EnergyTerms
iteration_state     : {dtset: 1, }
comment             : Components of total free energy in Hartree
kinetic             :  6.75559198165142E+00
hartree             :  1.80771129433037E+00
xc                  : -6.35342254497904E+00
Ewald energy        : -1.75094233806015E+01
psp_core            :  4.50230977840009E-01
local_psp           : -6.81178748351025E+00
non_local_psp       :  3.03522768365258E+00
total_energy        : -1.86258714716164E+01
total_energy_eV     : -5.06835738341178E+02
band_energy         : -9.08005745450557E-02
...


 Cartesian components of stress tensor (hartree/bohr^3)
  sigma(1 1)=  7.06357945E-08  sigma(3 2)=  0.00000000E+00
  sigma(2 2)=  7.06357945E-08  sigma(3 1)=  0.00000000E+00
  sigma(3 3)= -2.80154672E-09  sigma(2 1)=  0.00000000E+00

-Cartesian components of stress tensor (GPa)         [Pressure= -1.3580E-03 GPa]
- sigma(1 1)=  2.07817647E-03  sigma(3 2)=  0.00000000E+00
- sigma(2 2)=  2.07817647E-03  sigma(3 1)=  0.00000000E+00
- sigma(3 3)= -8.24243362E-05  sigma(2 1)=  0.00000000E+00

================================================================================
== DATASET  2 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 2, }
dimensions: {natom: 4, nkpt: 64, mband: 8, nsppol: 1, nspinor: 1, nspden: 1, mpw: 386, }
cutoff_energies: {ecut:   6.0, pawecutdg:  -1.0, }
electrons: {nelect:   1.60000000E+01, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 0, ionmov: 0, optcell: 0, iscf: -2, paral_kgb: 0, }
...

 mkfilename : getwfk/=0, take file _WFK from output of DATASET   1.

 mkfilename : getden/=0, take file _DEN from output of DATASET   1.

 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  6.2777276  3.6244477  0.0000000  G(1)=  0.0796467  0.1379521  0.0000000
 R(2)= -6.2777276  3.6244477  0.0000000  G(2)= -0.0796467  0.1379521  0.0000000
 R(3)=  0.0000000  0.0000000 11.8794999  G(3)=  0.0000000  0.0000000  0.0841786
 Unit cell volume ucvol=  5.4059554E+02 bohr^3
 Angles (23,13,12)=  9.00000000E+01  9.00000000E+01  1.20000000E+02 degrees

 getcut: wavevector=  0.0000  0.0000  0.0000  ngfft=  16  16  30
         ecut(hartree)=      6.000   =&gt; boxcut(ratio)=   2.00174
--------------------------------------------------------------------------------

-inwffil : will read wavefunctions from disk file telast_5o_DS1_WFK
  initberry: for direction 1, nkstr =   0, nstr =      0
  initberry: for direction 2, nkstr =   0, nstr =      0
  initberry: for direction 3, nkstr =   4, nstr =     16

================================================================================
 prteigrs : about to open file telast_5o_DS2_EIG
 Non-SCF case, kpt    1 (  0.00000  0.00000  0.12500), residuals and eigenvalues=
  9.03E-25  6.68E-25  1.37E-24  7.01E-24  9.55E-24  8.97E-23  1.30E-21  1.47E-21
 -2.5845E-01 -1.9638E-01 -4.4309E-02  1.2449E-01  1.2449E-01  1.4168E-01
  1.5654E-01  1.5654E-01
 prteigrs : prtvol=0 or 1, do not print more k-points.



 Computing the polarization (Berry phase) for reciprocal vector:
  0.00000  0.00000  0.25000 (in reduced coordinates)
  0.00000  0.00000  0.02104 (in cartesian coordinates - atomic units)
 Number of strings:    16
 Number of k points in string:    4

 Computing the ddk (Berry phase) for reciprocal vector:
  0.00000  0.00000  0.25000 (in reduced coordinates)
  0.00000  0.00000  0.02104 (in cartesian coordinates - atomic units)
 Mean square residual over all n,k,spin=   00.000E+00; max=  00.000E+00

--- !ResultsGS
iteration_state: {dtset: 2, }
comment   : Summary of ground state results
lattice_vectors:
- [  6.2777276,   3.6244477,   0.0000000, ]
- [ -6.2777276,   3.6244477,   0.0000000, ]
- [  0.0000000,   0.0000000,  11.8794999, ]
lattice_lengths: [   7.24890,    7.24890,   11.87950, ]
lattice_angles: [ 90.000,  90.000, 120.000, ] # degrees, (23, 13, 12)
lattice_volume:   5.4059554E+02
convergence: {deltae:  0.000E+00, res2:  0.000E+00, residm:  9.664E-21, diffor:  0.000E+00, }
etotal    :  -1.86258715E+01
entropy   :   0.00000000E+00
fermie    :   1.56540507E-01
cartesian_stress_tensor: null
pressure_GPa: null
xred      :
- [  3.3333E-01,   6.6667E-01,   0.0000E+00, Al]
- [  6.6667E-01,   3.3333E-01,   5.0000E-01, Al]
- [  3.3333E-01,   6.6667E-01,   3.7517E-01,  P]
- [  6.6667E-01,   3.3333E-01,   8.7517E-01,  P]
cartesian_forces: null
force_length_stats: {min: null, max: null, mean: null, }
...

 Integrated electronic density in atomic spheres:
 ------------------------------------------------
 Atom  Sphere_radius  Integrated_density
    1        2.00000          0.95513472
    2        2.00000          0.95513472
    3        2.00000          2.81414310
    4        2.00000          2.81414310
================================================================================

 ----iterations are completed or convergence reached----

 Mean square residual over all n,k,spin=   11.160E-22; max=  96.641E-22
 reduced coordinates (array xred) for    4 atoms
       0.333333333333      0.666666666667      0.000000000000
       0.666666666667      0.333333333333      0.500000000000
       0.333333333333      0.666666666667      0.375174468130
       0.666666666667      0.333333333333      0.875174468130

 cartesian coordinates (angstrom) at end:
    1     -1.10734345360655     1.91797512307532     0.00000000000000
    2      1.10734345360654     1.91797512307532     3.14318029032593
    3     -1.10734345360655     1.91797512307532     2.35848198731946
    4      1.10734345360654     1.91797512307532     5.50166227764540
 length scales=  7.248895424600  7.248895424600 11.879499870000 bohr
              =  3.835950246151  3.835950246151  6.286360580652 angstroms
 prteigrs : about to open file telast_5o_DS2_EIG
 Eigenvalues (hartree) for nkpt=  64  k points:
 kpt#   1, nband=  8, wtk=  0.01563, kpt=  0.0000  0.0000  0.1250 (reduced coord)
  -0.25845   -0.19638   -0.04431    0.12449    0.12449    0.14168    0.15654    0.15654
 prteigrs : prtvol=0 or 1, do not print more k-points.


================================================================================
== DATASET  3 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 3, }
dimensions: {natom: 4, nkpt: 32, mband: 8, nsppol: 1, nspinor: 1, nspden: 1, mpw: 386, }
cutoff_energies: {ecut:   6.0, pawecutdg:  -1.0, }
electrons: {nelect:   1.60000000E+01, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 1, rfstrs: 1, }
...

 mkfilename : getwfk/=0, take file _WFK from output of DATASET   2.

 mkfilename : getddk/=0, take file _1WF from output of DATASET   2.

 Real(R)+Recip(G) space primitive vectors, cartesian coordinates (Bohr,Bohr^-1):
 R(1)=  6.2777276  3.6244477  0.0000000  G(1)=  0.0796467  0.1379521  0.0000000
 R(2)= -6.2777276  3.6244477  0.0000000  G(2)= -0.0796467  0.1379521  0.0000000
 R(3)=  0.0000000  0.0000000 11.8794999  G(3)=  0.0000000  0.0000000  0.0841786
 Unit cell volume ucvol=  5.4059554E+02 bohr^3
 Angles (23,13,12)=  9.00000000E+01  9.00000000E+01  1.20000000E+02 degrees
 setup1 : take into account q-point for computing boxcut.

 getcut: wavevector=  0.0000  0.0000  0.0000  ngfft=  16  16  30
         ecut(hartree)=      6.000   =&gt; boxcut(ratio)=   2.00174
--------------------------------------------------------------------------------

 symkchk : k-point set has full space-group symmetry.

 ==&gt;  initialize data related to q vector &lt;==

 The list of irreducible perturbations for this q vector is:
    1)    idir= 3    ipert=   7

================================================================================

--------------------------------------------------------------------------------
 Perturbation wavevector (in red.coord.)   0.000000  0.000000  0.000000
 Found    12 symmetries that leave the perturbation invariant.
 symkpt : the number of k-points, thanks to the symmetries,
 is reduced to     8 .

--------------------------------------------------------------------------------

--------------------------------------------------------------------------------

 Initialisation of the first-order wave-functions :
  ireadwf=   0

--- !BeginCycle
iteration_state: {dtset: 3, }
solver: {iscf: 7, nstep: 40, nline: 4, wfoptalg: 0, }
tolerances: {tolvrs: 1.00E-10, }
...

     iter   2DEtotal(Ha)        deltaE(Ha) residm    vres2
-ETOT  1   7.7114570007514     -3.779E+01 7.503E+00 8.751E+02
 ETOT  2   4.7110743290064     -3.000E+00 1.847E-03 4.284E+01
 ETOT  3   4.5437619993997     -1.673E-01 1.544E-04 1.768E+00
 ETOT  4   4.5378643119126     -5.898E-03 5.252E-06 4.073E-02
 ETOT  5   4.5377668150558     -9.750E-05 9.168E-08 1.082E-03
 ETOT  6   4.5377633421921     -3.473E-06 4.906E-09 9.544E-06
 ETOT  7   4.5377633254610     -1.673E-08 1.066E-10 1.521E-07
 ETOT  8   4.5377633249868     -4.741E-10 1.427E-12 7.197E-09
 ETOT  9   4.5377633249566     -3.019E-11 5.963E-14 2.328E-10
 ETOT 10   4.5377633249557     -8.811E-13 9.358E-16 2.685E-12

 At SCF step   10       vres2   =  2.68E-12 &lt; tolvrs=  1.00E-10 =&gt;converged.
-open ddk wf file :telast_5o_DS2_1WF15
================================================================================

 ----iterations are completed or convergence reached----

 Mean square residual over all n,k,spin=   11.045E-17; max=  93.582E-17

 Seventeen components of 2nd-order total energy (hartree) are
 1,2,3: 0th-order hamiltonian combined with 1st-order wavefunctions
     kin0=   4.32908448E+01 eigvalue=  -2.86767713E-01  local=  -8.43532545E+00
 4,5,6,7: 1st-order hamiltonian combined with 1st and 0th-order wfs
 loc psp =  -1.40964435E+01  Hartree=   8.64545331E+00     xc=  -1.76738790E+00
     kin1=  -6.45352621E+01
 8,9,10: eventually, occupation + non-local contributions
    edocc=   0.00000000E+00     enl0=   2.98679954E+00   enl1=  -6.76997599E+00
 1-10 gives the relaxation energy (to be shifted if some occ is /=2.0)
   erelax=  -4.09680650E+01
 11,12,13 Non-relaxation  contributions : frozen-wavefunctions and Ewald
  fr.hart=   7.08474536E-01   fr.kin=   3.56458682E+01 fr.loc=  -3.54915699E+00
 14,15,16 Non-relaxation  contributions : frozen-wavefunctions and Ewald
  fr.nonl=   5.39940081E+00    fr.xc=  -6.93914072E-01  Ewald=   7.54492483E+00
 17 Non-relaxation  contributions : pseudopotential core energy
  pspcore=   4.50230978E-01
 Resulting in :
 2DEtotal=    0.4537763325E+01 Ha. Also 2DEtotal=    0.123478819701E+03 eV
    (2DErelax=   -4.0968065021E+01 Ha. 2DEnonrelax=    4.5505828346E+01 Ha)
    (  non-var. 2DEtotal :    4.5377632810E+00 Ha)

================================================================================

 ---- first-order wavefunction calculations are completed ----


 ==&gt; Compute Derivative Database &lt;==

  2nd-order matrix (non-cartesian coordinates, masses not included,
   asr not included )
  cartesian coordinates for strain terms (1/ucvol factor
   for elastic tensor components not included)
     j1       j2             matrix element
  dir pert dir pert     real part     imaginary part

   1    1   3    1         0.0000000000         0.0000000000
   1    1   3    2         0.0000000000         0.0000000000
   1    1   3    3         0.0000000000         0.0000000000
   1    1   3    4         0.0000000000         0.0000000000
   1    1   2    6         0.0000000000         0.0000000000
   1    1   3    6         0.0000000000         0.0000000000
   1    1   3    7        -0.0000000000         0.0000000000

   2    1   3    1         0.0000000000         0.0000000000
   2    1   3    2         0.0000000000         0.0000000000
   2    1   3    3         0.0000000000         0.0000000000
   2    1   3    4         0.0000000000         0.0000000000
   2    1   1    6         0.0000000000         0.0000000000
   2    1   3    6         0.0000000000         0.0000000000
   2    1   3    7         0.0000000000         0.0000000000

   3    1   1    1         0.0000000000         0.0000000000
   3    1   2    1         0.0000000000         0.0000000000
   3    1   1    2         0.0000000000         0.0000000000
   3    1   2    2         0.0000000000         0.0000000000
   3    1   1    3         0.0000000000         0.0000000000
   3    1   2    3         0.0000000000         0.0000000000
   3    1   1    4         0.0000000000         0.0000000000
   3    1   2    4         0.0000000000         0.0000000000
   3    1   3    7        -2.4063840895         0.0000000000

   1    2   3    1         0.0000000000         0.0000000000
   1    2   3    2         0.0000000000         0.0000000000
   1    2   3    3         0.0000000000         0.0000000000
   1    2   3    4         0.0000000000         0.0000000000
   1    2   2    6         0.0000000000         0.0000000000
   1    2   3    6         0.0000000000         0.0000000000
   1    2   3    7         0.0000000000         0.0000000000

   2    2   3    1         0.0000000000         0.0000000000
   2    2   3    2         0.0000000000         0.0000000000
   2    2   3    3         0.0000000000         0.0000000000
   2    2   3    4         0.0000000000         0.0000000000
   2    2   1    6         0.0000000000         0.0000000000
   2    2   3    6         0.0000000000         0.0000000000
   2    2   3    7        -0.0000000000         0.0000000000

   3    2   1    1         0.0000000000         0.0000000000
   3    2   2    1         0.0000000000         0.0000000000
   3    2   1    2         0.0000000000         0.0000000000
   3    2   2    2         0.0000000000         0.0000000000
   3    2   1    3         0.0000000000         0.0000000000
   3    2   2    3         0.0000000000         0.0000000000
   3    2   1    4         0.0000000000         0.0000000000
   3    2   2    4         0.0000000000         0.0000000000
   3    2   3    7        -2.4063840895         0.0000000000

   1    3   3    1         0.0000000000         0.0000000000
   1    3   3    2         0.0000000000         0.0000000000
   1    3   3    3         0.0000000000         0.0000000000
   1    3   3    4         0.0000000000         0.0000000000
   1    3   2    6         0.0000000000         0.0000000000
   1    3   3    6         0.0000000000         0.0000000000
   1    3   3    7         0.0000000000         0.0000000000

   2    3   3    1         0.0000000000         0.0000000000
   2    3   3    2         0.0000000000         0.0000000000
   2    3   3    3         0.0000000000         0.0000000000
   2    3   3    4         0.0000000000         0.0000000000
   2    3   1    6         0.0000000000         0.0000000000
   2    3   3    6         0.0000000000         0.0000000000
   2    3   3    7         0.0000000000         0.0000000000

   3    3   1    1         0.0000000000         0.0000000000
   3    3   2    1         0.0000000000         0.0000000000
   3    3   1    2         0.0000000000         0.0000000000
   3    3   2    2         0.0000000000         0.0000000000
   3    3   1    3         0.0000000000         0.0000000000
   3    3   2    3         0.0000000000         0.0000000000
   3    3   1    4         0.0000000000         0.0000000000
   3    3   2    4         0.0000000000         0.0000000000
   3    3   3    7         2.4102102658         0.0000000000

   1    4   3    1         0.0000000000         0.0000000000
   1    4   3    2         0.0000000000         0.0000000000
   1    4   3    3         0.0000000000         0.0000000000
   1    4   3    4         0.0000000000         0.0000000000
   1    4   2    6         0.0000000000         0.0000000000
   1    4   3    6         0.0000000000         0.0000000000
   1    4   3    7        -0.0000000000         0.0000000000

   2    4   3    1         0.0000000000         0.0000000000
   2    4   3    2         0.0000000000         0.0000000000
   2    4   3    3         0.0000000000         0.0000000000
   2    4   3    4         0.0000000000         0.0000000000
   2    4   1    6         0.0000000000         0.0000000000
   2    4   3    6         0.0000000000         0.0000000000
   2    4   3    7        -0.0000000000         0.0000000000

   3    4   1    1         0.0000000000         0.0000000000
   3    4   2    1         0.0000000000         0.0000000000
   3    4   1    2         0.0000000000         0.0000000000
   3    4   2    2         0.0000000000         0.0000000000
   3    4   1    3         0.0000000000         0.0000000000
   3    4   2    3         0.0000000000         0.0000000000
   3    4   1    4         0.0000000000         0.0000000000
   3    4   2    4         0.0000000000         0.0000000000
   3    4   3    7         2.4102102658         0.0000000000

   1    6   2    1         0.0000000000         0.0000000000
   1    6   2    2         0.0000000000         0.0000000000
   1    6   2    3         0.0000000000         0.0000000000
   1    6   2    4         0.0000000000         0.0000000000
   1    6   3    6         0.0000000000         0.0000000000

   2    6   1    1         0.0000000000         0.0000000000
   2    6   1    2         0.0000000000         0.0000000000
   2    6   1    3         0.0000000000         0.0000000000
   2    6   1    4         0.0000000000         0.0000000000
   2    6   3    6         0.0000000000         0.0000000000

   3    6   1    1         0.0000000000         0.0000000000
   3    6   2    1         0.0000000000         0.0000000000
   3    6   1    2         0.0000000000         0.0000000000
   3    6   2    2         0.0000000000         0.0000000000
   3    6   1    3         0.0000000000         0.0000000000
   3    6   2    3         0.0000000000         0.0000000000
   3    6   1    4         0.0000000000         0.0000000000
   3    6   2    4         0.0000000000         0.0000000000
   3    6   1    6         0.0000000000         0.0000000000
   3    6   2    6         0.0000000000         0.0000000000
   3    6   3    7        -3.4948867472         0.0000000000

   1    7   3    7         0.6406424279         0.0000000000

   2    7   3    7         0.6406424403         0.0000000000

   3    7   3    7         4.5377632810         0.0000000000

   1    8   3    7         0.0000000005         0.0000000000

   2    8   3    7         0.0000000002         0.0000000000

   3    8   3    7        -0.0000000109         0.0000000000


  Rigid-atom elastic tensor , in cartesian coordinates,
     j1       j2             matrix element
  dir pert dir pert     real part    imaginary part

   1    7   3    7         0.0011850679         0.0000000000

   2    7   3    7         0.0011850679         0.0000000000

   3    7   3    7         0.0083940080         0.0000000000

   1    8   3    7         0.0000000000         0.0000000000

   2    8   3    7         0.0000000000         0.0000000000

   3    8   3    7        -0.0000000000         0.0000000000

  Internal strain coupling parameters, in cartesian coordinates,
   zero average net force deriv. has been imposed
     j1       j2             matrix element
  dir pert dir pert     real part    imaginary part

   1    1   3    7         0.0000000000         0.0000000000

   2    1   3    7        -0.0000000000         0.0000000000

   3    1   3    7         0.2027271522         0.0000000000

   1    2   3    7        -0.0000000000         0.0000000000

   2    2   3    7         0.0000000000         0.0000000000

   3    2   3    7         0.2027271522         0.0000000000

   1    3   3    7        -0.0000000000         0.0000000000

   2    3   3    7        -0.0000000000         0.0000000000

   3    3   3    7        -0.2027271522         0.0000000000

   1    4   3    7        -0.0000000000         0.0000000000

   2    4   3    7         0.0000000000         0.0000000000

   3    4   3    7        -0.2027271522         0.0000000000

  Rigid-atom proper piezoelectric tensor, in cartesian coordinates,
  (from strain response)
     j1       j2             matrix element
  dir pert dir pert     real part    imaginary part

   3    6   3    7        -0.0122230317         0.0000000000

== END DATASET(S) ==============================================================
================================================================================

 -outvars: echo values of variables after computation  --------
            acell      7.2488954246E+00  7.2488954246E+00  1.1879499870E+01 Bohr
              amu      2.69815390E+01  3.09737620E+01
         berryopt1          0
         berryopt2         -2
         berryopt3          0
           diemac      9.00000000E+00
             ecut      6.00000000E+00 Hartree
           ecutsm      5.00000000E-01 Hartree
           etotal1    -1.8625871472E+01
           etotal3     4.5377633250E+00
            fcart1    -0.0000000000E+00 -0.0000000000E+00 -4.0875097259E-07
                      -0.0000000000E+00 -0.0000000000E+00 -4.0875097259E-07
                      -0.0000000000E+00 -0.0000000000E+00  4.0875097259E-07
                      -0.0000000000E+00 -0.0000000000E+00  4.0875097259E-07
            fcart3     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
-          fftalg         512
           getddk1          0
           getddk2          0
           getddk3         -1
           getden1          0
           getden2         -1
           getden3          0
           getwfk1          0
           getwfk2         -1
           getwfk3         -1
             iscf1          7
             iscf2         -2
             iscf3          7
              ixc       -1012
           jdtset        1    2    3
              kpt1     0.00000000E+00  0.00000000E+00  1.25000000E-01
                       2.50000000E-01  0.00000000E+00  1.25000000E-01
                       5.00000000E-01  0.00000000E+00  1.25000000E-01
                       2.50000000E-01  2.50000000E-01  1.25000000E-01
                       0.00000000E+00  0.00000000E+00  3.75000000E-01
                       2.50000000E-01  0.00000000E+00  3.75000000E-01
                       5.00000000E-01  0.00000000E+00  3.75000000E-01
                       2.50000000E-01  2.50000000E-01  3.75000000E-01
              kpt2     0.00000000E+00  0.00000000E+00  1.25000000E-01
                       2.50000000E-01  0.00000000E+00  1.25000000E-01
                       5.00000000E-01  0.00000000E+00  1.25000000E-01
                      -2.50000000E-01  0.00000000E+00  1.25000000E-01
                       0.00000000E+00  2.50000000E-01  1.25000000E-01
                       2.50000000E-01  2.50000000E-01  1.25000000E-01
                       5.00000000E-01  2.50000000E-01  1.25000000E-01
                      -2.50000000E-01  2.50000000E-01  1.25000000E-01
                       0.00000000E+00  5.00000000E-01  1.25000000E-01
                       2.50000000E-01  5.00000000E-01  1.25000000E-01
                       5.00000000E-01  5.00000000E-01  1.25000000E-01
                      -2.50000000E-01  5.00000000E-01  1.25000000E-01
                       0.00000000E+00 -2.50000000E-01  1.25000000E-01
                       2.50000000E-01 -2.50000000E-01  1.25000000E-01
                       5.00000000E-01 -2.50000000E-01  1.25000000E-01
                      -2.50000000E-01 -2.50000000E-01  1.25000000E-01
                       0.00000000E+00  0.00000000E+00  3.75000000E-01
                       2.50000000E-01  0.00000000E+00  3.75000000E-01
                       5.00000000E-01  0.00000000E+00  3.75000000E-01
                      -2.50000000E-01  0.00000000E+00  3.75000000E-01
                       0.00000000E+00  2.50000000E-01  3.75000000E-01
                       2.50000000E-01  2.50000000E-01  3.75000000E-01
                       5.00000000E-01  2.50000000E-01  3.75000000E-01
                      -2.50000000E-01  2.50000000E-01  3.75000000E-01
                       0.00000000E+00  5.00000000E-01  3.75000000E-01
                       2.50000000E-01  5.00000000E-01  3.75000000E-01
                       5.00000000E-01  5.00000000E-01  3.75000000E-01
                      -2.50000000E-01  5.00000000E-01  3.75000000E-01
                       0.00000000E+00 -2.50000000E-01  3.75000000E-01
                       2.50000000E-01 -2.50000000E-01  3.75000000E-01
                       5.00000000E-01 -2.50000000E-01  3.75000000E-01
                      -2.50000000E-01 -2.50000000E-01  3.75000000E-01
                       0.00000000E+00  0.00000000E+00 -3.75000000E-01
                       2.50000000E-01  0.00000000E+00 -3.75000000E-01
                       5.00000000E-01  0.00000000E+00 -3.75000000E-01
                      -2.50000000E-01  0.00000000E+00 -3.75000000E-01
                       0.00000000E+00  2.50000000E-01 -3.75000000E-01
                       2.50000000E-01  2.50000000E-01 -3.75000000E-01
                       5.00000000E-01  2.50000000E-01 -3.75000000E-01
                      -2.50000000E-01  2.50000000E-01 -3.75000000E-01
                       0.00000000E+00  5.00000000E-01 -3.75000000E-01
                       2.50000000E-01  5.00000000E-01 -3.75000000E-01
                       5.00000000E-01  5.00000000E-01 -3.75000000E-01
                      -2.50000000E-01  5.00000000E-01 -3.75000000E-01
                       0.00000000E+00 -2.50000000E-01 -3.75000000E-01
                       2.50000000E-01 -2.50000000E-01 -3.75000000E-01
                       5.00000000E-01 -2.50000000E-01 -3.75000000E-01
                      -2.50000000E-01 -2.50000000E-01 -3.75000000E-01
                       0.00000000E+00  0.00000000E+00 -1.25000000E-01
                       2.50000000E-01  0.00000000E+00 -1.25000000E-01
              kpt3     0.00000000E+00  0.00000000E+00  1.25000000E-01
                       2.50000000E-01  0.00000000E+00  1.25000000E-01
                       5.00000000E-01  0.00000000E+00  1.25000000E-01
                      -2.50000000E-01  0.00000000E+00  1.25000000E-01
                       0.00000000E+00  2.50000000E-01  1.25000000E-01
                       2.50000000E-01  2.50000000E-01  1.25000000E-01
                       5.00000000E-01  2.50000000E-01  1.25000000E-01
                      -2.50000000E-01  2.50000000E-01  1.25000000E-01
                       0.00000000E+00  5.00000000E-01  1.25000000E-01
                       2.50000000E-01  5.00000000E-01  1.25000000E-01
                       5.00000000E-01  5.00000000E-01  1.25000000E-01
                      -2.50000000E-01  5.00000000E-01  1.25000000E-01
                       0.00000000E+00 -2.50000000E-01  1.25000000E-01
                       2.50000000E-01 -2.50000000E-01  1.25000000E-01
                       5.00000000E-01 -2.50000000E-01  1.25000000E-01
                      -2.50000000E-01 -2.50000000E-01  1.25000000E-01
                       0.00000000E+00  0.00000000E+00  3.75000000E-01
                       2.50000000E-01  0.00000000E+00  3.75000000E-01
                       5.00000000E-01  0.00000000E+00  3.75000000E-01
                      -2.50000000E-01  0.00000000E+00  3.75000000E-01
                       0.00000000E+00  2.50000000E-01  3.75000000E-01
                       2.50000000E-01  2.50000000E-01  3.75000000E-01
                       5.00000000E-01  2.50000000E-01  3.75000000E-01
                      -2.50000000E-01  2.50000000E-01  3.75000000E-01
                       0.00000000E+00  5.00000000E-01  3.75000000E-01
                       2.50000000E-01  5.00000000E-01  3.75000000E-01
                       5.00000000E-01  5.00000000E-01  3.75000000E-01
                      -2.50000000E-01  5.00000000E-01  3.75000000E-01
                       0.00000000E+00 -2.50000000E-01  3.75000000E-01
                       2.50000000E-01 -2.50000000E-01  3.75000000E-01
                       5.00000000E-01 -2.50000000E-01  3.75000000E-01
                      -2.50000000E-01 -2.50000000E-01  3.75000000E-01
                       outvar_i_n : Printing only first  50 k-points.
           kptopt1          1
           kptopt2          3
           kptopt3          2
         kptrlatt        4    0    0      0    4    0      0    0    4
          kptrlen      2.89955817E+01
P           mkmem1          8
P           mkmem2         64
P           mkmem3         32
P          mkqmem1          8
P          mkqmem2         64
P          mkqmem3         32
P          mk1mem1          8
P          mk1mem2         64
P          mk1mem3         32
            natom           4
            nband1          8
            nband2          8
            nband3          8
           nbdbuf1          0
           nbdbuf2          2
           nbdbuf3          0
           ndtset           3
            ngfft          16      16      30
             nkpt1          8
             nkpt2         64
             nkpt3         32
             nqpt1          0
             nqpt2          0
             nqpt3          1
            nstep          40
             nsym          12
           ntypat           2
              occ1     2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000
              occ3     2.000000  2.000000  2.000000  2.000000  2.000000  2.000000
                       2.000000  2.000000
        optdriver1          0
        optdriver2          0
        optdriver3          1
        optforces           1
           prtpot1          0
           prtpot2          0
           prtpot3          1
            rfdir1          1       1       1
            rfdir2          0       0       1
            rfdir3          0       0       1
           rfstrs1          0
           rfstrs2          0
           rfstrs3          1
            rprim      8.6602540378E-01  5.0000000000E-01  0.0000000000E+00
                      -8.6602540378E-01  5.0000000000E-01  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  1.0000000000E+00
           shiftk      0.00000000E+00  0.00000000E+00  5.00000000E-01
          spgroup         186
           strten1     7.0635794531E-08  7.0635794531E-08 -2.8015467165E-09
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           strten3     0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           symrel      1  0  0   0  1  0   0  0  1       0  1  0   1  0  0   0  0  1
                       1  1  0  -1  0  0   0  0  1      -1  0  0   1  1  0   0  0  1
                       0  1  0  -1 -1  0   0  0  1      -1 -1  0   0  1  0   0  0  1
                      -1  0  0   0 -1  0   0  0  1       0 -1  0  -1  0  0   0  0  1
                      -1 -1  0   1  0  0   0  0  1       1  0  0  -1 -1  0   0  0  1
                       0 -1  0   1  1  0   0  0  1       1  1  0   0 -1  0   0  0  1
            tnons      0.0000000  0.0000000  0.0000000     0.0000000  0.0000000  0.5000000
                      -0.0000000  0.0000000  0.5000000    -0.0000000  0.0000000  0.0000000
                      -0.0000000 -0.0000000  0.0000000    -0.0000000 -0.0000000  0.5000000
                      -0.0000000 -0.0000000  0.5000000    -0.0000000 -0.0000000  0.0000000
                      -0.0000000 -0.0000000  0.0000000    -0.0000000 -0.0000000  0.5000000
                       0.0000000 -0.0000000  0.5000000     0.0000000 -0.0000000  0.0000000
           tolvrs1     1.00000000E-18
           tolvrs2     0.00000000E+00
           tolvrs3     1.00000000E-10
           tolwfr1     0.00000000E+00
           tolwfr2     1.00000000E-20
           tolwfr3     0.00000000E+00
            typat      1  1  2  2
              wtk1       0.03125    0.18750    0.09375    0.18750    0.03125    0.18750
                         0.09375    0.18750
              wtk2       0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563    0.01563    0.01563    0.01563    0.01563
                         0.01563    0.01563
              wtk3       0.03125    0.03125    0.03125    0.03125    0.03125    0.03125
                         0.03125    0.03125    0.03125    0.03125    0.03125    0.03125
                         0.03125    0.03125    0.03125    0.03125    0.03125    0.03125
                         0.03125    0.03125    0.03125    0.03125    0.03125    0.03125
                         0.03125    0.03125    0.03125    0.03125    0.03125    0.03125
                         0.03125    0.03125
                       outvars : Printing only first  50 k-points.
           xangst     -1.1073434536E+00  1.9179751231E+00  0.0000000000E+00
                       1.1073434536E+00  1.9179751231E+00  3.1431802903E+00
                      -1.1073434536E+00  1.9179751231E+00  2.3584819873E+00
                       1.1073434536E+00  1.9179751231E+00  5.5016622776E+00
            xcart     -2.0925758624E+00  3.6244477123E+00  0.0000000000E+00
                       2.0925758624E+00  3.6244477123E+00  5.9397499350E+00
                      -2.0925758624E+00  3.6244477123E+00  4.4568850454E+00
                       2.0925758624E+00  3.6244477123E+00  1.0396634980E+01
             xred      3.3333333333E-01  6.6666666667E-01  0.0000000000E+00
                       6.6666666667E-01  3.3333333333E-01  5.0000000000E-01
                       3.3333333333E-01  6.6666666667E-01  3.7517446813E-01
                       6.6666666667E-01  3.3333333333E-01  8.7517446813E-01
            znucl       13.00000   15.00000

================================================================================


- Timing analysis has been suppressed with timopt=0



================================================================================

 Suggested references for the acknowledgment of ABINIT usage.

 The users of ABINIT have little formal obligations with respect to the ABINIT group
 (those specified in the GNU General Public License, http://www.gnu.org/copyleft/gpl.txt).
 However, it is common practice in the scientific literature,
 to acknowledge the efforts of people that have made the research possible.
 In this spirit, please find below suggested citations of work written by ABINIT developers,
 corresponding to implementations inside of ABINIT that you have used in the present run.
 Note also that it will be of great value to readers of publications presenting these results,
 to read papers enabling them to understand the theoretical formalism and details
 of the ABINIT implementation.
 For information on why they are suggested, see also https://docs.abinit.org/theory/acknowledgments.
-
- [1] Metric tensor formulation of strain in density-functional perturbation theory,
- D. R. Hamann, X. Wu, K. M. Rabe, and D. Vanderbilt, Phys. Rev. B71, 035117 (2005).
- Comment: Non-vanishing rfstrs. Strong suggestion to cite this paper in your publications.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#hamann2005
-
- [2] Libxc: A library of exchange and correlation functionals for density functional theory.
- M.A.L. Marques, M.J.T. Oliveira, T. Burnus, Computer Physics Communications 183, 2227 (2012).
- Comment: to be cited when LibXC is used (negative value of ixc)
- Strong suggestion to cite this paper.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#marques2012
-
- [3] The Abinit project: Impact, environment and recent developments.
- Computer Phys. Comm. 248, 107042 (2020).
- X.Gonze, B. Amadon, G. Antonius, F.Arnardi, L.Baguet, J.-M.Beuken,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, N.Brouwer, F.Bruneval,
- G.Brunin, T.Cavignac, J.-B. Charraud, Wei Chen, M.Cote, S.Cottenier,
- J.Denier, G.Geneste, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, Xu He, N.Helbig, N.Holzwarth, Y.Jia, F.Jollet,
- W.Lafargue-Dit-Hauret, K.Lejaeghere, M.A.L.Marques, A.Martin, C.Martins,
- H.P.C. Miranda, F.Naccarato, K. Persson, G.Petretto, V.Planes, Y.Pouillon,
- S.Prokhorenko, F.Ricci, G.-M.Rignanese, A.H.Romero, M.M.Schmitt, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, G.Zerah and J.W.Zwanzig
- Comment: the fifth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm.
- is available at https://www.abinit.org/sites/default/files/ABINIT20.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2020
-
- [4] Optimized norm-conserving Vanderbilt pseudopotentials.
- D.R. Hamann, Phys. Rev. B 88, 085117 (2013).
- Comment: Some pseudopotential generated using the ONCVPSP code were used.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#hamann2013
-
- [5] ABINIT: Overview, and focus on selected capabilities
- J. Chem. Phys. 152, 124102 (2020).
- A. Romero, D.C. Allan, B. Amadon, G. Antonius, T. Applencourt, L.Baguet,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, F.Bruneval,
- G.Brunin, D.Caliste, M.Cote,
- J.Denier, C. Dreyer, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, F.Jollet, G. Jomard,
- A.Martin,
- H.P.C. Miranda, F.Naccarato, G.Petretto, N.A. Pike, V.Planes,
- S.Prokhorenko, T. Rangel, F.Ricci, G.-M.Rignanese, M.Royo, M.Stengel, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, J.Wiktor, J.W.Zwanziger, and X.Gonze.
- Comment: a global overview of ABINIT, with focus on selected capabilities .
- Note that a version of this paper, that is not formatted for J. Chem. Phys
- is available at https://www.abinit.org/sites/default/files/ABINIT20_JPC.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#romero2020
-
- [6] Recent developments in the ABINIT software package.
- Computer Phys. Comm. 205, 106 (2016).
- X.Gonze, F.Jollet, F.Abreu Araujo, D.Adams, B.Amadon, T.Applencourt,
- C.Audouze, J.-M.Beuken, J.Bieder, A.Bokhanchuk, E.Bousquet, F.Bruneval
- D.Caliste, M.Cote, F.Dahm, F.Da Pieve, M.Delaveau, M.Di Gennaro,
- B.Dorado, C.Espejo, G.Geneste, L.Genovese, A.Gerossier, M.Giantomassi,
- Y.Gillet, D.R.Hamann, L.He, G.Jomard, J.Laflamme Janssen, S.Le Roux,
- A.Levitt, A.Lherbier, F.Liu, I.Lukacevic, A.Martin, C.Martins,
- M.J.T.Oliveira, S.Ponce, Y.Pouillon, T.Rangel, G.-M.Rignanese,
- A.H.Romero, B.Rousseau, O.Rubel, A.A.Shukri, M.Stankovski, M.Torrent,
- M.J.Van Setten, B.Van Troeye, M.J.Verstraete, D.Waroquier, J.Wiktor,
- B.Xu, A.Zhou, J.W.Zwanziger.
- Comment: the fourth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm.
- is available at https://www.abinit.org/sites/default/files/ABINIT16.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2016
-
- Proc.   0 individual time (sec): cpu=          3.7  wall=          5.2

================================================================================

 Calculation completed.
.Delivered  16 WARNINGs and   8 COMMENTs to log file.
+Overall time at end (sec) : cpu=          3.7  wall=          5.2

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-a3d040a5-0142-4fbf-a0b0-86c1039552de", "#uuid-7b8feb7c-7cba-4ee3-99f4-ad6e4975f8fe") }); </script>

<p>We immediately see a problem &ndash; this output, like most of the .out file, is in
atomic units, while we computed our numerical derivative in conventional C/m<span class="arithmatex">\(^2\)</span>
units. While you might think to simply run anaddb to do the conversion as
before, its present version is not happy with such an incomplete DDB file as
telast_5 has generated and will not produce the desired result. While it
should be left as an exercise to the student to dig the conversion factor out
of the literature, or better yet out of the source code, we will cheat and
tell you that 1 a.u.=57.2147606 C/m<span class="arithmatex">\(^2\)</span>. Thus the new RF result for the 3,3 rigid-
ion piezoelectric constant is -0.699338  C/m<span class="arithmatex">\(^2\)</span> compared to the result found in
section 4 by a completely-GS finite difference calculation, -0.699337 C/m<span class="arithmatex">\(^2\)</span>.
The agreement is now excellent!</p>
<p>The fully RF calculation in section 2 in fact will converge much more rapidly
with <strong>k</strong> sample than the partial-finite-difference method introduced here.
Is it worthwhile to have learned how to do this? We believe that is always
pays to have alternative ways to test results, and besides, this didn&rsquo;t take
much time. (Have you found the conversion factor on your own yet?)</p>
<p>A final word about AlP calculations: in this study, we have not used converged parameters for the sake of speed.
It is always the duty of the user to check the precision of his numerical calculations with respect to the
parameters of the calculation.</p>
<h2 id="6-response-function-calculation-of-the-elastic-constants-of-al-metal">6 Response-function calculation of the elastic constants of Al metal<a class="headerlink" href="#6-response-function-calculation-of-the-elastic-constants-of-al-metal" title="Permanent link">&para;</a></h2>
<p>For metals, the existence of partially occupied bands is a complicating
feature for RF as well as GS calculations.
Now would be a good time to review <a href="/tutorial/base4">tutorial 4</a> which dealt in detail with the interplay between
<strong>k</strong>-sample convergence and Fermi-surface broadening, especially <a class="wikilink lesson-wikilink" href="/tutorial/base4#3">section 3 of tutorial 4</a>.
You should copy <em>telast_6.abi</em> into <em>Work_elast</em>, and begin your run
while you read on, since it involves a convergence study with multiple datasets and may take about two minutes.</p>
<div class="text-center"><button id="uuid-4f923cf0-dc05-41ad-be31-093ed19f9fcf" class="md-button md-button--secondary"> View tests/tutorespfn/Input/telast_6.abi </button></div>
<div id="uuid-9f52ecfe-75f8-4c37-9b9c-b9d742356ef2" class="my_dialog" title="tests/tutorespfn/Input/telast_6.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#Al fcc metal - elastic constant calculation</span>

<span class="w">   </span>ndtset<span class="w">   </span><span class="m">12</span><span class="w">        </span><span class="c1"># Total number of datasets (3*4)</span>
<span class="w">   </span>udtset<span class="w">   </span><span class="m">3</span><span class="w">  </span><span class="m">4</span><span class="w">      </span><span class="c1"># Double loop for k-sample convergence study</span>

<span class="c1"># Set 1 : Initial self-consistent and lattice optimization run</span>

<span class="w">  </span>getwfk?1<span class="w">   </span><span class="m">0</span>
<span class="w">  </span>geoopt?1<span class="w">   </span><span class="s2">&quot;bfgs&quot;</span><span class="w">   </span><span class="c1"># Broyden lattice optimization scheme</span>
<span class="w">   </span>ntime?1<span class="w">   </span><span class="m">5</span><span class="w">        </span><span class="c1"># Maximim lattice optimization steps</span>
<span class="w"> </span>optcell?1<span class="w">   </span><span class="m">1</span><span class="w">        </span><span class="c1"># Optimize cell volume only</span>
<span class="w"> </span>strfact?1<span class="w">   </span><span class="m">100</span><span class="w">      </span><span class="c1"># Test convergence of stresses (Hartree/bohr^3) by</span>
<span class="w">                      </span><span class="c1"># multiplying by this factor and applying force</span>
<span class="w">                      </span><span class="c1"># convergence test</span>
<span class="w">  </span>tolmxf?1<span class="w">   </span><span class="m">1</span>.0e-6<span class="w">   </span><span class="c1"># Convergence limit for forces as above</span>
<span class="w">  </span>tolvrs?1<span class="w">   </span><span class="m">1</span>.0d-18<span class="w">  </span><span class="c1"># Need excellent convergence of GS quantities for RF runs</span>

<span class="c1"># Set 2 : Additional iteration to print density just at converged acell</span>

<span class="w">  </span>prtden?2<span class="w">   </span><span class="m">1</span><span class="w">        </span><span class="c1"># Third dataset needs density</span>
<span class="w">  </span>tolvrs?2<span class="w">   </span><span class="m">1</span>.0d-18

<span class="c1"># Set 3 : Converge unoccupied wave functions</span>

<span class="w">  </span>getden?3<span class="w">   </span>-1<span class="w">       </span><span class="c1"># Use density from previout set</span>
<span class="w">  </span>tolwfr?3<span class="w">   </span><span class="m">5</span>.0d-19<span class="w">  </span><span class="c1"># Only wave function convergence can be used with</span>
<span class="w">                      </span><span class="c1"># non-self-consistent calculation</span>
<span class="w">  </span>tolwfr23<span class="w">   </span><span class="m">1</span>.0d-30<span class="w">  </span><span class="c1"># This is simply for a reason of portability of automatic tests</span>
<span class="w">  </span>nstep23<span class="w">    </span><span class="m">6</span><span class="w">        </span><span class="c1"># This is simply for a reason of portability of automatic tests</span>
<span class="w">  </span>nstep33<span class="w">    </span><span class="m">20</span><span class="w">       </span><span class="c1"># This is simply for a reason of portability of automatic tests</span>

<span class="c1"># Set 4 : response-function calculations for all needed perturbations</span>

<span class="w">  </span>kptopt?4<span class="w">   </span><span class="m">2</span><span class="w">        </span><span class="c1"># Time-reversal only for RF calculation</span>
<span class="w">    </span>nqpt?4<span class="w">   </span><span class="m">1</span>
<span class="w">     </span>qpt?4<span class="w">   </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="c1"># By symmetry, only need one direction</span>
<span class="w">   </span>rfdir?4<span class="w">   </span><span class="m">1</span><span class="w">  </span><span class="m">0</span><span class="w">  </span><span class="m">0</span>
<span class="w">  </span>rfstrs?4<span class="w">   </span><span class="m">3</span><span class="w">        </span><span class="c1"># Need both unaxial and shear strains</span>
<span class="w">  </span>tolvrs?4<span class="w">   </span><span class="m">1</span>.0d-12<span class="w">  </span><span class="c1"># Need reasonable convergence of 1st-order quantities</span>

<span class="c1">#Common input data</span>

<span class="c1">#Double loop data passing</span>

getcell<span class="w">   </span>-1<span class="w">         </span><span class="c1"># Start from optimized (datasets ?2-?4) or previously</span>
<span class="w">                     </span><span class="c1"># optimized (datasets ?1) acell</span>
<span class="w"> </span>getwfk<span class="w">   </span>-1<span class="w">         </span><span class="c1"># Use last set of wave functions (except datasets ?1)</span>


<span class="c1">#Lattice definition</span>
<span class="w">  </span>acell<span class="w">   </span><span class="m">3</span>*7.60<span class="w">     </span><span class="c1"># Starting value</span>
dilatmx<span class="w">   </span><span class="m">1</span>.05<span class="w">       </span><span class="c1"># Allow for optimization</span>
<span class="w">  </span>rprim<span class="w">   </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5
<span class="w">          </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.5
<span class="w">          </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0

<span class="c1">#Definition of the atom types and atoms</span>
<span class="w"> </span>ntypat<span class="w">   </span><span class="m">1</span>
<span class="w">  </span>znucl<span class="w">   </span><span class="m">13</span>
<span class="w">  </span>natom<span class="w">   </span><span class="m">1</span>
<span class="w">  </span>typat<span class="w">   </span><span class="m">1</span>

<span class="c1">#Atomic position</span>
<span class="w">   </span>xred<span class="w">   </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.0

<span class="c1">#Definition of the plane wave basis set</span>
<span class="w">   </span>ecut<span class="w">   </span><span class="m">8</span>.0<span class="w">            </span><span class="c1"># Maximum kinetic energy cutoff (Hartree)</span>
<span class="w"> </span>ecutsm<span class="w">   </span><span class="m">0</span>.5<span class="w">            </span><span class="c1"># Smoothing energy needed for lattice parameter</span>
<span class="w">                         </span><span class="c1"># optimization.  This will be retained for</span>
<span class="w">                         </span><span class="c1"># consistency throughout.</span>

<span class="c1">#Definition of the k-point grid - loop over 3 k-point densities</span>

ngkpt1?<span class="w">   </span><span class="m">6</span><span class="w">  </span><span class="m">6</span><span class="w">  </span><span class="m">6</span>
ngkpt2?<span class="w">   </span><span class="m">8</span><span class="w">  </span><span class="m">8</span><span class="w">  </span><span class="m">8</span>
ngkpt3?<span class="w">   </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span>

nshiftk<span class="w">   </span><span class="m">4</span><span class="w">              </span><span class="c1"># Use one copy of grid only (default)</span>
<span class="w"> </span>shiftk<span class="w">   </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.5<span class="w">    </span><span class="c1"># This gives the usual fcc Monkhorst-Pack grid</span>
<span class="w">          </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>.0
<span class="w">          </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0
<span class="w">          </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>.5

<span class="c1">#Definition of occupation numbers and number of bands</span>
<span class="w">  </span>nband<span class="w">   </span><span class="m">4</span><span class="w">              </span><span class="c1"># With metallic occup</span>
<span class="w"> </span>occopt<span class="w">   </span><span class="m">3</span><span class="w">              </span><span class="c1"># Femi-function smearing</span>
<span class="w"> </span>tsmear<span class="w">   </span><span class="m">0</span>.02

<span class="c1">#Definition of the self-consistency procedure</span>
<span class="w">  </span>nstep<span class="w">   </span><span class="m">25</span><span class="w">             </span><span class="c1"># Maximum number of SCF iterations</span>
<span class="w">                         </span><span class="c1"># This might not be enough for the very demanding tolwfr?3 above,</span>
<span class="w">                         </span><span class="c1"># but was chosen for portability reasons.</span>
<span class="c1"># enforce calculation of forces at each SCF step</span>
<span class="w"> </span>optforces<span class="w"> </span><span class="m">1</span>


<span class="w"> </span>pp_dirpath<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
<span class="w"> </span>pseudos<span class="w"> </span><span class="s2">&quot;Psdj_nc_sr_04_pw_std_psp8/Al.psp8&quot;</span>

<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   telast_6.abo, tolnlines=  0, tolabs=  0.000e+00, tolrel=  0.000e+00, fld_options = -medium</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 2</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = D. Hamann</span>
<span class="c1">#%% keywords = NC, DFPT</span>
<span class="c1">#%% description =  Al fcc metal - elastic constant calculation</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-9f52ecfe-75f8-4c37-9b9c-b9d742356ef2", "#uuid-4f923cf0-dc05-41ad-be31-093ed19f9fcf") }); </script>

<p>While the run is in progress, edit <em>telast_6.abi</em>. As in <em>tbase4_3.abi</em>, we will set
<a class="wikilink codevar-wikilink" href="/variables/basic#udtset">udtset</a> to specify a double loop.  In the present case, however, the outer
loop will be over 3 successively larger meshes of <strong>k</strong> points, while the
inner loop will be successively</p>
<ol>
<li>GS self-consistent runs with optimization of acell.</li>
<li>GS density-generating run for the next step.</li>
<li>Non-self-consistent GS run to converge unoccupied or slightly-occupied bands.</li>
<li>RF run for symmetry-inequivalent elastic constants.</li>
</ol>
<p>In Section 1, we did a separate GS structural optimization run and
transferred the results by hand to RF run section 2.  Because we are doing a
convergence test here, we have combined these steps, and use <a class="wikilink codevar-wikilink" href="/variables/rlx#getcell">getcell</a> to
transfer the optimized coordinates from the first dataset of the inner loop
forward to the rest.  If we were doing a more complicated structure with
internal coordinates that were also optimized, we would need to use both this
and <a class="wikilink codevar-wikilink" href="/variables/rlx#getxred">getxred</a> to transfer these, as in telast_1.abi.</p>
<p>The specific data for inner-loop dataset 1 is very similar to that for <em>telast_1.abi</em>.
Inner-loop dataset 2 is a bit of a hack.  We need the density
for inner-loop dataset 3, and while we could set <a class="wikilink codevar-wikilink" href="/variables/files#prtden">prtden</a> = 1 in dataset 1,
this would produce a separate density file for every step in the structural
optimization, and it isn&rsquo;t clear how to automatically pick out the last one.
So, dataset 2 picks up the wave functions from dataset 1 (only one file of
these is produced, for the optimized structure), does one more iteration with
fixed geometry, and writes a density file.</p>
<p>Inner-loop dataset 3 is a non-self-consistent run whose purpose is to ensure
that all the wave functions specified by <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> are well converged. For
metals, we have to specify enough bands to make sure that the Fermi surface is
properly calculated.  Bands above the  Fermi level which have small occupancy
or near-zero occupancy if their energies exceed the Fermi energy by more than
a few times <a class="wikilink codevar-wikilink" href="/variables/gstate#tsmear">tsmear</a>, will have very little effect on the self-consistent
potential, so the <a class="wikilink codevar-wikilink" href="/variables/basic#tolvrs">tolvrs</a> test in dataset 1 doesn&rsquo;t ensure their
convergence.  Using <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a> in inner-loop dataset 3 does.  Partially-
occupied or unoccupied bands up to <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>   play a different role in
constructing the first-order wave functions than do the many unoccupied bands
beyond <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> which aren&rsquo;t explicitly treated in Abinit, as discussed in
S. de Gironcoli, Phys. Rev. B 51, 6773 (1995) <a class="wikilink citation-wikilink" data-tippy-content="Lattice dynamics of metals from density-functional perturbation theory" data-toggle="popover" href="/theory/bibliography#degironcoli1995">[DeGironcoli1995]</a>.  By setting <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> exactly
equal to the number of occupied bands for RF calculations for semiconductors
and insulators, we avoid having to deal with the issue of converging
unoccupied bands.  Could we avoid the extra steps by simply using <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a>
instead of <a class="wikilink codevar-wikilink" href="/variables/basic#tolvrs">tolvrs</a> in dataset 1?  Perhaps, but experience has shown that
this does not necessarily lead to as well-converged a potential, and it is not
recommended.  These same considerations apply to phonon calculations for
metals, or in particular to <a class="wikilink codevar-wikilink" href="/variables/gstate#qpt">qpt</a>= 0 0 0 phonon calculations for the
interatomic force constants needed to find atom-relaxation contributions to
the elastic constants for non-trivial structures as in section 2 and section 3.</p>
<p>The data specific to the elastic-tensor RF calculation in inner-loop dataset 4
should by now be familiar.  We take advantage of the fact that for cubic
symmetry the only symmetry-inequivalent elastic constants are C<span class="arithmatex">\(_{11}\)</span>, C<span class="arithmatex">\(_{12}\)</span>, and
C<span class="arithmatex">\(_{44}\)</span>.  Abinit, unfortunately, does not do this analysis automatically, so we
specify <a class="wikilink codevar-wikilink" href="/variables/dfpt#rfdir">rfdir</a> = 1 0 0 to avoid duplicate calculations.  (Note that if atom
relaxation is to be taken into account  for a more complex structure, the full
set of directions must be used.)</p>
<p>When the telast_6 calculations finish, first look at <em>telast_6.log</em> as usual to
make sure they have run to completion without error. Next, it would be a good
idea to look at the band occupancies occ?? (where ?? is a dual-loop dataset
index) reported at the end (following  <code>==END DATASET(S)==</code>).  The highest band,
the fourth in this case, should have zero or very small occupation, or you
need to increase <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> or decrease <a class="wikilink codevar-wikilink" href="/variables/gstate#tsmear">tsmear</a> .  Now, use your newly
perfected knowledge of the Abinit perturbation indexing conventions to scan
through <em>telast_6.abo</em> and find C<span class="arithmatex">\(_{11}\)</span> , C<span class="arithmatex">\(_{12}\)</span> , and C<span class="arithmatex">\(_{44}\)</span> for each of the three
<strong>k</strong> -sample choices, which will be  under the &rdquo; Rigid-atom elastic tensor&rdquo;
heading.  Also find the lattice constants for each case, whose convergence you
studied in <a href="/tutorial/base4">tutorial 4</a>.
You should be able to cut-and-paste these into a table like the following,</p>
<div class="codehilite"><pre><span></span><code>            C_11        C_12        C_44        acell
ngkpt=3*6   0.003844    0.002294    0.001377    7.585323
ngkpt=3*8   0.004409    0.002088    0.001355    7.583261
ngkpt=3*10  0.004392    0.002092    0.001354    7.583710
</code></pre></div>

<p>We can immediately see that the lattice constant converges considerably more
rapidly with <strong>k</strong> sample than the elastic constants.   For <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> =3*6,
acell is converged to 0.02%, while the C&rsquo;s have up to 15% error.  For <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a>
=3*8, the C&rsquo;s are converged to better than 0.5%, even for the largest,
C<span class="arithmatex">\(_{11}\)</span>, which should be acceptable.</p>
<p>As in <a href="/tutorial/base4">tutorial 4</a>, the <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> convergence is controlled by <a class="wikilink codevar-wikilink" href="/variables/gstate#tsmear">tsmear</a>.  The
smaller the broadening, the denser the <strong>k</strong> sample that is needed to get a
smooth variation of occupancy, and presumably stress, with strain.   While we
will not explore <a class="wikilink codevar-wikilink" href="/variables/gstate#tsmear">tsmear</a> convergence in this tutorial, you may wish to do so
on your own.</p>
<p>Also, even more than for the lattice parameter, the type of smearing
function plays an important role. The preferred smearing, <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a>=7,
apparently performs worse than the the standard Fermi-Dirac broadening
<a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a>=3 that we have used above. Indeed, with <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a>=7
and the same <a class="wikilink codevar-wikilink" href="/variables/gstate#tsmear">tsmear</a>=0.02, one obtains:</p>
<div class="codehilite"><pre><span></span><code>            C_11        C_12        C_44        acell
ngkpt=3*6   0.003113    0.002598    0.001575    7.543949
ngkpt=3*8   0.004447    0.001948    0.001441    7.542962
ngkpt=3*10  0.004781    0.001816    0.001233    7.544365
ngkpt=3*12  0.004257    0.002108    0.001244    7.545547
ngkpt=3*14  0.004056    0.002210    0.001300    7.545783
ngkpt=3*16  0.004230    0.002120    0.001316    7.545453
ngkpt=3*20  0.004271    0.002100    0.001311    7.545363
</code></pre></div>

<p>The reasons that this supposedly superior smoothing function performs poorly in this context
has not been investigated. Of course, <a class="wikilink codevar-wikilink" href="/variables/gstate#tsmear">tsmear</a> has a different meaning
in both cases, and perhaps the value of 0.02Ha (=6315 Kelvin) for <a class="wikilink codevar-wikilink" href="/variables/basic#occopt">occopt</a>=3 might yield a large error
anyhow (see the predicted <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a>).</p>
<p>The main thing to be learned is that checking
convergence with respect to all relevant parameters is <strong>always</strong> the user&rsquo;s
responsibility.   Simple systems that include the main physical features of a
complex system of interest will usually suffice for this testing.  Don&rsquo;t get
caught publishing a result that another researcher refutes on convergence
grounds, and do not blame such a mistake on Abinit!</p>
<p>Now we make a comparison with experiment.  Using the above computed values, converting the C&rsquo;s to standard
units (Ha/Bohr<span class="arithmatex">\(^3\)</span> = 2.94210119E+04 GPa) and using zero-temperature extrapolated
experimental results from P. M. Sutton, Phys. Rev. 91, 816 (1953) <a class="wikilink citation-wikilink" data-tippy-content="The Variation of the Elastic Constants of Crystalline Aluminum with Temperature between 63$^\circ$ K and 773$^\circ$ K" data-toggle="popover" href="/theory/bibliography#sutton1953">[Sutton1953]</a>, we find</p>
<div class="codehilite"><pre><span></span><code>                                  C_11(GPa)  C_12(GPa)  C_44(GPa)
Calculated (T=6315K)                129.2      61.5       39.8
Calculated (T=0K, Gaussian 0.02Ha)  125.6      61.8       38.6
Experiment (T=0K)                   123.0      70.8       30.9
</code></pre></div>

<p>Is this good agreement?  The numerical values are not yet definitive,
as one should do more convergence studies anyhow. This being said, there isn&rsquo;t much literature on DFT calculations of
full sets of elastic constants.  Many calculations of the bulk modulus
(K=(C<span class="arithmatex">\(_{11}\)</span>+2C<span class="arithmatex">\(_{12}\)</span> )/3 in the cubic case) typically are within 10% of experiment
for the LDA.  Running telast_6 with ixc=11, the Perdew-Burke-Enzerhof GGA,
increases the calculated C&rsquo;s by 1-2%, and wouldn&rsquo;t be expected to make a large
difference for a nearly-free-electron metal.</p>
<h3 id="comment-on-symmetry">Comment on symmetry<a class="headerlink" href="#comment-on-symmetry" title="Permanent link">&para;</a></h3>
<p>It is important to bear in mind that the way a tensor like the elastic tensor
appears is a function of the frame used. Thus for the aluminum fcc case
considered above, the nonzero elements are <em>C<span class="arithmatex">\(_{11}\)</span></em>, <em>C<span class="arithmatex">\(_{12}\)</span></em>, and <em>C<span class="arithmatex">\(_{44}\)</span></em>,
<em>provided that the crystal axes are aligned with the laboratory frame.</em>
For an arbitrary alignment of the crystal axes, many more <em>C<span class="arithmatex">\(_{ij}\)</span></em> elements will be
non-zero, and this can be confusing.</p>
<p>It is easy to see why this happens if you
imagine actually measuring the elastic tensor elements. If you start with the
conventional cubic cell, and apply pressure to one face, you can measure <em>C<span class="arithmatex">\(_{11}\)</span></em>.
 But if you turn the cell to some random angle, you&rsquo;ll measure a response
that is a mixture of <em>C<span class="arithmatex">\(_{11}\)</span></em> and <em>C<span class="arithmatex">\(_{12}\)</span></em>.</p>
<p>Within ABINIT, if the aluminum fcc
cell is described using <a class="wikilink codevar-wikilink" href="/variables/basic#angdeg">angdeg</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a>, then an axis of the
primitive cell will be aligned along the laboratory <em>z</em> axis but this will not
lead to a (conventional) cell alignment with the laboratory frame. The
resulting elastic tensor will be correct but will appear to be more
complicated than in the illustration above. It can be rotated back to a simple
frame by hand (bearing in mind that all four indices of the fourth-rank
elastic tensor have to be rotated!) but it&rsquo;s easier to start with a more
conventional alignment of the unit cell.</p>
<p>If you use a standard text like
Bradley and Cracknell, The Mathematical Theory of Symmetry in Solids, Oxford <a class="wikilink citation-wikilink" data-tippy-content="The mathematical theory of symmetry in solids: representation theory for point groups and space groups" data-toggle="popover" href="/theory/bibliography#bradley1972">[Bradley1972]</a>
you can find the standard primitive cell descriptions for the Bravais lattice
types and these are aligned as much as possible with a standard laboratory frame.</p>







  
  






                

<!--
Add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
               <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
               <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
               <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li>
            <a href="https://gmatteo.github.io/abinit/about/release-notes/"
               data-toggle="popover" data-tippy-content="About">
               <i class="fa fa-info-circle"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/developers/git_and_gitlab/"
               data-toggle="popover" data-tippy-content="Developers">
               <i class="fa fa-terminal"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/theory/geometry/"
               data-toggle="popover" data-tippy-content="Theory">
               <i class="fa fa-book"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/faq/configuration_and_compilation/"
               data-toggle="popover" data-tippy-content="FAQ">
               <i class="fa fa-graduation-cap"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/tutorial/"
               data-toggle="popover" data-tippy-content="Tutorials">
               <i class="fa fa-file-text-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/variables/"
               data-toggle="popover" data-tippy-content="Variables">
               <i class="fa fa-question"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/topics/features/"
               data-toggle="popover" data-tippy-content="Topics">
               <i class="fa fa-user-circle-o"></i>
            </a>
          </li>
        
          <li>
            <a href=""
               data-toggle="popover" data-tippy-content="User Guides">
               <i class="fa "></i>
            </a>
          </li>
        
        </ul>
      </div>
    </div>
  </div>
</div>

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="footer.title">
      
        <a href="../rttddft/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              RT-TDDFT
            </div>
          </div>
        </a>
      
      
        <a href="../nlo/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              nonlinear
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 10.4.7</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020-2024 The Abinit Group
            
            (DRH)
            
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/abinit/abinit" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305m-317.51 213.508V175.185l142.739 81.205z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="http://www.facebook.com/abinit.org" target="_blank" rel="noopener" title="www.facebook.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256c0 120 82.7 220.8 194.2 248.5V334.2h-52.8V256h52.8v-33.7c0-87.1 39.4-127.5 125-127.5 16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287v175.9C413.8 494.8 512 386.9 512 256"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/hashtag/abinit" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
</div>
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "header.autohide"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": "10.4.7"}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
  </body>
</html>