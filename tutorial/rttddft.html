
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Abinit documentation">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <link rel="canonical" href="https://gmatteo.github.io/abinit/tutorial/rttddft.html">
      
      
        <link rel="prev" href="tddft.html">
      
      
        <link rel="next" href="elastic.html">
      
      
      <link rel="icon" href="../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.43">
    
    
      
        <title>RT-TDDFT - abinit</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
    
      
    

    <!--
    IMPORTANT: Don't use boostrap in particular boostrap.css since it comes into conflict with mkdocs-material theme.
    Prefer low-level tools based on Jquery or JS library such as Tippyjs to get the work done.
    -->

    <!-- Jquery from Google CDN -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>
    -->

    <!-- jQuery Modal -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />

    <!-- Tippyjs for popovers https://atomiks.github.io/tippyjs/ -->
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />

    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <!-- MathJax support
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    -->

    <!-- This version is compatible with plotly. -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script>

    <!-- Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "boldsymbol.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // Workaround for bm package. See https://github.com/mathjax/MathJax/issues/1219
                bm: ["{\\boldsymbol #1}",1],
                // Mathcal symbols
                mcL: "{\\mathcal{L}}",
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // Acronyms
                KS: "{\\text{KS}}",
                eph: "{\\text{e-ph}}",
                ee: "{\\text{e-e}}",
                phph: "{\\text{ph-ph}}",
                FM: "{\\text{FM}}",
                DW: "{\\text{DW}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // Symbols commonly used (k-points, eigenvalues ...)
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                bg: "{\\bf g}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kG: "{\\bf k + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                nk: "{n \\kk}",
                mk: "{, \\kk}",
                nks: "{n \\kk\\sigma}",
                mks: "{m \\kk\\sigma}",
                enk: "{\\varepsilon_\\nk}",
                emkq: "{\\varepsilon_{m\\kk+\\qq}}",
                qnu: "{\\qq \\nu}",
                wqnu: "{\\omega_{\\qnu}}",
                vnk: "{\\mathbf{v}_{n\\kk}}",
                vmkq: "{\\mathbf{v}_{m\\kk+\\qq}}",
                vnka: "{\\mathrm{v}_{n\\kk,\\alpha}}",
                vnkb: "{\\mathrm{v}_{n\\kk,\\beta}}",
                ef: "{\\varepsilon_F}",
                // EPH quantities
                gkkp: "{g_{mn\\nu}(\\kk,\\qq)}",
                gkq: "{g_{mn\\nu}(\\kk,\\qq)}",
                //\newcommand{\gkkpL}{g_{mn\nu}^\Lc(\kb,\qb)}
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                Gove: "{\\overline{G}}",
                Gund: "{\\underline{G}}",
                // Greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    

    

    <!-- Load fonts used for input variables -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/extra.css">
    
      <link rel="stylesheet" href="../css/gallery.css">
    
      <link rel="stylesheet" href="../css/my_codehilite.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tutorial-on-real-time-time-dependent-dft" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="abinit" class="md-header__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../images/logo-abinit-2015.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            abinit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              RT-TDDFT
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../installation.html" class="md-tabs__link">
          
  
  User Guides

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../topics/features.html" class="md-tabs__link">
          
  
  Topics

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../variables/index.html" class="md-tabs__link">
          
  
  Variables

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="index.html" class="md-tabs__link">
          
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../faq/configuration_and_compilation.html" class="md-tabs__link">
          
  
  FAQ

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../theory/geometry.html" class="md-tabs__link">
          
  
  Theory

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../developers/git_and_gitlab.html" class="md-tabs__link">
          
  
  Developers

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../about/release-notes.html" class="md-tabs__link">
          
  
  About

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="abinit" class="md-nav__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../images/logo-abinit-2015.png" alt="logo">

    </a>
    abinit
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    User Guides
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            User Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_1" >
        
          
          <label class="md-nav__link" for="__nav_1_1" id="__nav_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Installation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_1">
            <span class="md-nav__icon md-icon"></span>
            Installation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HowTo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../INSTALL_MacOS.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MacOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../INSTALL_Ubuntu.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ubuntu
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../INSTALL_CentOS.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CentOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../INSTALL_EasyBuild.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EasyBuild
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../INSTALL_gpu.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GPUs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NewUser
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide/abinit.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide/abitk.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abitk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide/aim.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aim
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide/anaddb.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Anaddb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide/atdep.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aTDEP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide/cut3d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cut3d
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide/fold2bloch.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fold2Bloch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide/mrgddb.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mrgddb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide/mrgscr.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mrgscr
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide/multibinit.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multibinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide/optic.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide/respfn.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Respfn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guide/spacegroup.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spacegroup
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Topics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Topics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/features.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Topic List
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/Abipy.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abipy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/APPA.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    APPA
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/Artificial.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Artificial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/aTDEP.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aTDEP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/AtomCentered.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AtomCentered
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/AtomManipulator.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AtomManipulator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/AtomTypes.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AtomTypes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/Bader.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bader
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/Band2eps.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Band2eps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/Berry.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Berry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/BandOcc.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BandOcc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/BSE.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BSE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/BoundingProcess.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BoundingProcess
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/ConstrainedDFT.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ConstrainedDFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/ConstrainedPol.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ConstrainedPol
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/Control.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/Coulomb.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coulomb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/CrossingBarriers.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CrossingBarriers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/CalcUJ.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CalcUJ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/crystal.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Crystal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/DFT%2BU.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFT+U
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/DeltaSCF.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DeltaSCF
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/DensityPotential.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DensityPotential
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/Dev.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dev
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/DFPT.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/DMFT.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DMFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/DynamicsMultibinit.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DynamicsMultibinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/EffectiveMass.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EffectiveMass
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/EFG.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EFG
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/Elastic.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Elastic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/ElPhonInt.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ElPhonInt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/ElPhonTransport.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ElPhonTransport
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/ElecDOS.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ElecDOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/ElecBandStructure.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ElecBandStructure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/ExtFPMD.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ExtFPMD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/FileFormats.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FileFormats
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/FitProcess.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FitProcess
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/ForcesStresses.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForcesStresses
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/FrequencyMeshMBPT.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FrequencyMeshMBPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/GeoConstraints.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GeoConstraints
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/GeoOpt.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GeoOpt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/Git.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/GSintroduction.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GSintroduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/GW.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/GWR.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GWR
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/GWls.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GWls
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/Hybrids.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hybrids
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/Install.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/k-points.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    K points
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/LatticeModel.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LatticeModel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/LatticeWannier.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LatticeWannier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/LWFModel.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LWFModel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/LDAminushalf.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LDAminushalf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/LOTF.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LOTF
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/longwave.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Longwave
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/Macroave.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Macroave
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/MagField.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MagField
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/MagMom.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MagMom
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/MolecularDynamics.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MolecularDynamics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/multidtset.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multidtset
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/NMR.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NMR
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/nonlinear.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nonlinear
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/Optic.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/Output.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Output
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/parallelism.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallelism
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/PAW.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PAW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/PIMD.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PIMD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/Planewaves.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Planewaves
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/Phonons.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phonons
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/PhononBands.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PhononBands
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/PhononWidth.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PhononWidth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/Polaron.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Polaron
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/PortabilityNonRegression.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PortabilityNonRegression
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/positron.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Positron
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/printing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Printing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/PseudosPAW.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PseudosPAW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/q-points.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Q points
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/RandStopPow.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RandStopPow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/Recursion.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Recursion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/RPACorrEn.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RPACorrEn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/RTTDDFT.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RTTDDFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/SCFControl.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SCFControl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/SCFAlgorithms.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SCFAlgorithms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/SelfEnergy.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SelfEnergy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/SmartSymm.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SmartSymm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/spinpolarisation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spinpolarisation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/SpinDynamicsMultibinit.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SpinDynamicsMultibinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/STM.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    STM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/Susceptibility.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Susceptibility
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/TDDFT.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TDDFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/TDepES.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TDepES
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/Temperature.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Temperature
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/TransPath.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TransPath
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/TuningSpeedMem.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TuningSpeedMem
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/Unfolding.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unfolding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/UnitCell.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UnitCell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/vdw.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vdw
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/Verification.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Verification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/Wannier.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wannier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/Wavelets.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wavelets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/xc.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Xc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topics/external_resources.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    External Resources
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Variables
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Variables
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../variables/index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    All Variables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Abinit
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Abinit
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../variables/basic.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../variables/bse.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bethe-Salpeter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../variables/dev.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../variables/dmft.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DMFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../variables/eph.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Electron-Phonon
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../variables/ffield.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Varff
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../variables/files.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File-handling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../variables/geo.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geometry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../variables/gstate.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ground-State
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../variables/gw.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../variables/internal.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Internal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../variables/paral.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallelism
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../variables/paw.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PAW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../variables/dfpt.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../variables/rlx.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Relaxation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../variables/rttddft.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RTTDDFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../variables/vdw.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VdW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../variables/w90.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wannier90
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../variables/anaddb.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Anaddb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../variables/atdep.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aTDEP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../variables/multibinit.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multibinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../variables/optic.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../variables/aim.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aim
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../variables/external_parameters.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    External Parameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../variables/varset_stats.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Statistics
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Basic tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Basic tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="base1.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    basic1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="base2.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    basic2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="base3.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    basic3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="base4.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    basic4
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="abinit_build.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ABINIT_build
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="paw1.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PAW1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="spin.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="polarization.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Polarization & finite field
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="rf1.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFPT1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="rf2.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFPT2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="basepar.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallelism
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_10" >
        
          
          <label class="md-nav__link" for="__nav_4_10" id="__nav_4_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ABINIT postprocessors
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_10">
            <span class="md-nav__icon md-icon"></span>
            ABINIT postprocessors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="atdep1.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aTDEP1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="cut3d.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cut3D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="fold2bloch.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fold2bloch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="optic.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    optic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="wannier90.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wannier90
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="z2pack.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Z2pack
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_11" >
        
          
          <label class="md-nav__link" for="__nav_4_11" id="__nav_4_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DFT beyond basics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_11">
            <span class="md-nav__icon md-icon"></span>
            DFT beyond basics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="nuc.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    properties at the nucleus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="dftu.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFT+U
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ucalc_crpa.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cRPA U(J)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="lruj.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linear Response U(J)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="paw2.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PAW2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="paw3.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PAW3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="positron.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    positron
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_12" checked>
        
          
          <label class="md-nav__link" for="__nav_4_12" id="__nav_4_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Many-Body Theory & excitations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_12_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_12">
            <span class="md-nav__icon md-icon"></span>
            Many-Body Theory & excitations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="gw1.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GW1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="gw2.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GW2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="gwr_intro.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GWR_intro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="gwr1.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GWR1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="bse.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bethe-Salpeter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="dmft.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DMFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tddft.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TDDFT (Casida)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    RT-TDDFT
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="rttddft.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    RT-TDDFT
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-basics-of-rt-tddft" class="md-nav__link">
    <span class="md-ellipsis">
      1. Basics of RT-TDDFT
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-ground-state-of-diamond" class="md-nav__link">
    <span class="md-ellipsis">
      2. Ground state of diamond
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-real-time-tddft-and-stability" class="md-nav__link">
    <span class="md-ellipsis">
      3. Real-time TDDFT and stability
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-time-dependent-electric-field-and-current-density" class="md-nav__link">
    <span class="md-ellipsis">
      4. Time-dependent electric field and current density
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Time-dependent electric field and current density">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#convergence-study-optional" class="md-nav__link">
    <span class="md-ellipsis">
      Convergence study (Optional)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-conductivity-and-dielectric-function" class="md-nav__link">
    <span class="md-ellipsis">
      5. Conductivity and dielectric function
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_13" >
        
          
          <label class="md-nav__link" for="__nav_4_13" id="__nav_4_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DFPT & electron-phonon
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_13">
            <span class="md-nav__icon md-icon"></span>
            DFPT & electron-phonon
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="elastic.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    elastic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="nlo.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nonlinear
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="lattice_wannier.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lattice_wannier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="lw_quad.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    quadrupoles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="eph_intro.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph_intro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="eph4mob.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph for mobilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="eph4zpr.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph for zero-point renormalization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="eph4vpq.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph for variational polaron equations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="eph_legacy.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph_legacy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="eph_tdep_legacy.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph_tdep_legacy
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_14" >
        
          
          <label class="md-nav__link" for="__nav_4_14" id="__nav_4_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Multibinit
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_14">
            <span class="md-nav__icon md-icon"></span>
            Multibinit
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="multibinit.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    introduction to multibinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="lattice_model.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lattice_model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="spin_model.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spin_model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="lwf_model.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lwf_model
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_15" >
        
          
          <label class="md-nav__link" for="__nav_4_15" id="__nav_4_15_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Advanced parallelism
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_15">
            <span class="md-nav__icon md-icon"></span>
            Advanced parallelism
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="paral_bandpw.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_band_PW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="paral_gswvl.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_wavelets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="paral_moldyn.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_MD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="paral_images.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_images
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="paral_dfpt.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_DFPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="paral_mbt.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_MBPT
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            FAQ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/configuration_and_compilation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration and compilation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/general_questions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General questions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/pre_and_post_processing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pre/Post processing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/ground_state.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ground state
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/dfpt.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/Troubleshooting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Troubleshooting (old-dokuwiki)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/tuning_abinit.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tuning (old-dokuwiki)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Theory
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Theory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../theory/geometry.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geometry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../theory/spherical_harmonics.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spherical Harmonics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../theory/wavefunctions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wavefunctions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../theory/noncollinear.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Noncollinear
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../theory/pseudopotentials.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pseudopotentials
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../theory/mbt.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Many-Body Perturbation Theory
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../theory/bse.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bethe-Salpeter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../theory/documents.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Documents
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../theory/acknowledgments.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Acknowledgments
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../theory/bibliography.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bibliography
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../theory/acronyms.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Acronyms
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Developers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Developers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developers/git_and_gitlab.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git and Gitlab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developers/developers_howto.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HowTo for developers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developers/abimkdocs.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abimkdocs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developers/markdown.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Markdown
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_5" >
        
          
          <label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Test Suite
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_5">
            <span class="md-nav__icon md-icon"></span>
            Test Suite
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developers/testsuite.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test list
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developers/testsuite_howto.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Suite Howto
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developers/new_testsuite.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YAML-based test suite Howto
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developers/yaml_tools_api.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YAML-based test suite Python tools and API
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developers/XgType.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XgType
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_7" >
        
          
          <label class="md-nav__link" for="__nav_7_7" id="__nav_7_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pseudos
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_7">
            <span class="md-nav__icon md-icon"></span>
            Pseudos
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developers/psp1_info.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developers/psp3_info.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developers/psp45_info.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp45
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developers/psp5spinorbit_info.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp5
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developers/psp6_info.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp6
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developers/psp8_info.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp8
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developers/codestats.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code stats
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developers/autoconf_examples.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Autoconf_examples
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developers/testlink.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Page for linkcheck
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    About
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            About
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../about/release-notes.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release Notes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../about/contributing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../about/history.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    History
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../about/license.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-basics-of-rt-tddft" class="md-nav__link">
    <span class="md-ellipsis">
      1. Basics of RT-TDDFT
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-ground-state-of-diamond" class="md-nav__link">
    <span class="md-ellipsis">
      2. Ground state of diamond
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-real-time-tddft-and-stability" class="md-nav__link">
    <span class="md-ellipsis">
      3. Real-time TDDFT and stability
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-time-dependent-electric-field-and-current-density" class="md-nav__link">
    <span class="md-ellipsis">
      4. Time-dependent electric field and current density
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Time-dependent electric field and current density">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#convergence-study-optional" class="md-nav__link">
    <span class="md-ellipsis">
      Convergence study (Optional)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-conductivity-and-dielectric-function" class="md-nav__link">
    <span class="md-ellipsis">
      5. Conductivity and dielectric function
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                

                  

  
  


<h1 id="tutorial-on-real-time-time-dependent-dft">Tutorial on real-time time-dependent DFT<a class="headerlink" href="#tutorial-on-real-time-time-dependent-dft" title="Permanent link">&para;</a></h1>
<p>This tutorial aims at showing how to perform Real-Time TDDFT (RT-TDDFT) calculation using Abinit
to compute the dielectric function of Diamond here.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>RT-TDDFT is under active development and should thus be used with caution!</p>
</div>
<p>If you have not yet done any of the basic tutorials it might be useful to do
at least the first three: <a href="/tutorial/base1">basic1</a>, <a href="/tutorial/base2">basic2</a> and
<a href="/tutorial/base3">basic3</a>.
It could also be useful that you know a little bit about PAW calculations using Abinit.
If you are interested you can follow the first tutorial on PAW:
<a href="/tutorial/paw1">PAW1</a>.</p>
<p>This tutorial should take about two hours to complete, depending on the amount of
computing power you have access to and how much of the convergence study you decide to do.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Supposing you made your own installation of ABINIT, the input files to run the examples
are in the <em>~abinit/tests/</em> directory where <em>~abinit</em> is the <strong>absolute path</strong> of the abinit top-level directory.
If you have NOT made your own install, ask your system administrator where to find the package,
especially the executable and test files.</p>
<p>In case you work on your own PC or workstation, to make things easier, we suggest you define
some handy environment variables by executing the following lines in the terminal:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">ABI_HOME</span><span class="o">=</span>Replace_with_absolute_path_to_abinit_top_level_dir<span class="w"> </span><span class="c1"># Change this line</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/src/98_main/:<span class="nv">$PATH</span><span class="w">      </span><span class="c1"># Do not change this line: path to executable</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">ABI_TESTS</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/tests/<span class="w">             </span><span class="c1"># Do not change this line: path to tests dir</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">ABI_PSPDIR</span><span class="o">=</span><span class="nv">$ABI_TESTS</span>/Pspdir/<span class="w">  </span><span class="c1"># Do not change this line: path to pseudos dir</span>
</code></pre></div>
<p>Examples in this tutorial use these shell variables: copy and paste
the code snippets into the terminal (<strong>remember to set ABI_HOME first!</strong>) or, alternatively,
source the <code>set_abienv.sh</code> script located in the <em>~abinit</em> directory:</p>
<div class="highlight"><pre><span></span><code><span class="nb">source</span><span class="w"> </span>~abinit/set_abienv.sh
</code></pre></div>
<p>The &lsquo;export PATH&rsquo; line adds the directory containing the executables to your <a href="http://www.linfo.org/path_env_var.html">PATH</a>
so that you can invoke the code by simply typing <em>abinit</em> in the terminal instead of providing the absolute path.</p>
<p>To execute the tutorials, create a working directory (<code>Work*</code>) and
copy there the input files of the lesson.</p>
<p>Most of the tutorials do not rely on parallelism (except specific <a class="wikilink lesson-wikilink" href="/tutorial/basepar">tutorials on parallelism</a>).
However you can run most of the tutorial examples in parallel with MPI, see the <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a parallel calculation" data-toggle="popover" href="/topics/parallelism">topic on parallelism</a>.</p>
</div>
<h2 id="1-basics-of-rt-tddft">1. Basics of RT-TDDFT<a class="headerlink" href="#1-basics-of-rt-tddft" title="Permanent link">&para;</a></h2>
<p>Time-dependent DFT (TDDFT) has been developed in the 1980s as a generalization of
DFT to the time-dependent case and is based on similar theorems than the standard
Hohenberg and Kohn theorems. They were developed, in the general case, by
Runge and Gross <a class="wikilink citation-wikilink" data-tippy-content="Density-Functional Theory for Time-Dependent Systems" data-toggle="popover" href="/theory/bibliography#runge1984">[Runge1984]</a> establishing a one-to-one correspondence
between the time-dependent potential and the time-dependent density <span class="arithmatex">\(n(\vec{r},t)\)</span>.
In the spirit of Kohn and Sham, Runge and Gross introduced a non-interacting
system evolving in an effective time-dependent potential such that its density
is the same as the one of the interacting system of interest.
Further work by Van Leeuwen <a class="wikilink citation-wikilink" data-tippy-content="Mapping from Densities to Potentials in Time-Dependent Density-Functional Theory" data-toggle="popover" href="/theory/bibliography#vanleeuwen1999">[VanLeeuwen1999]</a> proved the existence of this
effective potential under some rather mild approximations.</p>
<p>Within this framework, one ends up with the so-called time-dependent Kohn-Sham (TDKS)
equations that have the same form as the time-dependent Shrdinger equation
\begin{equation}
    i\partial_t \psi_{nk}(\vec{r},t) = \hat{H} \psi_{nk}(\vec{r},t),
\end{equation}
but with the Hamiltonian being now a functional of the density and the initial
state <span class="arithmatex">\(\Psi^0\)</span>, <span class="arithmatex">\(\hat{H} \equiv \hat{H}[n,\Psi^0]\)</span>.
Note that formally the Hamiltonian is a functional of the density at all previous times
<em>ie.</em> it depends on the whole history. This is quite complicated to account for as
it requires a functional that is non-local both in time and space.
In the following, we will thus always work in the so-called <em>adiabatic approximation</em>
which discards this dependence on the past history and consider that the Hamiltonian
is a functional of the density at time <span class="arithmatex">\(t\)</span> only.</p>
<p>In the real-time formulation of TDDFT (RT-TDDFT), the TDKS equations are numerically
integrated in <em>real-time</em> by discretizing the time with a time step <span class="arithmatex">\(\Delta t\)</span>.
The propagator to go from time <span class="arithmatex">\(t\)</span> to <span class="arithmatex">\(t+\Delta t\)</span> can be approximated as
\begin{equation}
    \hat{U}(t,t+\Delta t) = \exp\left(-i\hat{H}\Delta t\right).
\end{equation}
In the present implementation only two simple propagators are available:
the so-called exponential rule (ER) and exponential midpoint rule (EMR)
propagators. In both of them, the exponential in the propagator is approximated
by a Taylor expansion, usually up to fourth order as it was found to be the best
choice to ensure good stability while minimizing computation time <a class="wikilink citation-wikilink" data-tippy-content="Propagators for the time-dependent KohnSham equations" data-toggle="popover" href="/theory/bibliography#castro2004">[Castro2004]</a>.
These two propagators differ only by the choice of the Hamiltonian used in the exponential.
The simplest ER propagator uses the Hamiltonian at time <span class="arithmatex">\(t\)</span>, while the EMR propagator
uses the Hamiltonian at time <span class="arithmatex">\(t+\Delta t/2\)</span>. This last choice ensures the correct
time reversal symmetry and is thus supposed to be better than the simple ER propagator.
It also introduces a self-consistency since one needs the density at time
<span class="arithmatex">\(t+\Delta t/2\)</span> to evolve the orbitals at time <span class="arithmatex">\(t\)</span>. This is solved by a
predictor-corrector scheme. See <a class="wikilink citation-wikilink" data-tippy-content="Propagators for the time-dependent KohnSham equations" data-toggle="popover" href="/theory/bibliography#castro2004">[Castro2004]</a> for more information
on propagators for the TDKS equations including the ER and EMR propagators.
More general information on TDDFT including its real-time formulation can be
found for instance in <a class="wikilink citation-wikilink" data-tippy-content="Time-Dependent Density-Functional Theory: Concepts and Applications" data-toggle="popover" href="/theory/bibliography#ullrich2011">[Ullrich2011]</a>.</p>
<p>TDDFT is usually used to study the response of a system to a time-dependent perturbation.
In Abinit it is possible to apply an impulse external electric field that allows
the computation of associated response functions: the electronic conductivity and the
dielectric function. This tutorial describes how to perform such calculation with Abinit.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The application of an external electric field in RT-TDDFT is only available in PAW.
We will thus work in this formalism throughout this tutorial.</p>
</div>
<h2 id="2-ground-state-of-diamond">2. Ground state of diamond<a class="headerlink" href="#2-ground-state-of-diamond" title="Permanent link">&para;</a></h2>
<p><em>Before beginning, you might consider working in a different subdirectory, as for the other tutorials.
Why not Work_rttddft? In what follows, the name of files are mentioned as if you were in such a
 subdirectory in $ABI_TESTS/tutorial.
All the input files can be found in the <code>$ABI_TESTS/tutorial/Input</code> directory.</em></p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>You can compare your results with reference output files located in
<code>$ABI_TESTS/tutorial/Refs</code> directories (for the present tutorial they
 are named <code>trttddft_*.abo</code>).</p>
</div>
<p>The first thing that a real-time TDDFT (RT-TDDFT) calculation needs is a set of initial orbitals.
In the following we will start our calculations from the ground state KS orbitals.
Thus let us start by computing the ground state orbitals of diamond.
This system was actually treated in details in the first PAW tutorial.
If you have not done this tutorial <a href="/tutorial/paw1">PAW1</a> it might be a good idea to do it first.</p>
<p>The input file <em>trttddft_1.abi</em> can be used to compute the ground state of diamond in PAW
with a description that is similar to what was used in the first PAW tutorial.
Notably, we use the same functional (LDA-PW) and the same atomic dataset.
Copy the <em>trttddft_1.abi</em> file in your work directory,</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span><span class="nv">$ABI_TESTS</span>/tutorial/Input
mkdir<span class="w"> </span>Work_rttddft
<span class="nb">cd</span><span class="w"> </span>Work_rttddft
cp<span class="w"> </span>../trttddft_1.abi<span class="w"> </span>.
</code></pre></div>
<p>and execute Abinit:</p>
<div class="codehilite"><pre><span></span><code>abinit trttddft_1.abi &gt;&amp; log
</code></pre></div>

<p>The code should run quickly.</p>
<p>You can have a look at the input file. It is similar to the input files from the first PAW tutorial.</p>
<div class="text-center"><button id="uuid-139a0e0a-6522-4274-8a30-3e752bee708b" class="md-button md-button--secondary"> View tests/tutorial/Input/trttddft_1.abi </button></div>
<div id="uuid-1dc191ab-14b7-4f50-aa5a-553a9b8cce12" class="my_dialog" title="tests/tutorial/Input/trttddft_1.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Input for RT-TDDFT tutorial</span>
<span class="c1"># Ground-state calculation</span>
<span class="c1"># Converged ecut and ngkpt for total energy</span>
<span class="c1"># Diamond at equilibrium volume</span>

<span class="c1">#Definition of the unit cell</span>
acell<span class="w"> </span><span class="m">3</span>*3.53<span class="w"> </span>angstrom<span class="w">  </span><span class="c1"># Lengths of the primitive vectors (equilibrium volume)</span>
rprim<span class="w">                  </span><span class="c1"># 3 orthogonal primitive vectors (FCC lattice)</span>
<span class="w">  </span><span class="m">0</span>.0<span class="w"> </span><span class="m">1</span>/2<span class="w"> </span><span class="m">1</span>/2
<span class="w">  </span><span class="m">1</span>/2<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">1</span>/2
<span class="w">  </span><span class="m">1</span>/2<span class="w"> </span><span class="m">1</span>/2<span class="w"> </span><span class="m">0</span>.0
nsym<span class="w"> </span><span class="m">0</span><span class="w">                 </span><span class="c1"># Automatic detection of symetries</span>

<span class="c1">#Definition of the atom types and pseudopotentials</span>
ntypat<span class="w"> </span><span class="m">1</span><span class="w">          </span><span class="c1"># There is only one type of atom</span>
znucl<span class="w"> </span><span class="m">6</span><span class="w">           </span><span class="c1"># Atomic number of the possible type(s) of atom. Here carbon.</span>
pp_dirpath<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span><span class="w">        </span><span class="c1"># Path to the directory where</span>
<span class="w">                                </span><span class="c1"># pseudopotentials for tests are stored</span>
pseudos<span class="w"> </span><span class="s2">&quot;Psdj_paw_pw_std/C.xml&quot;</span><span class="w"> </span><span class="c1"># PAW atomic data for Carbon</span>

<span class="c1">#Definition of the atoms</span>
natom<span class="w"> </span><span class="m">2</span><span class="w">           </span><span class="c1"># There are two atoms</span>
typat<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w">         </span><span class="c1"># They both are of type 1, that is, Carbon</span>
xred<span class="w">              </span><span class="c1"># Location of the atoms: Diamond structure</span>
<span class="w">  </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0<span class="w">     </span><span class="c1">#  Triplet giving the reduced coordinates of atom 1</span>
<span class="w">  </span><span class="m">1</span>/4<span class="w"> </span><span class="m">1</span>/4<span class="w"> </span><span class="m">1</span>/4<span class="w">     </span><span class="c1">#  Triplet giving the reduced coordinates of atom 2</span>

<span class="c1">#Definition of bands and occupation numbers</span>
nband<span class="w"> </span><span class="m">8</span><span class="w">           </span><span class="c1"># Compute 8 bands (4 occupied, 4 empty)</span>
nbdbuf<span class="w"> </span><span class="m">2</span><span class="w">          </span><span class="c1"># No need to converge the last two empty bands</span>
occopt<span class="w"> </span><span class="m">1</span><span class="w">          </span><span class="c1"># Automatic generation of occupation numbers, as a semiconductor</span>

<span class="c1">#Numerical parameters of the calculation : planewave basis set and k point grid</span>
ecut<span class="w"> </span><span class="m">18</span><span class="w">           </span><span class="c1"># Maximal plane-wave kinetic energy cut-off, in Hartree</span>
pawecutdg<span class="w"> </span><span class="m">36</span><span class="w">      </span><span class="c1"># Max. plane-wave kinetic energy cut-off, in Ha, for the PAW double grid</span>
kptopt<span class="w"> </span><span class="m">1</span><span class="w">          </span><span class="c1"># Automatic generation of k points, taking into account the symmetry</span>
ngkpt<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">6</span><span class="w">       </span><span class="c1"># k-points grid based on the primitive vectors</span>
nshiftk<span class="w"> </span><span class="m">4</span><span class="w">         </span><span class="c1"># of the reciprocal space, repeated four times,</span>
shiftk<span class="w">            </span><span class="c1"># with different shifts:</span>
<span class="w">  </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>.5
<span class="w">  </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0
<span class="w">  </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>.0
<span class="w">  </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.5
istwfk<span class="w"> </span>*1<span class="w">         </span><span class="c1"># Wavefunctions are complex for all k-points</span>
<span class="w">                  </span><span class="c1"># not needed here but necessary for further RT-TDDFT runs</span>

<span class="c1">#Parameters for the SCF procedure</span>
nstep<span class="w"> </span><span class="m">20</span><span class="w">          </span><span class="c1"># Maximum number of SCF cycles</span>
tolvrs<span class="w"> </span><span class="m">1</span>.0d-10<span class="w">    </span><span class="c1"># Will stop when, twice in a row, the difference</span>
<span class="w">                  </span><span class="c1"># between two consecutive evaluations of potential residual</span>
<span class="w">                  </span><span class="c1"># differ by less than tolvrs</span>

<span class="c1">#Miscelaneous parameters</span>
prtwf<span class="w"> </span><span class="m">1</span><span class="w">           </span><span class="c1"># Print wavefunctions (required for following RT-TDDFT runs)</span>
prtden<span class="w"> </span><span class="m">0</span><span class="w">          </span><span class="c1"># Do not print density</span>
prteig<span class="w"> </span><span class="m">0</span><span class="w">          </span><span class="c1"># Do not print eigenvalues</span>
prtebands<span class="w"> </span><span class="m">0</span><span class="w">       </span><span class="c1"># Do not print ebands</span>


<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = trttddft_1.abi, trttddft_2.abi, trttddft_3.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   trttddft_1.abo, tolnlines=  0, tolabs=  0.0, tolrel=  0.0, fld_options= -easy;</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 7</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = F. Brieuc</span>
<span class="c1">#%% keywords = RTTDDFT, PAW</span>
<span class="c1">#%% description =</span>
<span class="c1">#%%   Input for RT-TDDFT tutorial</span>
<span class="c1">#%%   Diamond at equilibrium volume</span>
<span class="c1">#%%   Ground-state calculation</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-1dc191ab-14b7-4f50-aa5a-553a9b8cce12", "#uuid-139a0e0a-6522-4274-8a30-3e752bee708b") }); </script>

<p>The values of the plane wave cut-off energy <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a>, the double grid (PAW) cut-off energy <a class="wikilink codevar-wikilink" href="/variables/paw#pawecutdg">pawecutdg</a>
and the <span class="arithmatex">\(k\)</span>-points grid defined by <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> are set to ensure a relatively good convergence of
the total energy and pressure. The cell parameter <a class="wikilink codevar-wikilink" href="/variables/basic#acell">acell</a> is chosen to work at the equilibrium
volume. Finally, we ask Abinit to write the wavefunctions in a file by setting <a class="wikilink codevar-wikilink" href="/variables/files#prtwf">prtwf</a> to 1,
as we will need to read this file to start the following real-time calculations.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you look carefully at the input, you may notice that the variable <a class="wikilink codevar-wikilink" href="/variables/rlx#ecutsm">ecutsm</a> was not set.
That is because RT-TDDFT is not compatible with that option and it is thus better to generate
the initial orbitals without it as well.
You may also notice that we set the variable <a class="wikilink codevar-wikilink" href="/variables/dev#istwfk">istwfk</a> to 1 for all <span class="arithmatex">\(k\)</span>-points, that is
because we cannot take advantage of time-reversal symmetry for the storage of wavefunctions
in RT-TDDFT.</p>
</div>
<h2 id="3-real-time-tddft-and-stability">3. Real-time TDDFT and stability<a class="headerlink" href="#3-real-time-tddft-and-stability" title="Permanent link">&para;</a></h2>
<p>Now that we have a set of initial orbitals we can run some time-dependent calculations.
You can copy the input file <em>trttddft_2.abi</em></p>
<div class="highlight"><pre><span></span><code>cp<span class="w"> </span>../trttddft_2.abi<span class="w"> </span>.
</code></pre></div>
<p>and run Abinit:</p>
<div class="codehilite"><pre><span></span><code>abinit trttddft_2.abi &gt;&amp; log
</code></pre></div>

<p>The code should run quickly.</p>
<p>If you have a look at the input file you will see that it is almost exactly the same as the previous
one except that a few keywords were added: <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> was set to 9 which tells the driver of Abinit
to run real-time TDDFT and the keyword <a class="wikilink codevar-wikilink" href="/variables/files#getwfk_filepath">getwfk_filepath</a> was used to read the initial wavefunctions
from the previous ground state calculation.</p>
<div class="text-center"><button id="uuid-6bbcacca-1ef3-4b06-9708-f7349e43f280" class="md-button md-button--secondary"> View tests/tutorial/Input/trttddft_2.abi </button></div>
<div id="uuid-7b78ae3f-5922-4088-82a9-b0f744f94763" class="my_dialog" title="tests/tutorial/Input/trttddft_2.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Input for RT-TDDFT tutorial</span>
<span class="c1"># RT-TDDFT calculation</span>
<span class="c1"># with default values for all parameters</span>
<span class="c1"># Diamond at equilibrium volume</span>

<span class="c1"># RT-TDDFT section</span>
optdriver<span class="w"> </span><span class="m">9</span><span class="w">        </span><span class="c1"># RT-TDDFT</span>
getwfk_filepath<span class="w"> </span><span class="s2">&quot;trttddft_1o_WFK&quot;</span>

<span class="c1">#Definition of the unit cell</span>
acell<span class="w"> </span><span class="m">3</span>*3.53<span class="w"> </span>angstrom<span class="w">  </span><span class="c1"># Lengths of the primitive vectors (equilibrium volume)</span>
rprim<span class="w">                  </span><span class="c1"># 3 orthogonal primitive vectors (FCC lattice)</span>
<span class="w">  </span><span class="m">0</span>.0<span class="w"> </span><span class="m">1</span>/2<span class="w"> </span><span class="m">1</span>/2
<span class="w">  </span><span class="m">1</span>/2<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">1</span>/2
<span class="w">  </span><span class="m">1</span>/2<span class="w"> </span><span class="m">1</span>/2<span class="w"> </span><span class="m">0</span>.0
nsym<span class="w"> </span><span class="m">0</span><span class="w">                 </span><span class="c1"># Automatic detection of symetries</span>

<span class="c1">#Definition of the atom types and pseudopotentials</span>
ntypat<span class="w"> </span><span class="m">1</span><span class="w">          </span><span class="c1"># There is only one type of atom</span>
znucl<span class="w"> </span><span class="m">6</span><span class="w">           </span><span class="c1"># Atomic number of the possible type(s) of atom. Here carbon.</span>
pp_dirpath<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span><span class="w">        </span><span class="c1"># Path to the directory where</span>
<span class="w">                                </span><span class="c1"># pseudopotentials for tests are stored</span>
pseudos<span class="w"> </span><span class="s2">&quot;Psdj_paw_pw_std/C.xml&quot;</span><span class="w"> </span><span class="c1"># PAW atomic data for Carbon</span>

<span class="c1">#Definition of the atoms</span>
natom<span class="w"> </span><span class="m">2</span><span class="w">           </span><span class="c1"># There are two atoms</span>
typat<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w">         </span><span class="c1"># They both are of type 1, that is, Carbon</span>
xred<span class="w">              </span><span class="c1"># Location of the atoms: Diamond structure</span>
<span class="w">  </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0<span class="w">     </span><span class="c1">#  Triplet giving the reduced coordinates of atom 1</span>
<span class="w">  </span><span class="m">1</span>/4<span class="w"> </span><span class="m">1</span>/4<span class="w"> </span><span class="m">1</span>/4<span class="w">     </span><span class="c1">#  Triplet giving the reduced coordinates of atom 2</span>

<span class="c1">#Definition of bands and occupation numbers</span>
nband<span class="w"> </span><span class="m">8</span><span class="w">           </span><span class="c1"># Compute 8 bands (4 occupied, 4 empty)</span>
nbdbuf<span class="w"> </span><span class="m">2</span><span class="w">          </span><span class="c1"># No need to converge the last two empty bands</span>
occopt<span class="w"> </span><span class="m">1</span><span class="w">          </span><span class="c1"># Automatic generation of occupation numbers, as a semiconductor</span>

<span class="c1">#Numerical parameters of the calculation : planewave basis set and k point grid</span>
ecut<span class="w"> </span><span class="m">18</span><span class="w">           </span><span class="c1"># Maximal plane-wave kinetic energy cut-off, in Hartree</span>
pawecutdg<span class="w"> </span><span class="m">36</span><span class="w">      </span><span class="c1"># Max. plane-wave kinetic energy cut-off, in Ha, for the PAW double grid</span>
kptopt<span class="w"> </span><span class="m">1</span><span class="w">          </span><span class="c1"># Automatic generation of k points, taking into account the symmetry</span>
ngkpt<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">6</span><span class="w">       </span><span class="c1"># k-points grid based on the primitive vectors</span>
nshiftk<span class="w"> </span><span class="m">4</span><span class="w">         </span><span class="c1"># of the reciprocal space, repeated four times,</span>
shiftk<span class="w">            </span><span class="c1"># with different shifts:</span>
<span class="w">  </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>.5
<span class="w">  </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0
<span class="w">  </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>.0
<span class="w">  </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.5
istwfk<span class="w"> </span>*1<span class="w">         </span><span class="c1"># Wavefunctions are complex for all k-points</span>

<span class="c1">#Parameters for the SCF procedure</span>
nstep<span class="w"> </span><span class="m">20</span><span class="w">          </span><span class="c1"># Maximum number of SCF cycles</span>
tolvrs<span class="w"> </span><span class="m">1</span>.0d-10<span class="w">    </span><span class="c1"># Will stop when, twice in a row, the difference</span>
<span class="w">                  </span><span class="c1"># between two consecutive evaluations of potential residual</span>
<span class="w">                  </span><span class="c1"># differ by less than tolvrs</span>

<span class="c1">#Miscelaneous parameters</span>
prtwf<span class="w"> </span><span class="m">0</span><span class="w">           </span><span class="c1"># Do not print wavefunctions</span>
prtden<span class="w"> </span><span class="m">0</span><span class="w">          </span><span class="c1"># Do not print density</span>
prteig<span class="w"> </span><span class="m">0</span><span class="w">          </span><span class="c1"># Do not print eigenvalues</span>
prtebands<span class="w"> </span><span class="m">0</span><span class="w">       </span><span class="c1"># Do not print ebands</span>


<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = trttddft_1.abi, trttddft_2.abi, trttddft_3.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   trttddft_2.abo, tolnlines=  0, tolabs=  0.0, tolrel=  0.0, fld_options= -medium;</span>
<span class="c1">#%%   trttddft_2o_TDENER, tolnlines=  0, tolabs=  0.0, tolrel=  0.0, fld_options= -medium;</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 7</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = F. Brieuc</span>
<span class="c1">#%% keywords = RTTDDFT, PAW</span>
<span class="c1">#%% description =</span>
<span class="c1">#%%   Input for RT-TDDFT tutorial</span>
<span class="c1">#%%   Diamond at equilibrium volume</span>
<span class="c1">#%%   RT-TDDFT calculation with default values for all parameters</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-7b78ae3f-5922-4088-82a9-b0f744f94763", "#uuid-6bbcacca-1ef3-4b06-9708-f7349e43f280") }); </script>

<p>If you have a look at the output (<em>trttddft_2.abo</em>) or the log file you will see that Abinit has read
the previous ground state orbitals and started a RT-TDDFT run as expected. However, it only performed one step
which is not very useful.
That is because we did not set the number of time steps to perform. We can do so using the variable <a class="wikilink codevar-wikilink" href="/variables/rlx#ntime">ntime</a>.
Change the value of <a class="wikilink codevar-wikilink" href="/variables/rlx#ntime">ntime</a> by editing the input file and try running maybe about 50 time steps for now
to get a feeling of the time it takes.
You may notice that additional files have been created. The file called <em>TD_RESTART</em> contains some information
needed to restart a RT-TDDFT run if one wants to continue a calculation. In that case, the variable
<a class="wikilink codevar-wikilink" href="/variables/rttddft#td_restart">td_restart</a> should be set to 1. The file <em>trttddft_2o_TDENER</em> contains the total energy and its decomposition into
the different contributions as a function of time. You can have a look at this file and try to plot the total
energy as well as some energy contributions. You should find that the total energy as well as all
contributions remain constant. This is to be expected as we started from the ground state orbitals
 which are <em>stationary states</em>.
If we do not perturb the system then running a time-dependent calculation does not make much sense.
Various type of perturbations could be applied such as an external electric field which will
be discussed in the following. But let us stay in that special stationary case for now to study the
stability of the integration.</p>
<p>In order to do so, copy the input file <em>trttddft_3.abi</em> and run Abinit.</p>
<div class="text-center"><button id="uuid-201546e4-e40b-4b4c-84b7-1963935badaf" class="md-button md-button--secondary"> View tests/tutorial/Input/trttddft_3.abi </button></div>
<div id="uuid-af22df84-31a1-4c2a-b55e-48535d630c48" class="my_dialog" title="tests/tutorial/Input/trttddft_3.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Input for RT-TDDFT tutorial</span>
<span class="c1"># RT-TDDFT calculation</span>
<span class="c1"># using different time steps</span>
<span class="c1"># Diamond at equilibrium volume</span>

ndtset<span class="w"> </span><span class="m">4</span>

<span class="c1"># RT-TDDFT section</span>
optdriver<span class="w"> </span><span class="m">9</span><span class="w">        </span><span class="c1"># RT-TDDFT</span>
getwfk_filepath<span class="w"> </span><span class="s2">&quot;trttddft_1o_WFK&quot;</span>
td_exp_order<span class="w"> </span><span class="m">4</span>
<span class="c1"># Study of the stability of the integration with dtele</span>
<span class="c1"># ntime chosen such that the integration time remains constant</span>
dtele1<span class="w"> </span><span class="m">0</span>.05
dtele2<span class="w"> </span><span class="m">0</span>.10
dtele3<span class="w"> </span><span class="m">0</span>.15
dtele4<span class="w"> </span><span class="m">0</span>.20
ntime1<span class="w"> </span><span class="m">200</span>
ntime2<span class="w"> </span><span class="m">100</span>
ntime3<span class="w"> </span><span class="m">67</span>
ntime4<span class="w"> </span><span class="m">50</span>

<span class="c1">#Definition of the unit cell</span>
acell<span class="w"> </span><span class="m">3</span>*3.53<span class="w"> </span>angstrom<span class="w">  </span><span class="c1"># Lengths of the primitive vectors (equilibrium volume)</span>
rprim<span class="w">                  </span><span class="c1"># 3 orthogonal primitive vectors (FCC lattice)</span>
<span class="w">  </span><span class="m">0</span>.0<span class="w"> </span><span class="m">1</span>/2<span class="w"> </span><span class="m">1</span>/2
<span class="w">  </span><span class="m">1</span>/2<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">1</span>/2
<span class="w">  </span><span class="m">1</span>/2<span class="w"> </span><span class="m">1</span>/2<span class="w"> </span><span class="m">0</span>.0
nsym<span class="w"> </span><span class="m">0</span><span class="w">                 </span><span class="c1"># Automatic detection of symetries</span>

<span class="c1">#Definition of the atom types and pseudopotentials</span>
ntypat<span class="w"> </span><span class="m">1</span><span class="w">          </span><span class="c1"># There is only one type of atom</span>
znucl<span class="w"> </span><span class="m">6</span><span class="w">           </span><span class="c1"># Atomic number of the possible type(s) of atom. Here carbon.</span>
pp_dirpath<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span><span class="w">        </span><span class="c1"># Path to the directory where</span>
<span class="w">                                </span><span class="c1"># pseudopotentials for tests are stored</span>
pseudos<span class="w"> </span><span class="s2">&quot;Psdj_paw_pw_std/C.xml&quot;</span><span class="w"> </span><span class="c1"># PAW atomic data for Carbon</span>

<span class="c1">#Definition of the atoms</span>
natom<span class="w"> </span><span class="m">2</span><span class="w">           </span><span class="c1"># There are two atoms</span>
typat<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w">         </span><span class="c1"># They both are of type 1, that is, Carbon</span>
xred<span class="w">              </span><span class="c1"># Location of the atoms: Diamond structure</span>
<span class="w">  </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0<span class="w">     </span><span class="c1">#  Triplet giving the reduced coordinates of atom 1</span>
<span class="w">  </span><span class="m">1</span>/4<span class="w"> </span><span class="m">1</span>/4<span class="w"> </span><span class="m">1</span>/4<span class="w">     </span><span class="c1">#  Triplet giving the reduced coordinates of atom 2</span>

<span class="c1">#Definition of bands and occupation numbers</span>
nband<span class="w"> </span><span class="m">8</span><span class="w">           </span><span class="c1"># Compute 8 bands (4 occupied, 4 empty)</span>
nbdbuf<span class="w"> </span><span class="m">2</span><span class="w">          </span><span class="c1"># No need to converge the last two empty bands</span>
occopt<span class="w"> </span><span class="m">1</span><span class="w">          </span><span class="c1"># Automatic generation of occupation numbers, as a semiconductor</span>

<span class="c1">#Numerical parameters of the calculation : planewave basis set and k point grid</span>
ecut<span class="w"> </span><span class="m">18</span><span class="w">           </span><span class="c1"># Maximal plane-wave kinetic energy cut-off, in Hartree</span>
pawecutdg<span class="w"> </span><span class="m">36</span><span class="w">      </span><span class="c1"># Max. plane-wave kinetic energy cut-off, in Ha, for the PAW double grid</span>
kptopt<span class="w"> </span><span class="m">1</span><span class="w">          </span><span class="c1"># Automatic generation of k points, taking into account the symmetry</span>
ngkpt<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">6</span><span class="w">       </span><span class="c1"># k-points grid based on the primitive vectors</span>
nshiftk<span class="w"> </span><span class="m">4</span><span class="w">         </span><span class="c1"># of the reciprocal space, repeated four times,</span>
shiftk<span class="w">            </span><span class="c1"># with different shifts:</span>
<span class="w">  </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>.5
<span class="w">  </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0
<span class="w">  </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>.0
<span class="w">  </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.5
istwfk<span class="w"> </span>*1<span class="w">         </span><span class="c1"># Wavefunctions are complex for all k-points</span>

<span class="c1">#Parameters for the SCF procedure</span>
nstep<span class="w"> </span><span class="m">20</span><span class="w">          </span><span class="c1"># Maximum number of SCF cycles</span>
tolvrs<span class="w"> </span><span class="m">1</span>.0d-10<span class="w">    </span><span class="c1"># Will stop when, twice in a row, the difference</span>
<span class="w">                  </span><span class="c1"># between two consecutive evaluations of potential residual</span>
<span class="w">                  </span><span class="c1"># differ by less than tolvrs</span>

<span class="c1">#Miscelaneous parameters</span>
prtwf<span class="w"> </span><span class="m">0</span><span class="w">           </span><span class="c1"># Do not print wavefunctions</span>
prtden<span class="w"> </span><span class="m">0</span><span class="w">          </span><span class="c1"># Do not print density</span>
prteig<span class="w"> </span><span class="m">0</span><span class="w">          </span><span class="c1"># Do not print eigenvalues</span>
prtebands<span class="w"> </span><span class="m">0</span><span class="w">       </span><span class="c1"># Do not print ebands</span>


<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = trttddft_1.abi, trttddft_2.abi, trttddft_3.abi</span>
<span class="c1">#%% expected_failure = yes</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   trttddft_3o_DS1_TDENER, tolnlines=  0, tolabs=  0.0, tolrel=  0.0, fld_options= -medium;</span>
<span class="c1">#%%   trttddft_3o_DS2_TDENER, tolnlines=  0, tolabs=  0.0, tolrel=  0.0, fld_options= -medium;</span>
<span class="c1">#%%   trttddft_3o_DS3_TDENER, tolnlines=  0, tolabs=  0.0, tolrel=  0.0, fld_options= -medium;</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 7</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = F. Brieuc</span>
<span class="c1">#%% keywords = RTTDDFT, PAW</span>
<span class="c1">#%% description =</span>
<span class="c1">#%%   Input for RT-TDDFT tutorial</span>
<span class="c1">#%%   Diamond at equilibrium volume</span>
<span class="c1">#%%   RT-TDDFT calculation with different values of dtele</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-af22df84-31a1-4c2a-b55e-48535d630c48", "#uuid-201546e4-e40b-4b4c-84b7-1963935badaf") }); </script>

<p>This run takes a little longer, you can parallelize it by launching Abinit with mpirun if you have access
to several cores and that your executable has been correctly compiled with MPI, see <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a parallel calculation" data-toggle="popover" href="/topics/parallelism">topic_parallelism</a>.
A basic parallelisation over <span class="arithmatex">\(k\)</span>-points by simply running Abinit with mpirun is enough.
There are 28 <span class="arithmatex">\(k\)</span>-points and the best is of course to use a number that divides it, so you could use
2, 4, 7, 14 or even 28 processors.</p>
<p>The time-dependent Kohn-Sham (TDKS) equations are highly non-linear and their integration can be a little
tricky which is why there exists many different propagators (see <a class="wikilink citation-wikilink" data-tippy-content="Propagators for the time-dependent KohnSham equations" data-toggle="popover" href="/theory/bibliography#castro2004">[Castro2004]</a>).
The stability of the integration depends essentially on the propagator and the time step <a class="wikilink codevar-wikilink" href="/variables/rttddft#dtele">dtele</a>.
As of now, only simple propagators, namely the exponential rule (ER) and the exponential midpoint
rule (EMR) propagators, are implemented in Abinit.
The keyword <a class="wikilink codevar-wikilink" href="/variables/rttddft#td_propagator">td_propagator</a> can be used to setup the integrator: if set to 0 then the simple ER propagator
is used which is the default, if set to 1 then the EMR propagator is used. Here, we will only used the
ER propagator for simplicity since it is enough in this case.
If you look at the input file you can see that there are several datasets now in which the time step
for the electrons <a class="wikilink codevar-wikilink" href="/variables/rttddft#dtele">dtele</a> changes. The number of time steps also changes to ensure that we integrate
the TDKS equations over a fix amount of time (~ 0.5 fs here).</p>
<p>If you look at the output or log file, you will see that the last dataset stopped with the following error:</p>
<div class="highlight"><pre><span></span><code>The<span class="w"> </span>integrated<span class="w"> </span>density<span class="w"> </span>has<span class="w"> </span>changed<span class="w"> </span>by<span class="w"> </span>more<span class="w"> </span>than<span class="w"> </span><span class="m">10</span>%!
The<span class="w"> </span>integration<span class="w"> </span>is<span class="w"> </span>unstable,<span class="w"> </span>you<span class="w"> </span>should<span class="w"> </span>probably<span class="w"> </span>decrease<span class="w"> </span>the<span class="w"> </span>timestep<span class="w"> </span>dtele.
</code></pre></div>
<p>That is because the integration was not stable. The code stopped because the electronic density integrated
over the whole volume, which should be equal to the total number of electrons, has changed by more than 10 %.
Indeed this quantity should be constant and is used by Abinit to check the stability. Its value is written
in the output files and one can thus easily check its time evolution for instance by typing</p>
<div class="highlight"><pre><span></span><code>grep<span class="w"> </span><span class="s1">&#39;Integrated density&#39;</span><span class="w"> </span>trttddft_3.abo
</code></pre></div>
<p>One can also check the stability of the integration by checking that the total energy is well conserved during
the integration. In order to do so, you can simply plot the third column of the file <em>trttddft_3o_TDENER</em> and you
should get something similar to the following figure.</p>
<p><img alt="Stability of total energy with different values of the time step." src="rttddft_assets/stability.png" /></p>
<p>The integration becomes clearly unstable for time steps greater than <span class="arithmatex">\(0.15\)</span> au. Unfortunately, the integration can become
unstable for longer integration times even if it appears stable here. We will thus keep a timestep of <span class="arithmatex">\(0.1\)</span> au to be safe.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The order of the Taylor approximation used to approximate the exponential in the propagator will also have
an important impact on the stability of the integration. If you are interested, you can change the value of
the variable <a class="wikilink codevar-wikilink" href="/variables/rttddft#td_exp_order">td_exp_order</a> to investigate its effect on the stability.
You should find that the default value of 4 is the best choice.</p>
</div>
<h2 id="4-time-dependent-electric-field-and-current-density">4. Time-dependent electric field and current density<a class="headerlink" href="#4-time-dependent-electric-field-and-current-density" title="Permanent link">&para;</a></h2>
<p>We can now use RT-TDDFT to study the response of diamond to an external impulse electric field.
Such calculations allow the computation of the associated response functions ie. the electronic conductivity
from which one can also obtain the dielectric function as we will see in the last part of this tutorial.</p>
<p>The external electric field is added through an additional vector potential <span class="arithmatex">\(\vec{A}(t)\)</span> in the Hamiltonian
\begin{equation}
    \hat{H} = \frac{1}{2} \left[-i\vec{\nabla} + \vec{A}(t) \right]^2 + v_{KS}(\vec{r},t).
\end{equation}
This perturbation will generate a time-dependent macroscopic current density
\begin{equation}
    \vec{J}(t) = \frac{i}{\Omega} \sum_{nk} \left[ w_k f_{nk} \langle \psi_{nk}(t) | \vec{\nabla} | \psi_{nk}(t) \rangle \right]
                 - \frac{N\vec{A}(t)}{\Omega},
\end{equation}
with <span class="arithmatex">\(w_k\)</span> the weight of the <span class="arithmatex">\(k\)</span>-point, <span class="arithmatex">\(f_{nk}\)</span> the occupations, <span class="arithmatex">\(N\)</span> the total number of electrons and
<span class="arithmatex">\(\Omega\)</span> the volume of the simulation cell. In practice, the expressions for the Hamiltonian and the current
density include additional term coming from PAW that we do not include here for clarity. Moreover, there
are some subtleties related to gauge invariance and the non locality of the PAW transformation that we decide
not to discuss here for simplicity.</p>
<p>The application of an external electric field is set by switching the value of the variable <a class="wikilink codevar-wikilink" href="/variables/rttddft#td_ef_type">td_ef_type</a> to 1.
This will trigger the application of an impulse external electric field <span class="arithmatex">\(\vec{E}(t) = \vec{E}_0\delta(t-t_0)\)</span>.
The associated vector potential is given by
\begin{equation}
    \vec{A}(t) = -{\int}_0^t \vec{E}(t&rsquo;)dt&rsquo; = -\vec{E}_0 \Theta(t-t_0),
\end{equation}
with <span class="arithmatex">\(\Theta(t-t_0)\)</span> the Heaviside function.
The intensity is given by the parameter <a class="wikilink codevar-wikilink" href="/variables/rttddft#td_ef_ezero">td_ef_ezero</a> in atomic units, the direction is given by the
variable <a class="wikilink codevar-wikilink" href="/variables/rttddft#td_ef_pol">td_ef_pol</a> and the value of the time at which this Dirac pulse is applied is controlled by the
parameter <a class="wikilink codevar-wikilink" href="/variables/rttddft#td_ef_tzero">td_ef_tzero</a>.
By default the field is applied along <span class="arithmatex">\(\vec{e}_x\)</span>, its intensity is <span class="arithmatex">\(0.1\)</span> au and it is applied at time <span class="arithmatex">\(t=0\)</span>.
We will keep most of these default values here and simply change <span class="arithmatex">\(t_0\)</span> so we can clearly see the time at which
the field is switched on.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only impulse electric fields are implemented for now. Note that this is the best choice if one is interested
in response functions as such a perturbation is exciting all frequencies equally.</p>
</div>
<p>In order to launch the next calculation with the electric field, you should first copy the input <em>trttddft_4.abi</em>
and run Abinit again. From now on the calculations will take more time and, if you can, it may be better to run
in parallel. That is because we have to work now in the full Brillouin zone. Indeed the application of the
time-dependent electric field will break some symmetries and we thus cannot make use of them to reduce the
number of <span class="arithmatex">\(k\)</span>-points.
The variable <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> is thus set to 3 and, as a consequence, the total number of <span class="arithmatex">\(k\)</span>-points is now much larger.
If you have a look at the input file you can see that the value of <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> used to define the <span class="arithmatex">\(k\)</span>-points grid
was reduced to 2 2 2 instead of the previous 6 6 6 to decrease the computation time. Unfortunately,
this is not enough to converge as we will see in the following. You can have a look at the input file.</p>
<div class="text-center"><button id="uuid-91ddafc1-28ee-4879-814b-7c991cdb5cef" class="md-button md-button--secondary"> View tests/tutorial/Input/trttddft_4.abi </button></div>
<div id="uuid-5aab1f6a-0a3e-451d-b663-153cdbcce6bb" class="my_dialog" title="tests/tutorial/Input/trttddft_4.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Input for RT-TDDFT tutorial</span>
<span class="c1"># RT-TDDFT calculation</span>
<span class="c1"># Diamond at equilibrium volume</span>
<span class="c1"># First dataset: ground state calculation</span>
<span class="c1"># Second dataset: RT-TDDFT with impulsive electric field</span>

ndtset<span class="w"> </span><span class="m">2</span>

<span class="c1"># RT-TDDFT section</span>
optdriver2<span class="w"> </span><span class="m">9</span>
getwfk2<span class="w"> </span>-1<span class="w">         </span><span class="c1"># Read initial orbitals from the first dataset</span>
dtele<span class="w">  </span><span class="m">0</span>.10<span class="w">        </span><span class="c1"># Electronic time step</span>
ntime<span class="w"> </span><span class="m">100</span><span class="w">          </span><span class="c1"># Maximum number or time step</span>
td_ef_type<span class="w"> </span><span class="m">1</span><span class="w">       </span><span class="c1"># Impulse electric field</span>
td_ef_tzero<span class="w"> </span><span class="m">1</span>.0<span class="w">    </span><span class="c1"># applied at time tzero</span>

<span class="c1">#Definition of the unit cell</span>
acell<span class="w"> </span><span class="m">3</span>*3.53<span class="w"> </span>angstrom<span class="w">  </span><span class="c1"># Lengths of the primitive vectors (equilibrium volume)</span>
rprim<span class="w">                  </span><span class="c1"># 3 orthogonal primitive vectors (FCC lattice)</span>
<span class="w">  </span><span class="m">0</span>.0<span class="w"> </span><span class="m">1</span>/2<span class="w"> </span><span class="m">1</span>/2
<span class="w">  </span><span class="m">1</span>/2<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">1</span>/2
<span class="w">  </span><span class="m">1</span>/2<span class="w"> </span><span class="m">1</span>/2<span class="w"> </span><span class="m">0</span>.0
nsym<span class="w"> </span><span class="m">0</span><span class="w">                 </span><span class="c1"># Automatic detection of symetries</span>

<span class="c1">#Definition of the atom types and pseudopotentials</span>
ntypat<span class="w"> </span><span class="m">1</span><span class="w">          </span><span class="c1"># There is only one type of atom</span>
znucl<span class="w"> </span><span class="m">6</span><span class="w">           </span><span class="c1"># Atomic number of the possible type(s) of atom. Here carbon.</span>
pp_dirpath<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span><span class="w">        </span><span class="c1"># Path to the directory where</span>
<span class="w">                                </span><span class="c1"># pseudopotentials for tests are stored</span>
pseudos<span class="w"> </span><span class="s2">&quot;Psdj_paw_pw_std/C.xml&quot;</span><span class="w"> </span><span class="c1"># PAW atomic data for Carbon</span>

<span class="c1">#Definition of the atoms</span>
natom<span class="w"> </span><span class="m">2</span><span class="w">           </span><span class="c1"># There are two atoms</span>
typat<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w">         </span><span class="c1"># They both are of type 1, that is, Carbon</span>
xred<span class="w">              </span><span class="c1"># Location of the atoms: Diamond structure</span>
<span class="w">  </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0<span class="w">     </span><span class="c1">#  Triplet giving the reduced coordinates of atom 1</span>
<span class="w">  </span><span class="m">1</span>/4<span class="w"> </span><span class="m">1</span>/4<span class="w"> </span><span class="m">1</span>/4<span class="w">     </span><span class="c1">#  Triplet giving the reduced coordinates of atom 2</span>

<span class="c1">#Definition of bands and occupation numbers</span>
nband<span class="w"> </span><span class="m">8</span><span class="w">           </span><span class="c1"># Compute 8 bands (4 occupied, 4 empty)</span>
nbdbuf<span class="w"> </span><span class="m">2</span><span class="w">          </span><span class="c1"># No need to converge the last two empty bands</span>
occopt<span class="w"> </span><span class="m">1</span><span class="w">          </span><span class="c1"># Automatic generation of occupation numbers, as a semiconductor</span>

<span class="c1">#Numerical parameters of the calculation : planewave basis set and k point grid</span>
ecut<span class="w"> </span><span class="m">18</span><span class="w">           </span><span class="c1"># Maximal plane-wave kinetic energy cut-off, in Hartree</span>
pawecutdg<span class="w"> </span><span class="m">36</span><span class="w">      </span><span class="c1"># Max. plane-wave kinetic energy cut-off, in Ha, for the PAW double grid</span>
kptopt<span class="w"> </span><span class="m">3</span><span class="w">          </span><span class="c1"># Automatic generation of k points, no taking symmetry into account</span>
ngkpt<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w">       </span><span class="c1"># k-points grid based on the primitive vectors</span>
nshiftk<span class="w"> </span><span class="m">4</span><span class="w">         </span><span class="c1"># of the reciprocal space, repeated four times,</span>
shiftk<span class="w">            </span><span class="c1"># with different shifts:</span>
<span class="w">  </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>.5
<span class="w">  </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0
<span class="w">  </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>.0
<span class="w">  </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.5
istwfk<span class="w"> </span>*1<span class="w">         </span><span class="c1"># Wavefunctions are complex for all k-points</span>

<span class="c1">#Parameters for the SCF procedure</span>
nstep<span class="w"> </span><span class="m">20</span><span class="w">          </span><span class="c1"># Maximal number of SCF cycles</span>
tolvrs<span class="w"> </span><span class="m">1</span>.0d-10<span class="w">    </span><span class="c1"># Will stop when, twice in a row, the difference</span>
<span class="w">                  </span><span class="c1"># between two consecutive evaluations of potential residual</span>
<span class="w">                  </span><span class="c1"># differ by less than tolvrs</span>
tolwfr<span class="w"> </span><span class="m">1</span>.0d-20<span class="w">    </span><span class="c1"># Additional convergence criterion on the largest residual</span>
<span class="w">                  </span><span class="c1"># to ensure that wavefunctions are also tighlty converged</span>
<span class="w">                  </span><span class="c1"># as they will be used as initial conditions for the following</span>
<span class="w">                  </span><span class="c1"># RT-TDDFT run</span>

<span class="c1">#Miscelaneous parameters</span>
prtwf1<span class="w"> </span><span class="m">1</span><span class="w">          </span><span class="c1"># Print wavefunctions (required for following RT-TDDFT runs)</span>
prtwf2<span class="w"> </span><span class="m">0</span><span class="w">          </span><span class="c1"># Do not print wavefunctions at each step during RT-TDDFT</span>
prtden<span class="w"> </span><span class="m">0</span><span class="w">          </span><span class="c1"># Do not print density</span>
prteig<span class="w"> </span><span class="m">0</span><span class="w">          </span><span class="c1"># Do not print eigenvalues</span>
prtebands<span class="w"> </span><span class="m">0</span><span class="w">       </span><span class="c1"># Do not print ebands</span>
prtcurrent<span class="w"> </span><span class="m">1</span><span class="w">      </span><span class="c1"># Print current</span>


<span class="c1">##############################################################</span>
<span class="c1"># This section is used only for regression testing of ABINIT #</span>
<span class="c1">##############################################################</span>
<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   trttddft_4.abo, tolnlines=  0, tolabs=  0.0, tolrel=  0.0, fld_options= -medium ;</span>
<span class="c1">#%%   trttddft_4o_DS2_TDENER, tolnlines=  0, tolabs=  0.0, tolrel=  0.0, fld_options= -medium ;</span>
<span class="c1">#%%   trttddft_4o_DS2_TDCURRENT, tolnlines=  0, tolabs=  0.0, tolrel=  0.0, fld_options -=medium ;</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 8</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = F. Brieuc</span>
<span class="c1">#%% keywords = RTTDDFT, PAW</span>
<span class="c1">#%% description =</span>
<span class="c1">#%%   Input for RT-TDDFT tutorial</span>
<span class="c1">#%%   Diamond at equilibrium volume</span>
<span class="c1">#%%   RT-TDDFT calculation with TD electric field</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-5aab1f6a-0a3e-451d-b663-153cdbcce6bb", "#uuid-91ddafc1-28ee-4879-814b-7c991cdb5cef") }); </script>

<p>A few additional keywords <a class="wikilink codevar-wikilink" href="/variables/rttddft#td_ef_type">td_ef_type</a> and <a class="wikilink codevar-wikilink" href="/variables/rttddft#td_ef_tzero">td_ef_tzero</a> were added. Moreover, we now use two datasets.
The first one performs a ground state calculation to generate the initial wavefunctions while the second one runs
the RT-TDDFT calculation.
This way will be easier if we want to do a convergence study with respect to different parameters such as <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a>
or <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> as we will need to generate the ground state wavefunctions with the same parameters every time.
Two new files were created: <em>trttddft_4o_TDEFIELD</em> which contains the time evolution of the electric field as well
as the associated vector potential and <em>trttddft_4o_TDCURRENT</em> which contains the time evolution of the macroscopic
current density.
If you look at this file you can see that a macroscopic current density is induced by the application of the
electric field for <span class="arithmatex">\(t \geq t_0\)</span>. Before <span class="arithmatex">\(t_0\)</span>, there is no global current in the system as expected. That would not
be the case if we did not set <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> to 3. Moreover, as we applied an electric field in the <span class="arithmatex">\(x\)</span> direction,
the induced current density only appeared in that direction. That would also not have been the case if we did not
use <a class="wikilink codevar-wikilink" href="/variables/basic#kptopt">kptopt</a> 3.</p>
<h3 id="convergence-study-optional">Convergence study (Optional)<a class="headerlink" href="#convergence-study-optional" title="Permanent link">&para;</a></h3>
<p>We should now make sure that all the parameters are correctly chosen to ensure a proper convergence of the current
density as this is the central property here. This will require to launch several calculations with varying parameters
which can take some time especially if you do not have access to several processors to run in parallel.
In that case, it is probably better to not run the whole convergence study.</p>
<p>Let us start by studying the convergence of the current density with respect to the cutoff energy.
To do so you can modify the <em>trttddft_4.abi</em> input file and run for different values of <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> maybe
something like 8, 10, 12, 14 and 16 Ha. You should also increase <a class="wikilink codevar-wikilink" href="/variables/rlx#ntime">ntime</a> to a larger value to check
the convergence of the current density on a sufficient propagation time. You can try using <a class="wikilink codevar-wikilink" href="/variables/rlx#ntime">ntime</a>
around 800.
We can perform this study keeping <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> to 2 2 2 to save computation time.
If you do so and plot the current density you should get the same results as what is displayed on the
following figure.</p>
<p><img alt="Convergence of the induced current density with respect to ecut." src="rttddft_assets/cv_ecut.png" /></p>
<p>Clearly the current density is not too sensitive to the value of <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> and seems to be converged from
<a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> <span class="arithmatex">\(\gt 10\)</span> Ha. To ensure that we remain relatively converged in terms of total energy and pressure
we will keep <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> to 14 Ha in the following.
The current density is even less sensitive to the value of <a class="wikilink codevar-wikilink" href="/variables/paw#pawecutdg">pawecutdg</a> and we will just keep
it at twice the value of <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> that is 28 Ha in the following.</p>
<p>Now we switch to the convergence with respect to the number of <span class="arithmatex">\(k\)</span>-points. Again, this is now going to
take more time to run and you should consider running in parallel.
We now run similar calculations keeping <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> constant and varying the value of <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a>.
You can maybe try 2 2 2, 4 4 4, 6 6 6 and 8 8 8 to start. You can use a lower value of <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> if you
wish to decrease the computation time. You should find that the current density is significantly
impacted by the value of <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> and that the previous value of 6 6 6 is not enough
to converge it. The following figure shows the current density obtained with
different number <span class="arithmatex">\(k\)</span>-points keeping <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> fixed to 10 Ha and <a class="wikilink codevar-wikilink" href="/variables/paw#pawecutdg">pawecutdg</a> to 20 Ha.</p>
<p><img alt="Convergence of the induced current density with respect to ngkpt." src="rttddft_assets/cv_kpt.png" /></p>
<p>The current density clearly requires a large number of <span class="arithmatex">\(k\)</span>-points and it seems that we need to use
more than 4000 <span class="arithmatex">\(k\)</span>-points to converge over the integration time considered here.
It appears that converging the current density at short times is relatively easy but longer trajectories
require more <span class="arithmatex">\(k\)</span>-points. That means high frequencies will be easier to converge but accessing
low frequencies will be more demanding. In the following we will keep <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> to 8 8 8 with
four shifts so 2048 <span class="arithmatex">\(k\)</span>-points even though we see that we should use higher values to ensure
a fine convergence of the current density.</p>
<h2 id="5-conductivity-and-dielectric-function">5. Conductivity and dielectric function<a class="headerlink" href="#5-conductivity-and-dielectric-function" title="Permanent link">&para;</a></h2>
<p>The optical conductivity tensor <span class="arithmatex">\(\sigma_{\alpha\beta}\)</span> can be obtained from the Fourier transform
of the induced current density and the external electric field using the following relation
\begin{equation}
    \sigma_{\alpha\beta}(\omega) = \frac{J_\alpha(\omega)}{E_\beta(\omega)}.
\end{equation}
This equation is the well-known Ohm&rsquo;s law which translate the fact that, within linear response theory,
the conductivity is the response function that links the induced current density and the applied
external electric field.
The dielectric tensor can then be obtained directly from the conductivity tensor using the
following relation
\begin{equation}
    \epsilon_{\alpha\beta}(\omega) = \delta_{\alpha\beta} + 4\pi i\frac{\sigma_{\alpha\beta}(\omega)}{\omega}.
\end{equation}</p>
<p>A python script to perform the Fourier transform of the current density and compute the conductivity and
the dielectric tensor called <em>analyze_rtttddft.py</em> is available in <em>$ABI_HOME/scripts/post_processing</em>.
Let us first look at what we obtain already with the results from the previous convergence study on
the current density by using the <em>analyze_rtttddft.py</em> script to analyze the results of one of
your previous calculation. To do so you can run the following command</p>
<p><div class="highlight"><pre><span></span><code>python3<span class="w"> </span><span class="nv">$ABI_HOME</span>/scripts/post_processing/analyze_rtttddft.py<span class="w"> </span>-c<span class="w"> </span>trttddft_4o_DS2_TDCURRENT<span class="w"> </span>-e<span class="w"> </span>dirac<span class="w"> </span>-ez<span class="w"> </span><span class="m">0</span>.1<span class="w"> </span>-d<span class="w"> </span>x<span class="w"> </span>-wc<span class="w"> </span><span class="m">0</span>.01<span class="w"> </span>-ts<span class="w"> </span><span class="m">1</span><span class="w"> </span>-p<span class="w"> </span><span class="m">8</span>
</code></pre></div>
A description of the different options of this script can be obtained by typing</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span><span class="nv">$ABI_HOME</span>/scripts/post_processing/analyze_rtttddft.py<span class="w"> </span>-h
</code></pre></div>
<p>Here we use already quite a few that should give some rather good results:</p>
<ul>
<li><em>-c</em> gives the path to the file containing the current density (<em>TDCURRENT</em> file)</li>
<li><em>-e dirac</em> tells the script that the electric field is a Dirac pulse</li>
<li><em>-ez</em> gives the intensity of the applied impulse electric field (in atomic units)</li>
<li><em>-d</em> indicates by which direction of the electric field we wish to divide. It corresponds to the value of <span class="arithmatex">\(\beta\)</span> in equation (6) and (7)</li>
<li><em>-wc</em> is the cutoff angular frequency <span class="arithmatex">\(\omega_c\)</span> (in Ha) of a decaying exponential window <span class="arithmatex">\(\exp(-\omega_ct)\)</span> that is applied to the signal.
Such window leads to a convolution of the Fourier transform of the signal with a Lorentzian of width <span class="arithmatex">\(\Gamma=2\omega_c\)</span> in frequency space and is mostly used to smooth/broaden the results.</li>
<li><em>-ts</em> applies a time shift discarding all times before <em>ts</em> which is mostly used to effectively set the time at which the electric field is applied to zero.</li>
<li><em>-p</em> is to use zero-padding on the signal. This will artificially increase the number of points used in the Fourier transform by a factor of <em>p</em> which in turn increases the number of frequencies and thus helps getting a better resolution in frequency space.</li>
</ul>
<p>If you use the script to compute the dielectric function from the current densities obtained with different number of <span class="arithmatex">\(k\)</span>-points during
the convergence study of the previous section you should get results similar to the ones presented on the next figure.</p>
<p><img alt="Convergence of the dielectric function with respect to ngkpt." src="rttddft_assets/dielectric_kpt.png" /></p>
<p>Fortunately, the global shape of the dielectric function does not seem to be as sensitive to the number of <span class="arithmatex">\(k\)</span>-points than the
current density and it looks like a value of <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> to 8 8 8 is already able to give relatively well converged results.
In the following, we will thus use <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> 14 and <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> 8 8 8 which should give acceptable results in a reasonable computation time.
Clearly, if we are interested in fine details of the dielectric function than one should use a larger number of <span class="arithmatex">\(k\)</span>-points and
probably also a slightly higher value of <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a>.</p>
<p>Before launching the final calculation to compute the conductivity and the dielectric function we should decide how long the trajectory should be.
This is mostly defined by the frequency range we want to study and the resolution we need in frequency space.
For diamond, we know that the dielectric function exhibits interesting features for energies <span class="arithmatex">\(\hbar\omega\)</span> between 4 and 20 eV (see next figure).
The maximum frequency that can be sampled is <span class="arithmatex">\(f_{max} = 1/dt\)</span> which is directly related to the time step <span class="arithmatex">\(dt\)</span>.
In our case we used a time step <span class="arithmatex">\(dt = 0.1\)</span> au <span class="arithmatex">\(\approx 2.4\,10^{-3}\)</span> fs, which corresponds to an energy of about <span class="arithmatex">\(1700\)</span> eV that is much higher than
what we are interested in. The minimum frequency that can be sampled is given by <span class="arithmatex">\(f_{min} = f_{max}/N\)</span>.
So the total number of steps <span class="arithmatex">\(N\)</span> will directly define the minimum frequency that can theoretically be accessed.
As we are interested in energies down to a few eV, a 100 steps should already be enough. However this minimum frequency also defines the resolution
in frequency space <span class="arithmatex">\(\Delta f = f_{min}\)</span>. This frequency step <span class="arithmatex">\(\Delta f\)</span> needs to be small enough to accurately resolve the variations of the
conductivity and the dielectric function. In practice here, it needs to be much smaller and we need to at least perform a few thousands steps
(about 2000 steps should give good results).</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can easily restart a RT-TDDFT calculation using the <a class="wikilink codevar-wikilink" href="/variables/rttddft#td_restart">td_restart</a> input variable.
Thus you can start with a relatively short trajectory first and increase its length as required.
Note that it is also possible to artificially increase the frequency resolution by using zero-padding
(<em>-p</em> option of the script <em>analyze_rtttddft.py</em>).</p>
</div>
<p>Now, we can launch our final calculation using <a class="wikilink codevar-wikilink" href="/variables/rlx#ntime">ntime</a> 2000, <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> 8 8 8 and <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> 14 to ensure acceptable convergence.
Unfortunately, this is now quite a long calculation that can take more than an hour even if running on several cores.
The dielectric function obtained after running such calculation is presented on the following figure (orange line).
It is compared to the results from <a class="wikilink citation-wikilink" data-tippy-content="Long-range contribution to the exchange-correlation kernel of time-dependent density functional theory" data-toggle="popover" href="/theory/bibliography#botti2004">[Botti2004]</a> obtained using linear-response TDDFT (LR-TDDFT) in the LDA approximation (blue line)
 and to experimental results (grey dots) from <a class="wikilink citation-wikilink" data-tippy-content="Handbook of Optical Constants of Solids" data-toggle="popover" href="/theory/bibliography#edwards1985">[Edwards1985]</a>.</p>
<p><img alt="Dielectric function of Diamond computed with RT-TDDFT using Abinit compared to LR-TDDFT and experiment." src="rttddft_assets/dielectric_final.png" /></p>
<p>Clearly, the implementation in Abinit is able to retrieve the correct dielectric function and compares well with LR-TDDFT
using similar approximations. Moreover, the results we obtained are also quite close to the experimental ones.
One can notice however that our spectrum is &ldquo;more noisy&rdquo; than the one obtained using LR-TDDFT.
This effect can be mitigated by increasing the number of <span class="arithmatex">\(k\)</span>-points as can be seen from the dielectric function obtained
using a larger number of <span class="arithmatex">\(k\)</span>-points (green line).
In the case of diamond, TDDFT in the adiabatic approximation describes relatively well the dielectric function but that is
not the case for all systems, see for instance <a class="wikilink citation-wikilink" data-tippy-content="Long-range contribution to the exchange-correlation kernel of time-dependent density functional theory" data-toggle="popover" href="/theory/bibliography#botti2004">[Botti2004]</a> for different cases.</p>







  
  






                

<!--
Add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
               <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
               <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
               <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li>
            <a href="https://gmatteo.github.io/abinit/about/release-notes.html"
               data-toggle="popover" data-tippy-content="About">
               <i class="fa fa-info-circle"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/developers/git_and_gitlab.html"
               data-toggle="popover" data-tippy-content="Developers">
               <i class="fa fa-terminal"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/theory/geometry.html"
               data-toggle="popover" data-tippy-content="Theory">
               <i class="fa fa-book"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/faq/configuration_and_compilation.html"
               data-toggle="popover" data-tippy-content="FAQ">
               <i class="fa fa-graduation-cap"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/tutorial/index.html"
               data-toggle="popover" data-tippy-content="Tutorials">
               <i class="fa fa-file-text-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/variables/index.html"
               data-toggle="popover" data-tippy-content="Variables">
               <i class="fa fa-question"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/topics/features.html"
               data-toggle="popover" data-tippy-content="Topics">
               <i class="fa fa-user-circle-o"></i>
            </a>
          </li>
        
          <li>
            <a href=""
               data-toggle="popover" data-tippy-content="User Guides">
               <i class="fa "></i>
            </a>
          </li>
        
        </ul>
      </div>
    </div>
  </div>
</div>

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="footer.title">
      
        <a href="tddft.html" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              TDDFT (Casida)
            </div>
          </div>
        </a>
      
      
        <a href="elastic.html" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              elastic
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 10.4.7</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020-2024 The Abinit Group
            
            (FBrieuc)
            
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/abinit/abinit" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305m-317.51 213.508V175.185l142.739 81.205z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="http://www.facebook.com/abinit.org" target="_blank" rel="noopener" title="www.facebook.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256c0 120 82.7 220.8 194.2 248.5V334.2h-52.8V256h52.8v-33.7c0-87.1 39.4-127.5 125-127.5 16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287v175.9C413.8 494.8 512 386.9 512 256"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/hashtag/abinit" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
</div>
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "header.autohide"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": "10.4.7"}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../extra_javascript/abidocs.js"></script>
      
    
  </body>
</html>