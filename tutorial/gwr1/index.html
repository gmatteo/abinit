
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Abinit documentation">
      
      
        <meta name="author" content="The Abinit group">
      
      
        <link rel="canonical" href="https://gmatteo.github.io/abinit/tutorial/gwr1/">
      
      
        <link rel="prev" href="../gwr_intro/">
      
      
        <link rel="next" href="../bse/">
      
      
      <link rel="icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.43">
    
    
      
        <title>GWR1 - abinit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
    
      
    

    <!--
    IMPORTANT: Don't use boostrap in particular boostrap.css since it comes into conflict with mkdocs-material theme.
    Prefer low-level tools based on Jquery or JS library such as Tippyjs to get the work done.
    -->

    <!-- Jquery from Google CDN -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Load Jquery UI -->
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <!-- Handle jQuery plugin naming conflict between jQuery UI and Bootstrap
    https://stackoverflow.com/questions/13731400/jqueryui-tooltips-are-competing-with-twitter-bootstrap
    <script>
      $.widget.bridge('uibutton', $.ui.button);
      $.widget.bridge('uitooltip', $.ui.tooltip);
    </script>
    -->

    <!-- jQuery Modal -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />

    <!-- Tippyjs for popovers https://atomiks.github.io/tippyjs/ -->
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>

    <!-- font-awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

    <!--Pace support. http://github.hubspot.com/pace/ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/white/pace-theme-big-counter.min.css" />

    <script>
        paceOptions = {
            ajax: true,      // disabled
            document: true,  // activated
            eventLag: false  // disabled
            //target: 'article'
            //elements: {selectors: ['.my-page']}
        };
    </script>

    <!-- MathJax support
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    -->

    <!-- This version is compatible with plotly. -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG">
    </script>

    <!-- Configure MathJax to produce automatic equation numbers http://docs.mathjax.org/en/latest/tex.html -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        //jax: ["input/TeX","output/HTML-CSS"],
        //tex2jax: {inlineMath: [['$','$']]},
        //displayAlign: "center",
        TeX: {
            equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "boldsymbol.js"],
            Macros: {
                "*": "{\\dagger}",
                "ra": "{\\rangle}",
                "la": "{\\langle}",
                // Workaround for bm package. See https://github.com/mathjax/MathJax/issues/1219
                bm: ["{\\boldsymbol #1}",1],
                // Mathcal symbols
                mcL: "{\\mathcal{L}}",
                mcG: "{\\mathcal{G}}",
                mcR: "{\\mathcal{R}}",
                mcS: "{\\mathcal{S}}",
                mcC: "{\\mathcal{C}}",
                mcO: "{\\mathcal{O}}",
                // Acronyms
                KS: "{\\text{KS}}",
                eph: "{\\text{e-ph}}",
                ee: "{\\text{e-e}}",
                phph: "{\\text{ph-ph}}",
                FM: "{\\text{FM}}",
                DW: "{\\text{DW}}",
                QP: "{\\text{QP}}",
                BZ: "{\\text{BZ}}",
                sign: "{\\text{sign}}",
                xc: "{\\text{xc}}",
                tchi: "{\\tilde\\chi}",
                // Symbols commonly used (k-points, eigenvalues ...)
                rr: "{\\bf r}",
                RR: "{\\bf R}",
                tt: "{\\bf t}",
                GG: "{\\bf G}",
                bg: "{\\bf g}",
                kk: "{\\bf k}",
                qq: "{\\bf q}",
                kq: "{\\kk + \\qq}",
                qG: "{\\bf q + G}",
                kG: "{\\bf k + G}",
                kmq: "{\\kk - \\qq}",
                kpq: "{\\kk + \\qq}",
                kpG: "{\\kk + \\GG}",
                qpG: "{\\qq + \\GG}",
                nk: "{n \\kk}",
                mk: "{, \\kk}",
                nks: "{n \\kk\\sigma}",
                mks: "{m \\kk\\sigma}",
                enk: "{\\varepsilon_\\nk}",
                emkq: "{\\varepsilon_{m\\kk+\\qq}}",
                qnu: "{\\qq \\nu}",
                wqnu: "{\\omega_{\\qnu}}",
                vnk: "{\\mathbf{v}_{n\\kk}}",
                vmkq: "{\\mathbf{v}_{m\\kk+\\qq}}",
                vnka: "{\\mathrm{v}_{n\\kk,\\alpha}}",
                vnkb: "{\\mathrm{v}_{n\\kk,\\beta}}",
                ef: "{\\varepsilon_F}",
                // EPH quantities
                gkkp: "{g_{mn\\nu}(\\kk,\\qq)}",
                gkq: "{g_{mn\\nu}(\\kk,\\qq)}",
                //\newcommand{\gkkpL}{g_{mn\nu}^\Lc(\kb,\qb)}
                // Many-body theory
                Go: "{G_0}",
                Wo: "{W_0}",
                Ueff: "{U_{\\text{eff}}}",
                Gove: "{\\overline{G}}",
                Gund: "{\\underline{G}}",
                // Greek symbols + tilde version
                ee: "{\\epsilon}",
                tee: "{\\tilde{\\epsilon}}",
                ww: "{\\omega}",
                tww: "{\\tilde\\omega}",
                dd: "{\\,\\text{d}}",
                vxc: "{v_\\xc}",
                // symrel
                Ri: "{\\mcR^{-1}}",
                Rit: "{\\mcR^{-1\\tau}}",
                // symrec
                Si: "{\\mcS^{-1}}}",
                Sit: "{\\Si^\\tau}}",
                // partial and functional derivative.
                PDER: ["{\\dfrac{\\partial #1}{\\partial #2}}", 2],
                FDER: ["{\\dfrac{\\delta #1}{\\delta #2}}", 2],
                // PAW
                tPsi: "{\\tilde\\Psi}",
                tpsi: "{\\tilde\\psi}",
                tPhi: "{\\tilde\\Phi}",
                tphi: "{\\tilde\\phi}",
                tprj: "{\\tilde p}"
            }
          }
      });
    </script>

    

    

    <!-- Load fonts used for input variables -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../css/gallery.css">
    
      <link rel="stylesheet" href="../../css/my_codehilite.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#first-tutorial-on-gwr-gw-in-real-space-and-imaginary-time" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="abinit" class="md-header__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            abinit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              GWR1
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../installation/" class="md-tabs__link">
          
  
  User Guides

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../topics/features/" class="md-tabs__link">
          
  
  Topics

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../variables/" class="md-tabs__link">
          
  
  Variables

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../faq/configuration_and_compilation/" class="md-tabs__link">
          
  
  FAQ

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../theory/geometry/" class="md-tabs__link">
          
  
  Theory

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../developers/git_and_gitlab/" class="md-tabs__link">
          
  
  Developers

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../about/release-notes/" class="md-tabs__link">
          
  
  About

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="abinit" class="md-nav__button md-logo" aria-label="abinit" data-md-component="logo">
      
  <img src="../../images/logo-abinit-2015.png" alt="logo">

    </a>
    abinit
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/abinit/abinit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    github-abinit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    User Guides
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            User Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_1" >
        
          
          <label class="md-nav__link" for="__nav_1_1" id="__nav_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Installation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_1">
            <span class="md-nav__icon md-icon"></span>
            Installation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HowTo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_MacOS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MacOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_Ubuntu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ubuntu
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_CentOS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CentOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_EasyBuild/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EasyBuild
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../INSTALL_gpu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GPUs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NewUser
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/abitk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abitk
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/aim/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aim
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/anaddb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Anaddb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/atdep/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aTDEP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/cut3d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cut3d
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/fold2bloch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fold2Bloch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgddb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mrgddb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/mrgscr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mrgscr
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/multibinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multibinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/optic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/respfn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Respfn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/spacegroup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spacegroup
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Topics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Topics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Topic List
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Abipy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abipy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/APPA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    APPA
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Artificial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Artificial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/aTDEP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aTDEP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomCentered/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AtomCentered
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomManipulator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AtomManipulator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/AtomTypes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AtomTypes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Bader/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bader
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Band2eps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Band2eps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Berry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Berry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BandOcc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BandOcc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BSE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BSE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/BoundingProcess/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BoundingProcess
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedDFT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ConstrainedDFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ConstrainedPol/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ConstrainedPol
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Coulomb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coulomb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CrossingBarriers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CrossingBarriers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/CalcUJ/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CalcUJ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/crystal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Crystal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFT%2BU/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFT+U
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DeltaSCF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DeltaSCF
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DensityPotential/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DensityPotential
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Dev/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dev
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DFPT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DMFT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DMFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/DynamicsMultibinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DynamicsMultibinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EffectiveMass/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EffectiveMass
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/EFG/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EFG
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Elastic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Elastic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonInt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ElPhonInt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElPhonTransport/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ElPhonTransport
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecDOS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ElecDOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ElecBandStructure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ElecBandStructure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ExtFPMD/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ExtFPMD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FileFormats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FileFormats
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FitProcess/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FitProcess
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/ForcesStresses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForcesStresses
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/FrequencyMeshMBPT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FrequencyMeshMBPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoConstraints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GeoConstraints
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GeoOpt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GeoOpt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Git/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GSintroduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GSintroduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GW/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWR/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GWR
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/GWls/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GWls
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Hybrids/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hybrids
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/k-points/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    K points
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeModel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LatticeModel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LatticeWannier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LatticeWannier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LWFModel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LWFModel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LDAminushalf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LDAminushalf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/LOTF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LOTF
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/longwave/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Longwave
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Macroave/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Macroave
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagField/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MagField
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MagMom/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MagMom
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/MolecularDynamics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MolecularDynamics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/multidtset/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multidtset
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/NMR/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NMR
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/nonlinear/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nonlinear
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Optic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Output/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Output
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/parallelism/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallelism
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PAW/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PAW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PIMD/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PIMD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Planewaves/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Planewaves
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Phonons/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phonons
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononBands/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PhononBands
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PhononWidth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PhononWidth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Polaron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Polaron
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PortabilityNonRegression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PortabilityNonRegression
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/positron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Positron
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/printing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Printing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/PseudosPAW/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PseudosPAW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/q-points/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Q points
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RandStopPow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RandStopPow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Recursion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Recursion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RPACorrEn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RPACorrEn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/RTTDDFT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RTTDDFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFControl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SCFControl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SCFAlgorithms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SCFAlgorithms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SelfEnergy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SelfEnergy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SmartSymm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SmartSymm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/spinpolarisation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spinpolarisation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/SpinDynamicsMultibinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SpinDynamicsMultibinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/STM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    STM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Susceptibility/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Susceptibility
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDDFT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TDDFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TDepES/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TDepES
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Temperature/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Temperature
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TransPath/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TransPath
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/TuningSpeedMem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TuningSpeedMem
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Unfolding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unfolding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/UnitCell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    UnitCell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/vdw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vdw
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Verification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Verification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wannier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wannier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/Wavelets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wavelets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/xc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Xc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../topics/external_resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    External Resources
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Variables
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Variables
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    All Variables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Abinit
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Abinit
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/basic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/bse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bethe-Salpeter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dev/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dmft/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DMFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/eph/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Electron-Phonon
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/ffield/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Varff
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File-handling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/geo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geometry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/gstate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ground-State
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/gw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/internal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Internal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/paral/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallelism
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/paw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PAW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/dfpt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/rlx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Relaxation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/rttddft/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RTTDDFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/vdw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VdW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/w90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wannier90
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/anaddb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Anaddb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/atdep/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aTDEP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/multibinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multibinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/optic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/aim/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aim
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/external_parameters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    External Parameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/varset_stats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Statistics
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Basic tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Basic tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../base1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    basic1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../base2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    basic2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../base3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    basic3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../base4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    basic4
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../abinit_build/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ABINIT_build
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paw1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PAW1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../polarization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Polarization & finite field
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rf1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFPT1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rf2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFPT2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basepar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallelism
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_10" >
        
          
          <label class="md-nav__link" for="__nav_4_10" id="__nav_4_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ABINIT postprocessors
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_10">
            <span class="md-nav__icon md-icon"></span>
            ABINIT postprocessors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../atdep1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aTDEP1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cut3d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cut3D
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fold2bloch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fold2bloch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../optic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    optic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wannier90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wannier90
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../z2pack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Z2pack
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_11" >
        
          
          <label class="md-nav__link" for="__nav_4_11" id="__nav_4_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DFT beyond basics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_11">
            <span class="md-nav__icon md-icon"></span>
            DFT beyond basics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nuc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    properties at the nucleus
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dftu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFT+U
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ucalc_crpa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cRPA U(J)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lruj/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linear Response U(J)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paw2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PAW2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paw3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PAW3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../positron/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    positron
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_12" checked>
        
          
          <label class="md-nav__link" for="__nav_4_12" id="__nav_4_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Many-Body Theory & excitations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_12_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_12">
            <span class="md-nav__icon md-icon"></span>
            Many-Body Theory & excitations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gw1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GW1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gw2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GW2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gwr_intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GWR_intro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    GWR1
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    GWR1
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-quasi-particle-band-structure-of-silicon-in-the-one-shot-gw-approximation" class="md-nav__link">
    <span class="md-ellipsis">
      The quasi-particle band structure of Silicon in the one-shot GW approximation.
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The quasi-particle band structure of Silicon in the one-shot GW approximation.">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ground-state-and-ks-band-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Ground-state and KS band structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generation-of-the-wfk-file-with-empty-states" class="md-nav__link">
    <span class="md-ellipsis">
      Generation of the WFK file with empty states
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#our-first-gwr-calculation" class="md-nav__link">
    <span class="md-ellipsis">
      Our first GWR calculation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extracting-useful-info-from-the-gwr-log-file" class="md-nav__link">
    <span class="md-ellipsis">
      Extracting useful info from the GWR log file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convergence-study-howto" class="md-nav__link">
    <span class="md-ellipsis">
      Convergence study HOWTO
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convergence-wrt-ecutwfn" class="md-nav__link">
    <span class="md-ellipsis">
      Convergence wrt ecutwfn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convergence-wrt-nband-and-ecuteps" class="md-nav__link">
    <span class="md-ellipsis">
      Convergence wrt nband and ecuteps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convergence-wrt-gwr_ntau" class="md-nav__link">
    <span class="md-ellipsis">
      Convergence wrt gwr_ntau
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convergence-wrt-gwr_boxcutmin" class="md-nav__link">
    <span class="md-ellipsis">
      Convergence wrt gwr_boxcutmin
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gwr-calculations-with-different-bz-meshes" class="md-nav__link">
    <span class="md-ellipsis">
      GWR calculations with different BZ meshes.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-compute-an-interpolated-band-structure-with-gwr" class="md-nav__link">
    <span class="md-ellipsis">
      How to compute an interpolated band structure with GWR
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bethe-Salpeter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dmft/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DMFT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tddft/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TDDFT (Casida)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rttddft/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RT-TDDFT
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_13" >
        
          
          <label class="md-nav__link" for="__nav_4_13" id="__nav_4_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DFPT & electron-phonon
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_13">
            <span class="md-nav__icon md-icon"></span>
            DFPT & electron-phonon
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../elastic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    elastic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nlo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nonlinear
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lattice_wannier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lattice_wannier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lw_quad/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    quadrupoles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eph_intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph_intro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eph4mob/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph for mobilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eph4zpr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph for zero-point renormalization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eph4vpq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph for variational polaron equations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eph_legacy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph_legacy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eph_tdep_legacy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    eph_tdep_legacy
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_14" >
        
          
          <label class="md-nav__link" for="__nav_4_14" id="__nav_4_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Multibinit
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_14">
            <span class="md-nav__icon md-icon"></span>
            Multibinit
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../multibinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    introduction to multibinit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lattice_model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lattice_model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spin_model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    spin_model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lwf_model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lwf_model
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_15" >
        
          
          <label class="md-nav__link" for="__nav_4_15" id="__nav_4_15_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Advanced parallelism
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_15">
            <span class="md-nav__icon md-icon"></span>
            Advanced parallelism
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paral_bandpw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_band_PW
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paral_gswvl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_wavelets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paral_moldyn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_MD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paral_images/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_images
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paral_dfpt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_DFPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paral_mbt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    paral_MBPT
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            FAQ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/configuration_and_compilation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration and compilation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/general_questions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General questions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/pre_and_post_processing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pre/Post processing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/ground_state/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ground state
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/dfpt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFPT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/Troubleshooting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Troubleshooting (old-dokuwiki)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/tuning_abinit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tuning (old-dokuwiki)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Theory
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Theory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/geometry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geometry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/spherical_harmonics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spherical Harmonics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/wavefunctions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wavefunctions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/noncollinear/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Noncollinear
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/pseudopotentials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pseudopotentials
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/mbt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Many-Body Perturbation Theory
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bethe-Salpeter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/documents/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Documents
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acknowledgments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Acknowledgments
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/bibliography/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bibliography
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/acronyms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Acronyms
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Developers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Developers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/git_and_gitlab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git and Gitlab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/developers_howto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HowTo for developers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/abimkdocs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abimkdocs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/markdown/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Markdown
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_5" >
        
          
          <label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Test Suite
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_5">
            <span class="md-nav__icon md-icon"></span>
            Test Suite
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test list
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testsuite_howto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Suite Howto
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/new_testsuite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YAML-based test suite Howto
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/yaml_tools_api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YAML-based test suite Python tools and API
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/XgType/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XgType
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_7" >
        
          
          <label class="md-nav__link" for="__nav_7_7" id="__nav_7_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pseudos
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_7">
            <span class="md-nav__icon md-icon"></span>
            Pseudos
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp1_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp3_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp45_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp45
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp5spinorbit_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp5
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp6_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp6
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/psp8_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    psp8
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/codestats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code stats
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/autoconf_examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Autoconf_examples
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/testlink/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Page for linkcheck
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    About
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            About
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/release-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release Notes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/history/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    History
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-quasi-particle-band-structure-of-silicon-in-the-one-shot-gw-approximation" class="md-nav__link">
    <span class="md-ellipsis">
      The quasi-particle band structure of Silicon in the one-shot GW approximation.
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The quasi-particle band structure of Silicon in the one-shot GW approximation.">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ground-state-and-ks-band-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Ground-state and KS band structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generation-of-the-wfk-file-with-empty-states" class="md-nav__link">
    <span class="md-ellipsis">
      Generation of the WFK file with empty states
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#our-first-gwr-calculation" class="md-nav__link">
    <span class="md-ellipsis">
      Our first GWR calculation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extracting-useful-info-from-the-gwr-log-file" class="md-nav__link">
    <span class="md-ellipsis">
      Extracting useful info from the GWR log file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convergence-study-howto" class="md-nav__link">
    <span class="md-ellipsis">
      Convergence study HOWTO
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convergence-wrt-ecutwfn" class="md-nav__link">
    <span class="md-ellipsis">
      Convergence wrt ecutwfn
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convergence-wrt-nband-and-ecuteps" class="md-nav__link">
    <span class="md-ellipsis">
      Convergence wrt nband and ecuteps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convergence-wrt-gwr_ntau" class="md-nav__link">
    <span class="md-ellipsis">
      Convergence wrt gwr_ntau
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convergence-wrt-gwr_boxcutmin" class="md-nav__link">
    <span class="md-ellipsis">
      Convergence wrt gwr_boxcutmin
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gwr-calculations-with-different-bz-meshes" class="md-nav__link">
    <span class="md-ellipsis">
      GWR calculations with different BZ meshes.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-compute-an-interpolated-band-structure-with-gwr" class="md-nav__link">
    <span class="md-ellipsis">
      How to compute an interpolated band structure with GWR
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                

                  

  
  


<h1 id="first-tutorial-on-gwr-gw-in-real-space-and-imaginary-time">First tutorial on GWR (GW in real-space and imaginary time)<a class="headerlink" href="#first-tutorial-on-gwr-gw-in-real-space-and-imaginary-time" title="Permanent link">&para;</a></h1>
<h2 id="the-quasi-particle-band-structure-of-silicon-in-the-one-shot-gw-approximation">The quasi-particle band structure of Silicon in the one-shot GW approximation.<a class="headerlink" href="#the-quasi-particle-band-structure-of-silicon-in-the-one-shot-gw-approximation" title="Permanent link">&para;</a></h2>
<p>This tutorial aims at showing how to calculate self-energy corrections to the
DFT Kohn-Sham (KS) eigenvalues in the one-shot GW approximation using the GWR code</p>
<p>The user should be already familiar with the four basic tutorials of ABINIT,
see the <a href="/tutorial">tutorial home page</a>,
and is strongly encouraged to read the <a href="/tutorial/gwr_intro">introduction to the GWR code</a>
before running these examples.</p>
<p>This tutorial should take about 1.5 hours.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Supposing you made your own installation of ABINIT, the input files to run the examples
are in the <em>~abinit/tests/</em> directory where <em>~abinit</em> is the <strong>absolute path</strong> of the abinit top-level directory.
If you have NOT made your own install, ask your system administrator where to find the package,
especially the executable and test files.</p>
<p>In case you work on your own PC or workstation, to make things easier, we suggest you define
some handy environment variables by executing the following lines in the terminal:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">ABI_HOME</span><span class="o">=</span>Replace_with_absolute_path_to_abinit_top_level_dir<span class="w"> </span><span class="c1"># Change this line</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/src/98_main/:<span class="nv">$PATH</span><span class="w">      </span><span class="c1"># Do not change this line: path to executable</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">ABI_TESTS</span><span class="o">=</span><span class="nv">$ABI_HOME</span>/tests/<span class="w">             </span><span class="c1"># Do not change this line: path to tests dir</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">ABI_PSPDIR</span><span class="o">=</span><span class="nv">$ABI_TESTS</span>/Pspdir/<span class="w">  </span><span class="c1"># Do not change this line: path to pseudos dir</span>
</code></pre></div>
<p>Examples in this tutorial use these shell variables: copy and paste
the code snippets into the terminal (<strong>remember to set ABI_HOME first!</strong>) or, alternatively,
source the <code>set_abienv.sh</code> script located in the <em>~abinit</em> directory:</p>
<div class="highlight"><pre><span></span><code><span class="nb">source</span><span class="w"> </span>~abinit/set_abienv.sh
</code></pre></div>
<p>The &lsquo;export PATH&rsquo; line adds the directory containing the executables to your <a href="http://www.linfo.org/path_env_var.html">PATH</a>
so that you can invoke the code by simply typing <em>abinit</em> in the terminal instead of providing the absolute path.</p>
<p>To execute the tutorials, create a working directory (<code>Work*</code>) and
copy there the input files of the lesson.</p>
<p>Most of the tutorials do not rely on parallelism (except specific <a class="wikilink lesson-wikilink" href="/tutorial/basepar">tutorials on parallelism</a>).
However you can run most of the tutorial examples in parallel with MPI, see the <a class="wikilink topic-wikilink" data-tippy-content="How to set parameters for a parallel calculation" data-toggle="popover" href="/topics/parallelism">topic on parallelism</a>.</p>
</div>
<h3 id="ground-state-and-ks-band-structure">Ground-state and KS band structure<a class="headerlink" href="#ground-state-and-ks-band-structure" title="Permanent link">&para;</a></h3>
<p><em>Before beginning, you might consider creating a different subdirectory to work in.
Why not create Work_gwr?</em></p>
<p>The file <em>tgwr_1.abi</em> is the input file for the first step:
a SCF run followed by a KS NSCF band structure calculation along a high-symmetry <span class="arithmatex">\(\kk\)</span>-path.
Copy it to the working directory with:</p>
<div class="highlight"><pre><span></span><code>mkdir Work_gwr
cd Work_gwr
cp ../tgwr_1.abi .
</code></pre></div>
<p>You may want to immediately start the job in background with:</p>
<div class="highlight"><pre><span></span><code>mpirun -n 1 tgwr_1.abi &gt; tgwr_1.log 2&gt; err &amp;
</code></pre></div>
<p>so that we have some time to discuss the input while ABINIT is running.</p>
<div class="text-center"><button id="uuid-cb3a6091-9b47-4716-9a64-86bce169dafd" class="md-button md-button--secondary"> View tests/tutorial/Input/tgwr_1.abi </button></div>
<div id="uuid-8841b7f1-7488-4b10-b53e-aa16a7d39b55" class="my_dialog" title="tests/tutorial/Input/tgwr_1.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Crystalline silicon. Preparatory run for GWR code</span>
<span class="c1"># Dataset 1: ground state calculation to compute the density.</span>
<span class="c1"># Dataset 2: KS band structure calculation along a k-path.</span>

<span class="c1"># Include geometry and pseudos</span>
include<span class="w"> </span><span class="s2">&quot;gwr_include.abi&quot;</span>

ndtset<span class="w"> </span><span class="m">2</span>
prtwf<span class="w"> </span>-1<span class="w">       </span><span class="c1"># Don&#39;t need wavefunctions.</span>

<span class="c1">#paral_kgb 1   # Activate spin/k-point/band/FFT</span>
<span class="c1">#autoparal 1   # Automatic selection of np* variables.</span>
<span class="c1">#npfft 1       # Disable MPI-FFT</span>

<span class="c1">####################</span>
<span class="c1"># Dataset 1: SCF run</span>
<span class="c1">####################</span>
nband1<span class="w">  </span><span class="m">6</span>

<span class="c1"># Definition of the k-point grid</span>
ngkpt1<span class="w">   </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">4</span>
nshiftk1<span class="w"> </span><span class="m">4</span>
shiftk1<span class="w">  </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0
<span class="w">         </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>.5
<span class="w">         </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.5
<span class="w">         </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>.5<span class="w"> </span><span class="m">0</span>.0
tolvrs1<span class="w"> </span><span class="m">1</span>.e-12

<span class="c1">#######################################</span>
<span class="c1"># Dataset 2: Band structure calculation</span>
<span class="c1">#######################################</span>
getden2<span class="w">    </span>-1
nband2<span class="w">      </span><span class="m">12</span>
nbdbuf2<span class="w">     </span><span class="m">4</span>
tolwfr2<span class="w">     </span>1e-20
iscf2<span class="w">      </span>-2<span class="w">   </span><span class="c1"># NSCF run</span>

<span class="c1"># K-path in reduced coordinates:</span>
<span class="c1"># Generate using `abistruct.py kpath gwr_include.abi`</span>
ndivsm2<span class="w"> </span><span class="m">5</span>
kptopt2<span class="w"> </span>-11
kptbounds2
<span class="w">   </span>+0.000000000<span class="w">  </span>+0.000000000<span class="w">  </span>+0.000000000<span class="w">  </span><span class="c1"># $\Gamma$</span>
<span class="w">   </span>+0.500000000<span class="w">  </span>+0.000000000<span class="w">  </span>+0.500000000<span class="w">  </span><span class="c1"># X</span>
<span class="w">   </span>+0.500000000<span class="w">  </span>+0.250000000<span class="w">  </span>+0.750000000<span class="w">  </span><span class="c1"># W</span>
<span class="w">   </span>+0.375000000<span class="w">  </span>+0.375000000<span class="w">  </span>+0.750000000<span class="w">  </span><span class="c1"># K</span>
<span class="w">   </span>+0.000000000<span class="w">  </span>+0.000000000<span class="w">  </span>+0.000000000<span class="w">  </span><span class="c1"># $\Gamma$</span>
<span class="w">   </span>+0.500000000<span class="w">  </span>+0.500000000<span class="w">  </span>+0.500000000<span class="w">  </span><span class="c1"># L</span>
<span class="w">   </span>+0.625000000<span class="w">  </span>+0.250000000<span class="w">  </span>+0.625000000<span class="w">  </span><span class="c1"># U</span>
<span class="w">   </span>+0.500000000<span class="w">  </span>+0.250000000<span class="w">  </span>+0.750000000<span class="w">  </span><span class="c1"># W</span>
<span class="w">   </span>+0.500000000<span class="w">  </span>+0.500000000<span class="w">  </span>+0.500000000<span class="w">  </span><span class="c1"># L</span>
<span class="w">   </span>+0.375000000<span class="w">  </span>+0.375000000<span class="w">  </span>+0.750000000<span class="w">  </span><span class="c1"># K</span>
<span class="w">   </span>+0.625000000<span class="w">  </span>+0.250000000<span class="w">  </span>+0.625000000<span class="w">  </span><span class="c1"># U</span>
<span class="w">   </span>+0.500000000<span class="w">  </span>+0.000000000<span class="w">  </span>+0.500000000<span class="w">  </span><span class="c1"># X</span>


<span class="c1"># Definition of the SCF procedure</span>
nstep<span class="w">   </span><span class="m">100</span><span class="w">       </span><span class="c1"># Maximal number of SCF cycles</span>
diemac<span class="w">  </span><span class="m">12</span>.0<span class="w">      </span><span class="c1"># Although this is not mandatory, it is worth to</span>
<span class="w">                  </span><span class="c1"># precondition the SCF cycle. The model dielectric</span>
<span class="w">                  </span><span class="c1"># function used as the standard preconditioner</span>
<span class="w">                  </span><span class="c1"># is described in the &quot;dielng&quot; input variable section.</span>
<span class="w">                  </span><span class="c1"># Here, we follow the prescription for bulk silicon.</span>

<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = tgwr_1.abi, tgwr_2.abi, tgwr_3.abi, tgwr_4.abi, tgwr_5.abi</span>
<span class="c1">#%% need_cpp_vars = HAVE_LINALG_SCALAPACK</span>
<span class="c1">#%% exclude_builders = eos_nvhpc_23.9_elpa ,eos_nvhpc_24.9_openmpi</span>
<span class="c1">#%% [shell]</span>
<span class="c1">#%% pre_commands = iw_cp gwr_include.abi gwr_include.abi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   tgwr_1.abo, tolnlines = 25, tolabs = 1.1e-3, tolrel = 3.0e-3, fld_options = -medium;</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 12</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = M. Giantomassi</span>
<span class="c1">#%% keywords = NC, GWR</span>
<span class="c1">#%% description =</span>
<span class="c1">#%%     Crystalline silicon. Preparatory run for GWR code</span>
<span class="c1">#%%     Dataset 1: ground state calculation to compute the density.</span>
<span class="c1">#%%     Dataset 2: KS band structure calculation along a k-path.</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-8841b7f1-7488-4b10-b53e-aa16a7d39b55", "#uuid-cb3a6091-9b47-4716-9a64-86bce169dafd") }); </script>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>All the input files of this tutorial can be executed in parallel by just
increasing the value of <code>NUM</code> in <code>mpirun -n NUM</code>.
Clearly the size of the problem is small so do not expect
great parallel performance if you start to use dozens of MPI processes.</p>
</div>
<p>The first dataset produces the KS density file that is then used to compute the band structure in the second dataset.
Since all the input files of this tutorial use the same crystalline structure, pseudos
and cutoff energy <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> for the wavefunctions, we declare these variables in an external file
that will be <strong>included</strong> in all the other input files using the syntax:</p>
<div class="highlight"><pre><span></span><code># Include geometry and pseudos
include &quot;gwr_include.abi&quot;
</code></pre></div>
<p>If you open the include file:</p>
<div class="text-center"><button id="uuid-4de3bc48-14b3-427f-82c3-00d8ff565eef" class="md-button md-button--secondary"> View tests/tutorial/Input/gwr_include.abi </button></div>
<div id="uuid-9da8525f-640a-4779-82ad-9820c20b04c0" class="my_dialog" title="tests/tutorial/Input/gwr_include.abi" hidden><div><div class="codehilite small-text"><pre><span></span>ecut<span class="w"> </span><span class="m">16</span>.0<span class="w">        </span><span class="c1"># Maximal kinetic energy cut-off, in Hartree</span>

<span class="c1"># Definition of the unit cell: fcc</span>
acell<span class="w">  </span><span class="m">3</span>*10.26<span class="w">         </span><span class="c1"># Experimental lattice constants in Bohr</span>
rprim<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5<span class="w">   </span><span class="c1"># FCC primitive vectors (to be scaled by acell)</span>
<span class="w">       </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.5
<span class="w">       </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.5<span class="w">  </span><span class="m">0</span>.0

<span class="c1"># Definition of the atom types</span>
ntypat<span class="w">  </span><span class="m">1</span>
znucl<span class="w"> </span><span class="m">14</span>

<span class="c1"># Definition of the atoms</span>
natom<span class="w">  </span><span class="m">2</span>
typat<span class="w">  </span><span class="m">1</span><span class="w"> </span><span class="m">1</span>
xred
<span class="w">      </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.0<span class="w">  </span><span class="m">0</span>.0
<span class="w">      </span><span class="m">0</span>.25<span class="w"> </span><span class="m">0</span>.25<span class="w"> </span><span class="m">0</span>.25

<span class="c1"># PBE pseudos from the PseudoDojo (scalar relativistic)</span>
pp_dirpath<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ABI_PSPDIR</span><span class="s2">&quot;</span>
pseudos<span class="w"> </span><span class="s2">&quot;Psdj_nc_sr_04_pbe_std_psp8/Si.psp8&quot;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-9da8525f-640a-4779-82ad-9820c20b04c0", "#uuid-4de3bc48-14b3-427f-82c3-00d8ff565eef") }); </script>

<p>you will notice that we are using norm-conserving (NC) pseudos taken from
the standard scalar-relativistic table of the <a href="https://www.pseudo-dojo.org/">PseudoDojo</a>,
and the recommended value for <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> reported in the PseudoDojo table (16 Ha, normal hint).</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>For GW calculations, we <strong>strongly</strong> recommend using NC pseudos from the <strong>stringent table</strong>
as these pseudos have closed-shells treated as valence states.
This is important for a correct description of the matrix elements of the exchange part of the self-energy
that are rather sensitive to the overlap between the wavefunctions <a class="wikilink citation-wikilink" data-tippy-content="The PseudoDojo: Training and grading a 85 element optimized norm-conserving pseudopotential table" data-toggle="popover" href="/theory/bibliography#setten2018">[Setten2018]</a>.
In the special case of silicon, there is no difference between the standard version
and the stringent version of the pseudo, but if we consider e.g. Ga, you will notice
that the stringent version includes all the 3spd states in valence besides the outermost 4sp electrons
whereas the standard pseudo for Ga designed for GS calculations includes only the 3d states.</p>
</div>
<!--
Since we are using scalar-relativistic (SR) pseudos, it is not possible to treat spin-orbit coupling (SOC).
To include SOC with NC, one should use fully-relativistic (FR) pseudos, set [[nspinor]] 2 al all the input files
and then set the appropriate value of [[nspden]] to 4 or 1 depending on whether the system is magnetic or not.
-->

<p>At this point, the calculation should have completed, and we can have a look
at the KS band structure to find the position of the band edges.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If <a href="https://github.com/abinit/abipy">AbiPy</a>  is installed on your machine, you can use the <a href="http://abinit.github.io/abipy/scripts/abiopen.html">abiopen.py</a>  script
with the <code>--expose</code> option to visualize the band structure from the GSR.nc file:</p>
<div class="codehilite"><pre><span></span><code>abiopen.py tgwr_1o_DS2_GSR.nc --expose
</code></pre></div>

<p><img alt="" src="../gwr_assets/abiopen_tgwr_1o_DS2.png" /></p>
<p>To print the results to terminal, use:</p>
<div class="codehilite"><pre><span></span><code>abiopen.py tgwr_1o_DS2_GSR.nc -p
</code></pre></div>

<div class="highlight"><pre><span></span><code>============================== Electronic Bands ==============================
Number of electrons: 8.0, Fermi level: 4.356 (eV)
nsppol: 1, nkpt: 101, mband: 12, nspinor: 1, nspden: 1
smearing scheme: none (occopt 1), tsmear_eV: 0.272, tsmear Kelvin: 3157.7
Direct gap:
    Energy: 2.556 (eV)
    Initial state: spin: 0, kpt: $\Gamma$ [+0.000, +0.000, +0.000], band: 3, eig: 4.356, occ: 2.000
    Final state:   spin: 0, kpt: $\Gamma$ [+0.000, +0.000, +0.000], band: 4, eig: 6.912, occ: 0.000
Fundamental gap:
    Energy: 0.570 (eV)
    Initial state: spin: 0, kpt: $\Gamma$ [+0.000, +0.000, +0.000], band: 3, eig: 4.356, occ: 2.000
    Final state:   spin: 0, kpt: [+0.429, +0.000, +0.429], band: 4, eig: 4.926, occ: 0.000
Bandwidth: 11.970 (eV)
Valence maximum located at kpt index 0:
    spin: 0, kpt: $\Gamma$ [+0.000, +0.000, +0.000], band: 3, eig: 4.356, occ: 2.000
Conduction minimum located at kpt index 12:
    spin: 0, kpt: [+0.429, +0.000, +0.429], band: 4, eig: 4.926, occ: 0.000
</code></pre></div>
</div>
<p>Silicon is an indirect band gap semiconductor:
the CBM is located at the <span class="arithmatex">\(\Gamma\)</span> point while the VMB is located at ~[+0.429, +0.000, +0.429].
At the PBE level, the direct gap is 2.556 eV while the fundamental band gap is ~0.570 eV.
Both values strongly underestimate the experimental results that are ~3.4 eV and ~1.12 eV, respectively.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Similarly to the conventional GW code, also the GWR code can compute QP corrections only
for the <span class="arithmatex">\(\kk\)</span>-points belonging to the <span class="arithmatex">\(\kk\)</span>-mesh associated to the WFK file.
Before running GW calculations is always a good idea to analyze carefully the KS band
structure in order to understand the location of the band edges and then select
the most appropriate <span class="arithmatex">\(\kk\)</span>-mesh.</p>
</div>
<p>One final comment related to the MPI parallelism in the ground-state part.
For larger system, it is advisable to use <a class="wikilink codevar-wikilink" href="/variables/paral#paral_kgb">paral_kgb</a> = 1 for its better scalability
in conjunction with <a class="wikilink codevar-wikilink" href="/variables/paral#autoparal">autoparal</a> 1 to allow ABINIT to determine an optimal distribution,
in particular the band parallelism that is not available when the CG eigensolver is used.</p>
<!--
Note also that we suggest disabling the FFT parallelization by using [[npfft]] 1.
to 1 to enable $\kk$-point, band, and FFT parallelization,
and [[autoparal]] to 1 to allow ABINIT to determine an optimal distribution, with [[npfft]] fixed at 1.
-->

<h3 id="generation-of-the-wfk-file-with-empty-states">Generation of the WFK file with empty states<a class="headerlink" href="#generation-of-the-wfk-file-with-empty-states" title="Permanent link">&para;</a></h3>
<p>In the second input file, we use the density file computed previously (<code>tgwr_1o_DS1_DEN</code>)
to generate WFK files with three different <span class="arithmatex">\(\Gamma\)</span>-centered <span class="arithmatex">\(\kk\)</span>-meshes:</p>
<div class="highlight"><pre><span></span><code>ndtset 3

ngkpt1   2 2 2
ngkpt2   4 4 4
ngkpt3   6 6 6
</code></pre></div>
<p>This allows us to perform convergence studies with respect to the BZ sampling.
Let us recall that shifted <span class="arithmatex">\(\kk\)</span>-meshes <strong>are not supported</strong> by GWR.
In another words, <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> must be set to 1 with <a class="wikilink codevar-wikilink" href="/variables/basic#shiftk">shiftk</a> = 0 0 0 when producing the WFK file.
The density file, on the contrary, can be generated with shifted <span class="arithmatex">\(\kk\)</span>-meshes, as usual.</p>
<p>Let&rsquo;s immediately start the job in background with:</p>
<div class="highlight"><pre><span></span><code>mpirun -n 1 tgwr_2.abi &gt; tgwr_2.log 2&gt; err &amp;
</code></pre></div>
<div class="text-center"><button id="uuid-5b1df963-5d9f-4441-80ec-02f3e7362aae" class="md-button md-button--secondary"> View tests/tutorial/Input/tgwr_2.abi </button></div>
<div id="uuid-9bca8863-28d6-49b1-9574-95c56bfdfc19" class="my_dialog" title="tests/tutorial/Input/tgwr_2.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#  Calculation of WFK files with empty states and direct diagonalization</span>

<span class="c1"># Include geometry and pseudos</span>
include<span class="w"> </span><span class="s2">&quot;gwr_include.abi&quot;</span>

<span class="c1"># Generate 3 WFK files with increased BZ sampling.</span>
ndtset<span class="w"> </span><span class="m">3</span>
ngkpt1<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span>
ngkpt2<span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">4</span>
ngkpt3<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">6</span>

<span class="c1"># Definition of the k-point grid</span>
<span class="c1"># IMPORTANT: GWR requires Gamma-centered k-meshes</span>
nshiftk<span class="w"> </span><span class="m">1</span>
shiftk<span class="w">  </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0

<span class="c1">###########################################</span>
<span class="c1"># Direct diago with empty states</span>
<span class="c1">###########################################</span>
optdriver<span class="w">  </span><span class="m">6</span><span class="w">                         </span><span class="c1"># Activate GWR code</span>
gwr_task<span class="w"> </span><span class="s2">&quot;HDIAGO&quot;</span><span class="w">                    </span><span class="c1"># Direct diagonalization</span>
nband<span class="w">     </span><span class="m">400</span><span class="w">                        </span><span class="c1"># Number of (occ + empty) bands</span>
getden_filepath<span class="w"> </span><span class="s2">&quot;tgwr_1o_DS1_DEN&quot;</span><span class="w">    </span><span class="c1"># Density file used to build H[n]</span>

<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = tgwr_1.abi, tgwr_2.abi, tgwr_3.abi, tgwr_4.abi, tgwr_5.abi</span>
<span class="c1">#%% need_cpp_vars = HAVE_LINALG_SCALAPACK</span>
<span class="c1">#%% exclude_builders = eos_nvhpc_23.9_elpa ,eos_nvhpc_24.9_openmpi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   tgwr_2.abo, tolnlines = 25, tolabs = 1.1e-3, tolrel = 3.0e-3, fld_options = -medium;</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 12</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = M. Giantomassi</span>
<span class="c1">#%% keywords = NC, GWR</span>
<span class="c1">#%% description =</span>
<span class="c1">#%%  Calculation of WFK files with empty states with direct diagonalization</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-9bca8863-28d6-49b1-9574-95c56bfdfc19", "#uuid-5b1df963-5d9f-4441-80ec-02f3e7362aae") }); </script>

<p>Here we are using <a class="wikilink codevar-wikilink" href="/variables/gwr#gwr_task">gwr_task</a> = &ldquo;HDIAGO&rdquo; to perform a <strong>direct diagonalization</strong>
of the KS Hamiltonian <span class="arithmatex">\(H^\KS[n]\)</span> constructed from the input DEN file.
This procedure differs from the one used in the other GW tutorials in which the WFK file
is generated by performing an <strong>iterative diagonalization</strong> in which only the application of the Hamiltonian is required.
The reason is that the direct diagonalization outperforms iterative methods
when many empty states are required, especially if one can take advantage of ScalaPack
to distribute the KS Hamiltonian matrix.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>We strongly recommend using the ELPA library for diagonalization,
as it is much more efficient and requires significantly less memory than the ScaLAPACK drivers.
See the <a href="/tutorial/gwr_intro">GWR_intro</a> for more details on how to link the ELPA library.</p>
</div>
<p>Here, we ask for 400 bands. Let&rsquo;s recall that in the <a href="/tutorial/gw1">previous GW tutorial</a>
<a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> = 100 was considered converged within 30 meV,
but with GWR we can afford more bands since <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> enters into play only during the initial construction
of the Green&rsquo;s function
Clearly, when studying new systems, the value of <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> needed to converge is not known beforehand.
Therefore, it is important to plan ahead and choose a reasonably large number of bands
to avoid regenerating the WFK file multiple times just to increase <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>.</p>
<p>Note also that <a class="wikilink codevar-wikilink" href="/variables/paral#paral_kgb">paral_kgb</a> = 1 is only available in the ground-state (GS) part.
The GWR code, indeed, employs its own distribution scheme, which depends on the value of <a class="wikilink codevar-wikilink" href="/variables/gwr#gwr_task">gwr_task</a>.
When &ldquo;HDIAGO&rdquo; is used, the distribution is handled automatically at runtime, and the user has no control over it.
Please refer to the note below for guidance on choosing an appropriate number of MPI processes
to ensure an efficient workload distribution.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The direct diagonalization is MPI-parallelized across three different levels:
collinear spin <span class="arithmatex">\(\sigma\)</span> (not used here), <span class="arithmatex">\(\kk\)</span>-points in the IBZ and
Scalapack distribution of the <span class="arithmatex">\(H^\sigma_\kk(\bg,\bg')\)</span> matrix.
ABINIT will try to find an &ldquo;optimal&rdquo; distribution of the workload at runtime, yet there are a couple
of things worth keeping in mind when choosing the number of MPI processes for this step.
Ideally the total number of cores should be a multiple of <a class="wikilink codevar-wikilink" href="/variables/basic#nkpt">nkpt</a> * <a class="wikilink codevar-wikilink" href="/variables/basic#nsppol">nsppol</a> to avoid load imbalance.</p>
<p>In order to compute <strong>all</strong> the eigenvectors of the KS Hamiltonian, one can use gwr_task &ldquo;HDIAGO_FULL&rdquo;.
In this case the value of <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> is automatically set to the total number of plawewaves
for that particular <span class="arithmatex">\(\kk\)</span>-point.
No stopping criterion such as <a class="wikilink codevar-wikilink" href="/variables/basic#tolwfr">tolwfr</a> or number of iterations <a class="wikilink codevar-wikilink" href="/variables/basic#nstep">nstep</a> are required when Scalapack is used.</p>
<p>Again, multi-datasets are <strong>strongly discouraged</strong> if you care about performance.</p>
</div>
<!--
To use the iterative eigenvalue solver:

# optdriver  6                         # Activate GWR code
# gwr_task "HDIAGO"                    # Direct diagonalization
 nband     1000                        # Number of (occ + empty) bands
 iscf -2
 nbdbuf -10
 tolwfr 1e-20
 paral_kgb 1
 autoparal 1
 npfft 1
 nstep 150
!-->

<h3 id="our-first-gwr-calculation">Our first GWR calculation<a class="headerlink" href="#our-first-gwr-calculation" title="Permanent link">&para;</a></h3>
<p>For our first GWR run, we use a minimalistic input file that
performs a GWR calculation using the DEN and the WFK file produced previously.
First of all, you may want to start immediately the computation with:</p>
<div class="highlight"><pre><span></span><code>mpirun -n 1 tgwr_3.abi &gt; tgwr_3.log 2&gt; err &amp;
</code></pre></div>
<p>and the following input file:</p>
<div class="text-center"><button id="uuid-db49ddfa-e476-48c6-9ebd-d2e1a4148c44" class="md-button md-button--secondary"> View tests/tutorial/Input/tgwr_3.abi </button></div>
<div id="uuid-edf6f7d0-721c-40de-b07b-ec4d3553ae70" class="my_dialog" title="tests/tutorial/Input/tgwr_3.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Crystalline silicon</span>
<span class="c1"># Calculation of one-shot GW corrections with GWR code.</span>

<span class="c1"># Definition of the k-point grid</span>
<span class="c1"># IMPORTANT: GWR requires Gamma-centered k-meshes</span>
ngkpt<span class="w">   </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span>
nshiftk<span class="w"> </span><span class="m">1</span>
shiftk<span class="w">  </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0

<span class="c1"># Include geometry and pseudos</span>
include<span class="w"> </span><span class="s2">&quot;gwr_include.abi&quot;</span>

<span class="c1">################################</span>
<span class="c1"># Dataset 3: G0W0 with GWR code</span>
<span class="c1">################################</span>
optdriver<span class="w">  </span><span class="m">6</span><span class="w">                          </span><span class="c1"># Activate GWR code</span>
ecutwfn<span class="w">    </span><span class="m">10</span><span class="w">                         </span><span class="c1"># Truncate basis set when computing G.</span>
<span class="w">                                      </span><span class="c1"># This parameter should be subject to convergence studies</span>
gwr_task<span class="w"> </span><span class="s2">&quot;G0W0&quot;</span><span class="w">                       </span><span class="c1"># One-shot calculation</span>
getden_filepath<span class="w"> </span><span class="s2">&quot;tgwr_1o_DS1_DEN&quot;</span><span class="w">     </span><span class="c1"># Density file</span>
getwfk_filepath<span class="w"> </span><span class="s2">&quot;tgwr_2o_DS1_WFK&quot;</span><span class="w">     </span><span class="c1"># WFK file with empty states and 2x2x2 k-mesh</span>

gwr_ntau<span class="w"> </span><span class="m">6</span><span class="w">          </span><span class="c1"># Number of minimax points</span>
gwr_boxcutmin<span class="w">  </span><span class="m">1</span>.0<span class="w">  </span><span class="c1"># This should be subject to convergence studies</span>
gwr_sigma_algo<span class="w"> </span><span class="m">2</span><span class="w">    </span><span class="c1"># Use convolutions in the BZ for Sigma</span>

nband<span class="w">      </span><span class="m">100</span><span class="w">      </span><span class="c1"># Bands to be used in Green&#39;s functions.</span>
ecuteps<span class="w">    </span><span class="m">6</span><span class="w">        </span><span class="c1"># Cut-off energy of the planewave set to represent the dielectric matrix.</span>
<span class="w">                    </span><span class="c1"># It is important to adjust this parameter.</span>
<span class="c1">#ecutsigx    16     # Dimension of the G sum in Sigma_x.</span>

nkptgw<span class="w">      </span><span class="m">2</span><span class="w">       </span><span class="c1"># number of k-point where to calculate the GW correction</span>
kptgw<span class="w">               </span><span class="c1"># k-points in reduced coordinates</span>
<span class="w">   </span><span class="m">0</span>.0<span class="w">    </span><span class="m">0</span>.0<span class="w">    </span><span class="m">0</span>.0
<span class="w">   </span><span class="m">0</span>.5<span class="w">    </span><span class="m">0</span>.0<span class="w">    </span><span class="m">0</span>.0

bdgw<span class="w">       </span><span class="c1"># calculate GW corrections for bands from 4 to 5</span>
<span class="w">   </span><span class="m">4</span><span class="w">  </span><span class="m">5</span>
<span class="w">   </span><span class="m">4</span><span class="w">  </span><span class="m">5</span>

<span class="c1"># Spectral function (very coarse grid to reduce txt file size)</span>
<span class="c1">#nfreqsp3 50</span>
<span class="c1">#freqspmax3 5 eV</span>

<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = tgwr_1.abi, tgwr_2.abi, tgwr_3.abi, tgwr_4.abi, tgwr_5.abi</span>
<span class="c1">#%% need_cpp_vars = HAVE_LINALG_SCALAPACK</span>
<span class="c1">#%% exclude_builders = eos_nvhpc_23.9_elpa ,eos_nvhpc_24.9_openmpi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   tgwr_3.abo, tolnlines = 50, tolabs = 1.1e-3, tolrel = 3.0e-3, fld_options = -medium;</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 12</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = M. Giantomassi</span>
<span class="c1">#%% keywords = NC, GWR</span>
<span class="c1">#%% description =</span>
<span class="c1">#%%  Crystalline silicon</span>
<span class="c1">#%%  Calculation of one-shot GW corrections with GWR code.</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-edf6f7d0-721c-40de-b07b-ec4d3553ae70", "#uuid-db49ddfa-e476-48c6-9ebd-d2e1a4148c44") }); </script>

<p>This input contains some variables whose meaning is the same as in the conventional GW code,
and other variables whose name starts with <code>gwr_</code> that are specific to the GWR code.</p>
<p>We use <a class="wikilink codevar-wikilink" href="/variables/gstate#optdriver">optdriver</a> 6 to enter the GWR code while <a class="wikilink codevar-wikilink" href="/variables/gwr#gwr_task">gwr_task</a> activates a one-shot GW calculation.
To reduce the wall-time, we use a minimax mesh with <a class="wikilink codevar-wikilink" href="/variables/gwr#gwr_ntau">gwr_ntau</a> = 6 points, the minimum number of points that can be used.
Most likely, six points are not sufficient, but the convergence study for <a class="wikilink codevar-wikilink" href="/variables/gwr#gwr_ntau">gwr_ntau</a> is postponed to the next sections.
<a class="wikilink codevar-wikilink" href="/variables/files#getden_filepath">getden_filepath</a> specifies the density file used to compute <span class="arithmatex">\(v_{xc}[n](\rr)\)</span>,
while <a class="wikilink codevar-wikilink" href="/variables/files#getwfk_filepath">getwfk_filepath</a> specifies the WFK file with empty states used to build the Green&rsquo;s function.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Keep in mind that the <span class="arithmatex">\(\kk\)</span>-mesh specified in the input via <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#nshiftk">nshiftk</a> and <a class="wikilink codevar-wikilink" href="/variables/basic#shiftk">shiftk</a> must
agree with the one found in the WFK file else the code will abort.</p>
<p>Also, the FFT mesh for the density <a class="wikilink codevar-wikilink" href="/variables/gstate#ngfft">ngfft</a> specified in the input must agree with the one found in the <code>DEN</code>.
This is usually true, provided that the same <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> value is used everywhere.
A possible exception occurs when using <a class="wikilink codevar-wikilink" href="/variables/paral#paral_kgb">paral_kgb</a> 1 with MPI-FFT (<a class="wikilink codevar-wikilink" href="/variables/paral#npfft">npfft</a> &gt; 1) to generate the DEN.
In this case, the last two dimensions of the FFT mesh must be multiples of <a class="wikilink codevar-wikilink" href="/variables/paral#npfft">npfft</a>.
Since MPI-FFT is not available in GWR, ABINIT will stop with an error, complaining that the <a class="wikilink codevar-wikilink" href="/variables/gstate#ngfft">ngfft</a> mesh
computed from the input does not match the one read from the file.
To solve the problem, simply set <a class="wikilink codevar-wikilink" href="/variables/gstate#ngfft">ngfft</a> explicitly in the GWR input files using the value used in the GS part.</p>
</div>
<p>To accelerate the computation and reduce the memory requirements, we truncate the PW basis
set using <a class="wikilink codevar-wikilink" href="/variables/gw#ecutwfn">ecutwfn</a> = 10 &lt; <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> = 16, and <a class="wikilink codevar-wikilink" href="/variables/gwr#gwr_boxcutmin">gwr_boxcutmin</a> is set to 1.0.
These parameters should be subject to carefully convergence studies as systems with localized electrons
such as 3d or 4f electrons may require larger values (more PWs and denser FFT meshes).
Please take some time to read the variable description of <a class="wikilink codevar-wikilink" href="/variables/gw#ecutwfn">ecutwfn</a> and <a class="wikilink codevar-wikilink" href="/variables/gwr#gwr_boxcutmin">gwr_boxcutmin</a> before proceeding.</p>
<p>Now, let us turn our attention to the variables that are also used in the conventional GW code.
The cutoff of the polarizability and <span class="arithmatex">\(W\)</span> is defined by <a class="wikilink codevar-wikilink" href="/variables/gw#ecuteps">ecuteps</a> as in the conventional GW code.
The cutoff for the exchange part of the self-energy is given by <a class="wikilink codevar-wikilink" href="/variables/gw#ecutsigx">ecutsigx</a>.
For the initial convergence studies, it is advised to set <a class="wikilink codevar-wikilink" href="/variables/gw#ecutsigx">ecutsigx</a> to a value as high
as <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a> since, anyway, this parameter is not much influential on the total computational time,
as only occupied states are involved.
Note that the exact treatment of the exchange part requires, in principle, <a class="wikilink codevar-wikilink" href="/variables/gw#ecutsigx">ecutsigx</a> = 4 * <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If <a class="wikilink codevar-wikilink" href="/variables/gw#ecutsigx">ecutsigx</a> is not specified in the input, GWR will set it to <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a>.</p>
</div>
<p>The <span class="arithmatex">\(\kk\)</span>-points and the band range for the QP corrections are set
expliclty via <a class="wikilink codevar-wikilink" href="/variables/gw#nkptgw">nkptgw</a>, <a class="wikilink codevar-wikilink" href="/variables/gw#kptgw">kptgw</a> and <a class="wikilink codevar-wikilink" href="/variables/gw#bdgw">bdgw</a>.</p>
<!--
Alternatively, one can use [[gw_qprange]].
For the spectral function $A_\nk(\ww)$, we have the following variables [[nfreqsp]], [[freqspmax]]
TODO: Mention [[inclvkb]] == 2, [[symsigma]]
-->

<p>We can now have a look at the main output file:</p>
<div class="text-center"><button id="uuid-c54bbd07-042c-44e8-ab2f-add691636350" class="md-button md-button--secondary"> View tests/tutorial/Refs/tgwr_3.abo </button></div>
<div id="uuid-5f931e72-4cbd-4531-a8b7-b861c3a73095" class="my_dialog" title="tests/tutorial/Refs/tgwr_3.abo" hidden><div><pre class="small-text">

.Version 10.3.6.4 of ABINIT, released Feb 2025.
.(MPI version, prepared for a aarch64_darwin23.6.0_gnu14.2 computer)

.Copyright (C) 1998-2025 ABINIT group .
 ABINIT comes with ABSOLUTELY NO WARRANTY.
 It is free software, and you are welcome to redistribute it
 under certain conditions (GNU General Public License,
 see ~abinit/COPYING or http://www.gnu.org/copyleft/gpl.txt).

 ABINIT is a project of the Universite Catholique de Louvain,
 Corning Inc. and other collaborators, see ~abinit/doc/developers/contributors.txt .
 Please read https://docs.abinit.org/theory/acknowledgments for suggested
 acknowledgments of the ABINIT effort.
 For more information, see https://www.abinit.org .

.Starting date : Thu  3 Apr 2025.
- ( at 17h08 )

- input  file    -&gt; /Users/giantomassi/git_repos/abinit/_build/tests/Test_suite/tutorial_tgwr_1-tgwr_2-tgwr_3-tgwr_4-tgwr_5/tgwr_3.abi
- output file    -&gt; tgwr_3.abo
- root for input  files -&gt; tgwr_3i
- root for output files -&gt; tgwr_3o

 Symmetries : space group Fd -3 m (#227); Bravais cF (face-center cubic)
================================================================================
 Values of the parameters that define the memory need of the present run
     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       6
     lnmax =       6     mgfft =      30  mpssoang =       3    mqgrid =    3001
     natom =       2  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      48    n1xccc =    2501    ntypat =       1
    occopt =       1   xclevel =       2
-    mband =         100        mffmem =           1         mkmem =           3
       mpw =         435          nfft =       27000          nkpt =           3
================================================================================
P This job should need less than                      11.418 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      1.993 Mbytes ; DEN or POT disk file :      0.208 Mbytes.
================================================================================

--------------------------------------------------------------------------------
------------- Echo of variables that govern the present computation ------------
--------------------------------------------------------------------------------
-
- outvars: echo of selected default values
-   iomode0 =  0 , fftalg0 =312 , wfoptalg0 =  0
-
- outvars: echo of global parameters not present in the input file
-  max_nthreads =    0
-
 -outvars: echo values of preprocessed input variables --------
            acell      1.0260000000E+01  1.0260000000E+01  1.0260000000E+01 Bohr
              amu      2.80855000E+01
             bdgw           4       5       4       5
             ecut      1.60000000E+01 Hartree
          ecuteps      6.00000000E+00 Hartree
         ecutsigx      1.60000000E+01 Hartree
          ecutwfn      1.00000000E+01 Hartree
-          fftalg         312
         gwr_ntau           6
   gwr_sigma_algo           2
           istwfk        2    3    7
              ixc          11
              kpt      0.00000000E+00  0.00000000E+00  0.00000000E+00
                       5.00000000E-01  0.00000000E+00  0.00000000E+00
                       5.00000000E-01  5.00000000E-01  0.00000000E+00
            kptgw      0.00000000E+00  0.00000000E+00  0.00000000E+00
                       5.00000000E-01  0.00000000E+00  0.00000000E+00
         kptrlatt        2    0    0      0    2    0      0    0    2
          kptrlen      1.45098311E+01
P           mkmem           3
            natom           2
            nband         100
            ngfft          30      30      30
             nkpt           3
           nkptgw           2
             nsym          48
           ntypat           1
              occ      2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000
        optdriver           6
            rprim      0.0000000000E+00  5.0000000000E-01  5.0000000000E-01
                       5.0000000000E-01  0.0000000000E+00  5.0000000000E-01
                       5.0000000000E-01  5.0000000000E-01  0.0000000000E+00
          spgroup         227
           symrel      1  0  0   0  1  0   0  0  1      -1  0  0   0 -1  0   0  0 -1
                       0 -1  1   0 -1  0   1 -1  0       0  1 -1   0  1  0  -1  1  0
                      -1  0  0  -1  0  1  -1  1  0       1  0  0   1  0 -1   1 -1  0
                       0  1 -1   1  0 -1   0  0 -1       0 -1  1  -1  0  1   0  0  1
                      -1  0  0  -1  1  0  -1  0  1       1  0  0   1 -1  0   1  0 -1
                       0 -1  1   1 -1  0   0 -1  0       0  1 -1  -1  1  0   0  1  0
                       1  0  0   0  0  1   0  1  0      -1  0  0   0  0 -1   0 -1  0
                       0  1 -1   0  0 -1   1  0 -1       0 -1  1   0  0  1  -1  0  1
                      -1  0  1  -1  1  0  -1  0  0       1  0 -1   1 -1  0   1  0  0
                       0 -1  0   1 -1  0   0 -1  1       0  1  0  -1  1  0   0  1 -1
                       1  0 -1   0  0 -1   0  1 -1      -1  0  1   0  0  1   0 -1  1
                       0  1  0   0  0  1   1  0  0       0 -1  0   0  0 -1  -1  0  0
                       1  0 -1   0  1 -1   0  0 -1      -1  0  1   0 -1  1   0  0  1
                       0 -1  0   0 -1  1   1 -1  0       0  1  0   0  1 -1  -1  1  0
                      -1  0  1  -1  0  0  -1  1  0       1  0 -1   1  0  0   1 -1  0
                       0  1  0   1  0  0   0  0  1       0 -1  0  -1  0  0   0  0 -1
                       0  0 -1   0  1 -1   1  0 -1       0  0  1   0 -1  1  -1  0  1
                       1 -1  0   0 -1  1   0 -1  0      -1  1  0   0  1 -1   0  1  0
                       0  0  1   1  0  0   0  1  0       0  0 -1  -1  0  0   0 -1  0
                      -1  1  0  -1  0  0  -1  0  1       1 -1  0   1  0  0   1  0 -1
                       0  0  1   0  1  0   1  0  0       0  0 -1   0 -1  0  -1  0  0
                       1 -1  0   0 -1  0   0 -1  1      -1  1  0   0  1  0   0  1 -1
                       0  0 -1   1  0 -1   0  1 -1       0  0  1  -1  0  1   0 -1  1
                      -1  1  0  -1  0  1  -1  0  0       1 -1  0   1  0 -1   1  0  0
            tnons      0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
            typat      1  1
              wtk        0.12500    0.50000    0.37500
           xangst      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       1.3573395400E+00  1.3573395400E+00  1.3573395400E+00
            xcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.5650000000E+00  2.5650000000E+00  2.5650000000E+00
             xred      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.5000000000E-01  2.5000000000E-01  2.5000000000E-01
            znucl       14.00000

================================================================================

 chkinp: Checking input parameters for consistency.

================================================================================
== DATASET  1 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 1, }
dimensions: {natom: 2, nkpt: 3, mband: 100, nsppol: 1, nspinor: 1, nspden: 1, mpw: 435, }
cutoff_energies: {ecut:  16.0, pawecutdg:  -1.0, }
electrons: {nelect:   8.00000000E+00, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 6, }
...

 mkfilename: getwfk from: tgwr_2o_DS1_WFK

 mkfilename: getden from: tgwr_1o_DS1_DEN

 Exchange-correlation functional for the present dataset will be:
  GGA: Perdew-Burke-Ernzerhof functional - ixc=11
 Citation for XC functional:
  J.P.Perdew, K.Burke, M.Ernzerhof, PRL 77, 3865 (1996)

.Using double precision arithmetic; gwpc =  8

- Reading GS density from: tgwr_1o_DS1_DEN




--- Pseudopotential description ------------------------------------------------
- pspini: atom type   1  psp file is /Users/giantomassi/git_repos/abinit/tests/Pspdir/Psdj_nc_sr_04_pbe_std_psp8/Si.psp8
- pspatm: opening atomic psp file    /Users/giantomassi/git_repos/abinit/tests/Pspdir/Psdj_nc_sr_04_pbe_std_psp8/Si.psp8
- Si    ONCVPSP-3.2.3.1  r_core=   1.60303   1.72197   1.91712
- 14.00000   4.00000    170510                znucl, zion, pspdat
    8   11    2    4       600   0.00000      pspcod,pspxc,lmax,lloc,mmax,r2well
    5.99000000000000    4.00000000000000    0.00000000000000   rchrg,fchrg,qchrg
     nproj     2     2     2
     extension_switch     1
  pspatm : epsatm=    9.34321699
         --- l  ekb(1:nproj) --&gt;
             0    5.168965    0.829883
             1    2.571282    0.578307
             2   -2.427311   -0.488097
 pspatm: atomic psp has been read  and splines computed

   1.49491472E+02                                ecore*ucvol(ha*bohr**3)
--------------------------------------------------------------------------------

 Total charge density [el/Bohr^3]
)     Maximum=    8.5569E-02  at reduced coord.    0.1000    0.1000    0.7000
)     Minimum=    1.4870E-03  at reduced coord.    0.0000    0.0000    0.0000
   Integrated=    8.0000E+00
- Reading GS states from WFK file: tgwr_2o_DS1_WFK
  Mapping kBZ --&gt; kIBZ
 Legend: bz = TS(ibz) + g0 where isym is the index of the symrec operation S and itim is 1 if TR is used.
        BZ                                       IBZ                                       ibz  isym  itim  g0
     1  [ 0.0000E+00,  0.0000E+00,  0.0000E+00]  [ 0.0000E+00,  0.0000E+00,  0.0000E+00]     1     1     0  [0, 0, 0]
     2  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]     2     1     0  [0, 0, 0]
     3  [ 5.0000E-01,  5.0000E-01,  5.0000E-01]  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]     2     5     0  [1, 1, 1]
     4  [ 0.0000E+00,  0.0000E+00,  5.0000E-01]  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]     2     3     0  [0, 0, 0]
     5  [ 0.0000E+00,  5.0000E-01,  0.0000E+00]  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]     2     7     0  [0, 0, 0]
     6  [ 5.0000E-01,  5.0000E-01,  0.0000E+00]  [ 5.0000E-01,  5.0000E-01,  0.0000E+00]     3     1     0  [0, 0, 0]
     7  [ 5.0000E-01,  0.0000E+00,  5.0000E-01]  [ 5.0000E-01,  5.0000E-01,  0.0000E+00]     3     9     0  [1, 0, 1]
     8  [ 0.0000E+00,  5.0000E-01,  5.0000E-01]  [ 5.0000E-01,  5.0000E-01,  0.0000E+00]     3    17     0  [0, 0, 0]


  Mapping qBZ --&gt; qIBZ
 Legend: bz = TS(ibz) + g0 where isym is the index of the symrec operation S and itim is 1 if TR is used.
        BZ                                       IBZ                                       ibz  isym  itim  g0
     1  [ 0.0000E+00,  0.0000E+00,  0.0000E+00]  [ 0.0000E+00,  0.0000E+00,  0.0000E+00]     1     1     0  [0, 0, 0]
     2  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]     2     1     0  [0, 0, 0]
     3  [ 5.0000E-01,  5.0000E-01,  5.0000E-01]  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]     2     5     0  [1, 1, 1]
     4  [ 0.0000E+00,  0.0000E+00,  5.0000E-01]  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]     2     3     0  [0, 0, 0]
     5  [ 0.0000E+00,  5.0000E-01,  0.0000E+00]  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]     2     7     0  [0, 0, 0]
     6  [ 5.0000E-01,  5.0000E-01,  0.0000E+00]  [ 5.0000E-01,  5.0000E-01,  0.0000E+00]     3     1     0  [0, 0, 0]
     7  [ 5.0000E-01,  0.0000E+00,  5.0000E-01]  [ 5.0000E-01,  5.0000E-01,  0.0000E+00]     3     9     0  [1, 0, 1]
     8  [ 0.0000E+00,  5.0000E-01,  5.0000E-01]  [ 5.0000E-01,  5.0000E-01,  0.0000E+00]     3    17     0  [0, 0, 0]



 === Kohn-Sham gaps and band edges from IBZ mesh ===
 Indirect band gap semiconductor
 Fundamental gap:     0.707 (eV)
   VBM:    -0.354 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
   CBM:     0.354 (eV) at k: [ 5.0000E-01,  5.0000E-01,  0.0000E+00]
 Direct gap:         2.556 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]


- Optimizing MPI grid with mem_per_cpu_mb: 2.048000E+03 [Mb]
- Use `abinit run.abi --mem-per-cpu=4G` to set mem_per_cpu_mb in the submission script
- np_k  np_g  np_t  np_s  memb_per_cpu    efficiency       speedup
-    1     1     1     1   4.12178E+02   1.00000E+00   1.00000E+00
-
- Selected MPI grid:
- np_k  np_g  np_t  np_s  memb_per_cpu    efficiency       speedup
-    1     1     1     1   4.12178E+02   1.00000E+00   1.00000E+00

- Resident memory in Mb for G(g,g&#x27;,+/-tau) and chi(g,g&#x27;,tau):
- G_k(g,g,tau): 186.5
- Chi_q(g,g,tau): 9.9
- u_k(g,b): 1.9
- Temporary memory allocated inside the tau loops:
- G_k(r,g): 173.8
- chi_q(r,g): 40.1
- FFT uc_batch_size: 1
- FFT sc_batch_size: 1
 ==== Info on the gwr_t object ====

--- !GWR_params
iteration_state: {dtset: 1, }
gwr_task: G0W0
nband: 100
ntau: 6
ngkpt: [2, 2, 2, ]
ngqpt: [2, 2, 2, ]
chi_algo: supercell
sigma_algo: &#x27;BZ-convolutions&#x27;
nkibz: 3
nqibz: 3
inclvkb: 2
q0: [  1.00000000E-05,   2.00000000E-05,   3.00000000E-05, ]
gw_icutcoul: 6
green_mpw: 412
tchi_mpw: 190
g_ngfft: [12, 12, 12, 12, 12, 12, ]
gwr_boxcutmin:   1.00000000E+00
P gwr_np_kgts: [1, 1, 1, 1, ]
P np_kibz: [1, 1, 1, ]
P np_qibz: [1, 1, 1, ]
min_transition_energy_eV:   7.07322721E-01
max_transition_energy_eV:   1.04475612E+02
eratio:   1.47705721E+02
ft_max_err_t2w_cos:   2.89209381E-02
ft_max_err_w2t_cos:   2.86400623E-03
ft_max_err_t2w_sin:   7.19446763E-01
cosft_duality_error:   6.45172897E-04
Minimax imaginary tau/omega mesh in a.u.: !Tabular | # tau, weight(tau), omega, weight(omega)
    1 1.38455E-01   3.72941E-01   9.99589E-03   2.11026E-02
    2 9.09503E-01   1.31503E+00   3.74200E-02   3.73070E-02
    3 3.28166E+00   3.82961E+00   9.62519E-02   8.99217E-02
    4 9.80796E+00   1.01381E+01   2.52835E-01   2.55147E-01
    5 2.63488E+01   2.50323E+01   7.39607E-01   8.50598E-01
    6 6.70390E+01   6.29648E+01   2.66078E+00   3.94579E+00
...

 Cutting u(g) as ecutwfn: 1.000000E+01  &lt;  ecut: 1.600000E+01

 Computing chi0 head and wings with inclvkb: 2
 Using KS orbitals and KS energies...


 Computing diagonal matrix elements of Sigma_x
 Using KS orbitals and KS energies...



 Building Green&#x27;s functions from KS orbitals and KS energies...



 Building correlated screening Wc(i omega) ...

--- !EMACRO_WITHOUT_LOCAL_FIELDS
iteration_state: {dtset: 1, }
&#x27;epsilon_{iw, q -&gt; Gamma}(0,0)&#x27;: !Tabular |
      9.99589205E-03    5.52564360E+01    2.25946994E-18
      3.74199584E-02    4.99729175E+01   -3.42213777E-17
      9.62518851E-02    3.23467403E+01   -3.33490064E-17
      2.52835457E-01    1.04591346E+01    1.38474355E-17
      7.39607375E-01    2.37680464E+00    1.73989652E-19
      2.66078226E+00    1.11219821E+00   -1.54005829E-19
...


--- !EMACRO_WITH_LOCAL_FIELDS
iteration_state: {dtset: 1, }
&#x27;epsilon_{iw, q -&gt; Gamma}(0,0)&#x27;: !Tabular |
      9.99589205E-03    2.07789863E-02    0.00000000E+00
      3.74199584E-02    2.27508193E-02    0.00000000E+00
      9.62518851E-02    3.39654378E-02    0.00000000E+00
      2.52835457E-01    9.98946141E-02    0.00000000E+00
      7.39607375E-01    4.25122428E-01    0.00000000E+00
      2.66078226E+00    8.99429078E-01    0.00000000E+00
...



 Building Sigma_c with convolutions in k-space:
================================================================================
 QP results (energies in eV)
 Notations:
     E0: Kohn-Sham energy
     &lt;VxcDFT&gt;: Matrix elements of Vxc[n_val] without non-linear core correction (if any)
     SigX: Matrix elements of Sigma_x
     SigC(E0): Matrix elements of Sigma_c at E0
     Z: Renormalization factor
     E-E0: Difference between the QP and the KS energy.
     E-Eprev: Difference between QP energy at iteration i and i-1
     E: Quasi-particle energy
     Occ(E): Occupancy of QP state



--- !GWR_SelfEnergy_ee
iteration_state: {dtset: 1, }
kpoint     : [   0.000,    0.000,    0.000, ]
spin       : 1
gwr_scf_iteration: 1
gwr_task   : G0W0
QP_VBM_band: 4
QP_CBM_band: 5
KS_gap     :    2.556
QP_gap     :    3.672
Delta_QP_KS:    1.117
data: !Tabular |
     Band       E0 &lt;VxcDFT&gt;     SigX SigC(E0)        Z     E-E0  E-Eprev        E   Occ(E)
        2   -0.354  -11.319  -13.616    1.625    0.838   -0.562   -0.562   -0.916    2.000
        3   -0.354  -11.319  -13.616    1.625    0.838   -0.562   -0.562   -0.916    2.000
        4   -0.354  -11.319  -13.616    1.625    0.838   -0.562   -0.562   -0.916    2.000
        5    2.202  -10.034   -4.915   -4.445    0.824    0.555    0.555    2.757    0.000
        6    2.202  -10.034   -4.915   -4.445    0.824    0.555    0.555    2.757    0.000
        7    2.202  -10.034   -4.915   -4.445    0.824    0.555    0.555    2.757    0.000
...


--- !GWR_SelfEnergy_ee
iteration_state: {dtset: 1, }
kpoint     : [   0.500,    0.000,    0.000, ]
spin       : 1
gwr_scf_iteration: 1
gwr_task   : G0W0
QP_VBM_band: 4
QP_CBM_band: 5
KS_gap     :    2.733
QP_gap     :    3.804
Delta_QP_KS:    1.071
data: !Tabular |
     Band       E0 &lt;VxcDFT&gt;     SigX SigC(E0)        Z     E-E0  E-Eprev        E   Occ(E)
        3   -1.556  -11.058  -13.442    1.690    0.818   -0.566   -0.566   -2.122    2.000
        4   -1.556  -11.058  -13.442    1.690    0.818   -0.566   -0.566   -2.122    2.000
        5    1.177  -10.088   -5.037   -4.443    0.834    0.505    0.505    1.682    0.000
...


 === Kohn-Sham gaps and band edges from IBZ mesh ===
 Indirect band gap semiconductor
 Fundamental gap:     0.707 (eV)
   VBM:    -0.354 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
   CBM:     0.354 (eV) at k: [ 5.0000E-01,  5.0000E-01,  0.0000E+00]
 Direct gap:         2.556 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]


 === QP gaps and band edges taking into account Sigma_nk corrections for 2 k-points ===
 Indirect band gap semiconductor
 Fundamental gap:     1.269 (eV)
   VBM:    -0.916 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
   CBM:     0.354 (eV) at k: [ 5.0000E-01,  5.0000E-01,  0.0000E+00]
 Direct gap:         3.565 (eV) at k: [ 5.0000E-01,  5.0000E-01,  0.0000E+00]


== END DATASET(S) ==============================================================
================================================================================

 -outvars: echo values of variables after computation  --------
            acell      1.0260000000E+01  1.0260000000E+01  1.0260000000E+01 Bohr
              amu      2.80855000E+01
             bdgw           4       5       4       5
             ecut      1.60000000E+01 Hartree
          ecuteps      6.00000000E+00 Hartree
         ecutsigx      1.60000000E+01 Hartree
          ecutwfn      1.00000000E+01 Hartree
           etotal      0.0000000000E+00
            fcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
-          fftalg         312
         gwr_ntau           6
   gwr_sigma_algo           2
           istwfk        2    3    7
              ixc          11
              kpt      0.00000000E+00  0.00000000E+00  0.00000000E+00
                       5.00000000E-01  0.00000000E+00  0.00000000E+00
                       5.00000000E-01  5.00000000E-01  0.00000000E+00
            kptgw      0.00000000E+00  0.00000000E+00  0.00000000E+00
                       5.00000000E-01  0.00000000E+00  0.00000000E+00
         kptrlatt        2    0    0      0    2    0      0    0    2
          kptrlen      1.45098311E+01
P           mkmem           3
            natom           2
            nband         100
            ngfft          30      30      30
             nkpt           3
           nkptgw           2
             nsym          48
           ntypat           1
              occ      2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000
        optdriver           6
            rprim      0.0000000000E+00  5.0000000000E-01  5.0000000000E-01
                       5.0000000000E-01  0.0000000000E+00  5.0000000000E-01
                       5.0000000000E-01  5.0000000000E-01  0.0000000000E+00
          spgroup         227
           strten      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           symrel      1  0  0   0  1  0   0  0  1      -1  0  0   0 -1  0   0  0 -1
                       0 -1  1   0 -1  0   1 -1  0       0  1 -1   0  1  0  -1  1  0
                      -1  0  0  -1  0  1  -1  1  0       1  0  0   1  0 -1   1 -1  0
                       0  1 -1   1  0 -1   0  0 -1       0 -1  1  -1  0  1   0  0  1
                      -1  0  0  -1  1  0  -1  0  1       1  0  0   1 -1  0   1  0 -1
                       0 -1  1   1 -1  0   0 -1  0       0  1 -1  -1  1  0   0  1  0
                       1  0  0   0  0  1   0  1  0      -1  0  0   0  0 -1   0 -1  0
                       0  1 -1   0  0 -1   1  0 -1       0 -1  1   0  0  1  -1  0  1
                      -1  0  1  -1  1  0  -1  0  0       1  0 -1   1 -1  0   1  0  0
                       0 -1  0   1 -1  0   0 -1  1       0  1  0  -1  1  0   0  1 -1
                       1  0 -1   0  0 -1   0  1 -1      -1  0  1   0  0  1   0 -1  1
                       0  1  0   0  0  1   1  0  0       0 -1  0   0  0 -1  -1  0  0
                       1  0 -1   0  1 -1   0  0 -1      -1  0  1   0 -1  1   0  0  1
                       0 -1  0   0 -1  1   1 -1  0       0  1  0   0  1 -1  -1  1  0
                      -1  0  1  -1  0  0  -1  1  0       1  0 -1   1  0  0   1 -1  0
                       0  1  0   1  0  0   0  0  1       0 -1  0  -1  0  0   0  0 -1
                       0  0 -1   0  1 -1   1  0 -1       0  0  1   0 -1  1  -1  0  1
                       1 -1  0   0 -1  1   0 -1  0      -1  1  0   0  1 -1   0  1  0
                       0  0  1   1  0  0   0  1  0       0  0 -1  -1  0  0   0 -1  0
                      -1  1  0  -1  0  0  -1  0  1       1 -1  0   1  0  0   1  0 -1
                       0  0  1   0  1  0   1  0  0       0  0 -1   0 -1  0  -1  0  0
                       1 -1  0   0 -1  0   0 -1  1      -1  1  0   0  1  0   0  1 -1
                       0  0 -1   1  0 -1   0  1 -1       0  0  1  -1  0  1   0 -1  1
                      -1  1  0  -1  0  1  -1  0  0       1 -1  0   1  0 -1   1  0  0
            tnons      0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
            typat      1  1
              wtk        0.12500    0.50000    0.37500
           xangst      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       1.3573395400E+00  1.3573395400E+00  1.3573395400E+00
            xcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.5650000000E+00  2.5650000000E+00  2.5650000000E+00
             xred      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.5000000000E-01  2.5000000000E-01  2.5000000000E-01
            znucl       14.00000

================================================================================


- Timing analysis has been suppressed with timopt=0



================================================================================

 Suggested references for the acknowledgment of ABINIT usage.

 The users of ABINIT have little formal obligations with respect to the ABINIT group
 (those specified in the GNU General Public License, http://www.gnu.org/copyleft/gpl.txt).
 However, it is common practice in the scientific literature,
 to acknowledge the efforts of people that have made the research possible.
 In this spirit, please find below suggested citations of work written by ABINIT developers,
 corresponding to implementations inside of ABINIT that you have used in the present run.
 Note also that it will be of great value to readers of publications presenting these results,
 to read papers enabling them to understand the theoretical formalism and details
 of the ABINIT implementation.
 For information on why they are suggested, see also https://docs.abinit.org/theory/acknowledgments.
-
- [1] The Abinit project: Impact, environment and recent developments.
- Computer Phys. Comm. 248, 107042 (2020).
- X.Gonze, B. Amadon, G. Antonius, F.Arnardi, L.Baguet, J.-M.Beuken,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, N.Brouwer, F.Bruneval,
- G.Brunin, T.Cavignac, J.-B. Charraud, Wei Chen, M.Cote, S.Cottenier,
- J.Denier, G.Geneste, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, Xu He, N.Helbig, N.Holzwarth, Y.Jia, F.Jollet,
- W.Lafargue-Dit-Hauret, K.Lejaeghere, M.A.L.Marques, A.Martin, C.Martins,
- H.P.C. Miranda, F.Naccarato, K. Persson, G.Petretto, V.Planes, Y.Pouillon,
- S.Prokhorenko, F.Ricci, G.-M.Rignanese, A.H.Romero, M.M.Schmitt, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, G.Zerah and J.W.Zwanzig
- Comment: the fifth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm.
- is available at https://www.abinit.org/sites/default/files/ABINIT20.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2020
-
- [2] Optimized norm-conserving Vanderbilt pseudopotentials.
- D.R. Hamann, Phys. Rev. B 88, 085117 (2013).
- Comment: Some pseudopotential generated using the ONCVPSP code were used.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#hamann2013
-
- [3] ABINIT: Overview, and focus on selected capabilities
- J. Chem. Phys. 152, 124102 (2020).
- A. Romero, D.C. Allan, B. Amadon, G. Antonius, T. Applencourt, L.Baguet,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, F.Bruneval,
- G.Brunin, D.Caliste, M.Cote,
- J.Denier, C. Dreyer, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, F.Jollet, G. Jomard,
- A.Martin,
- H.P.C. Miranda, F.Naccarato, G.Petretto, N.A. Pike, V.Planes,
- S.Prokhorenko, T. Rangel, F.Ricci, G.-M.Rignanese, M.Royo, M.Stengel, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, J.Wiktor, J.W.Zwanziger, and X.Gonze.
- Comment: a global overview of ABINIT, with focus on selected capabilities .
- Note that a version of this paper, that is not formatted for J. Chem. Phys
- is available at https://www.abinit.org/sites/default/files/ABINIT20_JPC.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#romero2020
-
- [4] Recent developments in the ABINIT software package.
- Computer Phys. Comm. 205, 106 (2016).
- X.Gonze, F.Jollet, F.Abreu Araujo, D.Adams, B.Amadon, T.Applencourt,
- C.Audouze, J.-M.Beuken, J.Bieder, A.Bokhanchuk, E.Bousquet, F.Bruneval
- D.Caliste, M.Cote, F.Dahm, F.Da Pieve, M.Delaveau, M.Di Gennaro,
- B.Dorado, C.Espejo, G.Geneste, L.Genovese, A.Gerossier, M.Giantomassi,
- Y.Gillet, D.R.Hamann, L.He, G.Jomard, J.Laflamme Janssen, S.Le Roux,
- A.Levitt, A.Lherbier, F.Liu, I.Lukacevic, A.Martin, C.Martins,
- M.J.T.Oliveira, S.Ponce, Y.Pouillon, T.Rangel, G.-M.Rignanese,
- A.H.Romero, B.Rousseau, O.Rubel, A.A.Shukri, M.Stankovski, M.Torrent,
- M.J.Van Setten, B.Van Troeye, M.J.Verstraete, D.Waroquier, J.Wiktor,
- B.Xu, A.Zhou, J.W.Zwanziger.
- Comment: the fourth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm.
- is available at https://www.abinit.org/sites/default/files/ABINIT16.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2016
-
- And optionally:
-
- [5] ABINIT: First-principles approach of materials and nanosystem properties.
- Computer Phys. Comm. 180, 2582-2615 (2009).
- X. Gonze, B. Amadon, P.-M. Anglade, J.-M. Beuken, F. Bottin, P. Boulanger, F. Bruneval,
- D. Caliste, R. Caracas, M. Cote, T. Deutsch, L. Genovese, Ph. Ghosez, M. Giantomassi
- S. Goedecker, D.R. Hamann, P. Hermet, F. Jollet, G. Jomard, S. Leroux, M. Mancini, S. Mazevet,
- M.J.T. Oliveira, G. Onida, Y. Pouillon, T. Rangel, G.-M. Rignanese, D. Sangalli, R. Shaltaf,
- M. Torrent, M.J. Verstraete, G. Zerah, J.W. Zwanziger
- Comment: the third generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm.
- is available at https://www.abinit.org/sites/default/files/ABINIT_CPC_v10.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2009
-
- Proc.   0 individual time (sec): cpu=          9.4  wall=          9.4

================================================================================

 Calculation completed.
.Delivered   1 WARNINGs and   8 COMMENTs to log file.
+Overall time at end (sec) : cpu=          9.4  wall=          9.4
- [ALL OK] MEMORY CONSUMPTION REPORT FOR C CODE:
-   There were 40 allocations and 40 deallocations in C code
- [ALL OK] MEMORY CONSUMPTION REPORT FOR FORTRAN CODE:
-   There were 1065409 allocations and 1065409 deallocations in Fortran
-   Remaining memory at the end of the calculation is 0

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-5f931e72-4cbd-4531-a8b7-b861c3a73095", "#uuid-c54bbd07-042c-44e8-ab2f-add691636350") }); </script>

<p>First of all, we have a Yaml document that summarizes the most important GWR parameters:</p>
<div class="highlight"><pre><span></span><code><span class="nn">---</span><span class="w"> </span><span class="kt">!GWR_params</span>
<span class="nt">iteration_state</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">dtset</span><span class="p">:</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">}</span>
<span class="nt">gwr_task</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">G0W0</span>
<span class="nt">nband</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="nt">ntau</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6</span>
<span class="nt">ngkpt</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="nt">ngqpt</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="nt">chi_algo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">supercell</span>
<span class="nt">sigma_algo</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;BZ-convolutions&#39;</span>
<span class="nt">nkibz</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="nt">nqibz</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="nt">inclvkb</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="nt">q0</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w">  </span><span class="nv">1.00000000E-05</span><span class="p p-Indicator">,</span><span class="w">   </span><span class="nv">2.00000000E-05</span><span class="p p-Indicator">,</span><span class="w">   </span><span class="nv">3.00000000E-05</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="nt">gw_icutcoul</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6</span>
<span class="nt">green_mpw</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">412</span>
<span class="nt">tchi_mpw</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">190</span>
<span class="nt">g_ngfft</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">12</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">12</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">12</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">12</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">12</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">12</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="nt">gwr_boxcutmin</span><span class="p">:</span><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">1.00000000E+00</span>
<span class="nt">P gwr_np_kgts</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="nt">P np_kibz</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="nt">P np_qibz</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="nt">min_transition_energy_eV</span><span class="p">:</span><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">7.07322721E-01</span>
<span class="nt">max_transition_energy_eV</span><span class="p">:</span><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">1.04475612E+02</span>
<span class="nt">eratio</span><span class="p">:</span><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">1.47705721E+02</span>
<span class="nt">ft_max_err_t2w_cos</span><span class="p">:</span><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">2.89209381E-02</span>
<span class="nt">ft_max_err_w2t_cos</span><span class="p">:</span><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">2.86400623E-03</span>
<span class="nt">ft_max_err_t2w_sin</span><span class="p">:</span><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">7.19446763E-01</span>
<span class="nt">cosft_duality_error</span><span class="p">:</span><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">6.45172897E-04</span>
<span class="nt">Minimax imaginary tau/omega mesh in a.u.</span><span class="p">:</span><span class="w"> </span><span class="kt">!Tabular</span><span class="w"> </span><span class="p p-Indicator">|</span><span class="w"> </span><span class="c1"># tau, weight(tau), omega, weight(omega)</span>
<span class="w">    </span><span class="no">1 1.38455E-01   3.72941E-01   9.99589E-03   2.11026E-02</span>
<span class="w">    </span><span class="no">2 9.09503E-01   1.31503E+00   3.74200E-02   3.73070E-02</span>
<span class="w">    </span><span class="no">3 3.28166E+00   3.82961E+00   9.62519E-02   8.99217E-02</span>
<span class="w">    </span><span class="no">4 9.80796E+00   1.01381E+01   2.52835E-01   2.55147E-01</span>
<span class="w">    </span><span class="no">5 2.63488E+01   2.50323E+01   7.39607E-01   8.50598E-01</span>
<span class="w">    </span><span class="no">6 6.70390E+01   6.29648E+01   2.66078E+00   3.94579E+00</span>
<span class="nn">...</span>
</code></pre></div>
<p>Some of the entries in this dictionary have a direct correspondence with ABINIT variables and
won&rsquo;t be discussed here. The meaning of the other variables is reported below:</p>
<ul>
<li><code>nkibz</code>: Number of <span class="arithmatex">\(\kk\)</span>-points in the IBZ</li>
<li><code>qkibz</code>: Number of <span class="arithmatex">\(\qq\)</span>-points in the IBZ</li>
<li><code>green_mpw</code>: maximum number of PWs for the Green&rsquo;s function.</li>
<li><code>tchi_mpw</code>: maximum number of PWs for the polarizability.</li>
<li><code>g_ngfft</code>: FFT mesh in the unit cell used for the different MBPT quantities.</li>
<li><code>min_transition_energy_eV</code>, <code>max_transition_energy_eV</code>: min/max transition energies
leading to the energy ratio <code>eratio</code> used to select the minimax mesh.</li>
</ul>
<p><code>green_mpw</code> is computed from <a class="wikilink codevar-wikilink" href="/variables/basic#ecut">ecut</a>, while <code>tchi_mpw</code> is defined by <a class="wikilink codevar-wikilink" href="/variables/gw#ecuteps">ecuteps</a>
This two numbers are directly related to the memory footprint as they define
of the size of the matrices that must be stored in memory.</p>
<!--
TODO: Describe other entries
-->

<p>Finally, we have the most important section with the QP results in eV units:</p>
<div class="highlight"><pre><span></span><code>================================================================================
 QP results (energies in eV)
 Notations:
     E0: Kohn-Sham energy
     &lt;VxcDFT&gt;: Matrix elements of Vxc[n_val] without non-linear core correction (if any)
     SigX: Matrix elements of Sigma_x
     SigC(E0): Matrix elements of Sigma_c at E0
     Z: Renormalization factor
     E-E0: Difference between the QP and the KS energy.
     E-Eprev: Difference between QP energy at iteration i and i-1
     E: Quasi-particle energy
     Occ(E): Occupancy of QP state



--- !GWR_SelfEnergy_ee
iteration_state: {dtset: 1, }
kpoint     : [   0.000,    0.000,    0.000, ]
spin       : 1
gwr_scf_iteration: 1
gwr_task   : G0W0
QP_VBM_band: 4
QP_CBM_band: 5
KS_gap     :    2.556
QP_gap     :    3.672
Delta_QP_KS:    1.117
data: !Tabular |
     Band       E0 &lt;VxcDFT&gt;     SigX SigC(E0)        Z     E-E0  E-Eprev        E   Occ(E)
        2   -0.354  -11.319  -13.616    1.625    0.838   -0.562   -0.562   -0.916    2.000
        3   -0.354  -11.319  -13.616    1.625    0.838   -0.562   -0.562   -0.916    2.000
        4   -0.354  -11.319  -13.616    1.625    0.838   -0.562   -0.562   -0.916    2.000
        5    2.202  -10.034   -4.915   -4.445    0.824    0.555    0.555    2.757    0.000
        6    2.202  -10.034   -4.915   -4.445    0.824    0.555    0.555    2.757    0.000
        7    2.202  -10.034   -4.915   -4.445    0.824    0.555    0.555    2.757    0.000
...


--- !GWR_SelfEnergy_ee
iteration_state: {dtset: 1, }
kpoint     : [   0.500,    0.000,    0.000, ]
spin       : 1
gwr_scf_iteration: 1
gwr_task   : G0W0
QP_VBM_band: 4
QP_CBM_band: 5
KS_gap     :    2.733
QP_gap     :    3.804
Delta_QP_KS:    1.071
data: !Tabular |
     Band       E0 &lt;VxcDFT&gt;     SigX SigC(E0)        Z     E-E0  E-Eprev        E   Occ(E)
        3   -1.556  -11.058  -13.442    1.690    0.818   -0.566   -0.566   -2.122    2.000
        4   -1.556  -11.058  -13.442    1.690    0.818   -0.566   -0.566   -2.122    2.000
        5    1.177  -10.088   -5.037   -4.443    0.834    0.505    0.505    1.682    0.000
...
</code></pre></div>
<p>The meaning of the different columns should be self-explanatory.</p>
<p>As usual, we can use <code>abiopen.py</code> with the <code>-p</code> (<code>--print</code>) option to print to screen
a summary of the most important results. Use, for instance:</p>
<div class="highlight"><pre><span></span><code>abiopen.py tgwr_3o_GWR.nc -p
</code></pre></div>
<p>The last section gives the QP direct gaps:</p>
<div class="highlight"><pre><span></span><code>=============================== GWR parameters ===============================
gwr_task: G0W0
Number of k-points in Sigma_{nk}: 2
Number of bands included in e-e self-energy sum: 100
ecut: 16.0
ecutwfn: 10.0
ecutsigx: 16.0
ecuteps: 6.0
gwr_boxcutmin: 1.0

============================ QP direct gaps in eV ============================
            kpoint     kname  ks_dirgaps  qpz0_dirgaps  spin
0  [0.0, 0.0, 0.0]  $\Gamma$    2.555626      3.672337     0
1  [0.5, 0.0, 0.0]         L    2.732704      3.803596     0
</code></pre></div>
<p>The calculation has produced three different text files:</p>
<p><code>tgwr_3o_SIGC_IT</code>:
Diagonal elements of <span class="arithmatex">\(\Sigma_c(i \tau)\)</span> in atomic units</p>
<p><code>tgwr_3o_SIGXC_IW</code>:
Diagonal elements of <span class="arithmatex">\(\Sigma_\xc(i \omega)\)</span> in eV units</p>
<p><code>tgwr_3o_SIGXC_RW</code>:
Diagonal elements of <span class="arithmatex">\(\Sigma_\xc(\omega)\)</span> in eV units and spectral function <span class="arithmatex">\(A_\nk(\omega)\)</span></p>
<p>Finally, we have a netcdf file named <code>tgwr_3o_GWR.nc</code> storing the same data in binary format.
This file can be easily post-processed with AbiPy using:</p>
<div class="highlight"><pre><span></span><code>abiopen.py tgwr_3o_GWR.nc -e
</code></pre></div>
<p>If you need more control, you can use the following
<a href="https://abinit.github.io/abipy/gallery/plot_gwr.html">AbiPy example</a>.
and customize according to your needs.
Please take some time to read the script and understand how this post-processing tool
works before proceeding to the next section.</p>
<h3 id="extracting-useful-info-from-the-gwr-log-file">Extracting useful info from the GWR log file<a class="headerlink" href="#extracting-useful-info-from-the-gwr-log-file" title="Permanent link">&para;</a></h3>
<p>This section discusses some shell commands that are useful to understand
the resources required by your GWR calculation.</p>
<p>To extract the memory allocated for the most memory demanding arrays, use:</p>
<div class="highlight"><pre><span></span><code>grep &quot;&lt;&lt;&lt; MEM&quot; log

- Local memory for u_gb wavefunctions: 1.9  [Mb] &lt;&lt;&lt; MEM
- Local memory for G(g,g&#39;,kibz,itau): 185.6  [Mb] &lt;&lt;&lt; MEM
- Local memory for Chi(g,g&#39;,qibz,itau): 17.8  [Mb] &lt;&lt;&lt; MEM
- Local memory for Wc(g,g,qibz,itau): 17.8  [Mb] &lt;&lt;&lt; MEM
</code></pre></div>
<p>To have a measure of how much RAM the process is actually using, use:</p>
<div class="highlight"><pre><span></span><code>grep vmrss_mb log

vmrss_mb:   1.93379297E+03
</code></pre></div>
<p>To extract the wall-time and cpu-time for the most important sections, use:</p>
<div class="highlight"><pre><span></span><code>grep &quot;&lt;&lt;&lt; TIME&quot; log

gwr_read_ugb_from_wfk: , wall:  0.00 [s] , cpu:  0.00 [s] &lt;&lt;&lt; TIME
gwr_build_chi0_head_and_wings: , wall:  0.31 [s] , cpu:  0.31 [s] &lt;&lt;&lt; TIME
gwr_build_sigxme: , wall:  0.02 [s] , cpu:  0.02 [s] &lt;&lt;&lt; TIME
gwr_build_green: , wall:  0.31 [s] , cpu:  0.31 [s] &lt;&lt;&lt; TIME
gwr_build_tchi: , wall: 10.89 [s] , cpu: 10.87 [s] &lt;&lt;&lt; TIME
gwr_build_wc: , wall:  0.11 [s] , cpu:  0.11 [s] &lt;&lt;&lt; TIME
gwr_build_sigmac: , wall:  5.92 [s] , cpu:  5.90 [s] &lt;&lt;&lt; TIME
</code></pre></div>
<p>To obtain the wall-time and cpu-time required by the different datasets, use:</p>
<div class="highlight"><pre><span></span><code>grep &quot;dataset:&quot; log | grep &quot;&lt;&lt;&lt; TIME&quot;
dataset: 1 , wall: 17.90 [s] , cpu: 17.83 [s] &lt;&lt;&lt; TIME
</code></pre></div>
<p>Finally, use <a class="wikilink codevar-wikilink" href="/variables/gstate#timopt">timopt</a> 1 to have a detailed analysis of the time spent
in the different parts of the code at the end of the calculation.</p>
<h3 id="convergence-study-howto">Convergence study HOWTO<a class="headerlink" href="#convergence-study-howto" title="Permanent link">&para;</a></h3>
<p>As discussed in <a class="wikilink citation-wikilink" data-tippy-content="Automation methodologies and large-scale validation for GW: Towards high-throughput GW calculations" data-toggle="popover" href="/theory/bibliography#setten2017">[Setten2017]</a>, the convergence studies for
the <span class="arithmatex">\(\kk\)</span>-mesh, <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>, and the cutoff energies can be decoupled.
This means that one can start with a relatively coarse <span class="arithmatex">\(\kk\)</span>-mesh to determine
the converged values of <a class="wikilink codevar-wikilink" href="/variables/gw#ecutsigx">ecutsigx</a>, <a class="wikilink codevar-wikilink" href="/variables/gw#ecutwfn">ecutwfn</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>, <a class="wikilink codevar-wikilink" href="/variables/gw#ecuteps">ecuteps</a>, and <a class="wikilink codevar-wikilink" href="/variables/gwr#gwr_boxcutmin">gwr_boxcutmin</a>,
then fix these values, and refine the BZ sampling only at the end.
The recommended procedure for converging GWR gaps is therefore as follows:</p>
<p>1) Initial step:</p>
<ul>
<li>Select the <span class="arithmatex">\(\kk\)</span>-points where QP gaps are wanted.
  Usually the VBM and the CBM so that one can use <a class="wikilink codevar-wikilink" href="/variables/gwr#gwr_sigma_algo">gwr_sigma_algo</a> 2.</li>
<li>Fix the <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a> <span class="arithmatex">\(\kk\)</span>-mesh in the WFK file to a resonable value and produce &ldquo;enough&rdquo; <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> states
  with the direct diagonalization.</li>
<li>Set an initial value for <a class="wikilink codevar-wikilink" href="/variables/gwr#gwr_ntau">gwr_ntau</a> in the GWR run.</li>
</ul>
<!--
  Be aware that [[gwr_ntau]] = 6 may be too small, potentially leading to unphysical results
  such as renormalization factors $Z$ below 0.6.
  If this occurs, increase [[gwr_ntau]] in order to fix the problem.
, and [[ecutsigx]].
-->

<p>2) Convergence the QP gaps wrt <a class="wikilink codevar-wikilink" href="/variables/gw#ecutwfn">ecutwfn</a></p>
<p>3) Convergence wrt <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a>, <a class="wikilink codevar-wikilink" href="/variables/gw#ecuteps">ecuteps</a>, and <a class="wikilink codevar-wikilink" href="/variables/gw#ecutsigx">ecutsigx</a></p>
<p>If the number of <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> states in the WFK file is not large enough,
go back to point 1) and generate a new WFK with more bands else proceeed with the next step.</p>
<p>4) Convergence wrt <a class="wikilink codevar-wikilink" href="/variables/gwr#gwr_ntau">gwr_ntau</a>:</p>
<p>Once the results are converged with respect to <a class="wikilink codevar-wikilink" href="/variables/gw#ecutwfn">ecutwfn</a>, <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> and <a class="wikilink codevar-wikilink" href="/variables/gw#ecuteps">ecuteps</a>,
you may start to increase <a class="wikilink codevar-wikilink" href="/variables/gwr#gwr_ntau">gwr_ntau</a>while adjusting the number of MPI processes accordingly
(you are not using multidatasets, right?)</p>
<p>5) Convergence wrt <a class="wikilink codevar-wikilink" href="/variables/basic#ngkpt">ngkpt</a>:</p>
<p>Finally, refine the BZ sampling to ensure full convergence.
Make sure that all these <span class="arithmatex">\(\kk\)</span>-meshes contain the points you are trying to converge.
Clearly, one has perform a direct diagonalization from scratch for each <span class="arithmatex">\(\kk\)</span>-mesh.</p>
<p>5) Convergence wrt <a class="wikilink codevar-wikilink" href="/variables/gwr#gwr_boxcutmin">gwr_boxcutmin</a>:</p>
<ul>
<li>Increase it gradually to control memory usage and CPU time, which increase rapidly with this parameter.</li>
</ul>
<p>Once a good setup have been found, one can use the same parameters to compute the QP corrections in the IBZ
using <a class="wikilink codevar-wikilink" href="/variables/gwr#gwr_sigma_algo">gwr_sigma_algo</a> 2 and <a class="wikilink codevar-wikilink" href="/variables/gw#gw_qprange">gw_qprange</a> = <code>-NUM</code> to have a <code>GWR.nc</code> file that can be used to
perform an interpolation of the GW band structure as discussed in the last part of this tutorial.</p>
<p>Note that, due to cancellations of errors, QP gaps that are differences between QP energies
are usually much easier to convergence than QP values.
Fortunately, absolute values are important only in rather specialized studies such as work function
or band alignment in heterostructures.
In this tutorial, we only focus on gaps, and we aim to achieve an overall convergence of the QP gaps 0.01 eV (10 meV).
As a consequence we will try to reach a convergence of 2 meV.</p>
<p>In the next sections, we explain how to perform these convergence studies and how to use AbiPy to analyze the results.
Note that we will not provide ready-to-use input files.
Your task is therefore to modify <code>tgwr_3.abi</code>, run the calculations (possibly in parallel), and then analyze the results.</p>
<h3 id="convergence-wrt-ecutwfn">Convergence wrt ecutwfn<a class="headerlink" href="#convergence-wrt-ecutwfn" title="Permanent link">&para;</a></h3>
<p>The first parameter we check for convergence is the cutoff energy <a class="wikilink codevar-wikilink" href="/variables/gw#ecutwfn">ecutwfn</a> used to build the Green&rsquo;s function.
This value has a big impact on the computational cost and, most importantly, on the memory footprint
as the number of PWs scales as:</p>
<div class="arithmatex">\[\begin{equation}
N_{\text{PW}} \propto \Omega \cdot E_{\text{cutwfn}}^{3/2}
\end{equation}\]</div>
<p>hence the memory required for <span class="arithmatex">\(G_\kk(\bg,\bg')\)</span> scales with the cube of <a class="wikilink codevar-wikilink" href="/variables/gw#ecutwfn">ecutwfn</a> and
quadratically with the unit cell volume <span class="arithmatex">\(\Omega\)</span>.
To monitor the convergence of the QP direct gaps, we define a multidataset by adding
the following section to <code>tgwr_3.abi</code>:</p>
<div class="highlight"><pre><span></span><code>ndtset<span class="w"> </span><span class="m">5</span>
ecutwfn:<span class="w"> </span><span class="m">8</span>
ecutwfn+<span class="w"> </span><span class="m">2</span>
</code></pre></div>
<p>Once the calculation is finished, we can use the <code>GwrRobot</code> to load the list of GWR.nc files
and plot the convergence of the direct QP gaps with the following python script:</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python</span>

<span class="n">filepaths</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;tgwr_3o_DS</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_GWR.nc&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)]</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">abipy.electrons.gwr</span><span class="w"> </span><span class="kn">import</span> <span class="n">GwrRobot</span>
<span class="n">robot</span> <span class="o">=</span> <span class="n">GwrRobot</span><span class="o">.</span><span class="n">from_files</span><span class="p">(</span><span class="n">filepaths</span><span class="p">)</span>

<span class="c1"># Convergence window in eV</span>
<span class="n">abs_conv</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="n">robot</span><span class="o">.</span><span class="n">plot_qpgaps_convergence</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;ecutwfn&quot;</span><span class="p">,</span> <span class="n">abs_conv</span><span class="o">=</span><span class="n">abs_conv</span><span class="p">,</span>
                              <span class="n">savefig</span><span class="o">=</span><span class="s2">&quot;conv_ecuwfn.png&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Save the script in a file, lets say <code>conv_ecutwfn.py</code>, in the same
directory where we have launched the calculation, make the file executable with:</p>
<div class="highlight"><pre><span></span><code>chmod u+x conv_ecutwfn.py
</code></pre></div>
<p>and then run it with:</p>
<div class="highlight"><pre><span></span><code>./conv_ecutwfn.py
</code></pre></div>
<p>You should obtain the following results:</p>
<p><img alt="" src="../gwr_assets/conv_ecutwfn.png" /></p>
<p>On the basis of this convergence study, we can safely use <a class="wikilink codevar-wikilink" href="/variables/gw#ecutwfn">ecutwfn</a> = 10.</p>
<p>Since we will continue using <code>tgwr_3.abi</code> to perform other convergence studies,
it is a good idea to move the previously generated GWR.nc files and the python script
to a new directory to avoid overlaps between different calculations.
You can, for example, use the following list of shell commands:</p>
<div class="highlight"><pre><span></span><code>mkdir conv_ecutwfn
mv conv_ecutwfn.py conv_ecutwfn
mv tgwr_3o_* log conv_ecutwfn
</code></pre></div>
<h3 id="convergence-wrt-nband-and-ecuteps">Convergence wrt nband and ecuteps<a class="headerlink" href="#convergence-wrt-nband-and-ecuteps" title="Permanent link">&para;</a></h3>
<p>To perform a double convergence study in <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> and <a class="wikilink codevar-wikilink" href="/variables/gw#ecuteps">ecuteps</a>,
define a double loop with <a class="wikilink codevar-wikilink" href="/variables/basic#udtset">udtset</a>, and add this section to <code>tgwr_3.abi</code>:</p>
<div class="highlight"><pre><span></span><code>ndtset<span class="w"> </span><span class="m">16</span><span class="w">    </span><span class="c1"># NB: ndtset must be equal to udtset[0] * udtset[1]</span>
udtset<span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">4</span>

<span class="c1">#inner loop: increase nband. The number of iterations is given by udtset[0]</span>
nband:?<span class="w"> </span><span class="m">150</span><span class="w">    </span>nband+?<span class="w"> </span><span class="m">50</span>

<span class="c1">#outer loop: increase ecuteps. The number of iterations is given by udtset[1]</span>
ecuteps?:<span class="w"> </span><span class="m">6</span><span class="w">     </span>ecuteps?+<span class="w">  </span><span class="m">2</span>
</code></pre></div>
<p>If we analyze the wall-time required by each dataset, we observe
that, at variance with the conventional GW code,
the values of <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> and <a class="wikilink codevar-wikilink" href="/variables/gw#ecuteps">ecuteps</a> have little impact of the computational cost.</p>
<div class="highlight"><pre><span></span><code>grep &quot;dataset:&quot; log | grep &quot;&lt;&lt; TIME&quot;
</code></pre></div>
<!--
As concerns [[nband]] this is expected, as this parameter enters into play
only during the computation of the Green's function.
For [[ecuteps]] this is due to the FFT algorithm.
Of course, we are not saying that the wall-time does not depend on these two parameters.
Increasing [[ecuteps]] definitely has a greater effect in terms of wall-time.
-->

<p>Once the calculation is completed, plot the convergence of the direct QP gaps with the following script:</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python</span>

<span class="n">udtset</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>  <span class="c1"># Should be equal to the grid used in the ABINIT input file</span>

<span class="n">filepaths</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;tgwr_3o_DS</span><span class="si">{</span><span class="n">i</span><span class="si">}{</span><span class="n">j</span><span class="si">}</span><span class="s2">_GWR.nc&quot;</span>
             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">udtset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">udtset</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">abipy.electrons.gwr</span><span class="w"> </span><span class="kn">import</span> <span class="n">GwrRobot</span>
<span class="n">robot</span> <span class="o">=</span> <span class="n">GwrRobot</span><span class="o">.</span><span class="n">from_files</span><span class="p">(</span><span class="n">filepaths</span><span class="p">)</span>

<span class="c1"># Convergence window in eV</span>
<span class="n">abs_conv</span> <span class="o">=</span> <span class="mf">0.005</span>

<span class="n">robot</span><span class="o">.</span><span class="n">plot_qpgaps_convergence</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;nband&quot;</span><span class="p">,</span>
                              <span class="n">abs_conv</span><span class="o">=</span><span class="n">abs_conv</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;ecuteps&quot;</span><span class="p">,</span>
                              <span class="n">savefig</span><span class="o">=</span><span class="s2">&quot;conv_nband_ecuteps.png&quot;</span><span class="p">,</span>
                              <span class="p">)</span>

<span class="n">robot</span><span class="o">.</span><span class="n">plot_qpgaps_convergence</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;ecuteps&quot;</span><span class="p">,</span>
                              <span class="n">abs_conv</span><span class="o">=</span><span class="n">abs_conv</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;nband&quot;</span><span class="p">,</span>
                              <span class="n">savefig</span><span class="o">=</span><span class="s2">&quot;conv_ecuteps_nband.png&quot;</span><span class="p">,</span>
                              <span class="p">)</span>
</code></pre></div>
<p>Again, save the script in a file, lets say <code>conv_nband_ecuteps.py</code>, in the same
directory where we have launched the calculation, make the file executable and run it with:</p>
<div class="highlight"><pre><span></span><code>./conv_nband_ecuteps.py
</code></pre></div>
<p>You should obtain the following plots:</p>
<p><img alt="" src="../gwr_assets/conv_ecuteps_nband.png" /></p>
<p><img alt="" src="../gwr_assets/conv_nband_ecuteps.png" /></p>
<p>On the basis of this convergence study, we decide to use <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> = 250 and <a class="wikilink codevar-wikilink" href="/variables/gw#ecuteps">ecuteps</a> = 10.</p>
<!--
In the [first GW tutorial](/tutorial/gw1), we have already performed convergence studies,
and [[nband]] = 100 was found to give results converged within 30 mev, which is fair to compare with experimental accuracy.
Also ecuteps = 6.0 can be considered converged within 10 meV.
We will not repeat these convergence studies here, we just use these values for our calculation so that
we can focus on the analysis of the output file and the post-processing of the results.
Since we will continue using `tgwr_3.abi` to perform other convergence studies,
it is a good idea to move the previously generated GWR.nc files and the python script
to a new directory to avoid overlaps between different calculations.
You can, for example, use the following list of shell commands:
!-->

<p>Before proceeding with the next sections, save the results in a different directory by executing:</p>
<div class="highlight"><pre><span></span><code>mkdir conv_nband_ecuteps
mv conv_nband_ecuteps.py conv_nband_ecuteps
mv tgwr_3o_* log conv_nband_ecuteps
</code></pre></div>
<h3 id="convergence-wrt-gwr_ntau">Convergence wrt gwr_ntau<a class="headerlink" href="#convergence-wrt-gwr_ntau" title="Permanent link">&para;</a></h3>
<p>Now edit <code>tgwr_3.abi</code>, replace the values of <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> and <a class="wikilink codevar-wikilink" href="/variables/gw#ecuteps">ecuteps</a> found earlier,
and define a new one-dimensional multi-dataset to increase <a class="wikilink codevar-wikilink" href="/variables/gwr#gwr_ntau">gwr_ntau</a>:</p>
<div class="highlight"><pre><span></span><code>ndtset      15
gwr_ntau:   6         # Number of imaginary-time points
gwr_ntau+   2
</code></pre></div>
<p>Once the calculation is finished, save the script reported below in a file,
lets say <code>conv_ntau.py</code>, in the same directory where we have launched the calculation,
make it executable with <code>chmod</code> and execute it as usual.</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python</span>
<span class="n">filepaths</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;tgwr_3o_DS</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_GWR.nc&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">)]</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">abipy.electrons.gwr</span><span class="w"> </span><span class="kn">import</span> <span class="n">GwrRobot</span>
<span class="n">robot</span> <span class="o">=</span> <span class="n">GwrRobot</span><span class="o">.</span><span class="n">from_files</span><span class="p">(</span><span class="n">filepaths</span><span class="p">)</span>

<span class="n">abs_conv</span> <span class="o">=</span> <span class="mf">0.005</span>
<span class="n">robot</span><span class="o">.</span><span class="n">plot_qpgaps_convergence</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;gwr_ntau&quot;</span><span class="p">,</span>
                              <span class="n">abs_conv</span><span class="o">=</span><span class="n">abs_conv</span><span class="p">,</span>
                              <span class="n">savefig</span><span class="o">=</span><span class="s2">&quot;conv_ntau.png&quot;</span><span class="p">,</span>
                              <span class="p">)</span>
</code></pre></div>
<p>You should get the following figure:</p>
<p><img alt="" src="../gwr_assets/conv_ntau.png" /></p>
<p>Clearly six minimax points are not enough to convergence.
Also the convergence with <a class="wikilink codevar-wikilink" href="/variables/gwr#gwr_ntau">gwr_ntau</a> is not variational, and there are meshes that perform better than others.
This study shows that we should use 16-20 minimax points to reach an accuracy of 0.005 eV (<code>abs_conv</code>).
Unfortunately, this would render the calculations more expensive, especially for a tutorial,
therefore we opt to continue with <strong>12 minimax points</strong> for the next calculations.
Again, let&rsquo;s save the results in a different directory by executing:</p>
<div class="highlight"><pre><span></span><code>mkdir conv_ntau
mv conv_ntau.py conv_ntau
mv tgwr_3o_* log conv_ntau
</code></pre></div>
<h3 id="convergence-wrt-gwr_boxcutmin">Convergence wrt gwr_boxcutmin<a class="headerlink" href="#convergence-wrt-gwr_boxcutmin" title="Permanent link">&para;</a></h3>
<p>Now edit <code>tgwr_3.abi</code>, replace the values of <a class="wikilink codevar-wikilink" href="/variables/basic#nband">nband</a> and <a class="wikilink codevar-wikilink" href="/variables/gw#ecuteps">ecuteps</a> found earlier,
and define a one-dimensional multidataset to increase <a class="wikilink codevar-wikilink" href="/variables/gwr#gwr_boxcutmin">gwr_boxcutmin</a>:</p>
<div class="highlight"><pre><span></span><code>ndtset 5
gwr_boxcutmin: 1.1
gwr_boxcutmin+ 0.2
</code></pre></div>
<p>Once the calculation is finished, save the script reported below in a file,
lets say <code>conv_boxcut.py</code> in the same directory where we launched the calculation,
make it executable and execute it as usual.</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python</span>
<span class="n">filepaths</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;tgwr_3o_DS</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_GWR.nc&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)]</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">abipy.electrons.gwr</span><span class="w"> </span><span class="kn">import</span> <span class="n">GwrRobot</span>
<span class="n">robot</span> <span class="o">=</span> <span class="n">GwrRobot</span><span class="o">.</span><span class="n">from_files</span><span class="p">(</span><span class="n">filepaths</span><span class="p">)</span>

<span class="n">abs_conv</span> <span class="o">=</span> <span class="mf">0.005</span>
<span class="n">robot</span><span class="o">.</span><span class="n">plot_qpgaps_convergence</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;gwr_boxcutmin&quot;</span><span class="p">,</span>
                              <span class="n">abs_conv</span><span class="o">=</span><span class="n">abs_conv</span><span class="p">,</span>
                              <span class="n">savefig</span><span class="o">=</span><span class="s2">&quot;conv_boxcutmin.png&quot;</span><span class="p">,</span>
                              <span class="p">)</span>
</code></pre></div>
<p>You should obtain the following figure:</p>
<p><img alt="" src="../gwr_assets/conv_boxcutmin.png" /></p>
<p>In the case of silicon, the results are rather insensitive to the density
of the FFT mesh but keep in mind that other systems may behave differently.
We therefore fix <a class="wikilink codevar-wikilink" href="/variables/gwr#gwr_boxcutmin">gwr_boxcutmin</a> to 1.1.</p>
<p>Note that different values of <a class="wikilink codevar-wikilink" href="/variables/gwr#gwr_boxcutmin">gwr_boxcutmin</a> can lead to the same value of <code>g_ngfft</code>
as not all the number of points along the three directions of the FFT box are supported by the FFT library.</p>
<div class="highlight"><pre><span></span><code>grep g_ngfft log
g_ngfft: [12, 12, 12, 12, 12, 12, ]
g_ngfft: [15, 15, 15, 15, 15, 15, ]
g_ngfft: [16, 16, 16, 16, 16, 16, ]
g_ngfft: [18, 18, 18, 18, 18, 18, ]
g_ngfft: [20, 20, 20, 20, 20, 20, ]
</code></pre></div>
<p>Note how the wall-time quickly increases with <a class="wikilink codevar-wikilink" href="/variables/gwr#gwr_boxcutmin">gwr_boxcutmin</a>:</p>
<div class="highlight"><pre><span></span><code>grep &quot;dataset:&quot; log | grep &quot;&lt;&lt; TIME&quot;

 dataset: 1 , wall: 10.75 [s] , cpu: 10.74 [s] &lt;&lt;&lt; TIME
 dataset: 2 , wall: 31.20 [s] , cpu: 31.13 [s] &lt;&lt;&lt; TIME
 dataset: 3 , wall: 50.78 [s] , cpu: 50.68 [s] &lt;&lt;&lt; TIME
 dataset: 4 , wall: 01:27 [minutes] , cpu: 01:27 [minutes] &lt;&lt;&lt; TIME
 dataset: 5 , wall: 02:19 [minutes] , cpu: 02:19 [minutes] &lt;&lt;&lt; TIME
</code></pre></div>
<p>Finally, let&rsquo;s save the results in a different directory by executing:</p>
<div class="highlight"><pre><span></span><code>mkdir conv_boxcutmin
mv conv_boxcutmin.py conv_boxcutmin
mv tgwr_3o_* log conv_boxcutmin
</code></pre></div>
<h3 id="gwr-calculations-with-different-bz-meshes">GWR calculations with different BZ meshes.<a class="headerlink" href="#gwr-calculations-with-different-bz-meshes" title="Permanent link">&para;</a></h3>
<p>In this section of the tutorial, we perform GWR calculations with different BZ meshes.
You may want to start immediately the computation by issuing:</p>
<div class="highlight"><pre><span></span><code>mpirun -n 1 tgwr_4.abi &gt; tgwr_4.log 2&gt; err &amp;
</code></pre></div>
<p>with the following input file:</p>
<div class="text-center"><button id="uuid-d105df9c-216b-41a2-9c50-9e3d6c4ddbeb" class="md-button md-button--secondary"> View tests/tutorial/Input/tgwr_4.abi </button></div>
<div id="uuid-c2e796a9-ce85-4597-8808-40a666b52c77" class="my_dialog" title="tests/tutorial/Input/tgwr_4.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1">#  Crystalline silicon</span>
<span class="c1">#  Calculation of the GW corrections with GWR code and 4x4x4 k-mesh.</span>

<span class="c1"># Include geometry and pseudos</span>
include<span class="w"> </span><span class="s2">&quot;gwr_include.abi&quot;</span>

<span class="c1">################################</span>
<span class="c1"># Dataset 3: G0W0 with GWR code</span>
<span class="c1">################################</span>
optdriver<span class="w">  </span><span class="m">6</span><span class="w">                          </span><span class="c1"># Activate GWR code</span>
ecutwfn<span class="w">    </span><span class="m">10</span><span class="w">                         </span><span class="c1"># Truncate basis set when computing G.</span>
<span class="w">                                      </span><span class="c1"># This parameter should be subject to convergence studies</span>
gwr_task<span class="w"> </span><span class="s2">&quot;G0W0&quot;</span><span class="w">                       </span><span class="c1"># One-shot calculation</span>
getden_filepath<span class="w"> </span><span class="s2">&quot;tgwr_1o_DS1_DEN&quot;</span><span class="w">     </span><span class="c1"># Density file</span>


<span class="c1"># Definition of the k-point grid</span>
<span class="c1"># IMPORTANT: GWR requires Gamma-centered k-meshes</span>
nshiftk<span class="w"> </span><span class="m">1</span>
shiftk<span class="w">  </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0

ngkpt<span class="w">   </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">4</span>
getwfk_filepath<span class="w"> </span><span class="s2">&quot;tgwr_2o_DS2_WFK&quot;</span><span class="w">       </span><span class="c1"># WFK file with empty states on a 4x4x4 k-mesh</span>

<span class="c1"># To perform a convergence study wrt the mesh, comment the two lines above</span>
<span class="c1"># and activate the block below.</span>
<span class="c1">#ndtset 3</span>
<span class="c1">#ngkpt1 2 2 2</span>
<span class="c1">#getwfk_filepath1 &quot;tgwr_2o_DS1_WFK&quot;     # WFK file with empty states on a 2x2x2 k-mesh</span>
<span class="c1">#ngkpt2 4 4 4</span>
<span class="c1">#getwfk_filepath2 &quot;tgwr_2o_DS2_WFK&quot;     # WFK file with empty states on a 4x4x4 k-mesh</span>
<span class="c1">#ngkpt3 6 6 6</span>
<span class="c1">#getwfk_filepath3 &quot;tgwr_2o_DS3_WFK&quot;     # WFK file with empty states on a 6x6x6 k-mesh</span>

gwr_ntau<span class="w">   </span><span class="m">12</span><span class="w">        </span><span class="c1"># Number of imaginary-time points</span>
gwr_boxcutmin<span class="w">  </span><span class="m">1</span>.0<span class="w">   </span><span class="c1"># This should be subject to convergence studies</span>
gwr_sigma_algo<span class="w"> </span><span class="m">2</span><span class="w">     </span><span class="c1"># Use convolutions in the BZ for Sigma</span>

nband<span class="w">      </span><span class="m">250</span><span class="w">      </span><span class="c1"># Bands to be used in the screening calculation</span>
ecuteps<span class="w">    </span><span class="m">10</span><span class="w">       </span><span class="c1"># Cut-off energy of the planewave set to represent the dielectric matrix.</span>
<span class="w">                    </span><span class="c1"># It is important to adjust this parameter.</span>
<span class="c1">#ecutsigx    16     # Dimension of the G sum in Sigma_x.</span>
<span class="w">                    </span><span class="c1"># ecutsigx = ecut is usually a wise choice</span>
<span class="w">                    </span><span class="c1"># (the dimension in Sigma_c is controlled by ecuteps)</span>

nkptgw<span class="w">      </span><span class="m">2</span><span class="w">       </span><span class="c1"># number of k-point where to calculate the GW correction</span>
kptgw<span class="w">               </span><span class="c1"># k-points in reduced coordinates</span>
<span class="w">   </span><span class="m">0</span>.0<span class="w">    </span><span class="m">0</span>.0<span class="w">    </span><span class="m">0</span>.0
<span class="w">   </span><span class="m">0</span>.5<span class="w">    </span><span class="m">0</span>.0<span class="w">    </span><span class="m">0</span>.0

bdgw<span class="w">       </span><span class="c1"># calculate GW corrections for bands from 4 to 5</span>
<span class="w">   </span><span class="m">4</span><span class="w">  </span><span class="m">5</span>
<span class="w">   </span><span class="m">4</span><span class="w">  </span><span class="m">5</span>

<span class="c1"># Spectral function (very coarse grid to reduce txt file size)</span>
<span class="c1">#nfreqsp3 50</span>
<span class="c1">#freqspmax3 5 eV</span>

<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = tgwr_1.abi, tgwr_2.abi, tgwr_3.abi, tgwr_4.abi, tgwr_5.abi</span>
<span class="c1">#%% need_cpp_vars = HAVE_LINALG_SCALAPACK</span>
<span class="c1">#%% exclude_builders = eos_nvhpc_23.9_elpa ,eos_nvhpc_24.9_openmpi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   tgwr_4.abo, tolnlines = 25, tolabs = 1.1e-3, tolrel = 3.0e-3, fld_options = -medium;</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 12</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = M. Giantomassi</span>
<span class="c1">#%% keywords = NC, GWR</span>
<span class="c1">#%% description =</span>
<span class="c1">#%%  Crystalline silicon</span>
<span class="c1">#%%  Calculation of the GW corrections with GWR code with 4x4x4 k-mesh.</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-c2e796a9-ce85-4597-8808-40a666b52c77", "#uuid-d105df9c-216b-41a2-9c50-9e3d6c4ddbeb") }); </script>

<p>The output file is reported here for your convenience:</p>
<div class="text-center"><button id="uuid-1d350626-e15b-4e21-b6f6-38c6d66006f0" class="md-button md-button--secondary"> View tests/tutorial/Refs/tgwr_4.abo </button></div>
<div id="uuid-a567dbaa-8b06-4258-a8d5-32cbe068c4e1" class="my_dialog" title="tests/tutorial/Refs/tgwr_4.abo" hidden><div><pre class="small-text">

.Version 10.3.6.4 of ABINIT, released Feb 2025.
.(MPI version, prepared for a aarch64_darwin23.6.0_gnu14.2 computer)

.Copyright (C) 1998-2025 ABINIT group .
 ABINIT comes with ABSOLUTELY NO WARRANTY.
 It is free software, and you are welcome to redistribute it
 under certain conditions (GNU General Public License,
 see ~abinit/COPYING or http://www.gnu.org/copyleft/gpl.txt).

 ABINIT is a project of the Universite Catholique de Louvain,
 Corning Inc. and other collaborators, see ~abinit/doc/developers/contributors.txt .
 Please read https://docs.abinit.org/theory/acknowledgments for suggested
 acknowledgments of the ABINIT effort.
 For more information, see https://www.abinit.org .

.Starting date : Thu  3 Apr 2025.
- ( at 17h08 )

- input  file    -&gt; /Users/giantomassi/git_repos/abinit/_build/tests/Test_suite/tutorial_tgwr_1-tgwr_2-tgwr_3-tgwr_4-tgwr_5/tgwr_4.abi
- output file    -&gt; tgwr_4.abo
- root for input  files -&gt; tgwr_4i
- root for output files -&gt; tgwr_4o

 Symmetries : space group Fd -3 m (#227); Bravais cF (face-center cubic)
================================================================================
 Values of the parameters that define the memory need of the present run
     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       6
     lnmax =       6     mgfft =      30  mpssoang =       3    mqgrid =    3001
     natom =       2  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      48    n1xccc =    2501    ntypat =       1
    occopt =       1   xclevel =       2
-    mband =         250        mffmem =           1         mkmem =           8
       mpw =         848          nfft =       27000          nkpt =           8
================================================================================
P This job should need less than                      36.924 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :     25.881 Mbytes ; DEN or POT disk file :      0.208 Mbytes.
================================================================================

--------------------------------------------------------------------------------
------------- Echo of variables that govern the present computation ------------
--------------------------------------------------------------------------------
-
- outvars: echo of selected default values
-   iomode0 =  0 , fftalg0 =312 , wfoptalg0 =  0
-
- outvars: echo of global parameters not present in the input file
-  max_nthreads =    0
-
 -outvars: echo values of preprocessed input variables --------
            acell      1.0260000000E+01  1.0260000000E+01  1.0260000000E+01 Bohr
              amu      2.80855000E+01
             bdgw           4       5       4       5
             ecut      1.60000000E+01 Hartree
          ecuteps      1.00000000E+01 Hartree
         ecutsigx      1.60000000E+01 Hartree
          ecutwfn      1.00000000E+01 Hartree
-          fftalg         312
   gwr_sigma_algo           2
           istwfk        2    0    3    0    0    0    7    0
              ixc          11
              kpt      0.00000000E+00  0.00000000E+00  0.00000000E+00
                       2.50000000E-01  0.00000000E+00  0.00000000E+00
                       5.00000000E-01  0.00000000E+00  0.00000000E+00
                       2.50000000E-01  2.50000000E-01  0.00000000E+00
                       5.00000000E-01  2.50000000E-01  0.00000000E+00
                      -2.50000000E-01  2.50000000E-01  0.00000000E+00
                       5.00000000E-01  5.00000000E-01  0.00000000E+00
                      -2.50000000E-01  5.00000000E-01  2.50000000E-01
            kptgw      0.00000000E+00  0.00000000E+00  0.00000000E+00
                       5.00000000E-01  0.00000000E+00  0.00000000E+00
         kptrlatt        4    0    0      0    4    0      0    0    4
          kptrlen      2.90196623E+01
P           mkmem           8
            natom           2
            nband         250
            ngfft          30      30      30
             nkpt           8
           nkptgw           2
             nsym          48
           ntypat           1
              occ      2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000
        optdriver           6
            rprim      0.0000000000E+00  5.0000000000E-01  5.0000000000E-01
                       5.0000000000E-01  0.0000000000E+00  5.0000000000E-01
                       5.0000000000E-01  5.0000000000E-01  0.0000000000E+00
          spgroup         227
           symrel      1  0  0   0  1  0   0  0  1      -1  0  0   0 -1  0   0  0 -1
                       0 -1  1   0 -1  0   1 -1  0       0  1 -1   0  1  0  -1  1  0
                      -1  0  0  -1  0  1  -1  1  0       1  0  0   1  0 -1   1 -1  0
                       0  1 -1   1  0 -1   0  0 -1       0 -1  1  -1  0  1   0  0  1
                      -1  0  0  -1  1  0  -1  0  1       1  0  0   1 -1  0   1  0 -1
                       0 -1  1   1 -1  0   0 -1  0       0  1 -1  -1  1  0   0  1  0
                       1  0  0   0  0  1   0  1  0      -1  0  0   0  0 -1   0 -1  0
                       0  1 -1   0  0 -1   1  0 -1       0 -1  1   0  0  1  -1  0  1
                      -1  0  1  -1  1  0  -1  0  0       1  0 -1   1 -1  0   1  0  0
                       0 -1  0   1 -1  0   0 -1  1       0  1  0  -1  1  0   0  1 -1
                       1  0 -1   0  0 -1   0  1 -1      -1  0  1   0  0  1   0 -1  1
                       0  1  0   0  0  1   1  0  0       0 -1  0   0  0 -1  -1  0  0
                       1  0 -1   0  1 -1   0  0 -1      -1  0  1   0 -1  1   0  0  1
                       0 -1  0   0 -1  1   1 -1  0       0  1  0   0  1 -1  -1  1  0
                      -1  0  1  -1  0  0  -1  1  0       1  0 -1   1  0  0   1 -1  0
                       0  1  0   1  0  0   0  0  1       0 -1  0  -1  0  0   0  0 -1
                       0  0 -1   0  1 -1   1  0 -1       0  0  1   0 -1  1  -1  0  1
                       1 -1  0   0 -1  1   0 -1  0      -1  1  0   0  1 -1   0  1  0
                       0  0  1   1  0  0   0  1  0       0  0 -1  -1  0  0   0 -1  0
                      -1  1  0  -1  0  0  -1  0  1       1 -1  0   1  0  0   1  0 -1
                       0  0  1   0  1  0   1  0  0       0  0 -1   0 -1  0  -1  0  0
                       1 -1  0   0 -1  0   0 -1  1      -1  1  0   0  1  0   0  1 -1
                       0  0 -1   1  0 -1   0  1 -1       0  0  1  -1  0  1   0 -1  1
                      -1  1  0  -1  0  1  -1  0  0       1 -1  0   1  0 -1   1  0  0
            tnons      0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
            typat      1  1
              wtk        0.01563    0.12500    0.06250    0.09375    0.37500    0.18750
                         0.04688    0.09375
           xangst      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       1.3573395400E+00  1.3573395400E+00  1.3573395400E+00
            xcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.5650000000E+00  2.5650000000E+00  2.5650000000E+00
             xred      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.5000000000E-01  2.5000000000E-01  2.5000000000E-01
            znucl       14.00000

================================================================================

 chkinp: Checking input parameters for consistency.

================================================================================
== DATASET  1 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 1, }
dimensions: {natom: 2, nkpt: 8, mband: 250, nsppol: 1, nspinor: 1, nspden: 1, mpw: 848, }
cutoff_energies: {ecut:  16.0, pawecutdg:  -1.0, }
electrons: {nelect:   8.00000000E+00, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 6, }
...

 mkfilename: getwfk from: tgwr_2o_DS2_WFK

 mkfilename: getden from: tgwr_1o_DS1_DEN

 Exchange-correlation functional for the present dataset will be:
  GGA: Perdew-Burke-Ernzerhof functional - ixc=11
 Citation for XC functional:
  J.P.Perdew, K.Burke, M.Ernzerhof, PRL 77, 3865 (1996)

.Using double precision arithmetic; gwpc =  8

- Reading GS density from: tgwr_1o_DS1_DEN




--- Pseudopotential description ------------------------------------------------
- pspini: atom type   1  psp file is /Users/giantomassi/git_repos/abinit/tests/Pspdir/Psdj_nc_sr_04_pbe_std_psp8/Si.psp8
- pspatm: opening atomic psp file    /Users/giantomassi/git_repos/abinit/tests/Pspdir/Psdj_nc_sr_04_pbe_std_psp8/Si.psp8
- Si    ONCVPSP-3.2.3.1  r_core=   1.60303   1.72197   1.91712
- 14.00000   4.00000    170510                znucl, zion, pspdat
    8   11    2    4       600   0.00000      pspcod,pspxc,lmax,lloc,mmax,r2well
    5.99000000000000    4.00000000000000    0.00000000000000   rchrg,fchrg,qchrg
     nproj     2     2     2
     extension_switch     1
  pspatm : epsatm=    9.34321699
         --- l  ekb(1:nproj) --&gt;
             0    5.168965    0.829883
             1    2.571282    0.578307
             2   -2.427311   -0.488097
 pspatm: atomic psp has been read  and splines computed

   1.49491472E+02                                ecore*ucvol(ha*bohr**3)
--------------------------------------------------------------------------------

 Total charge density [el/Bohr^3]
)     Maximum=    8.5569E-02  at reduced coord.    0.1000    0.1000    0.7000
)     Minimum=    1.4870E-03  at reduced coord.    0.0000    0.0000    0.0000
   Integrated=    8.0000E+00
- Reading GS states from WFK file: tgwr_2o_DS2_WFK
  Mapping kBZ --&gt; kIBZ
 Legend: bz = TS(ibz) + g0 where isym is the index of the symrec operation S and itim is 1 if TR is used.
        BZ                                       IBZ                                       ibz  isym  itim  g0
     1  [ 0.0000E+00,  0.0000E+00,  0.0000E+00]  [ 0.0000E+00,  0.0000E+00,  0.0000E+00]     1     1     0  [0, 0, 0]
     2  [ 2.5000E-01,  0.0000E+00,  0.0000E+00]  [ 2.5000E-01,  0.0000E+00,  0.0000E+00]     2     1     0  [0, 0, 0]
     3  [-2.5000E-01, -2.5000E-01, -2.5000E-01]  [ 2.5000E-01,  0.0000E+00,  0.0000E+00]     2     5     0  [0, 0, 0]
     4  [ 0.0000E+00,  2.5000E-01,  0.0000E+00]  [ 2.5000E-01,  0.0000E+00,  0.0000E+00]     2     7     0  [0, 0, 0]
     5  [ 0.0000E+00,  0.0000E+00,  2.5000E-01]  [ 2.5000E-01,  0.0000E+00,  0.0000E+00]     2     3     0  [0, 0, 0]
     6  [ 0.0000E+00, -2.5000E-01,  0.0000E+00]  [ 2.5000E-01,  0.0000E+00,  0.0000E+00]     2     8     0  [0, 0, 0]
     7  [-2.5000E-01,  0.0000E+00,  0.0000E+00]  [ 2.5000E-01,  0.0000E+00,  0.0000E+00]     2     2     0  [0, 0, 0]
     8  [ 0.0000E+00,  0.0000E+00, -2.5000E-01]  [ 2.5000E-01,  0.0000E+00,  0.0000E+00]     2     4     0  [0, 0, 0]
     9  [ 2.5000E-01,  2.5000E-01,  2.5000E-01]  [ 2.5000E-01,  0.0000E+00,  0.0000E+00]     2     6     0  [0, 0, 0]
    10  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]     3     1     0  [0, 0, 0]
    11  [ 5.0000E-01,  5.0000E-01,  5.0000E-01]  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]     3     5     0  [1, 1, 1]
    12  [ 0.0000E+00,  0.0000E+00,  5.0000E-01]  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]     3     3     0  [0, 0, 0]
    13  [ 0.0000E+00,  5.0000E-01,  0.0000E+00]  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]     3     7     0  [0, 0, 0]
    14  [ 2.5000E-01,  2.5000E-01,  0.0000E+00]  [ 2.5000E-01,  2.5000E-01,  0.0000E+00]     4     1     0  [0, 0, 0]
    15  [ 0.0000E+00,  2.5000E-01,  2.5000E-01]  [ 2.5000E-01,  2.5000E-01,  0.0000E+00]     4    17     0  [0, 0, 0]
    16  [ 0.0000E+00, -2.5000E-01, -2.5000E-01]  [ 2.5000E-01,  2.5000E-01,  0.0000E+00]     4    18     0  [0, 0, 0]
    17  [ 2.5000E-01,  0.0000E+00,  2.5000E-01]  [ 2.5000E-01,  2.5000E-01,  0.0000E+00]     4    10     0  [0, 0, 0]
    18  [-2.5000E-01,  0.0000E+00, -2.5000E-01]  [ 2.5000E-01,  2.5000E-01,  0.0000E+00]     4     9     0  [0, 0, 0]
    19  [-2.5000E-01, -2.5000E-01,  0.0000E+00]  [ 2.5000E-01,  2.5000E-01,  0.0000E+00]     4     2     0  [0, 0, 0]
    20  [ 5.0000E-01,  2.5000E-01,  0.0000E+00]  [ 5.0000E-01,  2.5000E-01,  0.0000E+00]     5     1     0  [0, 0, 0]
prtvol = 0, max 20 points are written


  Mapping qBZ --&gt; qIBZ
 Legend: bz = TS(ibz) + g0 where isym is the index of the symrec operation S and itim is 1 if TR is used.
        BZ                                       IBZ                                       ibz  isym  itim  g0
     1  [ 0.0000E+00,  0.0000E+00,  0.0000E+00]  [ 0.0000E+00,  0.0000E+00,  0.0000E+00]     1     1     0  [0, 0, 0]
     2  [ 2.5000E-01,  0.0000E+00,  0.0000E+00]  [ 2.5000E-01,  0.0000E+00,  0.0000E+00]     2     1     0  [0, 0, 0]
     3  [-2.5000E-01, -2.5000E-01, -2.5000E-01]  [ 2.5000E-01,  0.0000E+00,  0.0000E+00]     2     5     0  [0, 0, 0]
     4  [ 0.0000E+00,  2.5000E-01,  0.0000E+00]  [ 2.5000E-01,  0.0000E+00,  0.0000E+00]     2     7     0  [0, 0, 0]
     5  [ 0.0000E+00,  0.0000E+00,  2.5000E-01]  [ 2.5000E-01,  0.0000E+00,  0.0000E+00]     2     3     0  [0, 0, 0]
     6  [ 0.0000E+00, -2.5000E-01,  0.0000E+00]  [ 2.5000E-01,  0.0000E+00,  0.0000E+00]     2     8     0  [0, 0, 0]
     7  [-2.5000E-01,  0.0000E+00,  0.0000E+00]  [ 2.5000E-01,  0.0000E+00,  0.0000E+00]     2     2     0  [0, 0, 0]
     8  [ 0.0000E+00,  0.0000E+00, -2.5000E-01]  [ 2.5000E-01,  0.0000E+00,  0.0000E+00]     2     4     0  [0, 0, 0]
     9  [ 2.5000E-01,  2.5000E-01,  2.5000E-01]  [ 2.5000E-01,  0.0000E+00,  0.0000E+00]     2     6     0  [0, 0, 0]
    10  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]     3     1     0  [0, 0, 0]
    11  [ 5.0000E-01,  5.0000E-01,  5.0000E-01]  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]     3     5     0  [1, 1, 1]
    12  [ 0.0000E+00,  0.0000E+00,  5.0000E-01]  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]     3     3     0  [0, 0, 0]
    13  [ 0.0000E+00,  5.0000E-01,  0.0000E+00]  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]     3     7     0  [0, 0, 0]
    14  [ 2.5000E-01,  2.5000E-01,  0.0000E+00]  [ 2.5000E-01,  2.5000E-01,  0.0000E+00]     4     1     0  [0, 0, 0]
    15  [ 0.0000E+00,  2.5000E-01,  2.5000E-01]  [ 2.5000E-01,  2.5000E-01,  0.0000E+00]     4    17     0  [0, 0, 0]
    16  [ 0.0000E+00, -2.5000E-01, -2.5000E-01]  [ 2.5000E-01,  2.5000E-01,  0.0000E+00]     4    18     0  [0, 0, 0]
    17  [ 2.5000E-01,  0.0000E+00,  2.5000E-01]  [ 2.5000E-01,  2.5000E-01,  0.0000E+00]     4    10     0  [0, 0, 0]
    18  [-2.5000E-01,  0.0000E+00, -2.5000E-01]  [ 2.5000E-01,  2.5000E-01,  0.0000E+00]     4     9     0  [0, 0, 0]
    19  [-2.5000E-01, -2.5000E-01,  0.0000E+00]  [ 2.5000E-01,  2.5000E-01,  0.0000E+00]     4     2     0  [0, 0, 0]
    20  [ 5.0000E-01,  2.5000E-01,  0.0000E+00]  [ 5.0000E-01,  2.5000E-01,  0.0000E+00]     5     1     0  [0, 0, 0]
prtvol = 0, max 20 points are written



 === Kohn-Sham gaps and band edges from IBZ mesh ===
 Indirect band gap semiconductor
 Fundamental gap:     0.707 (eV)
   VBM:    -0.354 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
   CBM:     0.354 (eV) at k: [ 5.0000E-01,  5.0000E-01,  0.0000E+00]
 Direct gap:         2.556 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]


- Optimizing MPI grid with mem_per_cpu_mb: 2.048000E+03 [Mb]
- Use `abinit run.abi --mem-per-cpu=4G` to set mem_per_cpu_mb in the submission script
- np_k  np_g  np_t  np_s  memb_per_cpu    efficiency       speedup
-    1     1     1     1   3.37502E+03   1.00000E+00   1.00000E+00
-
- Selected MPI grid:
- np_k  np_g  np_t  np_s  memb_per_cpu    efficiency       speedup
-    1     1     1     1   3.37502E+03   1.00000E+00   1.00000E+00

- Resident memory in Mb for G(g,g&#x27;,+/-tau) and chi(g,g&#x27;,tau):
- G_k(g,g,tau): 1009.1
- Chi_q(g,g,tau): 252.3
- u_k(g,b): 12.7
- Temporary memory allocated inside the tau loops:
- G_k(r,g): 1400.6
- chi_q(r,g): 700.3
- FFT uc_batch_size: 1
- FFT sc_batch_size: 1
 ==== Info on the gwr_t object ====

--- !GWR_params
iteration_state: {dtset: 1, }
gwr_task: G0W0
nband: 250
ntau: 12
ngkpt: [4, 4, 4, ]
ngqpt: [4, 4, 4, ]
chi_algo: supercell
sigma_algo: &#x27;BZ-convolutions&#x27;
nkibz: 8
nqibz: 8
inclvkb: 2
q0: [  1.00000000E-05,   2.00000000E-05,   3.00000000E-05, ]
gw_icutcoul: 6
green_mpw: 415
tchi_mpw: 415
g_ngfft: [12, 12, 12, 12, 12, 12, ]
gwr_boxcutmin:   1.00000000E+00
P gwr_np_kgts: [1, 1, 1, 1, ]
P np_kibz: [1, 1, 1, 1, 1, 1, 1, 1, ]
P np_qibz: [1, 1, 1, 1, 1, 1, 1, 1, ]
min_transition_energy_eV:   7.07322721E-01
max_transition_energy_eV:   1.92973188E+02
eratio:   2.72821984E+02
ft_max_err_t2w_cos:   1.19236269E-03
ft_max_err_w2t_cos:   3.51829949E-05
ft_max_err_t2w_sin:   2.27332971E-02
cosft_duality_error:   4.80114081E-03
Minimax imaginary tau/omega mesh in a.u.: !Tabular | # tau, weight(tau), omega, weight(omega)
    1 3.01845E-02   7.84567E-02   6.37107E-03   1.30197E-02
    2 1.68348E-01   2.04750E-01   2.08408E-02   1.65798E-02
    3 4.62515E-01   4.00892E-01   4.11428E-02   2.50342E-02
    4 1.02120E+00   7.51969E-01   7.35654E-02   4.15594E-02
    5 2.06352E+00   1.39686E+00   1.29029E-01   7.25879E-02
    6 3.98516E+00   2.55709E+00   2.27719E-01   1.30961E-01
    7 7.46798E+00   4.59587E+00   4.08469E-01   2.42767E-01
    8 1.36656E+01   8.11373E+00   7.48639E-01   4.62721E-01
    9 2.45159E+01   1.41167E+01   1.40860E+00   9.11790E-01
    10 4.33066E+01   2.43993E+01   2.74298E+00   1.88995E+00
    11 7.59655E+01   4.28466E+01   5.67129E+00   4.41801E+00
    12 1.35795E+02   8.33674E+01   1.41554E+01   1.63699E+01
...

 Cutting u(g) as ecutwfn: 1.000000E+01  &lt;  ecut: 1.600000E+01

 Computing chi0 head and wings with inclvkb: 2
 Using KS orbitals and KS energies...


 Computing diagonal matrix elements of Sigma_x
 Using KS orbitals and KS energies...



 Building Green&#x27;s functions from KS orbitals and KS energies...



 Building correlated screening Wc(i omega) ...

--- !EMACRO_WITHOUT_LOCAL_FIELDS
iteration_state: {dtset: 1, }
&#x27;epsilon_{iw, q -&gt; Gamma}(0,0)&#x27;: !Tabular |
      6.37106624E-03    2.40438756E+01    2.00197084E-18
      2.08407959E-02    2.34176150E+01    3.33193956E-19
      4.11427666E-02    2.16496344E+01   -3.87161991E-18
      7.35653993E-02    1.78507293E+01   -1.98828090E-19
      1.29029157E-01    1.20491202E+01    1.22909141E-19
      2.27718878E-01    6.50362270E+00    1.26625214E-19
      4.08469196E-01    3.16498220E+00    2.34635346E-19
      7.48638937E-01    1.72362216E+00   -1.91604740E-19
      1.40860376E+00    1.21615828E+00    4.77885183E-20
      2.74297741E+00    1.05875854E+00    5.97719959E-21
      5.67129327E+00    1.01399671E+00   -5.66762512E-21
      1.41553560E+01    1.00226743E+00   -5.58739760E-23
...


--- !EMACRO_WITH_LOCAL_FIELDS
iteration_state: {dtset: 1, }
&#x27;epsilon_{iw, q -&gt; Gamma}(0,0)&#x27;: !Tabular |
      6.37106624E-03    4.57058785E-02    0.00000000E+00
      2.08407959E-02    4.68755937E-02    0.00000000E+00
      4.11427666E-02    5.05398352E-02    0.00000000E+00
      7.35653993E-02    6.08427808E-02    0.00000000E+00
      1.29029157E-01    8.89379969E-02    0.00000000E+00
      2.27718878E-01    1.61726602E-01    0.00000000E+00
      4.08469196E-01    3.25250315E-01    0.00000000E+00
      7.48638937E-01    5.86358921E-01    0.00000000E+00
      1.40860376E+00    8.24055047E-01    0.00000000E+00
      2.74297741E+00    9.44758279E-01    0.00000000E+00
      5.67129327E+00    9.86216814E-01    0.00000000E+00
      1.41553560E+01    9.97738319E-01    0.00000000E+00
...



 Building Sigma_c with convolutions in k-space:
================================================================================
 QP results (energies in eV)
 Notations:
     E0: Kohn-Sham energy
     &lt;VxcDFT&gt;: Matrix elements of Vxc[n_val] without non-linear core correction (if any)
     SigX: Matrix elements of Sigma_x
     SigC(E0): Matrix elements of Sigma_c at E0
     Z: Renormalization factor
     E-E0: Difference between the QP and the KS energy.
     E-Eprev: Difference between QP energy at iteration i and i-1
     E: Quasi-particle energy
     Occ(E): Occupancy of QP state



--- !GWR_SelfEnergy_ee
iteration_state: {dtset: 1, }
kpoint     : [   0.000,    0.000,    0.000, ]
spin       : 1
gwr_scf_iteration: 1
gwr_task   : G0W0
QP_VBM_band: 4
QP_CBM_band: 5
KS_gap     :    2.556
QP_gap     :    3.247
Delta_QP_KS:    0.691
data: !Tabular |
     Band       E0 &lt;VxcDFT&gt;     SigX SigC(E0)        Z     E-E0  E-Eprev        E   Occ(E)
        2   -0.354  -11.319  -13.047    0.743    0.755   -0.743   -0.743   -1.097    2.000
        3   -0.354  -11.319  -13.047    0.743    0.755   -0.743   -0.743   -1.097    2.000
        4   -0.354  -11.319  -13.047    0.743    0.755   -0.743   -0.743   -1.097    2.000
        5    2.202  -10.034   -5.647   -4.456    0.758   -0.052   -0.052    2.150    0.000
        6    2.202  -10.034   -5.647   -4.456    0.758   -0.052   -0.052    2.150    0.000
        7    2.202  -10.034   -5.647   -4.456    0.758   -0.052   -0.052    2.150    0.000
...


--- !GWR_SelfEnergy_ee
iteration_state: {dtset: 1, }
kpoint     : [   0.500,    0.000,    0.000, ]
spin       : 1
gwr_scf_iteration: 1
gwr_task   : G0W0
QP_VBM_band: 4
QP_CBM_band: 5
KS_gap     :    2.733
QP_gap     :    3.413
Delta_QP_KS:    0.680
data: !Tabular |
     Band       E0 &lt;VxcDFT&gt;     SigX SigC(E0)        Z     E-E0  E-Eprev        E   Occ(E)
        3   -1.556  -11.058  -13.246    1.202    0.749   -0.738   -0.738   -2.294    2.000
        4   -1.556  -11.058  -13.246    1.202    0.749   -0.738   -0.738   -2.294    2.000
        5    1.177  -10.088   -5.834   -4.330    0.764   -0.058   -0.058    1.119    0.000
...


 === Kohn-Sham gaps and band edges from IBZ mesh ===
 Indirect band gap semiconductor
 Fundamental gap:     0.707 (eV)
   VBM:    -0.354 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
   CBM:     0.354 (eV) at k: [ 5.0000E-01,  5.0000E-01,  0.0000E+00]
 Direct gap:         2.556 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]


 === QP gaps and band edges taking into account Sigma_nk corrections for 2 k-points ===
 Indirect band gap semiconductor
 Fundamental gap:     1.450 (eV)
   VBM:    -1.097 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
   CBM:     0.354 (eV) at k: [ 5.0000E-01,  5.0000E-01,  0.0000E+00]
 Direct gap:         2.784 (eV) at k: [ 2.5000E-01,  0.0000E+00,  0.0000E+00]


== END DATASET(S) ==============================================================
================================================================================

 -outvars: echo values of variables after computation  --------
            acell      1.0260000000E+01  1.0260000000E+01  1.0260000000E+01 Bohr
              amu      2.80855000E+01
             bdgw           4       5       4       5
             ecut      1.60000000E+01 Hartree
          ecuteps      1.00000000E+01 Hartree
         ecutsigx      1.60000000E+01 Hartree
          ecutwfn      1.00000000E+01 Hartree
           etotal      0.0000000000E+00
            fcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
-          fftalg         312
   gwr_sigma_algo           2
           istwfk        2    0    3    0    0    0    7    0
              ixc          11
              kpt      0.00000000E+00  0.00000000E+00  0.00000000E+00
                       2.50000000E-01  0.00000000E+00  0.00000000E+00
                       5.00000000E-01  0.00000000E+00  0.00000000E+00
                       2.50000000E-01  2.50000000E-01  0.00000000E+00
                       5.00000000E-01  2.50000000E-01  0.00000000E+00
                      -2.50000000E-01  2.50000000E-01  0.00000000E+00
                       5.00000000E-01  5.00000000E-01  0.00000000E+00
                      -2.50000000E-01  5.00000000E-01  2.50000000E-01
            kptgw      0.00000000E+00  0.00000000E+00  0.00000000E+00
                       5.00000000E-01  0.00000000E+00  0.00000000E+00
         kptrlatt        4    0    0      0    4    0      0    0    4
          kptrlen      2.90196623E+01
P           mkmem           8
            natom           2
            nband         250
            ngfft          30      30      30
             nkpt           8
           nkptgw           2
             nsym          48
           ntypat           1
              occ      2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000
        optdriver           6
            rprim      0.0000000000E+00  5.0000000000E-01  5.0000000000E-01
                       5.0000000000E-01  0.0000000000E+00  5.0000000000E-01
                       5.0000000000E-01  5.0000000000E-01  0.0000000000E+00
          spgroup         227
           strten      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           symrel      1  0  0   0  1  0   0  0  1      -1  0  0   0 -1  0   0  0 -1
                       0 -1  1   0 -1  0   1 -1  0       0  1 -1   0  1  0  -1  1  0
                      -1  0  0  -1  0  1  -1  1  0       1  0  0   1  0 -1   1 -1  0
                       0  1 -1   1  0 -1   0  0 -1       0 -1  1  -1  0  1   0  0  1
                      -1  0  0  -1  1  0  -1  0  1       1  0  0   1 -1  0   1  0 -1
                       0 -1  1   1 -1  0   0 -1  0       0  1 -1  -1  1  0   0  1  0
                       1  0  0   0  0  1   0  1  0      -1  0  0   0  0 -1   0 -1  0
                       0  1 -1   0  0 -1   1  0 -1       0 -1  1   0  0  1  -1  0  1
                      -1  0  1  -1  1  0  -1  0  0       1  0 -1   1 -1  0   1  0  0
                       0 -1  0   1 -1  0   0 -1  1       0  1  0  -1  1  0   0  1 -1
                       1  0 -1   0  0 -1   0  1 -1      -1  0  1   0  0  1   0 -1  1
                       0  1  0   0  0  1   1  0  0       0 -1  0   0  0 -1  -1  0  0
                       1  0 -1   0  1 -1   0  0 -1      -1  0  1   0 -1  1   0  0  1
                       0 -1  0   0 -1  1   1 -1  0       0  1  0   0  1 -1  -1  1  0
                      -1  0  1  -1  0  0  -1  1  0       1  0 -1   1  0  0   1 -1  0
                       0  1  0   1  0  0   0  0  1       0 -1  0  -1  0  0   0  0 -1
                       0  0 -1   0  1 -1   1  0 -1       0  0  1   0 -1  1  -1  0  1
                       1 -1  0   0 -1  1   0 -1  0      -1  1  0   0  1 -1   0  1  0
                       0  0  1   1  0  0   0  1  0       0  0 -1  -1  0  0   0 -1  0
                      -1  1  0  -1  0  0  -1  0  1       1 -1  0   1  0  0   1  0 -1
                       0  0  1   0  1  0   1  0  0       0  0 -1   0 -1  0  -1  0  0
                       1 -1  0   0 -1  0   0 -1  1      -1  1  0   0  1  0   0  1 -1
                       0  0 -1   1  0 -1   0  1 -1       0  0  1  -1  0  1   0 -1  1
                      -1  1  0  -1  0  1  -1  0  0       1 -1  0   1  0 -1   1  0  0
            tnons      0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
            typat      1  1
              wtk        0.01563    0.12500    0.06250    0.09375    0.37500    0.18750
                         0.04688    0.09375
           xangst      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       1.3573395400E+00  1.3573395400E+00  1.3573395400E+00
            xcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.5650000000E+00  2.5650000000E+00  2.5650000000E+00
             xred      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.5000000000E-01  2.5000000000E-01  2.5000000000E-01
            znucl       14.00000

================================================================================


- Timing analysis has been suppressed with timopt=0



================================================================================

 Suggested references for the acknowledgment of ABINIT usage.

 The users of ABINIT have little formal obligations with respect to the ABINIT group
 (those specified in the GNU General Public License, http://www.gnu.org/copyleft/gpl.txt).
 However, it is common practice in the scientific literature,
 to acknowledge the efforts of people that have made the research possible.
 In this spirit, please find below suggested citations of work written by ABINIT developers,
 corresponding to implementations inside of ABINIT that you have used in the present run.
 Note also that it will be of great value to readers of publications presenting these results,
 to read papers enabling them to understand the theoretical formalism and details
 of the ABINIT implementation.
 For information on why they are suggested, see also https://docs.abinit.org/theory/acknowledgments.
-
- [1] The Abinit project: Impact, environment and recent developments.
- Computer Phys. Comm. 248, 107042 (2020).
- X.Gonze, B. Amadon, G. Antonius, F.Arnardi, L.Baguet, J.-M.Beuken,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, N.Brouwer, F.Bruneval,
- G.Brunin, T.Cavignac, J.-B. Charraud, Wei Chen, M.Cote, S.Cottenier,
- J.Denier, G.Geneste, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, Xu He, N.Helbig, N.Holzwarth, Y.Jia, F.Jollet,
- W.Lafargue-Dit-Hauret, K.Lejaeghere, M.A.L.Marques, A.Martin, C.Martins,
- H.P.C. Miranda, F.Naccarato, K. Persson, G.Petretto, V.Planes, Y.Pouillon,
- S.Prokhorenko, F.Ricci, G.-M.Rignanese, A.H.Romero, M.M.Schmitt, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, G.Zerah and J.W.Zwanzig
- Comment: the fifth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm.
- is available at https://www.abinit.org/sites/default/files/ABINIT20.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2020
-
- [2] Optimized norm-conserving Vanderbilt pseudopotentials.
- D.R. Hamann, Phys. Rev. B 88, 085117 (2013).
- Comment: Some pseudopotential generated using the ONCVPSP code were used.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#hamann2013
-
- [3] ABINIT: Overview, and focus on selected capabilities
- J. Chem. Phys. 152, 124102 (2020).
- A. Romero, D.C. Allan, B. Amadon, G. Antonius, T. Applencourt, L.Baguet,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, F.Bruneval,
- G.Brunin, D.Caliste, M.Cote,
- J.Denier, C. Dreyer, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, F.Jollet, G. Jomard,
- A.Martin,
- H.P.C. Miranda, F.Naccarato, G.Petretto, N.A. Pike, V.Planes,
- S.Prokhorenko, T. Rangel, F.Ricci, G.-M.Rignanese, M.Royo, M.Stengel, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, J.Wiktor, J.W.Zwanziger, and X.Gonze.
- Comment: a global overview of ABINIT, with focus on selected capabilities .
- Note that a version of this paper, that is not formatted for J. Chem. Phys
- is available at https://www.abinit.org/sites/default/files/ABINIT20_JPC.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#romero2020
-
- [4] Recent developments in the ABINIT software package.
- Computer Phys. Comm. 205, 106 (2016).
- X.Gonze, F.Jollet, F.Abreu Araujo, D.Adams, B.Amadon, T.Applencourt,
- C.Audouze, J.-M.Beuken, J.Bieder, A.Bokhanchuk, E.Bousquet, F.Bruneval
- D.Caliste, M.Cote, F.Dahm, F.Da Pieve, M.Delaveau, M.Di Gennaro,
- B.Dorado, C.Espejo, G.Geneste, L.Genovese, A.Gerossier, M.Giantomassi,
- Y.Gillet, D.R.Hamann, L.He, G.Jomard, J.Laflamme Janssen, S.Le Roux,
- A.Levitt, A.Lherbier, F.Liu, I.Lukacevic, A.Martin, C.Martins,
- M.J.T.Oliveira, S.Ponce, Y.Pouillon, T.Rangel, G.-M.Rignanese,
- A.H.Romero, B.Rousseau, O.Rubel, A.A.Shukri, M.Stankovski, M.Torrent,
- M.J.Van Setten, B.Van Troeye, M.J.Verstraete, D.Waroquier, J.Wiktor,
- B.Xu, A.Zhou, J.W.Zwanziger.
- Comment: the fourth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm.
- is available at https://www.abinit.org/sites/default/files/ABINIT16.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2016
-
- And optionally:
-
- [5] ABINIT: First-principles approach of materials and nanosystem properties.
- Computer Phys. Comm. 180, 2582-2615 (2009).
- X. Gonze, B. Amadon, P.-M. Anglade, J.-M. Beuken, F. Bottin, P. Boulanger, F. Bruneval,
- D. Caliste, R. Caracas, M. Cote, T. Deutsch, L. Genovese, Ph. Ghosez, M. Giantomassi
- S. Goedecker, D.R. Hamann, P. Hermet, F. Jollet, G. Jomard, S. Leroux, M. Mancini, S. Mazevet,
- M.J.T. Oliveira, G. Onida, Y. Pouillon, T. Rangel, G.-M. Rignanese, D. Sangalli, R. Shaltaf,
- M. Torrent, M.J. Verstraete, G. Zerah, J.W. Zwanziger
- Comment: the third generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm.
- is available at https://www.abinit.org/sites/default/files/ABINIT_CPC_v10.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2009
-
- Proc.   0 individual time (sec): cpu=        108.4  wall=        108.7

================================================================================

 Calculation completed.
.Delivered   1 WARNINGs and   8 COMMENTs to log file.
+Overall time at end (sec) : cpu=        108.4  wall=        108.7
- [ALL OK] MEMORY CONSUMPTION REPORT FOR C CODE:
-   There were 40 allocations and 40 deallocations in C code
- [ALL OK] MEMORY CONSUMPTION REPORT FOR FORTRAN CODE:
-   There were 4261304 allocations and 4261304 deallocations in Fortran
-   Remaining memory at the end of the calculation is 0

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-a567dbaa-8b06-4258-a8d5-32cbe068c4e1", "#uuid-1d350626-e15b-4e21-b6f6-38c6d66006f0") }); </script>

<p>Once the calculation is finished, save the script reported below in a file,
lets say <code>conv_kmesh.py</code> in the same directory where we launched the calculation,
make it executable and execute it as usual.</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">abipy.electrons.gwr</span><span class="w"> </span><span class="kn">import</span> <span class="n">GwrRobot</span>

<span class="n">filepaths</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;tgwr_4o_DS</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_GWR.nc&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]</span>

<span class="n">robot</span> <span class="o">=</span> <span class="n">GwrRobot</span><span class="o">.</span><span class="n">from_files</span><span class="p">(</span><span class="n">filepaths</span><span class="p">)</span>

<span class="n">abs_conv</span> <span class="o">=</span> <span class="mf">0.005</span>
<span class="n">robot</span><span class="o">.</span><span class="n">plot_qpgaps_convergence</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;nkpt&quot;</span><span class="p">,</span>
                              <span class="n">abs_conv</span><span class="o">=</span><span class="n">abs_conv</span><span class="p">,</span>
                              <span class="n">savefig</span><span class="o">=</span><span class="s2">&quot;conv_kmesh.png&quot;</span><span class="p">,</span>
                              <span class="p">)</span>
<span class="n">kpoint</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">df_dirgaps</span> <span class="o">=</span> <span class="n">robot</span><span class="o">.</span><span class="n">get_dirgaps_dataframe</span><span class="p">(</span><span class="n">kpoint</span><span class="o">=</span><span class="n">kpoint</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_dirgaps</span><span class="p">)</span>
</code></pre></div>
<p>You should get the following figure:</p>
<p><img alt="" src="../gwr_assets/conv_kmesh.png" /></p>
<p>To conclude, our best values for the direct QP gaps are 3.247 eV at the <span class="arithmatex">\(\Gamma\)</span>-point
and 3.413 eV at the <span class="arithmatex">\(L\)</span>-point.</p>
<div class="highlight"><pre><span></span><code>mkdir conv_kmesh
mv conv_kmesh.py conv_kmesh
mv tgwr_4o_* log conv_kmesh
</code></pre></div>
<h3 id="how-to-compute-an-interpolated-band-structure-with-gwr">How to compute an interpolated band structure with GWR<a class="headerlink" href="#how-to-compute-an-interpolated-band-structure-with-gwr" title="Permanent link">&para;</a></h3>
<p>In this last part of the tutorial, we discuss how to interpolate the QP corrections
along an arbitrary <span class="arithmatex">\(\kk\)</span>-path using the star-function method discussed in
<a href="/tutorial/eph_intro/#star-function-interpolation-of-the-ks-eigenvalues">this section</a> of the EPH introduction.
This method is less accurate than e.g. the Wannier interpolation, and might be problematic in the presence
of band-crossings, but it has the big advantage of being much easier to use and with minimal user intervention.</p>
<p>First of all, we need to compute the QP corrections for <strong>all</strong> the <span class="arithmatex">\(\kk\)</span>-points in the IBZ.
This is done in the following input:</p>
<div class="text-center"><button id="uuid-f15d0941-e120-4d96-9239-f065c5e53791" class="md-button md-button--secondary"> View tests/tutorial/Input/tgwr_5.abi </button></div>
<div id="uuid-9e3bc3c4-405c-49f4-a5f5-2a6d00c9035e" class="my_dialog" title="tests/tutorial/Input/tgwr_5.abi" hidden><div><div class="codehilite small-text"><pre><span></span><span class="c1"># Crystalline silicon</span>
<span class="c1"># Calculation of the GW corrections with GWR code and 2x2x2 k-mesh.</span>
<span class="c1"># Compute QP corrections for all k-points in the IBZ</span>


<span class="c1"># Definition of the k-point grid</span>
<span class="c1"># IMPORTANT: GWR requires Gamma-centered k-meshes</span>
ngkpt<span class="w">   </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span>
<span class="c1">#ngkpt   4 4 4</span>
nshiftk<span class="w"> </span><span class="m">1</span>
shiftk<span class="w">  </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0<span class="w"> </span><span class="m">0</span>.0

<span class="c1"># Include geometry and pseudos</span>
include<span class="w"> </span><span class="s2">&quot;gwr_include.abi&quot;</span>

<span class="c1">################################</span>
<span class="c1"># Dataset 3: G0W0 with GWR code</span>
<span class="c1">################################</span>
optdriver<span class="w">  </span><span class="m">6</span><span class="w">                          </span><span class="c1"># Activate GWR code</span>
ecutwfn<span class="w">    </span><span class="m">10</span><span class="w">                         </span><span class="c1"># Truncate basis set when computing G.</span>
<span class="w">                                      </span><span class="c1"># This parameter should be subject to convergence studies</span>
gwr_task<span class="w"> </span><span class="s2">&quot;G0W0&quot;</span><span class="w">                       </span><span class="c1"># One-shot calculation</span>
getden_filepath<span class="w"> </span><span class="s2">&quot;tgwr_1o_DS1_DEN&quot;</span><span class="w">     </span><span class="c1"># Density file</span>
getwfk_filepath<span class="w"> </span><span class="s2">&quot;tgwr_2o_DS1_WFK&quot;</span><span class="w">     </span><span class="c1"># WFK file with empty states. Must be consisten with ngkpt, shiftk</span>
<span class="c1">#getwfk_filepath &quot;tgwr_2o_DS2_WFK&quot;     # WFK file with empty states. Must be consisten with ngkpt, shiftk</span>

<span class="c1">#gwr_ntau   6         # Number of imaginary-time points</span>
gwr_ntau<span class="w">   </span><span class="m">12</span><span class="w">         </span><span class="c1"># Number of imaginary-time points</span>
gwr_boxcutmin<span class="w">  </span><span class="m">1</span>.0<span class="w">  </span><span class="c1"># This should be subject to convergence studies</span>
gwr_sigma_algo<span class="w"> </span><span class="m">1</span><span class="w">     </span><span class="c1"># Use supercell for Sigma</span>

nband<span class="w">      </span><span class="m">250</span><span class="w">      </span><span class="c1"># Bands to be used in the screening calculation</span>
ecuteps<span class="w">    </span><span class="m">6</span><span class="w">        </span><span class="c1"># Cut-off energy of the planewave set to represent the dielectric matrix.</span>
<span class="w">                    </span><span class="c1"># It is important to adjust this parameter.</span>
<span class="c1">#ecutsigx  16.0     # Dimension of the G sum in Sigma_x.</span>
<span class="w">                    </span><span class="c1"># ecutsigx = ecut is usually a wise choice</span>
<span class="w">                    </span><span class="c1"># (the dimension in Sigma_c is controlled by ecuteps)</span>
gw_qprange<span class="w">  </span>-4<span class="w">      </span><span class="c1"># Compute the QP corrections for all the k-points in the irreducible zone.</span>
<span class="w">                    </span><span class="c1"># Include all occupied states and -num empty states</span>

<span class="c1"># Spectral function (very coarse grid to reduce txt file size)</span>
<span class="c1">#nfreqsp3 50</span>
<span class="c1">#freqspmax3 5 eV</span>

<span class="c1">#%%&lt;BEGIN TEST_INFO&gt;</span>
<span class="c1">#%% [setup]</span>
<span class="c1">#%% executable = abinit</span>
<span class="c1">#%% test_chain = tgwr_1.abi, tgwr_2.abi, tgwr_3.abi, tgwr_4.abi, tgwr_5.abi</span>
<span class="c1">#%% need_cpp_vars = HAVE_LINALG_SCALAPACK</span>
<span class="c1">#%% exclude_builders = eos_nvhpc_23.9_elpa ,eos_nvhpc_24.9_openmpi</span>
<span class="c1">#%% [files]</span>
<span class="c1">#%% files_to_test =</span>
<span class="c1">#%%   tgwr_5.abo, tolnlines = 25, tolabs = 1.1e-3, tolrel = 3.0e-3, fld_options = -medium;</span>
<span class="c1">#%% [paral_info]</span>
<span class="c1">#%% max_nprocs = 12</span>
<span class="c1">#%% [extra_info]</span>
<span class="c1">#%% authors = M. Giantomassi</span>
<span class="c1">#%% keywords = NC, GWR</span>
<span class="c1">#%% description =</span>
<span class="c1">#%%  Crystalline silicon</span>
<span class="c1">#%%  Calculation of the GW corrections with GWR code for all k-points in the IBZ.</span>
<span class="c1">#%%&lt;END TEST_INFO&gt;</span>
</pre></div>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-9e3bc3c4-405c-49f4-a5f5-2a6d00c9035e", "#uuid-f15d0941-e120-4d96-9239-f065c5e53791") }); </script>

<!-- gw_qprange is positive in tgwr_5.abi -->
<p>Note the usage of <a class="wikilink codevar-wikilink" href="/variables/gw#gw_qprange">gw_qprange</a> = <code>-NUM</code> and <a class="wikilink codevar-wikilink" href="/variables/gwr#gwr_sigma_algo">gwr_sigma_algo</a> 1 to activate
the supercell algorithm for <span class="arithmatex">\(\Sigma_\nk\)</span>, the most efficient algorithm when all the <span class="arithmatex">\(\kk\)</span>-points in <span class="arithmatex">\(\Sigma_\nk\)</span> are wanted.
To keep the wall-time at a reasonable level, we use a WFK file with 2x2x2 <span class="arithmatex">\(\kk\)</span>-mesh,
but it is clear that a more accurate intepolation would require denser <span class="arithmatex">\(\kk\)</span>-meshes.</p>
<p>Run the job with:</p>
<div class="highlight"><pre><span></span><code>mpirun -n 1 tgwr_5.abi &gt; tgwr_5.log 2&gt; err &amp;
</code></pre></div>
<p>The output file is reported here for your convenience:</p>
<div class="text-center"><button id="uuid-98be26eb-6059-4791-ba74-caa7db6d4d93" class="md-button md-button--secondary"> View tests/tutorial/Refs/tgwr_5.abo </button></div>
<div id="uuid-729d5db6-1bdf-473d-8500-7c4b0d2850b2" class="my_dialog" title="tests/tutorial/Refs/tgwr_5.abo" hidden><div><pre class="small-text">

.Version 10.3.6.4 of ABINIT, released Feb 2025.
.(MPI version, prepared for a aarch64_darwin23.6.0_gnu14.2 computer)

.Copyright (C) 1998-2025 ABINIT group .
 ABINIT comes with ABSOLUTELY NO WARRANTY.
 It is free software, and you are welcome to redistribute it
 under certain conditions (GNU General Public License,
 see ~abinit/COPYING or http://www.gnu.org/copyleft/gpl.txt).

 ABINIT is a project of the Universite Catholique de Louvain,
 Corning Inc. and other collaborators, see ~abinit/doc/developers/contributors.txt .
 Please read https://docs.abinit.org/theory/acknowledgments for suggested
 acknowledgments of the ABINIT effort.
 For more information, see https://www.abinit.org .

.Starting date : Thu  3 Apr 2025.
- ( at 17h10 )

- input  file    -&gt; /Users/giantomassi/git_repos/abinit/_build/tests/Test_suite/tutorial_tgwr_1-tgwr_2-tgwr_3-tgwr_4-tgwr_5/tgwr_5.abi
- output file    -&gt; tgwr_5.abo
- root for input  files -&gt; tgwr_5i
- root for output files -&gt; tgwr_5o

 Symmetries : space group Fd -3 m (#227); Bravais cF (face-center cubic)
================================================================================
 Values of the parameters that define the memory need of the present run
     intxc =       0    ionmov =       0      iscf =       7    lmnmax =       6
     lnmax =       6     mgfft =      30  mpssoang =       3    mqgrid =    3001
     natom =       2  nloc_mem =       1    nspden =       1   nspinor =       1
    nsppol =       1      nsym =      48    n1xccc =    2501    ntypat =       1
    occopt =       1   xclevel =       2
-    mband =         250        mffmem =           1         mkmem =           3
       mpw =         435          nfft =       27000          nkpt =           3
================================================================================
P This job should need less than                      15.687 Mbytes of memory.
  Rough estimation (10% accuracy) of disk space for files :
_ WF disk file :      4.980 Mbytes ; DEN or POT disk file :      0.208 Mbytes.
================================================================================

--------------------------------------------------------------------------------
------------- Echo of variables that govern the present computation ------------
--------------------------------------------------------------------------------
-
- outvars: echo of selected default values
-   iomode0 =  0 , fftalg0 =312 , wfoptalg0 =  0
-
- outvars: echo of global parameters not present in the input file
-  max_nthreads =    0
-
 -outvars: echo values of preprocessed input variables --------
            acell      1.0260000000E+01  1.0260000000E+01  1.0260000000E+01 Bohr
              amu      2.80855000E+01
             ecut      1.60000000E+01 Hartree
          ecuteps      6.00000000E+00 Hartree
         ecutsigx      1.60000000E+01 Hartree
          ecutwfn      1.00000000E+01 Hartree
-          fftalg         312
       gw_qprange          -4
           istwfk        2    3    7
              ixc          11
              kpt      0.00000000E+00  0.00000000E+00  0.00000000E+00
                       5.00000000E-01  0.00000000E+00  0.00000000E+00
                       5.00000000E-01  5.00000000E-01  0.00000000E+00
         kptrlatt        2    0    0      0    2    0      0    0    2
          kptrlen      1.45098311E+01
P           mkmem           3
            natom           2
            nband         250
            ngfft          30      30      30
             nkpt           3
             nsym          48
           ntypat           1
              occ      2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000
        optdriver           6
            rprim      0.0000000000E+00  5.0000000000E-01  5.0000000000E-01
                       5.0000000000E-01  0.0000000000E+00  5.0000000000E-01
                       5.0000000000E-01  5.0000000000E-01  0.0000000000E+00
          spgroup         227
           symrel      1  0  0   0  1  0   0  0  1      -1  0  0   0 -1  0   0  0 -1
                       0 -1  1   0 -1  0   1 -1  0       0  1 -1   0  1  0  -1  1  0
                      -1  0  0  -1  0  1  -1  1  0       1  0  0   1  0 -1   1 -1  0
                       0  1 -1   1  0 -1   0  0 -1       0 -1  1  -1  0  1   0  0  1
                      -1  0  0  -1  1  0  -1  0  1       1  0  0   1 -1  0   1  0 -1
                       0 -1  1   1 -1  0   0 -1  0       0  1 -1  -1  1  0   0  1  0
                       1  0  0   0  0  1   0  1  0      -1  0  0   0  0 -1   0 -1  0
                       0  1 -1   0  0 -1   1  0 -1       0 -1  1   0  0  1  -1  0  1
                      -1  0  1  -1  1  0  -1  0  0       1  0 -1   1 -1  0   1  0  0
                       0 -1  0   1 -1  0   0 -1  1       0  1  0  -1  1  0   0  1 -1
                       1  0 -1   0  0 -1   0  1 -1      -1  0  1   0  0  1   0 -1  1
                       0  1  0   0  0  1   1  0  0       0 -1  0   0  0 -1  -1  0  0
                       1  0 -1   0  1 -1   0  0 -1      -1  0  1   0 -1  1   0  0  1
                       0 -1  0   0 -1  1   1 -1  0       0  1  0   0  1 -1  -1  1  0
                      -1  0  1  -1  0  0  -1  1  0       1  0 -1   1  0  0   1 -1  0
                       0  1  0   1  0  0   0  0  1       0 -1  0  -1  0  0   0  0 -1
                       0  0 -1   0  1 -1   1  0 -1       0  0  1   0 -1  1  -1  0  1
                       1 -1  0   0 -1  1   0 -1  0      -1  1  0   0  1 -1   0  1  0
                       0  0  1   1  0  0   0  1  0       0  0 -1  -1  0  0   0 -1  0
                      -1  1  0  -1  0  0  -1  0  1       1 -1  0   1  0  0   1  0 -1
                       0  0  1   0  1  0   1  0  0       0  0 -1   0 -1  0  -1  0  0
                       1 -1  0   0 -1  0   0 -1  1      -1  1  0   0  1  0   0  1 -1
                       0  0 -1   1  0 -1   0  1 -1       0  0  1  -1  0  1   0 -1  1
                      -1  1  0  -1  0  1  -1  0  0       1 -1  0   1  0 -1   1  0  0
            tnons      0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
            typat      1  1
              wtk        0.12500    0.50000    0.37500
           xangst      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       1.3573395400E+00  1.3573395400E+00  1.3573395400E+00
            xcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.5650000000E+00  2.5650000000E+00  2.5650000000E+00
             xred      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.5000000000E-01  2.5000000000E-01  2.5000000000E-01
            znucl       14.00000

================================================================================

 chkinp: Checking input parameters for consistency.

================================================================================
== DATASET  1 ==================================================================
-   mpi_nproc: 1, omp_nthreads: -1 (-1 if OMP is not activated)


--- !DatasetInfo
iteration_state: {dtset: 1, }
dimensions: {natom: 2, nkpt: 3, mband: 250, nsppol: 1, nspinor: 1, nspden: 1, mpw: 435, }
cutoff_energies: {ecut:  16.0, pawecutdg:  -1.0, }
electrons: {nelect:   8.00000000E+00, charge:   0.00000000E+00, occopt:   1.00000000E+00, tsmear:   1.00000000E-02, }
meta: {optdriver: 6, }
...

 mkfilename: getwfk from: tgwr_2o_DS1_WFK

 mkfilename: getden from: tgwr_1o_DS1_DEN

 Exchange-correlation functional for the present dataset will be:
  GGA: Perdew-Burke-Ernzerhof functional - ixc=11
 Citation for XC functional:
  J.P.Perdew, K.Burke, M.Ernzerhof, PRL 77, 3865 (1996)

.Using double precision arithmetic; gwpc =  8

- Reading GS density from: tgwr_1o_DS1_DEN




--- Pseudopotential description ------------------------------------------------
- pspini: atom type   1  psp file is /Users/giantomassi/git_repos/abinit/tests/Pspdir/Psdj_nc_sr_04_pbe_std_psp8/Si.psp8
- pspatm: opening atomic psp file    /Users/giantomassi/git_repos/abinit/tests/Pspdir/Psdj_nc_sr_04_pbe_std_psp8/Si.psp8
- Si    ONCVPSP-3.2.3.1  r_core=   1.60303   1.72197   1.91712
- 14.00000   4.00000    170510                znucl, zion, pspdat
    8   11    2    4       600   0.00000      pspcod,pspxc,lmax,lloc,mmax,r2well
    5.99000000000000    4.00000000000000    0.00000000000000   rchrg,fchrg,qchrg
     nproj     2     2     2
     extension_switch     1
  pspatm : epsatm=    9.34321699
         --- l  ekb(1:nproj) --&gt;
             0    5.168965    0.829883
             1    2.571282    0.578307
             2   -2.427311   -0.488097
 pspatm: atomic psp has been read  and splines computed

   1.49491472E+02                                ecore*ucvol(ha*bohr**3)
--------------------------------------------------------------------------------

 Total charge density [el/Bohr^3]
)     Maximum=    8.5569E-02  at reduced coord.    0.1000    0.1000    0.7000
)     Minimum=    1.4870E-03  at reduced coord.    0.0000    0.0000    0.0000
   Integrated=    8.0000E+00
- Reading GS states from WFK file: tgwr_2o_DS1_WFK
  Mapping kBZ --&gt; kIBZ
 Legend: bz = TS(ibz) + g0 where isym is the index of the symrec operation S and itim is 1 if TR is used.
        BZ                                       IBZ                                       ibz  isym  itim  g0
     1  [ 0.0000E+00,  0.0000E+00,  0.0000E+00]  [ 0.0000E+00,  0.0000E+00,  0.0000E+00]     1     1     0  [0, 0, 0]
     2  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]     2     1     0  [0, 0, 0]
     3  [ 5.0000E-01,  5.0000E-01,  5.0000E-01]  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]     2     5     0  [1, 1, 1]
     4  [ 0.0000E+00,  0.0000E+00,  5.0000E-01]  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]     2     3     0  [0, 0, 0]
     5  [ 0.0000E+00,  5.0000E-01,  0.0000E+00]  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]     2     7     0  [0, 0, 0]
     6  [ 5.0000E-01,  5.0000E-01,  0.0000E+00]  [ 5.0000E-01,  5.0000E-01,  0.0000E+00]     3     1     0  [0, 0, 0]
     7  [ 5.0000E-01,  0.0000E+00,  5.0000E-01]  [ 5.0000E-01,  5.0000E-01,  0.0000E+00]     3     9     0  [1, 0, 1]
     8  [ 0.0000E+00,  5.0000E-01,  5.0000E-01]  [ 5.0000E-01,  5.0000E-01,  0.0000E+00]     3    17     0  [0, 0, 0]


  Mapping qBZ --&gt; qIBZ
 Legend: bz = TS(ibz) + g0 where isym is the index of the symrec operation S and itim is 1 if TR is used.
        BZ                                       IBZ                                       ibz  isym  itim  g0
     1  [ 0.0000E+00,  0.0000E+00,  0.0000E+00]  [ 0.0000E+00,  0.0000E+00,  0.0000E+00]     1     1     0  [0, 0, 0]
     2  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]     2     1     0  [0, 0, 0]
     3  [ 5.0000E-01,  5.0000E-01,  5.0000E-01]  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]     2     5     0  [1, 1, 1]
     4  [ 0.0000E+00,  0.0000E+00,  5.0000E-01]  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]     2     3     0  [0, 0, 0]
     5  [ 0.0000E+00,  5.0000E-01,  0.0000E+00]  [ 5.0000E-01,  0.0000E+00,  0.0000E+00]     2     7     0  [0, 0, 0]
     6  [ 5.0000E-01,  5.0000E-01,  0.0000E+00]  [ 5.0000E-01,  5.0000E-01,  0.0000E+00]     3     1     0  [0, 0, 0]
     7  [ 5.0000E-01,  0.0000E+00,  5.0000E-01]  [ 5.0000E-01,  5.0000E-01,  0.0000E+00]     3     9     0  [1, 0, 1]
     8  [ 0.0000E+00,  5.0000E-01,  5.0000E-01]  [ 5.0000E-01,  5.0000E-01,  0.0000E+00]     3    17     0  [0, 0, 0]



 === Kohn-Sham gaps and band edges from IBZ mesh ===
 Indirect band gap semiconductor
 Fundamental gap:     0.707 (eV)
   VBM:    -0.354 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
   CBM:     0.354 (eV) at k: [ 5.0000E-01,  5.0000E-01,  0.0000E+00]
 Direct gap:         2.556 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]


- Optimizing MPI grid with mem_per_cpu_mb: 2.048000E+03 [Mb]
- Use `abinit run.abi --mem-per-cpu=4G` to set mem_per_cpu_mb in the submission script
- np_k  np_g  np_t  np_s  memb_per_cpu    efficiency       speedup
-    1     1     1     1   6.11409E+02   1.00000E+00   1.00000E+00
-
- Selected MPI grid:
- np_k  np_g  np_t  np_s  memb_per_cpu    efficiency       speedup
-    1     1     1     1   6.11409E+02   1.00000E+00   1.00000E+00

- Resident memory in Mb for G(g,g&#x27;,+/-tau) and chi(g,g&#x27;,tau):
- G_k(g,g,tau): 373.0
- Chi_q(g,g,tau): 19.8
- u_k(g,b): 4.7
- Temporary memory allocated inside the tau loops:
- G_k(r,g): 173.8
- chi_q(r,g): 40.1
- FFT uc_batch_size: 1
- FFT sc_batch_size: 1
 ==== Info on the gwr_t object ====

--- !GWR_params
iteration_state: {dtset: 1, }
gwr_task: G0W0
nband: 250
ntau: 12
ngkpt: [2, 2, 2, ]
ngqpt: [2, 2, 2, ]
chi_algo: supercell
sigma_algo: supercell
nkibz: 3
nqibz: 3
inclvkb: 2
q0: [  1.00000000E-05,   2.00000000E-05,   3.00000000E-05, ]
gw_icutcoul: 6
green_mpw: 412
tchi_mpw: 190
g_ngfft: [12, 12, 12, 12, 12, 12, ]
gwr_boxcutmin:   1.00000000E+00
P gwr_np_kgts: [1, 1, 1, 1, ]
P np_kibz: [1, 1, 1, ]
P np_qibz: [1, 1, 1, ]
min_transition_energy_eV:   7.07322721E-01
max_transition_energy_eV:   1.90213895E+02
eratio:   2.68920946E+02
ft_max_err_t2w_cos:   1.19214900E-03
ft_max_err_w2t_cos:   3.55934970E-05
ft_max_err_t2w_sin:   2.27327756E-02
cosft_duality_error:   5.10408367E-03
Minimax imaginary tau/omega mesh in a.u.: !Tabular | # tau, weight(tau), omega, weight(omega)
    1 3.01845E-02   7.84567E-02   6.37107E-03   1.30197E-02
    2 1.68348E-01   2.04750E-01   2.08408E-02   1.65798E-02
    3 4.62515E-01   4.00892E-01   4.11428E-02   2.50342E-02
    4 1.02120E+00   7.51969E-01   7.35654E-02   4.15594E-02
    5 2.06352E+00   1.39686E+00   1.29029E-01   7.25879E-02
    6 3.98516E+00   2.55709E+00   2.27719E-01   1.30961E-01
    7 7.46798E+00   4.59587E+00   4.08469E-01   2.42767E-01
    8 1.36656E+01   8.11373E+00   7.48639E-01   4.62721E-01
    9 2.45159E+01   1.41167E+01   1.40860E+00   9.11790E-01
    10 4.33066E+01   2.43993E+01   2.74298E+00   1.88995E+00
    11 7.59655E+01   4.28466E+01   5.67129E+00   4.41801E+00
    12 1.35795E+02   8.33674E+01   1.41554E+01   1.63699E+01
...

 Cutting u(g) as ecutwfn: 1.000000E+01  &lt;  ecut: 1.600000E+01

 Computing chi0 head and wings with inclvkb: 2
 Using KS orbitals and KS energies...


 Computing diagonal matrix elements of Sigma_x
 Using KS orbitals and KS energies...



 Building Green&#x27;s functions from KS orbitals and KS energies...



 Building correlated screening Wc(i omega) ...

--- !EMACRO_WITHOUT_LOCAL_FIELDS
iteration_state: {dtset: 1, }
&#x27;epsilon_{iw, q -&gt; Gamma}(0,0)&#x27;: !Tabular |
      6.37106624E-03    5.55279726E+01    7.98984477E-18
      2.08407959E-02    5.37815014E+01    2.13640238E-18
      4.11427666E-02    4.89350575E+01   -3.98104700E-17
      7.35653993E-02    3.89295630E+01   -3.64747690E-18
      1.29029157E-01    2.46713871E+01    5.46934312E-18
      2.27718878E-01    1.21440316E+01   -3.33963566E-18
      4.08469196E-01    5.16857531E+00    1.54888993E-18
      7.48638937E-01    2.34544068E+00   -7.78952948E-19
      1.40860376E+00    1.39397591E+00    3.52851872E-20
      2.74297741E+00    1.10584246E+00   -7.01587074E-20
      5.67129327E+00    1.02502657E+00   -6.01520988E-21
      1.41553560E+01    1.00403863E+00    1.70181465E-21
...


--- !EMACRO_WITH_LOCAL_FIELDS
iteration_state: {dtset: 1, }
&#x27;epsilon_{iw, q -&gt; Gamma}(0,0)&#x27;: !Tabular |
      6.37106624E-03    2.06795543E-02    0.00000000E+00
      2.08407959E-02    2.12825310E-02    0.00000000E+00
      4.11427666E-02    2.31803318E-02    0.00000000E+00
      7.35653993E-02    2.85859155E-02    0.00000000E+00
      1.29029157E-01    4.38160503E-02    0.00000000E+00
      2.27718878E-01    8.64291349E-02    0.00000000E+00
      4.08469196E-01    1.98525512E-01    0.00000000E+00
      7.48638937E-01    4.30694170E-01    0.00000000E+00
      1.40860376E+00    7.19057296E-01    0.00000000E+00
      2.74297741E+00    9.04569521E-01    0.00000000E+00
      5.67129327E+00    9.75607818E-01    0.00000000E+00
      1.41553560E+01    9.95978327E-01    0.00000000E+00
...

================================================================================
 QP results (energies in eV)
 Notations:
     E0: Kohn-Sham energy
     &lt;VxcDFT&gt;: Matrix elements of Vxc[n_val] without non-linear core correction (if any)
     SigX: Matrix elements of Sigma_x
     SigC(E0): Matrix elements of Sigma_c at E0
     Z: Renormalization factor
     E-E0: Difference between the QP and the KS energy.
     E-Eprev: Difference between QP energy at iteration i and i-1
     E: Quasi-particle energy
     Occ(E): Occupancy of QP state



--- !GWR_SelfEnergy_ee
iteration_state: {dtset: 1, }
kpoint     : [   0.000,    0.000,    0.000, ]
spin       : 1
gwr_scf_iteration: 1
gwr_task   : G0W0
QP_VBM_band: 2
QP_CBM_band: 5
KS_gap     :    2.556
QP_gap     :    3.449
Delta_QP_KS:    0.893
data: !Tabular |
     Band       E0 &lt;VxcDFT&gt;     SigX SigC(E0)        Z     E-E0  E-Eprev        E   Occ(E)
        1  -12.323  -10.470  -16.449    5.548    0.716   -0.049   -0.049  -12.373    2.000
        2   -0.354  -11.319  -13.616    1.514    0.777   -0.459   -0.459   -0.813    2.000
        3   -0.354  -11.319  -13.616    1.514    0.777   -0.460   -0.460   -0.813    2.000
        4   -0.354  -11.319  -13.616    1.514    0.777   -0.459   -0.459   -0.813    2.000
        5    2.202  -10.034   -4.915   -4.753    0.778    0.434    0.434    2.636    0.000
        6    2.202  -10.034   -4.915   -4.753    0.778    0.434    0.434    2.636    0.000
        7    2.202  -10.034   -4.915   -4.753    0.778    0.434    0.434    2.636    0.000
        8    2.996  -10.917   -5.006   -5.493    0.769    0.470    0.470    3.466    0.000
...


--- !GWR_SelfEnergy_ee
iteration_state: {dtset: 1, }
kpoint     : [   0.500,    0.000,    0.000, ]
spin       : 1
gwr_scf_iteration: 1
gwr_task   : G0W0
QP_VBM_band: 3
QP_CBM_band: 5
KS_gap     :    2.733
QP_gap     :    3.578
Delta_QP_KS:    0.845
data: !Tabular |
     Band       E0 &lt;VxcDFT&gt;     SigX SigC(E0)        Z     E-E0  E-Eprev        E   Occ(E)
        1   -9.991  -10.853  -15.973    4.636    0.732   -0.147   -0.147  -10.138    2.000
        2   -7.331  -10.209  -13.774    3.120    0.761   -0.171   -0.171   -7.502    2.000
        3   -1.556  -11.058  -13.442    1.686    0.774   -0.391   -0.391   -1.947    2.000
        4   -1.556  -11.058  -13.442    1.686    0.774   -0.392   -0.392   -1.947    2.000
        5    1.177  -10.088   -5.037   -4.663    0.786    0.454    0.454    1.631    0.000
        6    2.983   -9.664   -4.428   -4.837    0.784    0.461    0.461    3.445    0.000
        7    2.983   -9.664   -4.428   -4.838    0.784    0.461    0.461    3.444    0.000
        8    7.378   -7.761   -2.017   -5.677    0.789    0.192    0.192    7.571    0.000
...


--- !GWR_SelfEnergy_ee
iteration_state: {dtset: 1, }
kpoint     : [   0.500,    0.500,    0.000, ]
spin       : 1
gwr_scf_iteration: 1
gwr_task   : G0W0
QP_VBM_band: 4
QP_CBM_band: 5
KS_gap     :    3.565
QP_gap     :    4.326
Delta_QP_KS:    0.761
data: !Tabular |
     Band       E0 &lt;VxcDFT&gt;     SigX SigC(E0)        Z     E-E0  E-Eprev        E   Occ(E)
        1   -8.178  -10.852  -15.143    3.805    0.745   -0.183   -0.183   -8.361    2.000
        2   -8.178  -10.852  -15.143    3.805    0.745   -0.183   -0.183   -8.361    2.000
        3   -3.211  -10.592  -13.169    1.991    0.770   -0.302   -0.302   -3.513    2.000
        4   -3.211  -10.592  -13.169    1.991    0.770   -0.302   -0.302   -3.513    2.000
        5    0.354   -8.989   -4.197   -4.403    0.800    0.459    0.459    0.813    0.000
        6    0.354   -8.989   -4.197   -4.403    0.800    0.459    0.459    0.813    0.000
        7    9.744  -10.558   -3.773   -6.677    0.756    0.198    0.198    9.942    0.000
        8    9.744  -10.558   -3.773   -6.678    0.756    0.197    0.197    9.941    0.000
...


 === Kohn-Sham gaps and band edges from IBZ mesh ===
 Indirect band gap semiconductor
 Fundamental gap:     0.707 (eV)
   VBM:    -0.354 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
   CBM:     0.354 (eV) at k: [ 5.0000E-01,  5.0000E-01,  0.0000E+00]
 Direct gap:         2.556 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]


 === QP gaps and band edges taking into account Sigma_nk corrections for 3 k-points ===
 Indirect band gap semiconductor
 Fundamental gap:     1.626 (eV)
   VBM:    -0.813 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]
   CBM:     0.813 (eV) at k: [ 5.0000E-01,  5.0000E-01,  0.0000E+00]
 Direct gap:         3.449 (eV) at k: [ 0.0000E+00,  0.0000E+00,  0.0000E+00]


== END DATASET(S) ==============================================================
================================================================================

 -outvars: echo values of variables after computation  --------
            acell      1.0260000000E+01  1.0260000000E+01  1.0260000000E+01 Bohr
              amu      2.80855000E+01
             ecut      1.60000000E+01 Hartree
          ecuteps      6.00000000E+00 Hartree
         ecutsigx      1.60000000E+01 Hartree
          ecutwfn      1.00000000E+01 Hartree
           etotal      0.0000000000E+00
            fcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
-          fftalg         312
       gw_qprange          -4
           istwfk        2    3    7
              ixc          11
              kpt      0.00000000E+00  0.00000000E+00  0.00000000E+00
                       5.00000000E-01  0.00000000E+00  0.00000000E+00
                       5.00000000E-01  5.00000000E-01  0.00000000E+00
         kptrlatt        2    0    0      0    2    0      0    0    2
          kptrlen      1.45098311E+01
P           mkmem           3
            natom           2
            nband         250
            ngfft          30      30      30
             nkpt           3
             nsym          48
           ntypat           1
              occ      2.000000  2.000000  2.000000  2.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000  0.000000  0.000000
                       0.000000  0.000000  0.000000  0.000000
        optdriver           6
            rprim      0.0000000000E+00  5.0000000000E-01  5.0000000000E-01
                       5.0000000000E-01  0.0000000000E+00  5.0000000000E-01
                       5.0000000000E-01  5.0000000000E-01  0.0000000000E+00
          spgroup         227
           strten      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
           symrel      1  0  0   0  1  0   0  0  1      -1  0  0   0 -1  0   0  0 -1
                       0 -1  1   0 -1  0   1 -1  0       0  1 -1   0  1  0  -1  1  0
                      -1  0  0  -1  0  1  -1  1  0       1  0  0   1  0 -1   1 -1  0
                       0  1 -1   1  0 -1   0  0 -1       0 -1  1  -1  0  1   0  0  1
                      -1  0  0  -1  1  0  -1  0  1       1  0  0   1 -1  0   1  0 -1
                       0 -1  1   1 -1  0   0 -1  0       0  1 -1  -1  1  0   0  1  0
                       1  0  0   0  0  1   0  1  0      -1  0  0   0  0 -1   0 -1  0
                       0  1 -1   0  0 -1   1  0 -1       0 -1  1   0  0  1  -1  0  1
                      -1  0  1  -1  1  0  -1  0  0       1  0 -1   1 -1  0   1  0  0
                       0 -1  0   1 -1  0   0 -1  1       0  1  0  -1  1  0   0  1 -1
                       1  0 -1   0  0 -1   0  1 -1      -1  0  1   0  0  1   0 -1  1
                       0  1  0   0  0  1   1  0  0       0 -1  0   0  0 -1  -1  0  0
                       1  0 -1   0  1 -1   0  0 -1      -1  0  1   0 -1  1   0  0  1
                       0 -1  0   0 -1  1   1 -1  0       0  1  0   0  1 -1  -1  1  0
                      -1  0  1  -1  0  0  -1  1  0       1  0 -1   1  0  0   1 -1  0
                       0  1  0   1  0  0   0  0  1       0 -1  0  -1  0  0   0  0 -1
                       0  0 -1   0  1 -1   1  0 -1       0  0  1   0 -1  1  -1  0  1
                       1 -1  0   0 -1  1   0 -1  0      -1  1  0   0  1 -1   0  1  0
                       0  0  1   1  0  0   0  1  0       0  0 -1  -1  0  0   0 -1  0
                      -1  1  0  -1  0  0  -1  0  1       1 -1  0   1  0  0   1  0 -1
                       0  0  1   0  1  0   1  0  0       0  0 -1   0 -1  0  -1  0  0
                       1 -1  0   0 -1  0   0 -1  1      -1  1  0   0  1  0   0  1 -1
                       0  0 -1   1  0 -1   0  1 -1       0  0  1  -1  0  1   0 -1  1
                      -1  1  0  -1  0  1  -1  0  0       1 -1  0   1  0 -1   1  0  0
            tnons      0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
                       0.0000000  0.0000000  0.0000000     0.2500000  0.2500000  0.2500000
            typat      1  1
              wtk        0.12500    0.50000    0.37500
           xangst      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       1.3573395400E+00  1.3573395400E+00  1.3573395400E+00
            xcart      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.5650000000E+00  2.5650000000E+00  2.5650000000E+00
             xred      0.0000000000E+00  0.0000000000E+00  0.0000000000E+00
                       2.5000000000E-01  2.5000000000E-01  2.5000000000E-01
            znucl       14.00000

================================================================================


- Timing analysis has been suppressed with timopt=0



================================================================================

 Suggested references for the acknowledgment of ABINIT usage.

 The users of ABINIT have little formal obligations with respect to the ABINIT group
 (those specified in the GNU General Public License, http://www.gnu.org/copyleft/gpl.txt).
 However, it is common practice in the scientific literature,
 to acknowledge the efforts of people that have made the research possible.
 In this spirit, please find below suggested citations of work written by ABINIT developers,
 corresponding to implementations inside of ABINIT that you have used in the present run.
 Note also that it will be of great value to readers of publications presenting these results,
 to read papers enabling them to understand the theoretical formalism and details
 of the ABINIT implementation.
 For information on why they are suggested, see also https://docs.abinit.org/theory/acknowledgments.
-
- [1] The Abinit project: Impact, environment and recent developments.
- Computer Phys. Comm. 248, 107042 (2020).
- X.Gonze, B. Amadon, G. Antonius, F.Arnardi, L.Baguet, J.-M.Beuken,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, N.Brouwer, F.Bruneval,
- G.Brunin, T.Cavignac, J.-B. Charraud, Wei Chen, M.Cote, S.Cottenier,
- J.Denier, G.Geneste, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, Xu He, N.Helbig, N.Holzwarth, Y.Jia, F.Jollet,
- W.Lafargue-Dit-Hauret, K.Lejaeghere, M.A.L.Marques, A.Martin, C.Martins,
- H.P.C. Miranda, F.Naccarato, K. Persson, G.Petretto, V.Planes, Y.Pouillon,
- S.Prokhorenko, F.Ricci, G.-M.Rignanese, A.H.Romero, M.M.Schmitt, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, G.Zerah and J.W.Zwanzig
- Comment: the fifth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm.
- is available at https://www.abinit.org/sites/default/files/ABINIT20.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2020
-
- [2] Optimized norm-conserving Vanderbilt pseudopotentials.
- D.R. Hamann, Phys. Rev. B 88, 085117 (2013).
- Comment: Some pseudopotential generated using the ONCVPSP code were used.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#hamann2013
-
- [3] ABINIT: Overview, and focus on selected capabilities
- J. Chem. Phys. 152, 124102 (2020).
- A. Romero, D.C. Allan, B. Amadon, G. Antonius, T. Applencourt, L.Baguet,
- J.Bieder, F.Bottin, J.Bouchet, E.Bousquet, F.Bruneval,
- G.Brunin, D.Caliste, M.Cote,
- J.Denier, C. Dreyer, Ph.Ghosez, M.Giantomassi, Y.Gillet, O.Gingras,
- D.R.Hamann, G.Hautier, F.Jollet, G. Jomard,
- A.Martin,
- H.P.C. Miranda, F.Naccarato, G.Petretto, N.A. Pike, V.Planes,
- S.Prokhorenko, T. Rangel, F.Ricci, G.-M.Rignanese, M.Royo, M.Stengel, M.Torrent,
- M.J.van Setten, B.Van Troeye, M.J.Verstraete, J.Wiktor, J.W.Zwanziger, and X.Gonze.
- Comment: a global overview of ABINIT, with focus on selected capabilities .
- Note that a version of this paper, that is not formatted for J. Chem. Phys
- is available at https://www.abinit.org/sites/default/files/ABINIT20_JPC.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#romero2020
-
- [4] Recent developments in the ABINIT software package.
- Computer Phys. Comm. 205, 106 (2016).
- X.Gonze, F.Jollet, F.Abreu Araujo, D.Adams, B.Amadon, T.Applencourt,
- C.Audouze, J.-M.Beuken, J.Bieder, A.Bokhanchuk, E.Bousquet, F.Bruneval
- D.Caliste, M.Cote, F.Dahm, F.Da Pieve, M.Delaveau, M.Di Gennaro,
- B.Dorado, C.Espejo, G.Geneste, L.Genovese, A.Gerossier, M.Giantomassi,
- Y.Gillet, D.R.Hamann, L.He, G.Jomard, J.Laflamme Janssen, S.Le Roux,
- A.Levitt, A.Lherbier, F.Liu, I.Lukacevic, A.Martin, C.Martins,
- M.J.T.Oliveira, S.Ponce, Y.Pouillon, T.Rangel, G.-M.Rignanese,
- A.H.Romero, B.Rousseau, O.Rubel, A.A.Shukri, M.Stankovski, M.Torrent,
- M.J.Van Setten, B.Van Troeye, M.J.Verstraete, D.Waroquier, J.Wiktor,
- B.Xu, A.Zhou, J.W.Zwanziger.
- Comment: the fourth generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm.
- is available at https://www.abinit.org/sites/default/files/ABINIT16.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2016
-
- And optionally:
-
- [5] ABINIT: First-principles approach of materials and nanosystem properties.
- Computer Phys. Comm. 180, 2582-2615 (2009).
- X. Gonze, B. Amadon, P.-M. Anglade, J.-M. Beuken, F. Bottin, P. Boulanger, F. Bruneval,
- D. Caliste, R. Caracas, M. Cote, T. Deutsch, L. Genovese, Ph. Ghosez, M. Giantomassi
- S. Goedecker, D.R. Hamann, P. Hermet, F. Jollet, G. Jomard, S. Leroux, M. Mancini, S. Mazevet,
- M.J.T. Oliveira, G. Onida, Y. Pouillon, T. Rangel, G.-M. Rignanese, D. Sangalli, R. Shaltaf,
- M. Torrent, M.J. Verstraete, G. Zerah, J.W. Zwanziger
- Comment: the third generic paper describing the ABINIT project.
- Note that a version of this paper, that is not formatted for Computer Phys. Comm.
- is available at https://www.abinit.org/sites/default/files/ABINIT_CPC_v10.pdf .
- The licence allows the authors to put it on the Web.
- DOI and bibtex: see https://docs.abinit.org/theory/bibliography/#gonze2009
-
- Proc.   0 individual time (sec): cpu=         35.7  wall=         35.8

================================================================================

 Calculation completed.
.Delivered   1 WARNINGs and   6 COMMENTs to log file.
+Overall time at end (sec) : cpu=         35.7  wall=         35.8
- [ALL OK] MEMORY CONSUMPTION REPORT FOR C CODE:
-   There were 42 allocations and 42 deallocations in C code
- [ALL OK] MEMORY CONSUMPTION REPORT FOR FORTRAN CODE:
-   There were 990552 allocations and 990552 deallocations in Fortran
-   Remaining memory at the end of the calculation is 0

</pre>
</div></div>

<script> $(function() { abidocs_jqueryui_dialog("#uuid-729d5db6-1bdf-473d-8500-7c4b0d2850b2", "#uuid-98be26eb-6059-4791-ba74-caa7db6d4d93") }); </script>

<p>Now use the following AbiPy script to read the GWR results and interpolate the QP corrections.
In this case, we pass the KS band structure stored in <code>tgwr_1o_DS2_GSR.nc</code>.
This is the recommended approach as AbiPy will interpolate the QP corrections rather that the QP energies.
The interpolated QP corrections will then be added to the KS energies
thus improving the stability of the interpolation method as QP corrections
are usually smoother than QP energies.</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">abipy.electrons.gwr</span><span class="w"> </span><span class="kn">import</span> <span class="n">GwrFile</span>

<span class="n">gwr</span> <span class="o">=</span> <span class="n">GwrFile</span><span class="p">(</span><span class="s2">&quot;tgwr_5o_GWR.nc&quot;</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">gwr</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">ks_ebands_kpath</span><span class="o">=</span><span class="s2">&quot;tgwr_1o_DS2_GSR.nc&quot;</span><span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">abipy.electrons.ebands</span><span class="w"> </span><span class="kn">import</span> <span class="n">ElectronBandsPlotter</span>
<span class="n">plotter</span> <span class="o">=</span> <span class="n">ElectronBandsPlotter</span><span class="p">()</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_ebands</span><span class="p">(</span><span class="s2">&quot;KS&quot;</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">ks_ebands_kpath</span><span class="p">)</span>
<span class="n">plotter</span><span class="o">.</span><span class="n">add_ebands</span><span class="p">(</span><span class="s2">&quot;$G_0W_0$&quot;</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">qp_ebands_kpath</span><span class="p">)</span>

<span class="c1">#r.qp_ebands_kpath.plot(with_gaps=True)</span>

<span class="n">plotter</span><span class="o">.</span><span class="n">combiplot</span><span class="p">(</span><span class="n">savefig</span><span class="o">=</span><span class="s2">&quot;gw_vs_ks_bands.png&quot;</span><span class="p">)</span>
<span class="c1">#plotter.gridplot()</span>
</code></pre></div>
<p>Save the script in a file, lets say <code>plot_qpbands.py</code>, in the same
directory where we have launched the calculation, make the file executable and run it.
You should get the following figures:</p>
<p><img alt="" src="../gwr_assets/gw_vs_ks_combiplot.png" /></p>
<p><img alt="" src="../gwr_assets/gw_vs_ks_gridplot.png" /></p>







  
  






                

<!--
Add dropdown button with toolbar (based on https://bootsnipp.com/snippets/featured/inbox-by-gmail)
and return to Top button (based on https://codepen.io/rdallaire/pen/apoyx)
-->
<div class="md-container">
  <div class="row">
    <div id="inbox">
      <div class="fab btn-group show-on-hover dropup">
        <div data-toggle="tooltip" data-placement="left" title="Menu" style="margin-left: 42px;">
          <button id="return-to-top" type="button" class="btn btn-primary btn-io dropdown-toggle" data-toggle="dropdown">
            <span class="fa-stack fa-2x">
               <i class="fa fa-circle fa-stack-2x fab-backdrop"></i>
               <i class="fa fa-chevron-up fa-stack-1x fa-inverse fab-primary"></i>
               <i class="fa fa-map-signs fa-stack-1x fa-inverse fab-secondary"></i>
            </span>
          </button>
        </div>
        <ul class="dropdown-menu dropdown-menu-right" role="menu">
        
        
          <li>
            <a href="https://gmatteo.github.io/abinit/about/release-notes/"
               data-toggle="popover" data-tippy-content="About">
               <i class="fa fa-info-circle"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/developers/git_and_gitlab/"
               data-toggle="popover" data-tippy-content="Developers">
               <i class="fa fa-terminal"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/theory/geometry/"
               data-toggle="popover" data-tippy-content="Theory">
               <i class="fa fa-book"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/faq/configuration_and_compilation/"
               data-toggle="popover" data-tippy-content="FAQ">
               <i class="fa fa-graduation-cap"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/tutorial/"
               data-toggle="popover" data-tippy-content="Tutorials">
               <i class="fa fa-file-text-o"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/variables/"
               data-toggle="popover" data-tippy-content="Variables">
               <i class="fa fa-question"></i>
            </a>
          </li>
        
          <li>
            <a href="https://gmatteo.github.io/abinit/topics/features/"
               data-toggle="popover" data-tippy-content="Topics">
               <i class="fa fa-user-circle-o"></i>
            </a>
          </li>
        
          <li>
            <a href=""
               data-toggle="popover" data-tippy-content="User Guides">
               <i class="fa "></i>
            </a>
          </li>
        
        </ul>
      </div>
    </div>
  </div>
</div>

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="footer.title">
      
        <a href="../gwr_intro/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              GWR_intro
            </div>
          </div>
        </a>
      
      
        <a href="../bse/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Bethe-Salpeter
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
            <center>Abinit version 10.4.7</center>
        
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020-2024 The Abinit Group
            
            (MG)
            
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/abinit/abinit" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.youtube.com/watch?v=gcbfb_Mteo4" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305m-317.51 213.508V175.185l142.739 81.205z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="http://www.facebook.com/abinit.org" target="_blank" rel="noopener" title="www.facebook.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256c0 120 82.7 220.8 194.2 248.5V334.2h-52.8V256h52.8v-33.7c0-87.1 39.4-127.5 125-127.5 16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287v175.9C413.8 494.8 512 386.9 512 256"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/hashtag/abinit" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
</div>
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "header.autohide"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": "10.4.7"}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../extra_javascript/abidocs.js"></script>
      
    
  </body>
</html>